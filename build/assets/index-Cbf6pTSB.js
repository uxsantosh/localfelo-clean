(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const l of c.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function r(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(o){if(o.ep)return;o.ep=!0;const c=r(o);fetch(o.href,c)}})();function qx(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Kd={exports:{}},ba={},Yd={exports:{}},Ge={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lp;function Ww(){if(Lp)return Ge;Lp=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),c=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),p=Symbol.iterator;function y(T){return T===null||typeof T!="object"?null:(T=p&&T[p]||T["@@iterator"],typeof T=="function"?T:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,k={};function N(T,z,G){this.props=T,this.context=z,this.refs=k,this.updater=G||v}N.prototype.isReactComponent={},N.prototype.setState=function(T,z){if(typeof T!="object"&&typeof T!="function"&&T!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,T,z,"setState")},N.prototype.forceUpdate=function(T){this.updater.enqueueForceUpdate(this,T,"forceUpdate")};function C(){}C.prototype=N.prototype;function A(T,z,G){this.props=T,this.context=z,this.refs=k,this.updater=G||v}var E=A.prototype=new C;E.constructor=A,w(E,N.prototype),E.isPureReactComponent=!0;var _=Array.isArray,R=Object.prototype.hasOwnProperty,L={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function D(T,z,G){var M,X={},ie=null,be=null;if(z!=null)for(M in z.ref!==void 0&&(be=z.ref),z.key!==void 0&&(ie=""+z.key),z)R.call(z,M)&&!P.hasOwnProperty(M)&&(X[M]=z[M]);var ve=arguments.length-2;if(ve===1)X.children=G;else if(1<ve){for(var ee=Array(ve),ce=0;ce<ve;ce++)ee[ce]=arguments[ce+2];X.children=ee}if(T&&T.defaultProps)for(M in ve=T.defaultProps,ve)X[M]===void 0&&(X[M]=ve[M]);return{$$typeof:t,type:T,key:ie,ref:be,props:X,_owner:L.current}}function H(T,z){return{$$typeof:t,type:T.type,key:z,ref:T.ref,props:T.props,_owner:T._owner}}function B(T){return typeof T=="object"&&T!==null&&T.$$typeof===t}function ae(T){var z={"=":"=0",":":"=2"};return"$"+T.replace(/[=:]/g,function(G){return z[G]})}var ue=/\/+/g;function le(T,z){return typeof T=="object"&&T!==null&&T.key!=null?ae(""+T.key):z.toString(36)}function fe(T,z,G,M,X){var ie=typeof T;(ie==="undefined"||ie==="boolean")&&(T=null);var be=!1;if(T===null)be=!0;else switch(ie){case"string":case"number":be=!0;break;case"object":switch(T.$$typeof){case t:case e:be=!0}}if(be)return be=T,X=X(be),T=M===""?"."+le(be,0):M,_(X)?(G="",T!=null&&(G=T.replace(ue,"$&/")+"/"),fe(X,z,G,"",function(ce){return ce})):X!=null&&(B(X)&&(X=H(X,G+(!X.key||be&&be.key===X.key?"":(""+X.key).replace(ue,"$&/")+"/")+T)),z.push(X)),1;if(be=0,M=M===""?".":M+":",_(T))for(var ve=0;ve<T.length;ve++){ie=T[ve];var ee=M+le(ie,ve);be+=fe(ie,z,G,ee,X)}else if(ee=y(T),typeof ee=="function")for(T=ee.call(T),ve=0;!(ie=T.next()).done;)ie=ie.value,ee=M+le(ie,ve++),be+=fe(ie,z,G,ee,X);else if(ie==="object")throw z=String(T),Error("Objects are not valid as a React child (found: "+(z==="[object Object]"?"object with keys {"+Object.keys(T).join(", ")+"}":z)+"). If you meant to render a collection of children, use an array instead.");return be}function we(T,z,G){if(T==null)return T;var M=[],X=0;return fe(T,M,"","",function(ie){return z.call(G,ie,X++)}),M}function oe(T){if(T._status===-1){var z=T._result;z=z(),z.then(function(G){(T._status===0||T._status===-1)&&(T._status=1,T._result=G)},function(G){(T._status===0||T._status===-1)&&(T._status=2,T._result=G)}),T._status===-1&&(T._status=0,T._result=z)}if(T._status===1)return T._result.default;throw T._result}var Y={current:null},I={transition:null},$={ReactCurrentDispatcher:Y,ReactCurrentBatchConfig:I,ReactCurrentOwner:L};function W(){throw Error("act(...) is not supported in production builds of React.")}return Ge.Children={map:we,forEach:function(T,z,G){we(T,function(){z.apply(this,arguments)},G)},count:function(T){var z=0;return we(T,function(){z++}),z},toArray:function(T){return we(T,function(z){return z})||[]},only:function(T){if(!B(T))throw Error("React.Children.only expected to receive a single React element child.");return T}},Ge.Component=N,Ge.Fragment=r,Ge.Profiler=o,Ge.PureComponent=A,Ge.StrictMode=i,Ge.Suspense=h,Ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$,Ge.act=W,Ge.cloneElement=function(T,z,G){if(T==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+T+".");var M=w({},T.props),X=T.key,ie=T.ref,be=T._owner;if(z!=null){if(z.ref!==void 0&&(ie=z.ref,be=L.current),z.key!==void 0&&(X=""+z.key),T.type&&T.type.defaultProps)var ve=T.type.defaultProps;for(ee in z)R.call(z,ee)&&!P.hasOwnProperty(ee)&&(M[ee]=z[ee]===void 0&&ve!==void 0?ve[ee]:z[ee])}var ee=arguments.length-2;if(ee===1)M.children=G;else if(1<ee){ve=Array(ee);for(var ce=0;ce<ee;ce++)ve[ce]=arguments[ce+2];M.children=ve}return{$$typeof:t,type:T.type,key:X,ref:ie,props:M,_owner:be}},Ge.createContext=function(T){return T={$$typeof:l,_currentValue:T,_currentValue2:T,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},T.Provider={$$typeof:c,_context:T},T.Consumer=T},Ge.createElement=D,Ge.createFactory=function(T){var z=D.bind(null,T);return z.type=T,z},Ge.createRef=function(){return{current:null}},Ge.forwardRef=function(T){return{$$typeof:u,render:T}},Ge.isValidElement=B,Ge.lazy=function(T){return{$$typeof:g,_payload:{_status:-1,_result:T},_init:oe}},Ge.memo=function(T,z){return{$$typeof:f,type:T,compare:z===void 0?null:z}},Ge.startTransition=function(T){var z=I.transition;I.transition={};try{T()}finally{I.transition=z}},Ge.unstable_act=W,Ge.useCallback=function(T,z){return Y.current.useCallback(T,z)},Ge.useContext=function(T){return Y.current.useContext(T)},Ge.useDebugValue=function(){},Ge.useDeferredValue=function(T){return Y.current.useDeferredValue(T)},Ge.useEffect=function(T,z){return Y.current.useEffect(T,z)},Ge.useId=function(){return Y.current.useId()},Ge.useImperativeHandle=function(T,z,G){return Y.current.useImperativeHandle(T,z,G)},Ge.useInsertionEffect=function(T,z){return Y.current.useInsertionEffect(T,z)},Ge.useLayoutEffect=function(T,z){return Y.current.useLayoutEffect(T,z)},Ge.useMemo=function(T,z){return Y.current.useMemo(T,z)},Ge.useReducer=function(T,z,G){return Y.current.useReducer(T,z,G)},Ge.useRef=function(T){return Y.current.useRef(T)},Ge.useState=function(T){return Y.current.useState(T)},Ge.useSyncExternalStore=function(T,z,G){return Y.current.useSyncExternalStore(T,z,G)},Ge.useTransition=function(){return Y.current.useTransition()},Ge.version="18.3.1",Ge}var Rp;function Xu(){return Rp||(Rp=1,Yd.exports=Ww()),Yd.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dp;function Vw(){if(Dp)return ba;Dp=1;var t=Xu(),e=Symbol.for("react.element"),r=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,o=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(u,h,f){var g,p={},y=null,v=null;f!==void 0&&(y=""+f),h.key!==void 0&&(y=""+h.key),h.ref!==void 0&&(v=h.ref);for(g in h)i.call(h,g)&&!c.hasOwnProperty(g)&&(p[g]=h[g]);if(u&&u.defaultProps)for(g in h=u.defaultProps,h)p[g]===void 0&&(p[g]=h[g]);return{$$typeof:e,type:u,key:y,ref:v,props:p,_owner:o.current}}return ba.Fragment=r,ba.jsx=l,ba.jsxs=l,ba}var Fp;function zw(){return Fp||(Fp=1,Kd.exports=Vw()),Kd.exports}var s=zw(),pl={},Jd={exports:{}},os={},Qd={exports:{}},Zd={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mp;function qw(){return Mp||(Mp=1,(function(t){function e(I,$){var W=I.length;I.push($);e:for(;0<W;){var T=W-1>>>1,z=I[T];if(0<o(z,$))I[T]=$,I[W]=z,W=T;else break e}}function r(I){return I.length===0?null:I[0]}function i(I){if(I.length===0)return null;var $=I[0],W=I.pop();if(W!==$){I[0]=W;e:for(var T=0,z=I.length,G=z>>>1;T<G;){var M=2*(T+1)-1,X=I[M],ie=M+1,be=I[ie];if(0>o(X,W))ie<z&&0>o(be,X)?(I[T]=be,I[ie]=W,T=ie):(I[T]=X,I[M]=W,T=M);else if(ie<z&&0>o(be,W))I[T]=be,I[ie]=W,T=ie;else break e}}return $}function o(I,$){var W=I.sortIndex-$.sortIndex;return W!==0?W:I.id-$.id}if(typeof performance=="object"&&typeof performance.now=="function"){var c=performance;t.unstable_now=function(){return c.now()}}else{var l=Date,u=l.now();t.unstable_now=function(){return l.now()-u}}var h=[],f=[],g=1,p=null,y=3,v=!1,w=!1,k=!1,N=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(I){for(var $=r(f);$!==null;){if($.callback===null)i(f);else if($.startTime<=I)i(f),$.sortIndex=$.expirationTime,e(h,$);else break;$=r(f)}}function _(I){if(k=!1,E(I),!w)if(r(h)!==null)w=!0,oe(R);else{var $=r(f);$!==null&&Y(_,$.startTime-I)}}function R(I,$){w=!1,k&&(k=!1,C(D),D=-1),v=!0;var W=y;try{for(E($),p=r(h);p!==null&&(!(p.expirationTime>$)||I&&!ae());){var T=p.callback;if(typeof T=="function"){p.callback=null,y=p.priorityLevel;var z=T(p.expirationTime<=$);$=t.unstable_now(),typeof z=="function"?p.callback=z:p===r(h)&&i(h),E($)}else i(h);p=r(h)}if(p!==null)var G=!0;else{var M=r(f);M!==null&&Y(_,M.startTime-$),G=!1}return G}finally{p=null,y=W,v=!1}}var L=!1,P=null,D=-1,H=5,B=-1;function ae(){return!(t.unstable_now()-B<H)}function ue(){if(P!==null){var I=t.unstable_now();B=I;var $=!0;try{$=P(!0,I)}finally{$?le():(L=!1,P=null)}}else L=!1}var le;if(typeof A=="function")le=function(){A(ue)};else if(typeof MessageChannel<"u"){var fe=new MessageChannel,we=fe.port2;fe.port1.onmessage=ue,le=function(){we.postMessage(null)}}else le=function(){N(ue,0)};function oe(I){P=I,L||(L=!0,le())}function Y(I,$){D=N(function(){I(t.unstable_now())},$)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(I){I.callback=null},t.unstable_continueExecution=function(){w||v||(w=!0,oe(R))},t.unstable_forceFrameRate=function(I){0>I||125<I?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):H=0<I?Math.floor(1e3/I):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_getFirstCallbackNode=function(){return r(h)},t.unstable_next=function(I){switch(y){case 1:case 2:case 3:var $=3;break;default:$=y}var W=y;y=$;try{return I()}finally{y=W}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(I,$){switch(I){case 1:case 2:case 3:case 4:case 5:break;default:I=3}var W=y;y=I;try{return $()}finally{y=W}},t.unstable_scheduleCallback=function(I,$,W){var T=t.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?T+W:T):W=T,I){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=W+z,I={id:g++,callback:$,priorityLevel:I,startTime:W,expirationTime:z,sortIndex:-1},W>T?(I.sortIndex=W,e(f,I),r(h)===null&&I===r(f)&&(k?(C(D),D=-1):k=!0,Y(_,W-T))):(I.sortIndex=z,e(h,I),w||v||(w=!0,oe(R))),I},t.unstable_shouldYield=ae,t.unstable_wrapCallback=function(I){var $=y;return function(){var W=y;y=$;try{return I.apply(this,arguments)}finally{y=W}}}})(Zd)),Zd}var Op;function Hw(){return Op||(Op=1,Qd.exports=qw()),Qd.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Up;function Gw(){if(Up)return os;Up=1;var t=Xu(),e=Hw();function r(n){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+n,d=1;d<arguments.length;d++)a+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+n+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,o={};function c(n,a){l(n,a),l(n+"Capture",a)}function l(n,a){for(o[n]=a,n=0;n<a.length;n++)i.add(a[n])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},p={};function y(n){return h.call(p,n)?!0:h.call(g,n)?!1:f.test(n)?p[n]=!0:(g[n]=!0,!1)}function v(n,a,d,m){if(d!==null&&d.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return m?!1:d!==null?!d.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function w(n,a,d,m){if(a===null||typeof a>"u"||v(n,a,d,m))return!0;if(m)return!1;if(d!==null)switch(d.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function k(n,a,d,m,x,b,S){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=m,this.attributeNamespace=x,this.mustUseProperty=d,this.propertyName=n,this.type=a,this.sanitizeURL=b,this.removeEmptyString=S}var N={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){N[n]=new k(n,0,!1,n,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var a=n[0];N[a]=new k(a,1,!1,n[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(n){N[n]=new k(n,2,!1,n.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){N[n]=new k(n,2,!1,n,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){N[n]=new k(n,3,!1,n.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(n){N[n]=new k(n,3,!0,n,null,!1,!1)}),["capture","download"].forEach(function(n){N[n]=new k(n,4,!1,n,null,!1,!1)}),["cols","rows","size","span"].forEach(function(n){N[n]=new k(n,6,!1,n,null,!1,!1)}),["rowSpan","start"].forEach(function(n){N[n]=new k(n,5,!1,n.toLowerCase(),null,!1,!1)});var C=/[\-:]([a-z])/g;function A(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var a=n.replace(C,A);N[a]=new k(a,1,!1,n,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var a=n.replace(C,A);N[a]=new k(a,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(n){var a=n.replace(C,A);N[a]=new k(a,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(n){N[n]=new k(n,1,!1,n.toLowerCase(),null,!1,!1)}),N.xlinkHref=new k("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(n){N[n]=new k(n,1,!1,n.toLowerCase(),null,!0,!0)});function E(n,a,d,m){var x=N.hasOwnProperty(a)?N[a]:null;(x!==null?x.type!==0:m||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(w(a,d,x,m)&&(d=null),m||x===null?y(a)&&(d===null?n.removeAttribute(a):n.setAttribute(a,""+d)):x.mustUseProperty?n[x.propertyName]=d===null?x.type===3?!1:"":d:(a=x.attributeName,m=x.attributeNamespace,d===null?n.removeAttribute(a):(x=x.type,d=x===3||x===4&&d===!0?"":""+d,m?n.setAttributeNS(m,a,d):n.setAttribute(a,d))))}var _=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,R=Symbol.for("react.element"),L=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),D=Symbol.for("react.strict_mode"),H=Symbol.for("react.profiler"),B=Symbol.for("react.provider"),ae=Symbol.for("react.context"),ue=Symbol.for("react.forward_ref"),le=Symbol.for("react.suspense"),fe=Symbol.for("react.suspense_list"),we=Symbol.for("react.memo"),oe=Symbol.for("react.lazy"),Y=Symbol.for("react.offscreen"),I=Symbol.iterator;function $(n){return n===null||typeof n!="object"?null:(n=I&&n[I]||n["@@iterator"],typeof n=="function"?n:null)}var W=Object.assign,T;function z(n){if(T===void 0)try{throw Error()}catch(d){var a=d.stack.trim().match(/\n( *(at )?)/);T=a&&a[1]||""}return`
`+T+n}var G=!1;function M(n,a){if(!n||G)return"";G=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(te){var m=te}Reflect.construct(n,[],a)}else{try{a.call()}catch(te){m=te}n.call(a.prototype)}else{try{throw Error()}catch(te){m=te}n()}}catch(te){if(te&&m&&typeof te.stack=="string"){for(var x=te.stack.split(`
`),b=m.stack.split(`
`),S=x.length-1,F=b.length-1;1<=S&&0<=F&&x[S]!==b[F];)F--;for(;1<=S&&0<=F;S--,F--)if(x[S]!==b[F]){if(S!==1||F!==1)do if(S--,F--,0>F||x[S]!==b[F]){var q=`
`+x[S].replace(" at new "," at ");return n.displayName&&q.includes("<anonymous>")&&(q=q.replace("<anonymous>",n.displayName)),q}while(1<=S&&0<=F);break}}}finally{G=!1,Error.prepareStackTrace=d}return(n=n?n.displayName||n.name:"")?z(n):""}function X(n){switch(n.tag){case 5:return z(n.type);case 16:return z("Lazy");case 13:return z("Suspense");case 19:return z("SuspenseList");case 0:case 2:case 15:return n=M(n.type,!1),n;case 11:return n=M(n.type.render,!1),n;case 1:return n=M(n.type,!0),n;default:return""}}function ie(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case P:return"Fragment";case L:return"Portal";case H:return"Profiler";case D:return"StrictMode";case le:return"Suspense";case fe:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case ae:return(n.displayName||"Context")+".Consumer";case B:return(n._context.displayName||"Context")+".Provider";case ue:var a=n.render;return n=n.displayName,n||(n=a.displayName||a.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case we:return a=n.displayName||null,a!==null?a:ie(n.type)||"Memo";case oe:a=n._payload,n=n._init;try{return ie(n(a))}catch{}}return null}function be(n){var a=n.type;switch(n.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=a.render,n=n.displayName||n.name||"",a.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ie(a);case 8:return a===D?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function ve(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function ee(n){var a=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function ce(n){var a=ee(n)?"checked":"value",d=Object.getOwnPropertyDescriptor(n.constructor.prototype,a),m=""+n[a];if(!n.hasOwnProperty(a)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var x=d.get,b=d.set;return Object.defineProperty(n,a,{configurable:!0,get:function(){return x.call(this)},set:function(S){m=""+S,b.call(this,S)}}),Object.defineProperty(n,a,{enumerable:d.enumerable}),{getValue:function(){return m},setValue:function(S){m=""+S},stopTracking:function(){n._valueTracker=null,delete n[a]}}}}function Ue(n){n._valueTracker||(n._valueTracker=ce(n))}function he(n){if(!n)return!1;var a=n._valueTracker;if(!a)return!0;var d=a.getValue(),m="";return n&&(m=ee(n)?n.checked?"true":"false":n.value),n=m,n!==d?(a.setValue(n),!0):!1}function Le(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Ke(n,a){var d=a.checked;return W({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??n._wrapperState.initialChecked})}function at(n,a){var d=a.defaultValue==null?"":a.defaultValue,m=a.checked!=null?a.checked:a.defaultChecked;d=ve(a.value!=null?a.value:d),n._wrapperState={initialChecked:m,initialValue:d,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function re(n,a){a=a.checked,a!=null&&E(n,"checked",a,!1)}function ne(n,a){re(n,a);var d=ve(a.value),m=a.type;if(d!=null)m==="number"?(d===0&&n.value===""||n.value!=d)&&(n.value=""+d):n.value!==""+d&&(n.value=""+d);else if(m==="submit"||m==="reset"){n.removeAttribute("value");return}a.hasOwnProperty("value")?He(n,a.type,d):a.hasOwnProperty("defaultValue")&&He(n,a.type,ve(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(n.defaultChecked=!!a.defaultChecked)}function Oe(n,a,d){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var m=a.type;if(!(m!=="submit"&&m!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+n._wrapperState.initialValue,d||a===n.value||(n.value=a),n.defaultValue=a}d=n.name,d!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,d!==""&&(n.name=d)}function He(n,a,d){(a!=="number"||Le(n.ownerDocument)!==n)&&(d==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+d&&(n.defaultValue=""+d))}var wt=Array.isArray;function Lt(n,a,d,m){if(n=n.options,a){a={};for(var x=0;x<d.length;x++)a["$"+d[x]]=!0;for(d=0;d<n.length;d++)x=a.hasOwnProperty("$"+n[d].value),n[d].selected!==x&&(n[d].selected=x),x&&m&&(n[d].defaultSelected=!0)}else{for(d=""+ve(d),a=null,x=0;x<n.length;x++){if(n[x].value===d){n[x].selected=!0,m&&(n[x].defaultSelected=!0);return}a!==null||n[x].disabled||(a=n[x])}a!==null&&(a.selected=!0)}}function st(n,a){if(a.dangerouslySetInnerHTML!=null)throw Error(r(91));return W({},a,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Qt(n,a){var d=a.value;if(d==null){if(d=a.children,a=a.defaultValue,d!=null){if(a!=null)throw Error(r(92));if(wt(d)){if(1<d.length)throw Error(r(93));d=d[0]}a=d}a==null&&(a=""),d=a}n._wrapperState={initialValue:ve(d)}}function Ae(n,a){var d=ve(a.value),m=ve(a.defaultValue);d!=null&&(d=""+d,d!==n.value&&(n.value=d),a.defaultValue==null&&n.defaultValue!==d&&(n.defaultValue=d)),m!=null&&(n.defaultValue=""+m)}function Je(n){var a=n.textContent;a===n._wrapperState.initialValue&&a!==""&&a!==null&&(n.value=a)}function jt(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function St(n,a){return n==null||n==="http://www.w3.org/1999/xhtml"?jt(a):n==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var xe,ur=(function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,d,m,x){MSApp.execUnsafeLocalFunction(function(){return n(a,d,m,x)})}:n})(function(n,a){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=a;else{for(xe=xe||document.createElement("div"),xe.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=xe.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;a.firstChild;)n.appendChild(a.firstChild)}});function ts(n,a){if(a){var d=n.firstChild;if(d&&d===n.lastChild&&d.nodeType===3){d.nodeValue=a;return}}n.textContent=a}var Ds={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Zs=["Webkit","ms","Moz","O"];Object.keys(Ds).forEach(function(n){Zs.forEach(function(a){a=a+n.charAt(0).toUpperCase()+n.substring(1),Ds[a]=Ds[n]})});function hr(n,a,d){return a==null||typeof a=="boolean"||a===""?"":d||typeof a!="number"||a===0||Ds.hasOwnProperty(n)&&Ds[n]?(""+a).trim():a+"px"}function js(n,a){n=n.style;for(var d in a)if(a.hasOwnProperty(d)){var m=d.indexOf("--")===0,x=hr(d,a[d],m);d==="float"&&(d="cssFloat"),m?n.setProperty(d,x):n[d]=x}}var zt=W({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ir(n,a){if(a){if(zt[n]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(r(137,n));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(r(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(r(61))}if(a.style!=null&&typeof a.style!="object")throw Error(r(62))}}function dn(n,a){if(n.indexOf("-")===-1)return typeof a.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var mr=null;function Zt(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var qe=null,Fs=null,Ms=null;function Lr(n){if(n=na(n)){if(typeof qe!="function")throw Error(r(280));var a=n.stateNode;a&&(a=Po(a),qe(n.stateNode,n.type,a))}}function se(n){Fs?Ms?Ms.push(n):Ms=[n]:Fs=n}function ft(){if(Fs){var n=Fs,a=Ms;if(Ms=Fs=null,Lr(n),a)for(n=0;n<a.length;n++)Lr(a[n])}}function O(n,a){return n(a)}function U(){}var Re=!1;function pe(n,a,d){if(Re)return n(a,d);Re=!0;try{return O(n,a,d)}finally{Re=!1,(Fs!==null||Ms!==null)&&(U(),ft())}}function De(n,a){var d=n.stateNode;if(d===null)return null;var m=Po(d);if(m===null)return null;d=m[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(n=n.type,m=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!m;break e;default:n=!1}if(n)return null;if(d&&typeof d!="function")throw Error(r(231,a,typeof d));return d}var Ie=!1;if(u)try{var $e={};Object.defineProperty($e,"passive",{get:function(){Ie=!0}}),window.addEventListener("test",$e,$e),window.removeEventListener("test",$e,$e)}catch{Ie=!1}function Te(n,a,d,m,x,b,S,F,q){var te=Array.prototype.slice.call(arguments,3);try{a.apply(d,te)}catch(me){this.onError(me)}}var Ye=!1,Ze=null,Ct=!1,Rt=null,oo={onError:function(n){Ye=!0,Ze=n}};function Xs(n,a,d,m,x,b,S,F,q){Ye=!1,Ze=null,Te.apply(oo,arguments)}function lo(n,a,d,m,x,b,S,F,q){if(Xs.apply(this,arguments),Ye){if(Ye){var te=Ze;Ye=!1,Ze=null}else throw Error(r(198));Ct||(Ct=!0,Rt=te)}}function fr(n){var a=n,d=n;if(n.alternate)for(;a.return;)a=a.return;else{n=a;do a=n,(a.flags&4098)!==0&&(d=a.return),n=a.return;while(n)}return a.tag===3?d:null}function tm(n){if(n.tag===13){var a=n.memoizedState;if(a===null&&(n=n.alternate,n!==null&&(a=n.memoizedState)),a!==null)return a.dehydrated}return null}function sm(n){if(fr(n)!==n)throw Error(r(188))}function Zb(n){var a=n.alternate;if(!a){if(a=fr(n),a===null)throw Error(r(188));return a!==n?null:n}for(var d=n,m=a;;){var x=d.return;if(x===null)break;var b=x.alternate;if(b===null){if(m=x.return,m!==null){d=m;continue}break}if(x.child===b.child){for(b=x.child;b;){if(b===d)return sm(x),n;if(b===m)return sm(x),a;b=b.sibling}throw Error(r(188))}if(d.return!==m.return)d=x,m=b;else{for(var S=!1,F=x.child;F;){if(F===d){S=!0,d=x,m=b;break}if(F===m){S=!0,m=x,d=b;break}F=F.sibling}if(!S){for(F=b.child;F;){if(F===d){S=!0,d=b,m=x;break}if(F===m){S=!0,m=b,d=x;break}F=F.sibling}if(!S)throw Error(r(189))}}if(d.alternate!==m)throw Error(r(190))}if(d.tag!==3)throw Error(r(188));return d.stateNode.current===d?n:a}function rm(n){return n=Zb(n),n!==null?nm(n):null}function nm(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var a=nm(n);if(a!==null)return a;n=n.sibling}return null}var im=e.unstable_scheduleCallback,am=e.unstable_cancelCallback,Xb=e.unstable_shouldYield,ev=e.unstable_requestPaint,Nt=e.unstable_now,tv=e.unstable_getCurrentPriorityLevel,fc=e.unstable_ImmediatePriority,om=e.unstable_UserBlockingPriority,co=e.unstable_NormalPriority,sv=e.unstable_LowPriority,lm=e.unstable_IdlePriority,uo=null,er=null;function rv(n){if(er&&typeof er.onCommitFiberRoot=="function")try{er.onCommitFiberRoot(uo,n,void 0,(n.current.flags&128)===128)}catch{}}var Os=Math.clz32?Math.clz32:av,nv=Math.log,iv=Math.LN2;function av(n){return n>>>=0,n===0?32:31-(nv(n)/iv|0)|0}var ho=64,mo=4194304;function $i(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function fo(n,a){var d=n.pendingLanes;if(d===0)return 0;var m=0,x=n.suspendedLanes,b=n.pingedLanes,S=d&268435455;if(S!==0){var F=S&~x;F!==0?m=$i(F):(b&=S,b!==0&&(m=$i(b)))}else S=d&~x,S!==0?m=$i(S):b!==0&&(m=$i(b));if(m===0)return 0;if(a!==0&&a!==m&&(a&x)===0&&(x=m&-m,b=a&-a,x>=b||x===16&&(b&4194240)!==0))return a;if((m&4)!==0&&(m|=d&16),a=n.entangledLanes,a!==0)for(n=n.entanglements,a&=m;0<a;)d=31-Os(a),x=1<<d,m|=n[d],a&=~x;return m}function ov(n,a){switch(n){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lv(n,a){for(var d=n.suspendedLanes,m=n.pingedLanes,x=n.expirationTimes,b=n.pendingLanes;0<b;){var S=31-Os(b),F=1<<S,q=x[S];q===-1?((F&d)===0||(F&m)!==0)&&(x[S]=ov(F,a)):q<=a&&(n.expiredLanes|=F),b&=~F}}function pc(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function cm(){var n=ho;return ho<<=1,(ho&4194240)===0&&(ho=64),n}function gc(n){for(var a=[],d=0;31>d;d++)a.push(n);return a}function Bi(n,a,d){n.pendingLanes|=a,a!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,a=31-Os(a),n[a]=d}function cv(n,a){var d=n.pendingLanes&~a;n.pendingLanes=a,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=a,n.mutableReadLanes&=a,n.entangledLanes&=a,a=n.entanglements;var m=n.eventTimes;for(n=n.expirationTimes;0<d;){var x=31-Os(d),b=1<<x;a[x]=0,m[x]=-1,n[x]=-1,d&=~b}}function xc(n,a){var d=n.entangledLanes|=a;for(n=n.entanglements;d;){var m=31-Os(d),x=1<<m;x&a|n[m]&a&&(n[m]|=a),d&=~x}}var et=0;function dm(n){return n&=-n,1<n?4<n?(n&268435455)!==0?16:536870912:4:1}var um,yc,hm,mm,fm,bc=!1,po=[],Rr=null,Dr=null,Fr=null,Wi=new Map,Vi=new Map,Mr=[],dv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function pm(n,a){switch(n){case"focusin":case"focusout":Rr=null;break;case"dragenter":case"dragleave":Dr=null;break;case"mouseover":case"mouseout":Fr=null;break;case"pointerover":case"pointerout":Wi.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vi.delete(a.pointerId)}}function zi(n,a,d,m,x,b){return n===null||n.nativeEvent!==b?(n={blockedOn:a,domEventName:d,eventSystemFlags:m,nativeEvent:b,targetContainers:[x]},a!==null&&(a=na(a),a!==null&&yc(a)),n):(n.eventSystemFlags|=m,a=n.targetContainers,x!==null&&a.indexOf(x)===-1&&a.push(x),n)}function uv(n,a,d,m,x){switch(a){case"focusin":return Rr=zi(Rr,n,a,d,m,x),!0;case"dragenter":return Dr=zi(Dr,n,a,d,m,x),!0;case"mouseover":return Fr=zi(Fr,n,a,d,m,x),!0;case"pointerover":var b=x.pointerId;return Wi.set(b,zi(Wi.get(b)||null,n,a,d,m,x)),!0;case"gotpointercapture":return b=x.pointerId,Vi.set(b,zi(Vi.get(b)||null,n,a,d,m,x)),!0}return!1}function gm(n){var a=un(n.target);if(a!==null){var d=fr(a);if(d!==null){if(a=d.tag,a===13){if(a=tm(d),a!==null){n.blockedOn=a,fm(n.priority,function(){hm(d)});return}}else if(a===3&&d.stateNode.current.memoizedState.isDehydrated){n.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}n.blockedOn=null}function go(n){if(n.blockedOn!==null)return!1;for(var a=n.targetContainers;0<a.length;){var d=wc(n.domEventName,n.eventSystemFlags,a[0],n.nativeEvent);if(d===null){d=n.nativeEvent;var m=new d.constructor(d.type,d);mr=m,d.target.dispatchEvent(m),mr=null}else return a=na(d),a!==null&&yc(a),n.blockedOn=d,!1;a.shift()}return!0}function xm(n,a,d){go(n)&&d.delete(a)}function hv(){bc=!1,Rr!==null&&go(Rr)&&(Rr=null),Dr!==null&&go(Dr)&&(Dr=null),Fr!==null&&go(Fr)&&(Fr=null),Wi.forEach(xm),Vi.forEach(xm)}function qi(n,a){n.blockedOn===a&&(n.blockedOn=null,bc||(bc=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,hv)))}function Hi(n){function a(x){return qi(x,n)}if(0<po.length){qi(po[0],n);for(var d=1;d<po.length;d++){var m=po[d];m.blockedOn===n&&(m.blockedOn=null)}}for(Rr!==null&&qi(Rr,n),Dr!==null&&qi(Dr,n),Fr!==null&&qi(Fr,n),Wi.forEach(a),Vi.forEach(a),d=0;d<Mr.length;d++)m=Mr[d],m.blockedOn===n&&(m.blockedOn=null);for(;0<Mr.length&&(d=Mr[0],d.blockedOn===null);)gm(d),d.blockedOn===null&&Mr.shift()}var On=_.ReactCurrentBatchConfig,xo=!0;function mv(n,a,d,m){var x=et,b=On.transition;On.transition=null;try{et=1,vc(n,a,d,m)}finally{et=x,On.transition=b}}function fv(n,a,d,m){var x=et,b=On.transition;On.transition=null;try{et=4,vc(n,a,d,m)}finally{et=x,On.transition=b}}function vc(n,a,d,m){if(xo){var x=wc(n,a,d,m);if(x===null)Oc(n,a,m,yo,d),pm(n,m);else if(uv(x,n,a,d,m))m.stopPropagation();else if(pm(n,m),a&4&&-1<dv.indexOf(n)){for(;x!==null;){var b=na(x);if(b!==null&&um(b),b=wc(n,a,d,m),b===null&&Oc(n,a,m,yo,d),b===x)break;x=b}x!==null&&m.stopPropagation()}else Oc(n,a,m,null,d)}}var yo=null;function wc(n,a,d,m){if(yo=null,n=Zt(m),n=un(n),n!==null)if(a=fr(n),a===null)n=null;else if(d=a.tag,d===13){if(n=tm(a),n!==null)return n;n=null}else if(d===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;n=null}else a!==n&&(n=null);return yo=n,null}function ym(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(tv()){case fc:return 1;case om:return 4;case co:case sv:return 16;case lm:return 536870912;default:return 16}default:return 16}}var Or=null,jc=null,bo=null;function bm(){if(bo)return bo;var n,a=jc,d=a.length,m,x="value"in Or?Or.value:Or.textContent,b=x.length;for(n=0;n<d&&a[n]===x[n];n++);var S=d-n;for(m=1;m<=S&&a[d-m]===x[b-m];m++);return bo=x.slice(n,1<m?1-m:void 0)}function vo(n){var a=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&a===13&&(n=13)):n=a,n===10&&(n=13),32<=n||n===13?n:0}function wo(){return!0}function vm(){return!1}function us(n){function a(d,m,x,b,S){this._reactName=d,this._targetInst=x,this.type=m,this.nativeEvent=b,this.target=S,this.currentTarget=null;for(var F in n)n.hasOwnProperty(F)&&(d=n[F],this[F]=d?d(b):b[F]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?wo:vm,this.isPropagationStopped=vm,this}return W(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=wo)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=wo)},persist:function(){},isPersistent:wo}),a}var Un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Nc=us(Un),Gi=W({},Un,{view:0,detail:0}),pv=us(Gi),kc,_c,Ki,jo=W({},Gi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cc,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Ki&&(Ki&&n.type==="mousemove"?(kc=n.screenX-Ki.screenX,_c=n.screenY-Ki.screenY):_c=kc=0,Ki=n),kc)},movementY:function(n){return"movementY"in n?n.movementY:_c}}),wm=us(jo),gv=W({},jo,{dataTransfer:0}),xv=us(gv),yv=W({},Gi,{relatedTarget:0}),Sc=us(yv),bv=W({},Un,{animationName:0,elapsedTime:0,pseudoElement:0}),vv=us(bv),wv=W({},Un,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),jv=us(wv),Nv=W({},Un,{data:0}),jm=us(Nv),kv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_v={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cv(n){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(n):(n=Sv[n])?!!a[n]:!1}function Cc(){return Cv}var Tv=W({},Gi,{key:function(n){if(n.key){var a=kv[n.key]||n.key;if(a!=="Unidentified")return a}return n.type==="keypress"?(n=vo(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?_v[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cc,charCode:function(n){return n.type==="keypress"?vo(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?vo(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Ev=us(Tv),Pv=W({},jo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Nm=us(Pv),Av=W({},Gi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cc}),Iv=us(Av),Lv=W({},Un,{propertyName:0,elapsedTime:0,pseudoElement:0}),Rv=us(Lv),Dv=W({},jo,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Fv=us(Dv),Mv=[9,13,27,32],Tc=u&&"CompositionEvent"in window,Yi=null;u&&"documentMode"in document&&(Yi=document.documentMode);var Ov=u&&"TextEvent"in window&&!Yi,km=u&&(!Tc||Yi&&8<Yi&&11>=Yi),_m=" ",Sm=!1;function Cm(n,a){switch(n){case"keyup":return Mv.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Tm(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var $n=!1;function Uv(n,a){switch(n){case"compositionend":return Tm(a);case"keypress":return a.which!==32?null:(Sm=!0,_m);case"textInput":return n=a.data,n===_m&&Sm?null:n;default:return null}}function $v(n,a){if($n)return n==="compositionend"||!Tc&&Cm(n,a)?(n=bm(),bo=jc=Or=null,$n=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return km&&a.locale!=="ko"?null:a.data;default:return null}}var Bv={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Em(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a==="input"?!!Bv[n.type]:a==="textarea"}function Pm(n,a,d,m){se(m),a=Co(a,"onChange"),0<a.length&&(d=new Nc("onChange","change",null,d,m),n.push({event:d,listeners:a}))}var Ji=null,Qi=null;function Wv(n){Km(n,0)}function No(n){var a=qn(n);if(he(a))return n}function Vv(n,a){if(n==="change")return a}var Am=!1;if(u){var Ec;if(u){var Pc="oninput"in document;if(!Pc){var Im=document.createElement("div");Im.setAttribute("oninput","return;"),Pc=typeof Im.oninput=="function"}Ec=Pc}else Ec=!1;Am=Ec&&(!document.documentMode||9<document.documentMode)}function Lm(){Ji&&(Ji.detachEvent("onpropertychange",Rm),Qi=Ji=null)}function Rm(n){if(n.propertyName==="value"&&No(Qi)){var a=[];Pm(a,Qi,n,Zt(n)),pe(Wv,a)}}function zv(n,a,d){n==="focusin"?(Lm(),Ji=a,Qi=d,Ji.attachEvent("onpropertychange",Rm)):n==="focusout"&&Lm()}function qv(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return No(Qi)}function Hv(n,a){if(n==="click")return No(a)}function Gv(n,a){if(n==="input"||n==="change")return No(a)}function Kv(n,a){return n===a&&(n!==0||1/n===1/a)||n!==n&&a!==a}var Us=typeof Object.is=="function"?Object.is:Kv;function Zi(n,a){if(Us(n,a))return!0;if(typeof n!="object"||n===null||typeof a!="object"||a===null)return!1;var d=Object.keys(n),m=Object.keys(a);if(d.length!==m.length)return!1;for(m=0;m<d.length;m++){var x=d[m];if(!h.call(a,x)||!Us(n[x],a[x]))return!1}return!0}function Dm(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Fm(n,a){var d=Dm(n);n=0;for(var m;d;){if(d.nodeType===3){if(m=n+d.textContent.length,n<=a&&m>=a)return{node:d,offset:a-n};n=m}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=Dm(d)}}function Mm(n,a){return n&&a?n===a?!0:n&&n.nodeType===3?!1:a&&a.nodeType===3?Mm(n,a.parentNode):"contains"in n?n.contains(a):n.compareDocumentPosition?!!(n.compareDocumentPosition(a)&16):!1:!1}function Om(){for(var n=window,a=Le();a instanceof n.HTMLIFrameElement;){try{var d=typeof a.contentWindow.location.href=="string"}catch{d=!1}if(d)n=a.contentWindow;else break;a=Le(n.document)}return a}function Ac(n){var a=n&&n.nodeName&&n.nodeName.toLowerCase();return a&&(a==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||a==="textarea"||n.contentEditable==="true")}function Yv(n){var a=Om(),d=n.focusedElem,m=n.selectionRange;if(a!==d&&d&&d.ownerDocument&&Mm(d.ownerDocument.documentElement,d)){if(m!==null&&Ac(d)){if(a=m.start,n=m.end,n===void 0&&(n=a),"selectionStart"in d)d.selectionStart=a,d.selectionEnd=Math.min(n,d.value.length);else if(n=(a=d.ownerDocument||document)&&a.defaultView||window,n.getSelection){n=n.getSelection();var x=d.textContent.length,b=Math.min(m.start,x);m=m.end===void 0?b:Math.min(m.end,x),!n.extend&&b>m&&(x=m,m=b,b=x),x=Fm(d,b);var S=Fm(d,m);x&&S&&(n.rangeCount!==1||n.anchorNode!==x.node||n.anchorOffset!==x.offset||n.focusNode!==S.node||n.focusOffset!==S.offset)&&(a=a.createRange(),a.setStart(x.node,x.offset),n.removeAllRanges(),b>m?(n.addRange(a),n.extend(S.node,S.offset)):(a.setEnd(S.node,S.offset),n.addRange(a)))}}for(a=[],n=d;n=n.parentNode;)n.nodeType===1&&a.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<a.length;d++)n=a[d],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Jv=u&&"documentMode"in document&&11>=document.documentMode,Bn=null,Ic=null,Xi=null,Lc=!1;function Um(n,a,d){var m=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Lc||Bn==null||Bn!==Le(m)||(m=Bn,"selectionStart"in m&&Ac(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),Xi&&Zi(Xi,m)||(Xi=m,m=Co(Ic,"onSelect"),0<m.length&&(a=new Nc("onSelect","select",null,a,d),n.push({event:a,listeners:m}),a.target=Bn)))}function ko(n,a){var d={};return d[n.toLowerCase()]=a.toLowerCase(),d["Webkit"+n]="webkit"+a,d["Moz"+n]="moz"+a,d}var Wn={animationend:ko("Animation","AnimationEnd"),animationiteration:ko("Animation","AnimationIteration"),animationstart:ko("Animation","AnimationStart"),transitionend:ko("Transition","TransitionEnd")},Rc={},$m={};u&&($m=document.createElement("div").style,"AnimationEvent"in window||(delete Wn.animationend.animation,delete Wn.animationiteration.animation,delete Wn.animationstart.animation),"TransitionEvent"in window||delete Wn.transitionend.transition);function _o(n){if(Rc[n])return Rc[n];if(!Wn[n])return n;var a=Wn[n],d;for(d in a)if(a.hasOwnProperty(d)&&d in $m)return Rc[n]=a[d];return n}var Bm=_o("animationend"),Wm=_o("animationiteration"),Vm=_o("animationstart"),zm=_o("transitionend"),qm=new Map,Hm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ur(n,a){qm.set(n,a),c(a,[n])}for(var Dc=0;Dc<Hm.length;Dc++){var Fc=Hm[Dc],Qv=Fc.toLowerCase(),Zv=Fc[0].toUpperCase()+Fc.slice(1);Ur(Qv,"on"+Zv)}Ur(Bm,"onAnimationEnd"),Ur(Wm,"onAnimationIteration"),Ur(Vm,"onAnimationStart"),Ur("dblclick","onDoubleClick"),Ur("focusin","onFocus"),Ur("focusout","onBlur"),Ur(zm,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ea="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Xv=new Set("cancel close invalid load scroll toggle".split(" ").concat(ea));function Gm(n,a,d){var m=n.type||"unknown-event";n.currentTarget=d,lo(m,a,void 0,n),n.currentTarget=null}function Km(n,a){a=(a&4)!==0;for(var d=0;d<n.length;d++){var m=n[d],x=m.event;m=m.listeners;e:{var b=void 0;if(a)for(var S=m.length-1;0<=S;S--){var F=m[S],q=F.instance,te=F.currentTarget;if(F=F.listener,q!==b&&x.isPropagationStopped())break e;Gm(x,F,te),b=q}else for(S=0;S<m.length;S++){if(F=m[S],q=F.instance,te=F.currentTarget,F=F.listener,q!==b&&x.isPropagationStopped())break e;Gm(x,F,te),b=q}}}if(Ct)throw n=Rt,Ct=!1,Rt=null,n}function ot(n,a){var d=a[zc];d===void 0&&(d=a[zc]=new Set);var m=n+"__bubble";d.has(m)||(Ym(a,n,2,!1),d.add(m))}function Mc(n,a,d){var m=0;a&&(m|=4),Ym(d,n,m,a)}var So="_reactListening"+Math.random().toString(36).slice(2);function ta(n){if(!n[So]){n[So]=!0,i.forEach(function(d){d!=="selectionchange"&&(Xv.has(d)||Mc(d,!1,n),Mc(d,!0,n))});var a=n.nodeType===9?n:n.ownerDocument;a===null||a[So]||(a[So]=!0,Mc("selectionchange",!1,a))}}function Ym(n,a,d,m){switch(ym(a)){case 1:var x=mv;break;case 4:x=fv;break;default:x=vc}d=x.bind(null,a,d,n),x=void 0,!Ie||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(x=!0),m?x!==void 0?n.addEventListener(a,d,{capture:!0,passive:x}):n.addEventListener(a,d,!0):x!==void 0?n.addEventListener(a,d,{passive:x}):n.addEventListener(a,d,!1)}function Oc(n,a,d,m,x){var b=m;if((a&1)===0&&(a&2)===0&&m!==null)e:for(;;){if(m===null)return;var S=m.tag;if(S===3||S===4){var F=m.stateNode.containerInfo;if(F===x||F.nodeType===8&&F.parentNode===x)break;if(S===4)for(S=m.return;S!==null;){var q=S.tag;if((q===3||q===4)&&(q=S.stateNode.containerInfo,q===x||q.nodeType===8&&q.parentNode===x))return;S=S.return}for(;F!==null;){if(S=un(F),S===null)return;if(q=S.tag,q===5||q===6){m=b=S;continue e}F=F.parentNode}}m=m.return}pe(function(){var te=b,me=Zt(d),ge=[];e:{var de=qm.get(n);if(de!==void 0){var ke=Nc,Se=n;switch(n){case"keypress":if(vo(d)===0)break e;case"keydown":case"keyup":ke=Ev;break;case"focusin":Se="focus",ke=Sc;break;case"focusout":Se="blur",ke=Sc;break;case"beforeblur":case"afterblur":ke=Sc;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ke=wm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ke=xv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ke=Iv;break;case Bm:case Wm:case Vm:ke=vv;break;case zm:ke=Rv;break;case"scroll":ke=pv;break;case"wheel":ke=Fv;break;case"copy":case"cut":case"paste":ke=jv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ke=Nm}var Ce=(a&4)!==0,kt=!Ce&&n==="scroll",Q=Ce?de!==null?de+"Capture":null:de;Ce=[];for(var K=te,Z;K!==null;){Z=K;var ye=Z.stateNode;if(Z.tag===5&&ye!==null&&(Z=ye,Q!==null&&(ye=De(K,Q),ye!=null&&Ce.push(sa(K,ye,Z)))),kt)break;K=K.return}0<Ce.length&&(de=new ke(de,Se,null,d,me),ge.push({event:de,listeners:Ce}))}}if((a&7)===0){e:{if(de=n==="mouseover"||n==="pointerover",ke=n==="mouseout"||n==="pointerout",de&&d!==mr&&(Se=d.relatedTarget||d.fromElement)&&(un(Se)||Se[pr]))break e;if((ke||de)&&(de=me.window===me?me:(de=me.ownerDocument)?de.defaultView||de.parentWindow:window,ke?(Se=d.relatedTarget||d.toElement,ke=te,Se=Se?un(Se):null,Se!==null&&(kt=fr(Se),Se!==kt||Se.tag!==5&&Se.tag!==6)&&(Se=null)):(ke=null,Se=te),ke!==Se)){if(Ce=wm,ye="onMouseLeave",Q="onMouseEnter",K="mouse",(n==="pointerout"||n==="pointerover")&&(Ce=Nm,ye="onPointerLeave",Q="onPointerEnter",K="pointer"),kt=ke==null?de:qn(ke),Z=Se==null?de:qn(Se),de=new Ce(ye,K+"leave",ke,d,me),de.target=kt,de.relatedTarget=Z,ye=null,un(me)===te&&(Ce=new Ce(Q,K+"enter",Se,d,me),Ce.target=Z,Ce.relatedTarget=kt,ye=Ce),kt=ye,ke&&Se)t:{for(Ce=ke,Q=Se,K=0,Z=Ce;Z;Z=Vn(Z))K++;for(Z=0,ye=Q;ye;ye=Vn(ye))Z++;for(;0<K-Z;)Ce=Vn(Ce),K--;for(;0<Z-K;)Q=Vn(Q),Z--;for(;K--;){if(Ce===Q||Q!==null&&Ce===Q.alternate)break t;Ce=Vn(Ce),Q=Vn(Q)}Ce=null}else Ce=null;ke!==null&&Jm(ge,de,ke,Ce,!1),Se!==null&&kt!==null&&Jm(ge,kt,Se,Ce,!0)}}e:{if(de=te?qn(te):window,ke=de.nodeName&&de.nodeName.toLowerCase(),ke==="select"||ke==="input"&&de.type==="file")var Ee=Vv;else if(Em(de))if(Am)Ee=Gv;else{Ee=qv;var Fe=zv}else(ke=de.nodeName)&&ke.toLowerCase()==="input"&&(de.type==="checkbox"||de.type==="radio")&&(Ee=Hv);if(Ee&&(Ee=Ee(n,te))){Pm(ge,Ee,d,me);break e}Fe&&Fe(n,de,te),n==="focusout"&&(Fe=de._wrapperState)&&Fe.controlled&&de.type==="number"&&He(de,"number",de.value)}switch(Fe=te?qn(te):window,n){case"focusin":(Em(Fe)||Fe.contentEditable==="true")&&(Bn=Fe,Ic=te,Xi=null);break;case"focusout":Xi=Ic=Bn=null;break;case"mousedown":Lc=!0;break;case"contextmenu":case"mouseup":case"dragend":Lc=!1,Um(ge,d,me);break;case"selectionchange":if(Jv)break;case"keydown":case"keyup":Um(ge,d,me)}var Me;if(Tc)e:{switch(n){case"compositionstart":var ze="onCompositionStart";break e;case"compositionend":ze="onCompositionEnd";break e;case"compositionupdate":ze="onCompositionUpdate";break e}ze=void 0}else $n?Cm(n,d)&&(ze="onCompositionEnd"):n==="keydown"&&d.keyCode===229&&(ze="onCompositionStart");ze&&(km&&d.locale!=="ko"&&($n||ze!=="onCompositionStart"?ze==="onCompositionEnd"&&$n&&(Me=bm()):(Or=me,jc="value"in Or?Or.value:Or.textContent,$n=!0)),Fe=Co(te,ze),0<Fe.length&&(ze=new jm(ze,n,null,d,me),ge.push({event:ze,listeners:Fe}),Me?ze.data=Me:(Me=Tm(d),Me!==null&&(ze.data=Me)))),(Me=Ov?Uv(n,d):$v(n,d))&&(te=Co(te,"onBeforeInput"),0<te.length&&(me=new jm("onBeforeInput","beforeinput",null,d,me),ge.push({event:me,listeners:te}),me.data=Me))}Km(ge,a)})}function sa(n,a,d){return{instance:n,listener:a,currentTarget:d}}function Co(n,a){for(var d=a+"Capture",m=[];n!==null;){var x=n,b=x.stateNode;x.tag===5&&b!==null&&(x=b,b=De(n,d),b!=null&&m.unshift(sa(n,b,x)),b=De(n,a),b!=null&&m.push(sa(n,b,x))),n=n.return}return m}function Vn(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Jm(n,a,d,m,x){for(var b=a._reactName,S=[];d!==null&&d!==m;){var F=d,q=F.alternate,te=F.stateNode;if(q!==null&&q===m)break;F.tag===5&&te!==null&&(F=te,x?(q=De(d,b),q!=null&&S.unshift(sa(d,q,F))):x||(q=De(d,b),q!=null&&S.push(sa(d,q,F)))),d=d.return}S.length!==0&&n.push({event:a,listeners:S})}var ew=/\r\n?/g,tw=/\u0000|\uFFFD/g;function Qm(n){return(typeof n=="string"?n:""+n).replace(ew,`
`).replace(tw,"")}function To(n,a,d){if(a=Qm(a),Qm(n)!==a&&d)throw Error(r(425))}function Eo(){}var Uc=null,$c=null;function Bc(n,a){return n==="textarea"||n==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Wc=typeof setTimeout=="function"?setTimeout:void 0,sw=typeof clearTimeout=="function"?clearTimeout:void 0,Zm=typeof Promise=="function"?Promise:void 0,rw=typeof queueMicrotask=="function"?queueMicrotask:typeof Zm<"u"?function(n){return Zm.resolve(null).then(n).catch(nw)}:Wc;function nw(n){setTimeout(function(){throw n})}function Vc(n,a){var d=a,m=0;do{var x=d.nextSibling;if(n.removeChild(d),x&&x.nodeType===8)if(d=x.data,d==="/$"){if(m===0){n.removeChild(x),Hi(a);return}m--}else d!=="$"&&d!=="$?"&&d!=="$!"||m++;d=x}while(d);Hi(a)}function $r(n){for(;n!=null;n=n.nextSibling){var a=n.nodeType;if(a===1||a===3)break;if(a===8){if(a=n.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return n}function Xm(n){n=n.previousSibling;for(var a=0;n;){if(n.nodeType===8){var d=n.data;if(d==="$"||d==="$!"||d==="$?"){if(a===0)return n;a--}else d==="/$"&&a++}n=n.previousSibling}return null}var zn=Math.random().toString(36).slice(2),tr="__reactFiber$"+zn,ra="__reactProps$"+zn,pr="__reactContainer$"+zn,zc="__reactEvents$"+zn,iw="__reactListeners$"+zn,aw="__reactHandles$"+zn;function un(n){var a=n[tr];if(a)return a;for(var d=n.parentNode;d;){if(a=d[pr]||d[tr]){if(d=a.alternate,a.child!==null||d!==null&&d.child!==null)for(n=Xm(n);n!==null;){if(d=n[tr])return d;n=Xm(n)}return a}n=d,d=n.parentNode}return null}function na(n){return n=n[tr]||n[pr],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function qn(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(r(33))}function Po(n){return n[ra]||null}var qc=[],Hn=-1;function Br(n){return{current:n}}function lt(n){0>Hn||(n.current=qc[Hn],qc[Hn]=null,Hn--)}function nt(n,a){Hn++,qc[Hn]=n.current,n.current=a}var Wr={},qt=Br(Wr),ss=Br(!1),hn=Wr;function Gn(n,a){var d=n.type.contextTypes;if(!d)return Wr;var m=n.stateNode;if(m&&m.__reactInternalMemoizedUnmaskedChildContext===a)return m.__reactInternalMemoizedMaskedChildContext;var x={},b;for(b in d)x[b]=a[b];return m&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=a,n.__reactInternalMemoizedMaskedChildContext=x),x}function rs(n){return n=n.childContextTypes,n!=null}function Ao(){lt(ss),lt(qt)}function ef(n,a,d){if(qt.current!==Wr)throw Error(r(168));nt(qt,a),nt(ss,d)}function tf(n,a,d){var m=n.stateNode;if(a=a.childContextTypes,typeof m.getChildContext!="function")return d;m=m.getChildContext();for(var x in m)if(!(x in a))throw Error(r(108,be(n)||"Unknown",x));return W({},d,m)}function Io(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Wr,hn=qt.current,nt(qt,n),nt(ss,ss.current),!0}function sf(n,a,d){var m=n.stateNode;if(!m)throw Error(r(169));d?(n=tf(n,a,hn),m.__reactInternalMemoizedMergedChildContext=n,lt(ss),lt(qt),nt(qt,n)):lt(ss),nt(ss,d)}var gr=null,Lo=!1,Hc=!1;function rf(n){gr===null?gr=[n]:gr.push(n)}function ow(n){Lo=!0,rf(n)}function Vr(){if(!Hc&&gr!==null){Hc=!0;var n=0,a=et;try{var d=gr;for(et=1;n<d.length;n++){var m=d[n];do m=m(!0);while(m!==null)}gr=null,Lo=!1}catch(x){throw gr!==null&&(gr=gr.slice(n+1)),im(fc,Vr),x}finally{et=a,Hc=!1}}return null}var Kn=[],Yn=0,Ro=null,Do=0,Ns=[],ks=0,mn=null,xr=1,yr="";function fn(n,a){Kn[Yn++]=Do,Kn[Yn++]=Ro,Ro=n,Do=a}function nf(n,a,d){Ns[ks++]=xr,Ns[ks++]=yr,Ns[ks++]=mn,mn=n;var m=xr;n=yr;var x=32-Os(m)-1;m&=~(1<<x),d+=1;var b=32-Os(a)+x;if(30<b){var S=x-x%5;b=(m&(1<<S)-1).toString(32),m>>=S,x-=S,xr=1<<32-Os(a)+x|d<<x|m,yr=b+n}else xr=1<<b|d<<x|m,yr=n}function Gc(n){n.return!==null&&(fn(n,1),nf(n,1,0))}function Kc(n){for(;n===Ro;)Ro=Kn[--Yn],Kn[Yn]=null,Do=Kn[--Yn],Kn[Yn]=null;for(;n===mn;)mn=Ns[--ks],Ns[ks]=null,yr=Ns[--ks],Ns[ks]=null,xr=Ns[--ks],Ns[ks]=null}var hs=null,ms=null,ht=!1,$s=null;function af(n,a){var d=Ts(5,null,null,0);d.elementType="DELETED",d.stateNode=a,d.return=n,a=n.deletions,a===null?(n.deletions=[d],n.flags|=16):a.push(d)}function of(n,a){switch(n.tag){case 5:var d=n.type;return a=a.nodeType!==1||d.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(n.stateNode=a,hs=n,ms=$r(a.firstChild),!0):!1;case 6:return a=n.pendingProps===""||a.nodeType!==3?null:a,a!==null?(n.stateNode=a,hs=n,ms=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?(d=mn!==null?{id:xr,overflow:yr}:null,n.memoizedState={dehydrated:a,treeContext:d,retryLane:1073741824},d=Ts(18,null,null,0),d.stateNode=a,d.return=n,n.child=d,hs=n,ms=null,!0):!1;default:return!1}}function Yc(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Jc(n){if(ht){var a=ms;if(a){var d=a;if(!of(n,a)){if(Yc(n))throw Error(r(418));a=$r(d.nextSibling);var m=hs;a&&of(n,a)?af(m,d):(n.flags=n.flags&-4097|2,ht=!1,hs=n)}}else{if(Yc(n))throw Error(r(418));n.flags=n.flags&-4097|2,ht=!1,hs=n}}}function lf(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;hs=n}function Fo(n){if(n!==hs)return!1;if(!ht)return lf(n),ht=!0,!1;var a;if((a=n.tag!==3)&&!(a=n.tag!==5)&&(a=n.type,a=a!=="head"&&a!=="body"&&!Bc(n.type,n.memoizedProps)),a&&(a=ms)){if(Yc(n))throw cf(),Error(r(418));for(;a;)af(n,a),a=$r(a.nextSibling)}if(lf(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));e:{for(n=n.nextSibling,a=0;n;){if(n.nodeType===8){var d=n.data;if(d==="/$"){if(a===0){ms=$r(n.nextSibling);break e}a--}else d!=="$"&&d!=="$!"&&d!=="$?"||a++}n=n.nextSibling}ms=null}}else ms=hs?$r(n.stateNode.nextSibling):null;return!0}function cf(){for(var n=ms;n;)n=$r(n.nextSibling)}function Jn(){ms=hs=null,ht=!1}function Qc(n){$s===null?$s=[n]:$s.push(n)}var lw=_.ReactCurrentBatchConfig;function ia(n,a,d){if(n=d.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(r(309));var m=d.stateNode}if(!m)throw Error(r(147,n));var x=m,b=""+n;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===b?a.ref:(a=function(S){var F=x.refs;S===null?delete F[b]:F[b]=S},a._stringRef=b,a)}if(typeof n!="string")throw Error(r(284));if(!d._owner)throw Error(r(290,n))}return n}function Mo(n,a){throw n=Object.prototype.toString.call(a),Error(r(31,n==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":n))}function df(n){var a=n._init;return a(n._payload)}function uf(n){function a(Q,K){if(n){var Z=Q.deletions;Z===null?(Q.deletions=[K],Q.flags|=16):Z.push(K)}}function d(Q,K){if(!n)return null;for(;K!==null;)a(Q,K),K=K.sibling;return null}function m(Q,K){for(Q=new Map;K!==null;)K.key!==null?Q.set(K.key,K):Q.set(K.index,K),K=K.sibling;return Q}function x(Q,K){return Q=Qr(Q,K),Q.index=0,Q.sibling=null,Q}function b(Q,K,Z){return Q.index=Z,n?(Z=Q.alternate,Z!==null?(Z=Z.index,Z<K?(Q.flags|=2,K):Z):(Q.flags|=2,K)):(Q.flags|=1048576,K)}function S(Q){return n&&Q.alternate===null&&(Q.flags|=2),Q}function F(Q,K,Z,ye){return K===null||K.tag!==6?(K=Wd(Z,Q.mode,ye),K.return=Q,K):(K=x(K,Z),K.return=Q,K)}function q(Q,K,Z,ye){var Ee=Z.type;return Ee===P?me(Q,K,Z.props.children,ye,Z.key):K!==null&&(K.elementType===Ee||typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===oe&&df(Ee)===K.type)?(ye=x(K,Z.props),ye.ref=ia(Q,K,Z),ye.return=Q,ye):(ye=ol(Z.type,Z.key,Z.props,null,Q.mode,ye),ye.ref=ia(Q,K,Z),ye.return=Q,ye)}function te(Q,K,Z,ye){return K===null||K.tag!==4||K.stateNode.containerInfo!==Z.containerInfo||K.stateNode.implementation!==Z.implementation?(K=Vd(Z,Q.mode,ye),K.return=Q,K):(K=x(K,Z.children||[]),K.return=Q,K)}function me(Q,K,Z,ye,Ee){return K===null||K.tag!==7?(K=jn(Z,Q.mode,ye,Ee),K.return=Q,K):(K=x(K,Z),K.return=Q,K)}function ge(Q,K,Z){if(typeof K=="string"&&K!==""||typeof K=="number")return K=Wd(""+K,Q.mode,Z),K.return=Q,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case R:return Z=ol(K.type,K.key,K.props,null,Q.mode,Z),Z.ref=ia(Q,null,K),Z.return=Q,Z;case L:return K=Vd(K,Q.mode,Z),K.return=Q,K;case oe:var ye=K._init;return ge(Q,ye(K._payload),Z)}if(wt(K)||$(K))return K=jn(K,Q.mode,Z,null),K.return=Q,K;Mo(Q,K)}return null}function de(Q,K,Z,ye){var Ee=K!==null?K.key:null;if(typeof Z=="string"&&Z!==""||typeof Z=="number")return Ee!==null?null:F(Q,K,""+Z,ye);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case R:return Z.key===Ee?q(Q,K,Z,ye):null;case L:return Z.key===Ee?te(Q,K,Z,ye):null;case oe:return Ee=Z._init,de(Q,K,Ee(Z._payload),ye)}if(wt(Z)||$(Z))return Ee!==null?null:me(Q,K,Z,ye,null);Mo(Q,Z)}return null}function ke(Q,K,Z,ye,Ee){if(typeof ye=="string"&&ye!==""||typeof ye=="number")return Q=Q.get(Z)||null,F(K,Q,""+ye,Ee);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case R:return Q=Q.get(ye.key===null?Z:ye.key)||null,q(K,Q,ye,Ee);case L:return Q=Q.get(ye.key===null?Z:ye.key)||null,te(K,Q,ye,Ee);case oe:var Fe=ye._init;return ke(Q,K,Z,Fe(ye._payload),Ee)}if(wt(ye)||$(ye))return Q=Q.get(Z)||null,me(K,Q,ye,Ee,null);Mo(K,ye)}return null}function Se(Q,K,Z,ye){for(var Ee=null,Fe=null,Me=K,ze=K=0,Mt=null;Me!==null&&ze<Z.length;ze++){Me.index>ze?(Mt=Me,Me=null):Mt=Me.sibling;var Xe=de(Q,Me,Z[ze],ye);if(Xe===null){Me===null&&(Me=Mt);break}n&&Me&&Xe.alternate===null&&a(Q,Me),K=b(Xe,K,ze),Fe===null?Ee=Xe:Fe.sibling=Xe,Fe=Xe,Me=Mt}if(ze===Z.length)return d(Q,Me),ht&&fn(Q,ze),Ee;if(Me===null){for(;ze<Z.length;ze++)Me=ge(Q,Z[ze],ye),Me!==null&&(K=b(Me,K,ze),Fe===null?Ee=Me:Fe.sibling=Me,Fe=Me);return ht&&fn(Q,ze),Ee}for(Me=m(Q,Me);ze<Z.length;ze++)Mt=ke(Me,Q,ze,Z[ze],ye),Mt!==null&&(n&&Mt.alternate!==null&&Me.delete(Mt.key===null?ze:Mt.key),K=b(Mt,K,ze),Fe===null?Ee=Mt:Fe.sibling=Mt,Fe=Mt);return n&&Me.forEach(function(Zr){return a(Q,Zr)}),ht&&fn(Q,ze),Ee}function Ce(Q,K,Z,ye){var Ee=$(Z);if(typeof Ee!="function")throw Error(r(150));if(Z=Ee.call(Z),Z==null)throw Error(r(151));for(var Fe=Ee=null,Me=K,ze=K=0,Mt=null,Xe=Z.next();Me!==null&&!Xe.done;ze++,Xe=Z.next()){Me.index>ze?(Mt=Me,Me=null):Mt=Me.sibling;var Zr=de(Q,Me,Xe.value,ye);if(Zr===null){Me===null&&(Me=Mt);break}n&&Me&&Zr.alternate===null&&a(Q,Me),K=b(Zr,K,ze),Fe===null?Ee=Zr:Fe.sibling=Zr,Fe=Zr,Me=Mt}if(Xe.done)return d(Q,Me),ht&&fn(Q,ze),Ee;if(Me===null){for(;!Xe.done;ze++,Xe=Z.next())Xe=ge(Q,Xe.value,ye),Xe!==null&&(K=b(Xe,K,ze),Fe===null?Ee=Xe:Fe.sibling=Xe,Fe=Xe);return ht&&fn(Q,ze),Ee}for(Me=m(Q,Me);!Xe.done;ze++,Xe=Z.next())Xe=ke(Me,Q,ze,Xe.value,ye),Xe!==null&&(n&&Xe.alternate!==null&&Me.delete(Xe.key===null?ze:Xe.key),K=b(Xe,K,ze),Fe===null?Ee=Xe:Fe.sibling=Xe,Fe=Xe);return n&&Me.forEach(function(Bw){return a(Q,Bw)}),ht&&fn(Q,ze),Ee}function kt(Q,K,Z,ye){if(typeof Z=="object"&&Z!==null&&Z.type===P&&Z.key===null&&(Z=Z.props.children),typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case R:e:{for(var Ee=Z.key,Fe=K;Fe!==null;){if(Fe.key===Ee){if(Ee=Z.type,Ee===P){if(Fe.tag===7){d(Q,Fe.sibling),K=x(Fe,Z.props.children),K.return=Q,Q=K;break e}}else if(Fe.elementType===Ee||typeof Ee=="object"&&Ee!==null&&Ee.$$typeof===oe&&df(Ee)===Fe.type){d(Q,Fe.sibling),K=x(Fe,Z.props),K.ref=ia(Q,Fe,Z),K.return=Q,Q=K;break e}d(Q,Fe);break}else a(Q,Fe);Fe=Fe.sibling}Z.type===P?(K=jn(Z.props.children,Q.mode,ye,Z.key),K.return=Q,Q=K):(ye=ol(Z.type,Z.key,Z.props,null,Q.mode,ye),ye.ref=ia(Q,K,Z),ye.return=Q,Q=ye)}return S(Q);case L:e:{for(Fe=Z.key;K!==null;){if(K.key===Fe)if(K.tag===4&&K.stateNode.containerInfo===Z.containerInfo&&K.stateNode.implementation===Z.implementation){d(Q,K.sibling),K=x(K,Z.children||[]),K.return=Q,Q=K;break e}else{d(Q,K);break}else a(Q,K);K=K.sibling}K=Vd(Z,Q.mode,ye),K.return=Q,Q=K}return S(Q);case oe:return Fe=Z._init,kt(Q,K,Fe(Z._payload),ye)}if(wt(Z))return Se(Q,K,Z,ye);if($(Z))return Ce(Q,K,Z,ye);Mo(Q,Z)}return typeof Z=="string"&&Z!==""||typeof Z=="number"?(Z=""+Z,K!==null&&K.tag===6?(d(Q,K.sibling),K=x(K,Z),K.return=Q,Q=K):(d(Q,K),K=Wd(Z,Q.mode,ye),K.return=Q,Q=K),S(Q)):d(Q,K)}return kt}var Qn=uf(!0),hf=uf(!1),Oo=Br(null),Uo=null,Zn=null,Zc=null;function Xc(){Zc=Zn=Uo=null}function ed(n){var a=Oo.current;lt(Oo),n._currentValue=a}function td(n,a,d){for(;n!==null;){var m=n.alternate;if((n.childLanes&a)!==a?(n.childLanes|=a,m!==null&&(m.childLanes|=a)):m!==null&&(m.childLanes&a)!==a&&(m.childLanes|=a),n===d)break;n=n.return}}function Xn(n,a){Uo=n,Zc=Zn=null,n=n.dependencies,n!==null&&n.firstContext!==null&&((n.lanes&a)!==0&&(ns=!0),n.firstContext=null)}function _s(n){var a=n._currentValue;if(Zc!==n)if(n={context:n,memoizedValue:a,next:null},Zn===null){if(Uo===null)throw Error(r(308));Zn=n,Uo.dependencies={lanes:0,firstContext:n}}else Zn=Zn.next=n;return a}var pn=null;function sd(n){pn===null?pn=[n]:pn.push(n)}function mf(n,a,d,m){var x=a.interleaved;return x===null?(d.next=d,sd(a)):(d.next=x.next,x.next=d),a.interleaved=d,br(n,m)}function br(n,a){n.lanes|=a;var d=n.alternate;for(d!==null&&(d.lanes|=a),d=n,n=n.return;n!==null;)n.childLanes|=a,d=n.alternate,d!==null&&(d.childLanes|=a),d=n,n=n.return;return d.tag===3?d.stateNode:null}var zr=!1;function rd(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ff(n,a){n=n.updateQueue,a.updateQueue===n&&(a.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function vr(n,a){return{eventTime:n,lane:a,tag:0,payload:null,callback:null,next:null}}function qr(n,a,d){var m=n.updateQueue;if(m===null)return null;if(m=m.shared,(Qe&2)!==0){var x=m.pending;return x===null?a.next=a:(a.next=x.next,x.next=a),m.pending=a,br(n,d)}return x=m.interleaved,x===null?(a.next=a,sd(m)):(a.next=x.next,x.next=a),m.interleaved=a,br(n,d)}function $o(n,a,d){if(a=a.updateQueue,a!==null&&(a=a.shared,(d&4194240)!==0)){var m=a.lanes;m&=n.pendingLanes,d|=m,a.lanes=d,xc(n,d)}}function pf(n,a){var d=n.updateQueue,m=n.alternate;if(m!==null&&(m=m.updateQueue,d===m)){var x=null,b=null;if(d=d.firstBaseUpdate,d!==null){do{var S={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};b===null?x=b=S:b=b.next=S,d=d.next}while(d!==null);b===null?x=b=a:b=b.next=a}else x=b=a;d={baseState:m.baseState,firstBaseUpdate:x,lastBaseUpdate:b,shared:m.shared,effects:m.effects},n.updateQueue=d;return}n=d.lastBaseUpdate,n===null?d.firstBaseUpdate=a:n.next=a,d.lastBaseUpdate=a}function Bo(n,a,d,m){var x=n.updateQueue;zr=!1;var b=x.firstBaseUpdate,S=x.lastBaseUpdate,F=x.shared.pending;if(F!==null){x.shared.pending=null;var q=F,te=q.next;q.next=null,S===null?b=te:S.next=te,S=q;var me=n.alternate;me!==null&&(me=me.updateQueue,F=me.lastBaseUpdate,F!==S&&(F===null?me.firstBaseUpdate=te:F.next=te,me.lastBaseUpdate=q))}if(b!==null){var ge=x.baseState;S=0,me=te=q=null,F=b;do{var de=F.lane,ke=F.eventTime;if((m&de)===de){me!==null&&(me=me.next={eventTime:ke,lane:0,tag:F.tag,payload:F.payload,callback:F.callback,next:null});e:{var Se=n,Ce=F;switch(de=a,ke=d,Ce.tag){case 1:if(Se=Ce.payload,typeof Se=="function"){ge=Se.call(ke,ge,de);break e}ge=Se;break e;case 3:Se.flags=Se.flags&-65537|128;case 0:if(Se=Ce.payload,de=typeof Se=="function"?Se.call(ke,ge,de):Se,de==null)break e;ge=W({},ge,de);break e;case 2:zr=!0}}F.callback!==null&&F.lane!==0&&(n.flags|=64,de=x.effects,de===null?x.effects=[F]:de.push(F))}else ke={eventTime:ke,lane:de,tag:F.tag,payload:F.payload,callback:F.callback,next:null},me===null?(te=me=ke,q=ge):me=me.next=ke,S|=de;if(F=F.next,F===null){if(F=x.shared.pending,F===null)break;de=F,F=de.next,de.next=null,x.lastBaseUpdate=de,x.shared.pending=null}}while(!0);if(me===null&&(q=ge),x.baseState=q,x.firstBaseUpdate=te,x.lastBaseUpdate=me,a=x.shared.interleaved,a!==null){x=a;do S|=x.lane,x=x.next;while(x!==a)}else b===null&&(x.shared.lanes=0);yn|=S,n.lanes=S,n.memoizedState=ge}}function gf(n,a,d){if(n=a.effects,a.effects=null,n!==null)for(a=0;a<n.length;a++){var m=n[a],x=m.callback;if(x!==null){if(m.callback=null,m=d,typeof x!="function")throw Error(r(191,x));x.call(m)}}}var aa={},sr=Br(aa),oa=Br(aa),la=Br(aa);function gn(n){if(n===aa)throw Error(r(174));return n}function nd(n,a){switch(nt(la,a),nt(oa,n),nt(sr,aa),n=a.nodeType,n){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:St(null,"");break;default:n=n===8?a.parentNode:a,a=n.namespaceURI||null,n=n.tagName,a=St(a,n)}lt(sr),nt(sr,a)}function ei(){lt(sr),lt(oa),lt(la)}function xf(n){gn(la.current);var a=gn(sr.current),d=St(a,n.type);a!==d&&(nt(oa,n),nt(sr,d))}function id(n){oa.current===n&&(lt(sr),lt(oa))}var pt=Br(0);function Wo(n){for(var a=n;a!==null;){if(a.tag===13){var d=a.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var ad=[];function od(){for(var n=0;n<ad.length;n++)ad[n]._workInProgressVersionPrimary=null;ad.length=0}var Vo=_.ReactCurrentDispatcher,ld=_.ReactCurrentBatchConfig,xn=0,gt=null,Pt=null,Dt=null,zo=!1,ca=!1,da=0,cw=0;function Ht(){throw Error(r(321))}function cd(n,a){if(a===null)return!1;for(var d=0;d<a.length&&d<n.length;d++)if(!Us(n[d],a[d]))return!1;return!0}function dd(n,a,d,m,x,b){if(xn=b,gt=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Vo.current=n===null||n.memoizedState===null?mw:fw,n=d(m,x),ca){b=0;do{if(ca=!1,da=0,25<=b)throw Error(r(301));b+=1,Dt=Pt=null,a.updateQueue=null,Vo.current=pw,n=d(m,x)}while(ca)}if(Vo.current=Go,a=Pt!==null&&Pt.next!==null,xn=0,Dt=Pt=gt=null,zo=!1,a)throw Error(r(300));return n}function ud(){var n=da!==0;return da=0,n}function rr(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dt===null?gt.memoizedState=Dt=n:Dt=Dt.next=n,Dt}function Ss(){if(Pt===null){var n=gt.alternate;n=n!==null?n.memoizedState:null}else n=Pt.next;var a=Dt===null?gt.memoizedState:Dt.next;if(a!==null)Dt=a,Pt=n;else{if(n===null)throw Error(r(310));Pt=n,n={memoizedState:Pt.memoizedState,baseState:Pt.baseState,baseQueue:Pt.baseQueue,queue:Pt.queue,next:null},Dt===null?gt.memoizedState=Dt=n:Dt=Dt.next=n}return Dt}function ua(n,a){return typeof a=="function"?a(n):a}function hd(n){var a=Ss(),d=a.queue;if(d===null)throw Error(r(311));d.lastRenderedReducer=n;var m=Pt,x=m.baseQueue,b=d.pending;if(b!==null){if(x!==null){var S=x.next;x.next=b.next,b.next=S}m.baseQueue=x=b,d.pending=null}if(x!==null){b=x.next,m=m.baseState;var F=S=null,q=null,te=b;do{var me=te.lane;if((xn&me)===me)q!==null&&(q=q.next={lane:0,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null}),m=te.hasEagerState?te.eagerState:n(m,te.action);else{var ge={lane:me,action:te.action,hasEagerState:te.hasEagerState,eagerState:te.eagerState,next:null};q===null?(F=q=ge,S=m):q=q.next=ge,gt.lanes|=me,yn|=me}te=te.next}while(te!==null&&te!==b);q===null?S=m:q.next=F,Us(m,a.memoizedState)||(ns=!0),a.memoizedState=m,a.baseState=S,a.baseQueue=q,d.lastRenderedState=m}if(n=d.interleaved,n!==null){x=n;do b=x.lane,gt.lanes|=b,yn|=b,x=x.next;while(x!==n)}else x===null&&(d.lanes=0);return[a.memoizedState,d.dispatch]}function md(n){var a=Ss(),d=a.queue;if(d===null)throw Error(r(311));d.lastRenderedReducer=n;var m=d.dispatch,x=d.pending,b=a.memoizedState;if(x!==null){d.pending=null;var S=x=x.next;do b=n(b,S.action),S=S.next;while(S!==x);Us(b,a.memoizedState)||(ns=!0),a.memoizedState=b,a.baseQueue===null&&(a.baseState=b),d.lastRenderedState=b}return[b,m]}function yf(){}function bf(n,a){var d=gt,m=Ss(),x=a(),b=!Us(m.memoizedState,x);if(b&&(m.memoizedState=x,ns=!0),m=m.queue,fd(jf.bind(null,d,m,n),[n]),m.getSnapshot!==a||b||Dt!==null&&Dt.memoizedState.tag&1){if(d.flags|=2048,ha(9,wf.bind(null,d,m,x,a),void 0,null),Ft===null)throw Error(r(349));(xn&30)!==0||vf(d,a,x)}return x}function vf(n,a,d){n.flags|=16384,n={getSnapshot:a,value:d},a=gt.updateQueue,a===null?(a={lastEffect:null,stores:null},gt.updateQueue=a,a.stores=[n]):(d=a.stores,d===null?a.stores=[n]:d.push(n))}function wf(n,a,d,m){a.value=d,a.getSnapshot=m,Nf(a)&&kf(n)}function jf(n,a,d){return d(function(){Nf(a)&&kf(n)})}function Nf(n){var a=n.getSnapshot;n=n.value;try{var d=a();return!Us(n,d)}catch{return!0}}function kf(n){var a=br(n,1);a!==null&&zs(a,n,1,-1)}function _f(n){var a=rr();return typeof n=="function"&&(n=n()),a.memoizedState=a.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ua,lastRenderedState:n},a.queue=n,n=n.dispatch=hw.bind(null,gt,n),[a.memoizedState,n]}function ha(n,a,d,m){return n={tag:n,create:a,destroy:d,deps:m,next:null},a=gt.updateQueue,a===null?(a={lastEffect:null,stores:null},gt.updateQueue=a,a.lastEffect=n.next=n):(d=a.lastEffect,d===null?a.lastEffect=n.next=n:(m=d.next,d.next=n,n.next=m,a.lastEffect=n)),n}function Sf(){return Ss().memoizedState}function qo(n,a,d,m){var x=rr();gt.flags|=n,x.memoizedState=ha(1|a,d,void 0,m===void 0?null:m)}function Ho(n,a,d,m){var x=Ss();m=m===void 0?null:m;var b=void 0;if(Pt!==null){var S=Pt.memoizedState;if(b=S.destroy,m!==null&&cd(m,S.deps)){x.memoizedState=ha(a,d,b,m);return}}gt.flags|=n,x.memoizedState=ha(1|a,d,b,m)}function Cf(n,a){return qo(8390656,8,n,a)}function fd(n,a){return Ho(2048,8,n,a)}function Tf(n,a){return Ho(4,2,n,a)}function Ef(n,a){return Ho(4,4,n,a)}function Pf(n,a){if(typeof a=="function")return n=n(),a(n),function(){a(null)};if(a!=null)return n=n(),a.current=n,function(){a.current=null}}function Af(n,a,d){return d=d!=null?d.concat([n]):null,Ho(4,4,Pf.bind(null,a,n),d)}function pd(){}function If(n,a){var d=Ss();a=a===void 0?null:a;var m=d.memoizedState;return m!==null&&a!==null&&cd(a,m[1])?m[0]:(d.memoizedState=[n,a],n)}function Lf(n,a){var d=Ss();a=a===void 0?null:a;var m=d.memoizedState;return m!==null&&a!==null&&cd(a,m[1])?m[0]:(n=n(),d.memoizedState=[n,a],n)}function Rf(n,a,d){return(xn&21)===0?(n.baseState&&(n.baseState=!1,ns=!0),n.memoizedState=d):(Us(d,a)||(d=cm(),gt.lanes|=d,yn|=d,n.baseState=!0),a)}function dw(n,a){var d=et;et=d!==0&&4>d?d:4,n(!0);var m=ld.transition;ld.transition={};try{n(!1),a()}finally{et=d,ld.transition=m}}function Df(){return Ss().memoizedState}function uw(n,a,d){var m=Yr(n);if(d={lane:m,action:d,hasEagerState:!1,eagerState:null,next:null},Ff(n))Mf(a,d);else if(d=mf(n,a,d,m),d!==null){var x=es();zs(d,n,m,x),Of(d,a,m)}}function hw(n,a,d){var m=Yr(n),x={lane:m,action:d,hasEagerState:!1,eagerState:null,next:null};if(Ff(n))Mf(a,x);else{var b=n.alternate;if(n.lanes===0&&(b===null||b.lanes===0)&&(b=a.lastRenderedReducer,b!==null))try{var S=a.lastRenderedState,F=b(S,d);if(x.hasEagerState=!0,x.eagerState=F,Us(F,S)){var q=a.interleaved;q===null?(x.next=x,sd(a)):(x.next=q.next,q.next=x),a.interleaved=x;return}}catch{}finally{}d=mf(n,a,x,m),d!==null&&(x=es(),zs(d,n,m,x),Of(d,a,m))}}function Ff(n){var a=n.alternate;return n===gt||a!==null&&a===gt}function Mf(n,a){ca=zo=!0;var d=n.pending;d===null?a.next=a:(a.next=d.next,d.next=a),n.pending=a}function Of(n,a,d){if((d&4194240)!==0){var m=a.lanes;m&=n.pendingLanes,d|=m,a.lanes=d,xc(n,d)}}var Go={readContext:_s,useCallback:Ht,useContext:Ht,useEffect:Ht,useImperativeHandle:Ht,useInsertionEffect:Ht,useLayoutEffect:Ht,useMemo:Ht,useReducer:Ht,useRef:Ht,useState:Ht,useDebugValue:Ht,useDeferredValue:Ht,useTransition:Ht,useMutableSource:Ht,useSyncExternalStore:Ht,useId:Ht,unstable_isNewReconciler:!1},mw={readContext:_s,useCallback:function(n,a){return rr().memoizedState=[n,a===void 0?null:a],n},useContext:_s,useEffect:Cf,useImperativeHandle:function(n,a,d){return d=d!=null?d.concat([n]):null,qo(4194308,4,Pf.bind(null,a,n),d)},useLayoutEffect:function(n,a){return qo(4194308,4,n,a)},useInsertionEffect:function(n,a){return qo(4,2,n,a)},useMemo:function(n,a){var d=rr();return a=a===void 0?null:a,n=n(),d.memoizedState=[n,a],n},useReducer:function(n,a,d){var m=rr();return a=d!==void 0?d(a):a,m.memoizedState=m.baseState=a,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:a},m.queue=n,n=n.dispatch=uw.bind(null,gt,n),[m.memoizedState,n]},useRef:function(n){var a=rr();return n={current:n},a.memoizedState=n},useState:_f,useDebugValue:pd,useDeferredValue:function(n){return rr().memoizedState=n},useTransition:function(){var n=_f(!1),a=n[0];return n=dw.bind(null,n[1]),rr().memoizedState=n,[a,n]},useMutableSource:function(){},useSyncExternalStore:function(n,a,d){var m=gt,x=rr();if(ht){if(d===void 0)throw Error(r(407));d=d()}else{if(d=a(),Ft===null)throw Error(r(349));(xn&30)!==0||vf(m,a,d)}x.memoizedState=d;var b={value:d,getSnapshot:a};return x.queue=b,Cf(jf.bind(null,m,b,n),[n]),m.flags|=2048,ha(9,wf.bind(null,m,b,d,a),void 0,null),d},useId:function(){var n=rr(),a=Ft.identifierPrefix;if(ht){var d=yr,m=xr;d=(m&~(1<<32-Os(m)-1)).toString(32)+d,a=":"+a+"R"+d,d=da++,0<d&&(a+="H"+d.toString(32)),a+=":"}else d=cw++,a=":"+a+"r"+d.toString(32)+":";return n.memoizedState=a},unstable_isNewReconciler:!1},fw={readContext:_s,useCallback:If,useContext:_s,useEffect:fd,useImperativeHandle:Af,useInsertionEffect:Tf,useLayoutEffect:Ef,useMemo:Lf,useReducer:hd,useRef:Sf,useState:function(){return hd(ua)},useDebugValue:pd,useDeferredValue:function(n){var a=Ss();return Rf(a,Pt.memoizedState,n)},useTransition:function(){var n=hd(ua)[0],a=Ss().memoizedState;return[n,a]},useMutableSource:yf,useSyncExternalStore:bf,useId:Df,unstable_isNewReconciler:!1},pw={readContext:_s,useCallback:If,useContext:_s,useEffect:fd,useImperativeHandle:Af,useInsertionEffect:Tf,useLayoutEffect:Ef,useMemo:Lf,useReducer:md,useRef:Sf,useState:function(){return md(ua)},useDebugValue:pd,useDeferredValue:function(n){var a=Ss();return Pt===null?a.memoizedState=n:Rf(a,Pt.memoizedState,n)},useTransition:function(){var n=md(ua)[0],a=Ss().memoizedState;return[n,a]},useMutableSource:yf,useSyncExternalStore:bf,useId:Df,unstable_isNewReconciler:!1};function Bs(n,a){if(n&&n.defaultProps){a=W({},a),n=n.defaultProps;for(var d in n)a[d]===void 0&&(a[d]=n[d]);return a}return a}function gd(n,a,d,m){a=n.memoizedState,d=d(m,a),d=d==null?a:W({},a,d),n.memoizedState=d,n.lanes===0&&(n.updateQueue.baseState=d)}var Ko={isMounted:function(n){return(n=n._reactInternals)?fr(n)===n:!1},enqueueSetState:function(n,a,d){n=n._reactInternals;var m=es(),x=Yr(n),b=vr(m,x);b.payload=a,d!=null&&(b.callback=d),a=qr(n,b,x),a!==null&&(zs(a,n,x,m),$o(a,n,x))},enqueueReplaceState:function(n,a,d){n=n._reactInternals;var m=es(),x=Yr(n),b=vr(m,x);b.tag=1,b.payload=a,d!=null&&(b.callback=d),a=qr(n,b,x),a!==null&&(zs(a,n,x,m),$o(a,n,x))},enqueueForceUpdate:function(n,a){n=n._reactInternals;var d=es(),m=Yr(n),x=vr(d,m);x.tag=2,a!=null&&(x.callback=a),a=qr(n,x,m),a!==null&&(zs(a,n,m,d),$o(a,n,m))}};function Uf(n,a,d,m,x,b,S){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(m,b,S):a.prototype&&a.prototype.isPureReactComponent?!Zi(d,m)||!Zi(x,b):!0}function $f(n,a,d){var m=!1,x=Wr,b=a.contextType;return typeof b=="object"&&b!==null?b=_s(b):(x=rs(a)?hn:qt.current,m=a.contextTypes,b=(m=m!=null)?Gn(n,x):Wr),a=new a(d,b),n.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=Ko,n.stateNode=a,a._reactInternals=n,m&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=x,n.__reactInternalMemoizedMaskedChildContext=b),a}function Bf(n,a,d,m){n=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(d,m),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(d,m),a.state!==n&&Ko.enqueueReplaceState(a,a.state,null)}function xd(n,a,d,m){var x=n.stateNode;x.props=d,x.state=n.memoizedState,x.refs={},rd(n);var b=a.contextType;typeof b=="object"&&b!==null?x.context=_s(b):(b=rs(a)?hn:qt.current,x.context=Gn(n,b)),x.state=n.memoizedState,b=a.getDerivedStateFromProps,typeof b=="function"&&(gd(n,a,b,d),x.state=n.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(a=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),a!==x.state&&Ko.enqueueReplaceState(x,x.state,null),Bo(n,d,x,m),x.state=n.memoizedState),typeof x.componentDidMount=="function"&&(n.flags|=4194308)}function ti(n,a){try{var d="",m=a;do d+=X(m),m=m.return;while(m);var x=d}catch(b){x=`
Error generating stack: `+b.message+`
`+b.stack}return{value:n,source:a,stack:x,digest:null}}function yd(n,a,d){return{value:n,source:null,stack:d??null,digest:a??null}}function bd(n,a){try{console.error(a.value)}catch(d){setTimeout(function(){throw d})}}var gw=typeof WeakMap=="function"?WeakMap:Map;function Wf(n,a,d){d=vr(-1,d),d.tag=3,d.payload={element:null};var m=a.value;return d.callback=function(){tl||(tl=!0,Rd=m),bd(n,a)},d}function Vf(n,a,d){d=vr(-1,d),d.tag=3;var m=n.type.getDerivedStateFromError;if(typeof m=="function"){var x=a.value;d.payload=function(){return m(x)},d.callback=function(){bd(n,a)}}var b=n.stateNode;return b!==null&&typeof b.componentDidCatch=="function"&&(d.callback=function(){bd(n,a),typeof m!="function"&&(Gr===null?Gr=new Set([this]):Gr.add(this));var S=a.stack;this.componentDidCatch(a.value,{componentStack:S!==null?S:""})}),d}function zf(n,a,d){var m=n.pingCache;if(m===null){m=n.pingCache=new gw;var x=new Set;m.set(a,x)}else x=m.get(a),x===void 0&&(x=new Set,m.set(a,x));x.has(d)||(x.add(d),n=Pw.bind(null,n,a,d),a.then(n,n))}function qf(n){do{var a;if((a=n.tag===13)&&(a=n.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return n;n=n.return}while(n!==null);return null}function Hf(n,a,d,m,x){return(n.mode&1)===0?(n===a?n.flags|=65536:(n.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(a=vr(-1,1),a.tag=2,qr(d,a,1))),d.lanes|=1),n):(n.flags|=65536,n.lanes=x,n)}var xw=_.ReactCurrentOwner,ns=!1;function Xt(n,a,d,m){a.child=n===null?hf(a,null,d,m):Qn(a,n.child,d,m)}function Gf(n,a,d,m,x){d=d.render;var b=a.ref;return Xn(a,x),m=dd(n,a,d,m,b,x),d=ud(),n!==null&&!ns?(a.updateQueue=n.updateQueue,a.flags&=-2053,n.lanes&=~x,wr(n,a,x)):(ht&&d&&Gc(a),a.flags|=1,Xt(n,a,m,x),a.child)}function Kf(n,a,d,m,x){if(n===null){var b=d.type;return typeof b=="function"&&!Bd(b)&&b.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(a.tag=15,a.type=b,Yf(n,a,b,m,x)):(n=ol(d.type,null,m,a,a.mode,x),n.ref=a.ref,n.return=a,a.child=n)}if(b=n.child,(n.lanes&x)===0){var S=b.memoizedProps;if(d=d.compare,d=d!==null?d:Zi,d(S,m)&&n.ref===a.ref)return wr(n,a,x)}return a.flags|=1,n=Qr(b,m),n.ref=a.ref,n.return=a,a.child=n}function Yf(n,a,d,m,x){if(n!==null){var b=n.memoizedProps;if(Zi(b,m)&&n.ref===a.ref)if(ns=!1,a.pendingProps=m=b,(n.lanes&x)!==0)(n.flags&131072)!==0&&(ns=!0);else return a.lanes=n.lanes,wr(n,a,x)}return vd(n,a,d,m,x)}function Jf(n,a,d){var m=a.pendingProps,x=m.children,b=n!==null?n.memoizedState:null;if(m.mode==="hidden")if((a.mode&1)===0)a.memoizedState={baseLanes:0,cachePool:null,transitions:null},nt(ri,fs),fs|=d;else{if((d&1073741824)===0)return n=b!==null?b.baseLanes|d:d,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:n,cachePool:null,transitions:null},a.updateQueue=null,nt(ri,fs),fs|=n,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},m=b!==null?b.baseLanes:d,nt(ri,fs),fs|=m}else b!==null?(m=b.baseLanes|d,a.memoizedState=null):m=d,nt(ri,fs),fs|=m;return Xt(n,a,x,d),a.child}function Qf(n,a){var d=a.ref;(n===null&&d!==null||n!==null&&n.ref!==d)&&(a.flags|=512,a.flags|=2097152)}function vd(n,a,d,m,x){var b=rs(d)?hn:qt.current;return b=Gn(a,b),Xn(a,x),d=dd(n,a,d,m,b,x),m=ud(),n!==null&&!ns?(a.updateQueue=n.updateQueue,a.flags&=-2053,n.lanes&=~x,wr(n,a,x)):(ht&&m&&Gc(a),a.flags|=1,Xt(n,a,d,x),a.child)}function Zf(n,a,d,m,x){if(rs(d)){var b=!0;Io(a)}else b=!1;if(Xn(a,x),a.stateNode===null)Jo(n,a),$f(a,d,m),xd(a,d,m,x),m=!0;else if(n===null){var S=a.stateNode,F=a.memoizedProps;S.props=F;var q=S.context,te=d.contextType;typeof te=="object"&&te!==null?te=_s(te):(te=rs(d)?hn:qt.current,te=Gn(a,te));var me=d.getDerivedStateFromProps,ge=typeof me=="function"||typeof S.getSnapshotBeforeUpdate=="function";ge||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(F!==m||q!==te)&&Bf(a,S,m,te),zr=!1;var de=a.memoizedState;S.state=de,Bo(a,m,S,x),q=a.memoizedState,F!==m||de!==q||ss.current||zr?(typeof me=="function"&&(gd(a,d,me,m),q=a.memoizedState),(F=zr||Uf(a,d,F,m,de,q,te))?(ge||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(a.flags|=4194308)):(typeof S.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=m,a.memoizedState=q),S.props=m,S.state=q,S.context=te,m=F):(typeof S.componentDidMount=="function"&&(a.flags|=4194308),m=!1)}else{S=a.stateNode,ff(n,a),F=a.memoizedProps,te=a.type===a.elementType?F:Bs(a.type,F),S.props=te,ge=a.pendingProps,de=S.context,q=d.contextType,typeof q=="object"&&q!==null?q=_s(q):(q=rs(d)?hn:qt.current,q=Gn(a,q));var ke=d.getDerivedStateFromProps;(me=typeof ke=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(F!==ge||de!==q)&&Bf(a,S,m,q),zr=!1,de=a.memoizedState,S.state=de,Bo(a,m,S,x);var Se=a.memoizedState;F!==ge||de!==Se||ss.current||zr?(typeof ke=="function"&&(gd(a,d,ke,m),Se=a.memoizedState),(te=zr||Uf(a,d,te,m,de,Se,q)||!1)?(me||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(m,Se,q),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(m,Se,q)),typeof S.componentDidUpdate=="function"&&(a.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof S.componentDidUpdate!="function"||F===n.memoizedProps&&de===n.memoizedState||(a.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||F===n.memoizedProps&&de===n.memoizedState||(a.flags|=1024),a.memoizedProps=m,a.memoizedState=Se),S.props=m,S.state=Se,S.context=q,m=te):(typeof S.componentDidUpdate!="function"||F===n.memoizedProps&&de===n.memoizedState||(a.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||F===n.memoizedProps&&de===n.memoizedState||(a.flags|=1024),m=!1)}return wd(n,a,d,m,b,x)}function wd(n,a,d,m,x,b){Qf(n,a);var S=(a.flags&128)!==0;if(!m&&!S)return x&&sf(a,d,!1),wr(n,a,b);m=a.stateNode,xw.current=a;var F=S&&typeof d.getDerivedStateFromError!="function"?null:m.render();return a.flags|=1,n!==null&&S?(a.child=Qn(a,n.child,null,b),a.child=Qn(a,null,F,b)):Xt(n,a,F,b),a.memoizedState=m.state,x&&sf(a,d,!0),a.child}function Xf(n){var a=n.stateNode;a.pendingContext?ef(n,a.pendingContext,a.pendingContext!==a.context):a.context&&ef(n,a.context,!1),nd(n,a.containerInfo)}function ep(n,a,d,m,x){return Jn(),Qc(x),a.flags|=256,Xt(n,a,d,m),a.child}var jd={dehydrated:null,treeContext:null,retryLane:0};function Nd(n){return{baseLanes:n,cachePool:null,transitions:null}}function tp(n,a,d){var m=a.pendingProps,x=pt.current,b=!1,S=(a.flags&128)!==0,F;if((F=S)||(F=n!==null&&n.memoizedState===null?!1:(x&2)!==0),F?(b=!0,a.flags&=-129):(n===null||n.memoizedState!==null)&&(x|=1),nt(pt,x&1),n===null)return Jc(a),n=a.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?((a.mode&1)===0?a.lanes=1:n.data==="$!"?a.lanes=8:a.lanes=1073741824,null):(S=m.children,n=m.fallback,b?(m=a.mode,b=a.child,S={mode:"hidden",children:S},(m&1)===0&&b!==null?(b.childLanes=0,b.pendingProps=S):b=ll(S,m,0,null),n=jn(n,m,d,null),b.return=a,n.return=a,b.sibling=n,a.child=b,a.child.memoizedState=Nd(d),a.memoizedState=jd,n):kd(a,S));if(x=n.memoizedState,x!==null&&(F=x.dehydrated,F!==null))return yw(n,a,S,m,F,x,d);if(b){b=m.fallback,S=a.mode,x=n.child,F=x.sibling;var q={mode:"hidden",children:m.children};return(S&1)===0&&a.child!==x?(m=a.child,m.childLanes=0,m.pendingProps=q,a.deletions=null):(m=Qr(x,q),m.subtreeFlags=x.subtreeFlags&14680064),F!==null?b=Qr(F,b):(b=jn(b,S,d,null),b.flags|=2),b.return=a,m.return=a,m.sibling=b,a.child=m,m=b,b=a.child,S=n.child.memoizedState,S=S===null?Nd(d):{baseLanes:S.baseLanes|d,cachePool:null,transitions:S.transitions},b.memoizedState=S,b.childLanes=n.childLanes&~d,a.memoizedState=jd,m}return b=n.child,n=b.sibling,m=Qr(b,{mode:"visible",children:m.children}),(a.mode&1)===0&&(m.lanes=d),m.return=a,m.sibling=null,n!==null&&(d=a.deletions,d===null?(a.deletions=[n],a.flags|=16):d.push(n)),a.child=m,a.memoizedState=null,m}function kd(n,a){return a=ll({mode:"visible",children:a},n.mode,0,null),a.return=n,n.child=a}function Yo(n,a,d,m){return m!==null&&Qc(m),Qn(a,n.child,null,d),n=kd(a,a.pendingProps.children),n.flags|=2,a.memoizedState=null,n}function yw(n,a,d,m,x,b,S){if(d)return a.flags&256?(a.flags&=-257,m=yd(Error(r(422))),Yo(n,a,S,m)):a.memoizedState!==null?(a.child=n.child,a.flags|=128,null):(b=m.fallback,x=a.mode,m=ll({mode:"visible",children:m.children},x,0,null),b=jn(b,x,S,null),b.flags|=2,m.return=a,b.return=a,m.sibling=b,a.child=m,(a.mode&1)!==0&&Qn(a,n.child,null,S),a.child.memoizedState=Nd(S),a.memoizedState=jd,b);if((a.mode&1)===0)return Yo(n,a,S,null);if(x.data==="$!"){if(m=x.nextSibling&&x.nextSibling.dataset,m)var F=m.dgst;return m=F,b=Error(r(419)),m=yd(b,m,void 0),Yo(n,a,S,m)}if(F=(S&n.childLanes)!==0,ns||F){if(m=Ft,m!==null){switch(S&-S){case 4:x=2;break;case 16:x=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:x=32;break;case 536870912:x=268435456;break;default:x=0}x=(x&(m.suspendedLanes|S))!==0?0:x,x!==0&&x!==b.retryLane&&(b.retryLane=x,br(n,x),zs(m,n,x,-1))}return $d(),m=yd(Error(r(421))),Yo(n,a,S,m)}return x.data==="$?"?(a.flags|=128,a.child=n.child,a=Aw.bind(null,n),x._reactRetry=a,null):(n=b.treeContext,ms=$r(x.nextSibling),hs=a,ht=!0,$s=null,n!==null&&(Ns[ks++]=xr,Ns[ks++]=yr,Ns[ks++]=mn,xr=n.id,yr=n.overflow,mn=a),a=kd(a,m.children),a.flags|=4096,a)}function sp(n,a,d){n.lanes|=a;var m=n.alternate;m!==null&&(m.lanes|=a),td(n.return,a,d)}function _d(n,a,d,m,x){var b=n.memoizedState;b===null?n.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:m,tail:d,tailMode:x}:(b.isBackwards=a,b.rendering=null,b.renderingStartTime=0,b.last=m,b.tail=d,b.tailMode=x)}function rp(n,a,d){var m=a.pendingProps,x=m.revealOrder,b=m.tail;if(Xt(n,a,m.children,d),m=pt.current,(m&2)!==0)m=m&1|2,a.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=a.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&sp(n,d,a);else if(n.tag===19)sp(n,d,a);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===a)break e;for(;n.sibling===null;){if(n.return===null||n.return===a)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}m&=1}if(nt(pt,m),(a.mode&1)===0)a.memoizedState=null;else switch(x){case"forwards":for(d=a.child,x=null;d!==null;)n=d.alternate,n!==null&&Wo(n)===null&&(x=d),d=d.sibling;d=x,d===null?(x=a.child,a.child=null):(x=d.sibling,d.sibling=null),_d(a,!1,x,d,b);break;case"backwards":for(d=null,x=a.child,a.child=null;x!==null;){if(n=x.alternate,n!==null&&Wo(n)===null){a.child=x;break}n=x.sibling,x.sibling=d,d=x,x=n}_d(a,!0,d,null,b);break;case"together":_d(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function Jo(n,a){(a.mode&1)===0&&n!==null&&(n.alternate=null,a.alternate=null,a.flags|=2)}function wr(n,a,d){if(n!==null&&(a.dependencies=n.dependencies),yn|=a.lanes,(d&a.childLanes)===0)return null;if(n!==null&&a.child!==n.child)throw Error(r(153));if(a.child!==null){for(n=a.child,d=Qr(n,n.pendingProps),a.child=d,d.return=a;n.sibling!==null;)n=n.sibling,d=d.sibling=Qr(n,n.pendingProps),d.return=a;d.sibling=null}return a.child}function bw(n,a,d){switch(a.tag){case 3:Xf(a),Jn();break;case 5:xf(a);break;case 1:rs(a.type)&&Io(a);break;case 4:nd(a,a.stateNode.containerInfo);break;case 10:var m=a.type._context,x=a.memoizedProps.value;nt(Oo,m._currentValue),m._currentValue=x;break;case 13:if(m=a.memoizedState,m!==null)return m.dehydrated!==null?(nt(pt,pt.current&1),a.flags|=128,null):(d&a.child.childLanes)!==0?tp(n,a,d):(nt(pt,pt.current&1),n=wr(n,a,d),n!==null?n.sibling:null);nt(pt,pt.current&1);break;case 19:if(m=(d&a.childLanes)!==0,(n.flags&128)!==0){if(m)return rp(n,a,d);a.flags|=128}if(x=a.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),nt(pt,pt.current),m)break;return null;case 22:case 23:return a.lanes=0,Jf(n,a,d)}return wr(n,a,d)}var np,Sd,ip,ap;np=function(n,a){for(var d=a.child;d!==null;){if(d.tag===5||d.tag===6)n.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===a)break;for(;d.sibling===null;){if(d.return===null||d.return===a)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},Sd=function(){},ip=function(n,a,d,m){var x=n.memoizedProps;if(x!==m){n=a.stateNode,gn(sr.current);var b=null;switch(d){case"input":x=Ke(n,x),m=Ke(n,m),b=[];break;case"select":x=W({},x,{value:void 0}),m=W({},m,{value:void 0}),b=[];break;case"textarea":x=st(n,x),m=st(n,m),b=[];break;default:typeof x.onClick!="function"&&typeof m.onClick=="function"&&(n.onclick=Eo)}Ir(d,m);var S;d=null;for(te in x)if(!m.hasOwnProperty(te)&&x.hasOwnProperty(te)&&x[te]!=null)if(te==="style"){var F=x[te];for(S in F)F.hasOwnProperty(S)&&(d||(d={}),d[S]="")}else te!=="dangerouslySetInnerHTML"&&te!=="children"&&te!=="suppressContentEditableWarning"&&te!=="suppressHydrationWarning"&&te!=="autoFocus"&&(o.hasOwnProperty(te)?b||(b=[]):(b=b||[]).push(te,null));for(te in m){var q=m[te];if(F=x?.[te],m.hasOwnProperty(te)&&q!==F&&(q!=null||F!=null))if(te==="style")if(F){for(S in F)!F.hasOwnProperty(S)||q&&q.hasOwnProperty(S)||(d||(d={}),d[S]="");for(S in q)q.hasOwnProperty(S)&&F[S]!==q[S]&&(d||(d={}),d[S]=q[S])}else d||(b||(b=[]),b.push(te,d)),d=q;else te==="dangerouslySetInnerHTML"?(q=q?q.__html:void 0,F=F?F.__html:void 0,q!=null&&F!==q&&(b=b||[]).push(te,q)):te==="children"?typeof q!="string"&&typeof q!="number"||(b=b||[]).push(te,""+q):te!=="suppressContentEditableWarning"&&te!=="suppressHydrationWarning"&&(o.hasOwnProperty(te)?(q!=null&&te==="onScroll"&&ot("scroll",n),b||F===q||(b=[])):(b=b||[]).push(te,q))}d&&(b=b||[]).push("style",d);var te=b;(a.updateQueue=te)&&(a.flags|=4)}},ap=function(n,a,d,m){d!==m&&(a.flags|=4)};function ma(n,a){if(!ht)switch(n.tailMode){case"hidden":a=n.tail;for(var d=null;a!==null;)a.alternate!==null&&(d=a),a=a.sibling;d===null?n.tail=null:d.sibling=null;break;case"collapsed":d=n.tail;for(var m=null;d!==null;)d.alternate!==null&&(m=d),d=d.sibling;m===null?a||n.tail===null?n.tail=null:n.tail.sibling=null:m.sibling=null}}function Gt(n){var a=n.alternate!==null&&n.alternate.child===n.child,d=0,m=0;if(a)for(var x=n.child;x!==null;)d|=x.lanes|x.childLanes,m|=x.subtreeFlags&14680064,m|=x.flags&14680064,x.return=n,x=x.sibling;else for(x=n.child;x!==null;)d|=x.lanes|x.childLanes,m|=x.subtreeFlags,m|=x.flags,x.return=n,x=x.sibling;return n.subtreeFlags|=m,n.childLanes=d,a}function vw(n,a,d){var m=a.pendingProps;switch(Kc(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gt(a),null;case 1:return rs(a.type)&&Ao(),Gt(a),null;case 3:return m=a.stateNode,ei(),lt(ss),lt(qt),od(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(n===null||n.child===null)&&(Fo(a)?a.flags|=4:n===null||n.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,$s!==null&&(Md($s),$s=null))),Sd(n,a),Gt(a),null;case 5:id(a);var x=gn(la.current);if(d=a.type,n!==null&&a.stateNode!=null)ip(n,a,d,m,x),n.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!m){if(a.stateNode===null)throw Error(r(166));return Gt(a),null}if(n=gn(sr.current),Fo(a)){m=a.stateNode,d=a.type;var b=a.memoizedProps;switch(m[tr]=a,m[ra]=b,n=(a.mode&1)!==0,d){case"dialog":ot("cancel",m),ot("close",m);break;case"iframe":case"object":case"embed":ot("load",m);break;case"video":case"audio":for(x=0;x<ea.length;x++)ot(ea[x],m);break;case"source":ot("error",m);break;case"img":case"image":case"link":ot("error",m),ot("load",m);break;case"details":ot("toggle",m);break;case"input":at(m,b),ot("invalid",m);break;case"select":m._wrapperState={wasMultiple:!!b.multiple},ot("invalid",m);break;case"textarea":Qt(m,b),ot("invalid",m)}Ir(d,b),x=null;for(var S in b)if(b.hasOwnProperty(S)){var F=b[S];S==="children"?typeof F=="string"?m.textContent!==F&&(b.suppressHydrationWarning!==!0&&To(m.textContent,F,n),x=["children",F]):typeof F=="number"&&m.textContent!==""+F&&(b.suppressHydrationWarning!==!0&&To(m.textContent,F,n),x=["children",""+F]):o.hasOwnProperty(S)&&F!=null&&S==="onScroll"&&ot("scroll",m)}switch(d){case"input":Ue(m),Oe(m,b,!0);break;case"textarea":Ue(m),Je(m);break;case"select":case"option":break;default:typeof b.onClick=="function"&&(m.onclick=Eo)}m=x,a.updateQueue=m,m!==null&&(a.flags|=4)}else{S=x.nodeType===9?x:x.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=jt(d)),n==="http://www.w3.org/1999/xhtml"?d==="script"?(n=S.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof m.is=="string"?n=S.createElement(d,{is:m.is}):(n=S.createElement(d),d==="select"&&(S=n,m.multiple?S.multiple=!0:m.size&&(S.size=m.size))):n=S.createElementNS(n,d),n[tr]=a,n[ra]=m,np(n,a,!1,!1),a.stateNode=n;e:{switch(S=dn(d,m),d){case"dialog":ot("cancel",n),ot("close",n),x=m;break;case"iframe":case"object":case"embed":ot("load",n),x=m;break;case"video":case"audio":for(x=0;x<ea.length;x++)ot(ea[x],n);x=m;break;case"source":ot("error",n),x=m;break;case"img":case"image":case"link":ot("error",n),ot("load",n),x=m;break;case"details":ot("toggle",n),x=m;break;case"input":at(n,m),x=Ke(n,m),ot("invalid",n);break;case"option":x=m;break;case"select":n._wrapperState={wasMultiple:!!m.multiple},x=W({},m,{value:void 0}),ot("invalid",n);break;case"textarea":Qt(n,m),x=st(n,m),ot("invalid",n);break;default:x=m}Ir(d,x),F=x;for(b in F)if(F.hasOwnProperty(b)){var q=F[b];b==="style"?js(n,q):b==="dangerouslySetInnerHTML"?(q=q?q.__html:void 0,q!=null&&ur(n,q)):b==="children"?typeof q=="string"?(d!=="textarea"||q!=="")&&ts(n,q):typeof q=="number"&&ts(n,""+q):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(o.hasOwnProperty(b)?q!=null&&b==="onScroll"&&ot("scroll",n):q!=null&&E(n,b,q,S))}switch(d){case"input":Ue(n),Oe(n,m,!1);break;case"textarea":Ue(n),Je(n);break;case"option":m.value!=null&&n.setAttribute("value",""+ve(m.value));break;case"select":n.multiple=!!m.multiple,b=m.value,b!=null?Lt(n,!!m.multiple,b,!1):m.defaultValue!=null&&Lt(n,!!m.multiple,m.defaultValue,!0);break;default:typeof x.onClick=="function"&&(n.onclick=Eo)}switch(d){case"button":case"input":case"select":case"textarea":m=!!m.autoFocus;break e;case"img":m=!0;break e;default:m=!1}}m&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return Gt(a),null;case 6:if(n&&a.stateNode!=null)ap(n,a,n.memoizedProps,m);else{if(typeof m!="string"&&a.stateNode===null)throw Error(r(166));if(d=gn(la.current),gn(sr.current),Fo(a)){if(m=a.stateNode,d=a.memoizedProps,m[tr]=a,(b=m.nodeValue!==d)&&(n=hs,n!==null))switch(n.tag){case 3:To(m.nodeValue,d,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&To(m.nodeValue,d,(n.mode&1)!==0)}b&&(a.flags|=4)}else m=(d.nodeType===9?d:d.ownerDocument).createTextNode(m),m[tr]=a,a.stateNode=m}return Gt(a),null;case 13:if(lt(pt),m=a.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(ht&&ms!==null&&(a.mode&1)!==0&&(a.flags&128)===0)cf(),Jn(),a.flags|=98560,b=!1;else if(b=Fo(a),m!==null&&m.dehydrated!==null){if(n===null){if(!b)throw Error(r(318));if(b=a.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(r(317));b[tr]=a}else Jn(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Gt(a),b=!1}else $s!==null&&(Md($s),$s=null),b=!0;if(!b)return a.flags&65536?a:null}return(a.flags&128)!==0?(a.lanes=d,a):(m=m!==null,m!==(n!==null&&n.memoizedState!==null)&&m&&(a.child.flags|=8192,(a.mode&1)!==0&&(n===null||(pt.current&1)!==0?At===0&&(At=3):$d())),a.updateQueue!==null&&(a.flags|=4),Gt(a),null);case 4:return ei(),Sd(n,a),n===null&&ta(a.stateNode.containerInfo),Gt(a),null;case 10:return ed(a.type._context),Gt(a),null;case 17:return rs(a.type)&&Ao(),Gt(a),null;case 19:if(lt(pt),b=a.memoizedState,b===null)return Gt(a),null;if(m=(a.flags&128)!==0,S=b.rendering,S===null)if(m)ma(b,!1);else{if(At!==0||n!==null&&(n.flags&128)!==0)for(n=a.child;n!==null;){if(S=Wo(n),S!==null){for(a.flags|=128,ma(b,!1),m=S.updateQueue,m!==null&&(a.updateQueue=m,a.flags|=4),a.subtreeFlags=0,m=d,d=a.child;d!==null;)b=d,n=m,b.flags&=14680066,S=b.alternate,S===null?(b.childLanes=0,b.lanes=n,b.child=null,b.subtreeFlags=0,b.memoizedProps=null,b.memoizedState=null,b.updateQueue=null,b.dependencies=null,b.stateNode=null):(b.childLanes=S.childLanes,b.lanes=S.lanes,b.child=S.child,b.subtreeFlags=0,b.deletions=null,b.memoizedProps=S.memoizedProps,b.memoizedState=S.memoizedState,b.updateQueue=S.updateQueue,b.type=S.type,n=S.dependencies,b.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),d=d.sibling;return nt(pt,pt.current&1|2),a.child}n=n.sibling}b.tail!==null&&Nt()>ni&&(a.flags|=128,m=!0,ma(b,!1),a.lanes=4194304)}else{if(!m)if(n=Wo(S),n!==null){if(a.flags|=128,m=!0,d=n.updateQueue,d!==null&&(a.updateQueue=d,a.flags|=4),ma(b,!0),b.tail===null&&b.tailMode==="hidden"&&!S.alternate&&!ht)return Gt(a),null}else 2*Nt()-b.renderingStartTime>ni&&d!==1073741824&&(a.flags|=128,m=!0,ma(b,!1),a.lanes=4194304);b.isBackwards?(S.sibling=a.child,a.child=S):(d=b.last,d!==null?d.sibling=S:a.child=S,b.last=S)}return b.tail!==null?(a=b.tail,b.rendering=a,b.tail=a.sibling,b.renderingStartTime=Nt(),a.sibling=null,d=pt.current,nt(pt,m?d&1|2:d&1),a):(Gt(a),null);case 22:case 23:return Ud(),m=a.memoizedState!==null,n!==null&&n.memoizedState!==null!==m&&(a.flags|=8192),m&&(a.mode&1)!==0?(fs&1073741824)!==0&&(Gt(a),a.subtreeFlags&6&&(a.flags|=8192)):Gt(a),null;case 24:return null;case 25:return null}throw Error(r(156,a.tag))}function ww(n,a){switch(Kc(a),a.tag){case 1:return rs(a.type)&&Ao(),n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 3:return ei(),lt(ss),lt(qt),od(),n=a.flags,(n&65536)!==0&&(n&128)===0?(a.flags=n&-65537|128,a):null;case 5:return id(a),null;case 13:if(lt(pt),n=a.memoizedState,n!==null&&n.dehydrated!==null){if(a.alternate===null)throw Error(r(340));Jn()}return n=a.flags,n&65536?(a.flags=n&-65537|128,a):null;case 19:return lt(pt),null;case 4:return ei(),null;case 10:return ed(a.type._context),null;case 22:case 23:return Ud(),null;case 24:return null;default:return null}}var Qo=!1,Kt=!1,jw=typeof WeakSet=="function"?WeakSet:Set,_e=null;function si(n,a){var d=n.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(m){yt(n,a,m)}else d.current=null}function Cd(n,a,d){try{d()}catch(m){yt(n,a,m)}}var op=!1;function Nw(n,a){if(Uc=xo,n=Om(),Ac(n)){if("selectionStart"in n)var d={start:n.selectionStart,end:n.selectionEnd};else e:{d=(d=n.ownerDocument)&&d.defaultView||window;var m=d.getSelection&&d.getSelection();if(m&&m.rangeCount!==0){d=m.anchorNode;var x=m.anchorOffset,b=m.focusNode;m=m.focusOffset;try{d.nodeType,b.nodeType}catch{d=null;break e}var S=0,F=-1,q=-1,te=0,me=0,ge=n,de=null;t:for(;;){for(var ke;ge!==d||x!==0&&ge.nodeType!==3||(F=S+x),ge!==b||m!==0&&ge.nodeType!==3||(q=S+m),ge.nodeType===3&&(S+=ge.nodeValue.length),(ke=ge.firstChild)!==null;)de=ge,ge=ke;for(;;){if(ge===n)break t;if(de===d&&++te===x&&(F=S),de===b&&++me===m&&(q=S),(ke=ge.nextSibling)!==null)break;ge=de,de=ge.parentNode}ge=ke}d=F===-1||q===-1?null:{start:F,end:q}}else d=null}d=d||{start:0,end:0}}else d=null;for($c={focusedElem:n,selectionRange:d},xo=!1,_e=a;_e!==null;)if(a=_e,n=a.child,(a.subtreeFlags&1028)!==0&&n!==null)n.return=a,_e=n;else for(;_e!==null;){a=_e;try{var Se=a.alternate;if((a.flags&1024)!==0)switch(a.tag){case 0:case 11:case 15:break;case 1:if(Se!==null){var Ce=Se.memoizedProps,kt=Se.memoizedState,Q=a.stateNode,K=Q.getSnapshotBeforeUpdate(a.elementType===a.type?Ce:Bs(a.type,Ce),kt);Q.__reactInternalSnapshotBeforeUpdate=K}break;case 3:var Z=a.stateNode.containerInfo;Z.nodeType===1?Z.textContent="":Z.nodeType===9&&Z.documentElement&&Z.removeChild(Z.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(ye){yt(a,a.return,ye)}if(n=a.sibling,n!==null){n.return=a.return,_e=n;break}_e=a.return}return Se=op,op=!1,Se}function fa(n,a,d){var m=a.updateQueue;if(m=m!==null?m.lastEffect:null,m!==null){var x=m=m.next;do{if((x.tag&n)===n){var b=x.destroy;x.destroy=void 0,b!==void 0&&Cd(a,d,b)}x=x.next}while(x!==m)}}function Zo(n,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var d=a=a.next;do{if((d.tag&n)===n){var m=d.create;d.destroy=m()}d=d.next}while(d!==a)}}function Td(n){var a=n.ref;if(a!==null){var d=n.stateNode;switch(n.tag){case 5:n=d;break;default:n=d}typeof a=="function"?a(n):a.current=n}}function lp(n){var a=n.alternate;a!==null&&(n.alternate=null,lp(a)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(a=n.stateNode,a!==null&&(delete a[tr],delete a[ra],delete a[zc],delete a[iw],delete a[aw])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function cp(n){return n.tag===5||n.tag===3||n.tag===4}function dp(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||cp(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Ed(n,a,d){var m=n.tag;if(m===5||m===6)n=n.stateNode,a?d.nodeType===8?d.parentNode.insertBefore(n,a):d.insertBefore(n,a):(d.nodeType===8?(a=d.parentNode,a.insertBefore(n,d)):(a=d,a.appendChild(n)),d=d._reactRootContainer,d!=null||a.onclick!==null||(a.onclick=Eo));else if(m!==4&&(n=n.child,n!==null))for(Ed(n,a,d),n=n.sibling;n!==null;)Ed(n,a,d),n=n.sibling}function Pd(n,a,d){var m=n.tag;if(m===5||m===6)n=n.stateNode,a?d.insertBefore(n,a):d.appendChild(n);else if(m!==4&&(n=n.child,n!==null))for(Pd(n,a,d),n=n.sibling;n!==null;)Pd(n,a,d),n=n.sibling}var Ut=null,Ws=!1;function Hr(n,a,d){for(d=d.child;d!==null;)up(n,a,d),d=d.sibling}function up(n,a,d){if(er&&typeof er.onCommitFiberUnmount=="function")try{er.onCommitFiberUnmount(uo,d)}catch{}switch(d.tag){case 5:Kt||si(d,a);case 6:var m=Ut,x=Ws;Ut=null,Hr(n,a,d),Ut=m,Ws=x,Ut!==null&&(Ws?(n=Ut,d=d.stateNode,n.nodeType===8?n.parentNode.removeChild(d):n.removeChild(d)):Ut.removeChild(d.stateNode));break;case 18:Ut!==null&&(Ws?(n=Ut,d=d.stateNode,n.nodeType===8?Vc(n.parentNode,d):n.nodeType===1&&Vc(n,d),Hi(n)):Vc(Ut,d.stateNode));break;case 4:m=Ut,x=Ws,Ut=d.stateNode.containerInfo,Ws=!0,Hr(n,a,d),Ut=m,Ws=x;break;case 0:case 11:case 14:case 15:if(!Kt&&(m=d.updateQueue,m!==null&&(m=m.lastEffect,m!==null))){x=m=m.next;do{var b=x,S=b.destroy;b=b.tag,S!==void 0&&((b&2)!==0||(b&4)!==0)&&Cd(d,a,S),x=x.next}while(x!==m)}Hr(n,a,d);break;case 1:if(!Kt&&(si(d,a),m=d.stateNode,typeof m.componentWillUnmount=="function"))try{m.props=d.memoizedProps,m.state=d.memoizedState,m.componentWillUnmount()}catch(F){yt(d,a,F)}Hr(n,a,d);break;case 21:Hr(n,a,d);break;case 22:d.mode&1?(Kt=(m=Kt)||d.memoizedState!==null,Hr(n,a,d),Kt=m):Hr(n,a,d);break;default:Hr(n,a,d)}}function hp(n){var a=n.updateQueue;if(a!==null){n.updateQueue=null;var d=n.stateNode;d===null&&(d=n.stateNode=new jw),a.forEach(function(m){var x=Iw.bind(null,n,m);d.has(m)||(d.add(m),m.then(x,x))})}}function Vs(n,a){var d=a.deletions;if(d!==null)for(var m=0;m<d.length;m++){var x=d[m];try{var b=n,S=a,F=S;e:for(;F!==null;){switch(F.tag){case 5:Ut=F.stateNode,Ws=!1;break e;case 3:Ut=F.stateNode.containerInfo,Ws=!0;break e;case 4:Ut=F.stateNode.containerInfo,Ws=!0;break e}F=F.return}if(Ut===null)throw Error(r(160));up(b,S,x),Ut=null,Ws=!1;var q=x.alternate;q!==null&&(q.return=null),x.return=null}catch(te){yt(x,a,te)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)mp(a,n),a=a.sibling}function mp(n,a){var d=n.alternate,m=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Vs(a,n),nr(n),m&4){try{fa(3,n,n.return),Zo(3,n)}catch(Ce){yt(n,n.return,Ce)}try{fa(5,n,n.return)}catch(Ce){yt(n,n.return,Ce)}}break;case 1:Vs(a,n),nr(n),m&512&&d!==null&&si(d,d.return);break;case 5:if(Vs(a,n),nr(n),m&512&&d!==null&&si(d,d.return),n.flags&32){var x=n.stateNode;try{ts(x,"")}catch(Ce){yt(n,n.return,Ce)}}if(m&4&&(x=n.stateNode,x!=null)){var b=n.memoizedProps,S=d!==null?d.memoizedProps:b,F=n.type,q=n.updateQueue;if(n.updateQueue=null,q!==null)try{F==="input"&&b.type==="radio"&&b.name!=null&&re(x,b),dn(F,S);var te=dn(F,b);for(S=0;S<q.length;S+=2){var me=q[S],ge=q[S+1];me==="style"?js(x,ge):me==="dangerouslySetInnerHTML"?ur(x,ge):me==="children"?ts(x,ge):E(x,me,ge,te)}switch(F){case"input":ne(x,b);break;case"textarea":Ae(x,b);break;case"select":var de=x._wrapperState.wasMultiple;x._wrapperState.wasMultiple=!!b.multiple;var ke=b.value;ke!=null?Lt(x,!!b.multiple,ke,!1):de!==!!b.multiple&&(b.defaultValue!=null?Lt(x,!!b.multiple,b.defaultValue,!0):Lt(x,!!b.multiple,b.multiple?[]:"",!1))}x[ra]=b}catch(Ce){yt(n,n.return,Ce)}}break;case 6:if(Vs(a,n),nr(n),m&4){if(n.stateNode===null)throw Error(r(162));x=n.stateNode,b=n.memoizedProps;try{x.nodeValue=b}catch(Ce){yt(n,n.return,Ce)}}break;case 3:if(Vs(a,n),nr(n),m&4&&d!==null&&d.memoizedState.isDehydrated)try{Hi(a.containerInfo)}catch(Ce){yt(n,n.return,Ce)}break;case 4:Vs(a,n),nr(n);break;case 13:Vs(a,n),nr(n),x=n.child,x.flags&8192&&(b=x.memoizedState!==null,x.stateNode.isHidden=b,!b||x.alternate!==null&&x.alternate.memoizedState!==null||(Ld=Nt())),m&4&&hp(n);break;case 22:if(me=d!==null&&d.memoizedState!==null,n.mode&1?(Kt=(te=Kt)||me,Vs(a,n),Kt=te):Vs(a,n),nr(n),m&8192){if(te=n.memoizedState!==null,(n.stateNode.isHidden=te)&&!me&&(n.mode&1)!==0)for(_e=n,me=n.child;me!==null;){for(ge=_e=me;_e!==null;){switch(de=_e,ke=de.child,de.tag){case 0:case 11:case 14:case 15:fa(4,de,de.return);break;case 1:si(de,de.return);var Se=de.stateNode;if(typeof Se.componentWillUnmount=="function"){m=de,d=de.return;try{a=m,Se.props=a.memoizedProps,Se.state=a.memoizedState,Se.componentWillUnmount()}catch(Ce){yt(m,d,Ce)}}break;case 5:si(de,de.return);break;case 22:if(de.memoizedState!==null){gp(ge);continue}}ke!==null?(ke.return=de,_e=ke):gp(ge)}me=me.sibling}e:for(me=null,ge=n;;){if(ge.tag===5){if(me===null){me=ge;try{x=ge.stateNode,te?(b=x.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none"):(F=ge.stateNode,q=ge.memoizedProps.style,S=q!=null&&q.hasOwnProperty("display")?q.display:null,F.style.display=hr("display",S))}catch(Ce){yt(n,n.return,Ce)}}}else if(ge.tag===6){if(me===null)try{ge.stateNode.nodeValue=te?"":ge.memoizedProps}catch(Ce){yt(n,n.return,Ce)}}else if((ge.tag!==22&&ge.tag!==23||ge.memoizedState===null||ge===n)&&ge.child!==null){ge.child.return=ge,ge=ge.child;continue}if(ge===n)break e;for(;ge.sibling===null;){if(ge.return===null||ge.return===n)break e;me===ge&&(me=null),ge=ge.return}me===ge&&(me=null),ge.sibling.return=ge.return,ge=ge.sibling}}break;case 19:Vs(a,n),nr(n),m&4&&hp(n);break;case 21:break;default:Vs(a,n),nr(n)}}function nr(n){var a=n.flags;if(a&2){try{e:{for(var d=n.return;d!==null;){if(cp(d)){var m=d;break e}d=d.return}throw Error(r(160))}switch(m.tag){case 5:var x=m.stateNode;m.flags&32&&(ts(x,""),m.flags&=-33);var b=dp(n);Pd(n,b,x);break;case 3:case 4:var S=m.stateNode.containerInfo,F=dp(n);Ed(n,F,S);break;default:throw Error(r(161))}}catch(q){yt(n,n.return,q)}n.flags&=-3}a&4096&&(n.flags&=-4097)}function kw(n,a,d){_e=n,fp(n)}function fp(n,a,d){for(var m=(n.mode&1)!==0;_e!==null;){var x=_e,b=x.child;if(x.tag===22&&m){var S=x.memoizedState!==null||Qo;if(!S){var F=x.alternate,q=F!==null&&F.memoizedState!==null||Kt;F=Qo;var te=Kt;if(Qo=S,(Kt=q)&&!te)for(_e=x;_e!==null;)S=_e,q=S.child,S.tag===22&&S.memoizedState!==null?xp(x):q!==null?(q.return=S,_e=q):xp(x);for(;b!==null;)_e=b,fp(b),b=b.sibling;_e=x,Qo=F,Kt=te}pp(n)}else(x.subtreeFlags&8772)!==0&&b!==null?(b.return=x,_e=b):pp(n)}}function pp(n){for(;_e!==null;){var a=_e;if((a.flags&8772)!==0){var d=a.alternate;try{if((a.flags&8772)!==0)switch(a.tag){case 0:case 11:case 15:Kt||Zo(5,a);break;case 1:var m=a.stateNode;if(a.flags&4&&!Kt)if(d===null)m.componentDidMount();else{var x=a.elementType===a.type?d.memoizedProps:Bs(a.type,d.memoizedProps);m.componentDidUpdate(x,d.memoizedState,m.__reactInternalSnapshotBeforeUpdate)}var b=a.updateQueue;b!==null&&gf(a,b,m);break;case 3:var S=a.updateQueue;if(S!==null){if(d=null,a.child!==null)switch(a.child.tag){case 5:d=a.child.stateNode;break;case 1:d=a.child.stateNode}gf(a,S,d)}break;case 5:var F=a.stateNode;if(d===null&&a.flags&4){d=F;var q=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":q.autoFocus&&d.focus();break;case"img":q.src&&(d.src=q.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var te=a.alternate;if(te!==null){var me=te.memoizedState;if(me!==null){var ge=me.dehydrated;ge!==null&&Hi(ge)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Kt||a.flags&512&&Td(a)}catch(de){yt(a,a.return,de)}}if(a===n){_e=null;break}if(d=a.sibling,d!==null){d.return=a.return,_e=d;break}_e=a.return}}function gp(n){for(;_e!==null;){var a=_e;if(a===n){_e=null;break}var d=a.sibling;if(d!==null){d.return=a.return,_e=d;break}_e=a.return}}function xp(n){for(;_e!==null;){var a=_e;try{switch(a.tag){case 0:case 11:case 15:var d=a.return;try{Zo(4,a)}catch(q){yt(a,d,q)}break;case 1:var m=a.stateNode;if(typeof m.componentDidMount=="function"){var x=a.return;try{m.componentDidMount()}catch(q){yt(a,x,q)}}var b=a.return;try{Td(a)}catch(q){yt(a,b,q)}break;case 5:var S=a.return;try{Td(a)}catch(q){yt(a,S,q)}}}catch(q){yt(a,a.return,q)}if(a===n){_e=null;break}var F=a.sibling;if(F!==null){F.return=a.return,_e=F;break}_e=a.return}}var _w=Math.ceil,Xo=_.ReactCurrentDispatcher,Ad=_.ReactCurrentOwner,Cs=_.ReactCurrentBatchConfig,Qe=0,Ft=null,Tt=null,$t=0,fs=0,ri=Br(0),At=0,pa=null,yn=0,el=0,Id=0,ga=null,is=null,Ld=0,ni=1/0,jr=null,tl=!1,Rd=null,Gr=null,sl=!1,Kr=null,rl=0,xa=0,Dd=null,nl=-1,il=0;function es(){return(Qe&6)!==0?Nt():nl!==-1?nl:nl=Nt()}function Yr(n){return(n.mode&1)===0?1:(Qe&2)!==0&&$t!==0?$t&-$t:lw.transition!==null?(il===0&&(il=cm()),il):(n=et,n!==0||(n=window.event,n=n===void 0?16:ym(n.type)),n)}function zs(n,a,d,m){if(50<xa)throw xa=0,Dd=null,Error(r(185));Bi(n,d,m),((Qe&2)===0||n!==Ft)&&(n===Ft&&((Qe&2)===0&&(el|=d),At===4&&Jr(n,$t)),as(n,m),d===1&&Qe===0&&(a.mode&1)===0&&(ni=Nt()+500,Lo&&Vr()))}function as(n,a){var d=n.callbackNode;lv(n,a);var m=fo(n,n===Ft?$t:0);if(m===0)d!==null&&am(d),n.callbackNode=null,n.callbackPriority=0;else if(a=m&-m,n.callbackPriority!==a){if(d!=null&&am(d),a===1)n.tag===0?ow(bp.bind(null,n)):rf(bp.bind(null,n)),rw(function(){(Qe&6)===0&&Vr()}),d=null;else{switch(dm(m)){case 1:d=fc;break;case 4:d=om;break;case 16:d=co;break;case 536870912:d=lm;break;default:d=co}d=Cp(d,yp.bind(null,n))}n.callbackPriority=a,n.callbackNode=d}}function yp(n,a){if(nl=-1,il=0,(Qe&6)!==0)throw Error(r(327));var d=n.callbackNode;if(ii()&&n.callbackNode!==d)return null;var m=fo(n,n===Ft?$t:0);if(m===0)return null;if((m&30)!==0||(m&n.expiredLanes)!==0||a)a=al(n,m);else{a=m;var x=Qe;Qe|=2;var b=wp();(Ft!==n||$t!==a)&&(jr=null,ni=Nt()+500,vn(n,a));do try{Tw();break}catch(F){vp(n,F)}while(!0);Xc(),Xo.current=b,Qe=x,Tt!==null?a=0:(Ft=null,$t=0,a=At)}if(a!==0){if(a===2&&(x=pc(n),x!==0&&(m=x,a=Fd(n,x))),a===1)throw d=pa,vn(n,0),Jr(n,m),as(n,Nt()),d;if(a===6)Jr(n,m);else{if(x=n.current.alternate,(m&30)===0&&!Sw(x)&&(a=al(n,m),a===2&&(b=pc(n),b!==0&&(m=b,a=Fd(n,b))),a===1))throw d=pa,vn(n,0),Jr(n,m),as(n,Nt()),d;switch(n.finishedWork=x,n.finishedLanes=m,a){case 0:case 1:throw Error(r(345));case 2:wn(n,is,jr);break;case 3:if(Jr(n,m),(m&130023424)===m&&(a=Ld+500-Nt(),10<a)){if(fo(n,0)!==0)break;if(x=n.suspendedLanes,(x&m)!==m){es(),n.pingedLanes|=n.suspendedLanes&x;break}n.timeoutHandle=Wc(wn.bind(null,n,is,jr),a);break}wn(n,is,jr);break;case 4:if(Jr(n,m),(m&4194240)===m)break;for(a=n.eventTimes,x=-1;0<m;){var S=31-Os(m);b=1<<S,S=a[S],S>x&&(x=S),m&=~b}if(m=x,m=Nt()-m,m=(120>m?120:480>m?480:1080>m?1080:1920>m?1920:3e3>m?3e3:4320>m?4320:1960*_w(m/1960))-m,10<m){n.timeoutHandle=Wc(wn.bind(null,n,is,jr),m);break}wn(n,is,jr);break;case 5:wn(n,is,jr);break;default:throw Error(r(329))}}}return as(n,Nt()),n.callbackNode===d?yp.bind(null,n):null}function Fd(n,a){var d=ga;return n.current.memoizedState.isDehydrated&&(vn(n,a).flags|=256),n=al(n,a),n!==2&&(a=is,is=d,a!==null&&Md(a)),n}function Md(n){is===null?is=n:is.push.apply(is,n)}function Sw(n){for(var a=n;;){if(a.flags&16384){var d=a.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var m=0;m<d.length;m++){var x=d[m],b=x.getSnapshot;x=x.value;try{if(!Us(b(),x))return!1}catch{return!1}}}if(d=a.child,a.subtreeFlags&16384&&d!==null)d.return=a,a=d;else{if(a===n)break;for(;a.sibling===null;){if(a.return===null||a.return===n)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Jr(n,a){for(a&=~Id,a&=~el,n.suspendedLanes|=a,n.pingedLanes&=~a,n=n.expirationTimes;0<a;){var d=31-Os(a),m=1<<d;n[d]=-1,a&=~m}}function bp(n){if((Qe&6)!==0)throw Error(r(327));ii();var a=fo(n,0);if((a&1)===0)return as(n,Nt()),null;var d=al(n,a);if(n.tag!==0&&d===2){var m=pc(n);m!==0&&(a=m,d=Fd(n,m))}if(d===1)throw d=pa,vn(n,0),Jr(n,a),as(n,Nt()),d;if(d===6)throw Error(r(345));return n.finishedWork=n.current.alternate,n.finishedLanes=a,wn(n,is,jr),as(n,Nt()),null}function Od(n,a){var d=Qe;Qe|=1;try{return n(a)}finally{Qe=d,Qe===0&&(ni=Nt()+500,Lo&&Vr())}}function bn(n){Kr!==null&&Kr.tag===0&&(Qe&6)===0&&ii();var a=Qe;Qe|=1;var d=Cs.transition,m=et;try{if(Cs.transition=null,et=1,n)return n()}finally{et=m,Cs.transition=d,Qe=a,(Qe&6)===0&&Vr()}}function Ud(){fs=ri.current,lt(ri)}function vn(n,a){n.finishedWork=null,n.finishedLanes=0;var d=n.timeoutHandle;if(d!==-1&&(n.timeoutHandle=-1,sw(d)),Tt!==null)for(d=Tt.return;d!==null;){var m=d;switch(Kc(m),m.tag){case 1:m=m.type.childContextTypes,m!=null&&Ao();break;case 3:ei(),lt(ss),lt(qt),od();break;case 5:id(m);break;case 4:ei();break;case 13:lt(pt);break;case 19:lt(pt);break;case 10:ed(m.type._context);break;case 22:case 23:Ud()}d=d.return}if(Ft=n,Tt=n=Qr(n.current,null),$t=fs=a,At=0,pa=null,Id=el=yn=0,is=ga=null,pn!==null){for(a=0;a<pn.length;a++)if(d=pn[a],m=d.interleaved,m!==null){d.interleaved=null;var x=m.next,b=d.pending;if(b!==null){var S=b.next;b.next=x,m.next=S}d.pending=m}pn=null}return n}function vp(n,a){do{var d=Tt;try{if(Xc(),Vo.current=Go,zo){for(var m=gt.memoizedState;m!==null;){var x=m.queue;x!==null&&(x.pending=null),m=m.next}zo=!1}if(xn=0,Dt=Pt=gt=null,ca=!1,da=0,Ad.current=null,d===null||d.return===null){At=1,pa=a,Tt=null;break}e:{var b=n,S=d.return,F=d,q=a;if(a=$t,F.flags|=32768,q!==null&&typeof q=="object"&&typeof q.then=="function"){var te=q,me=F,ge=me.tag;if((me.mode&1)===0&&(ge===0||ge===11||ge===15)){var de=me.alternate;de?(me.updateQueue=de.updateQueue,me.memoizedState=de.memoizedState,me.lanes=de.lanes):(me.updateQueue=null,me.memoizedState=null)}var ke=qf(S);if(ke!==null){ke.flags&=-257,Hf(ke,S,F,b,a),ke.mode&1&&zf(b,te,a),a=ke,q=te;var Se=a.updateQueue;if(Se===null){var Ce=new Set;Ce.add(q),a.updateQueue=Ce}else Se.add(q);break e}else{if((a&1)===0){zf(b,te,a),$d();break e}q=Error(r(426))}}else if(ht&&F.mode&1){var kt=qf(S);if(kt!==null){(kt.flags&65536)===0&&(kt.flags|=256),Hf(kt,S,F,b,a),Qc(ti(q,F));break e}}b=q=ti(q,F),At!==4&&(At=2),ga===null?ga=[b]:ga.push(b),b=S;do{switch(b.tag){case 3:b.flags|=65536,a&=-a,b.lanes|=a;var Q=Wf(b,q,a);pf(b,Q);break e;case 1:F=q;var K=b.type,Z=b.stateNode;if((b.flags&128)===0&&(typeof K.getDerivedStateFromError=="function"||Z!==null&&typeof Z.componentDidCatch=="function"&&(Gr===null||!Gr.has(Z)))){b.flags|=65536,a&=-a,b.lanes|=a;var ye=Vf(b,F,a);pf(b,ye);break e}}b=b.return}while(b!==null)}Np(d)}catch(Ee){a=Ee,Tt===d&&d!==null&&(Tt=d=d.return);continue}break}while(!0)}function wp(){var n=Xo.current;return Xo.current=Go,n===null?Go:n}function $d(){(At===0||At===3||At===2)&&(At=4),Ft===null||(yn&268435455)===0&&(el&268435455)===0||Jr(Ft,$t)}function al(n,a){var d=Qe;Qe|=2;var m=wp();(Ft!==n||$t!==a)&&(jr=null,vn(n,a));do try{Cw();break}catch(x){vp(n,x)}while(!0);if(Xc(),Qe=d,Xo.current=m,Tt!==null)throw Error(r(261));return Ft=null,$t=0,At}function Cw(){for(;Tt!==null;)jp(Tt)}function Tw(){for(;Tt!==null&&!Xb();)jp(Tt)}function jp(n){var a=Sp(n.alternate,n,fs);n.memoizedProps=n.pendingProps,a===null?Np(n):Tt=a,Ad.current=null}function Np(n){var a=n;do{var d=a.alternate;if(n=a.return,(a.flags&32768)===0){if(d=vw(d,a,fs),d!==null){Tt=d;return}}else{if(d=ww(d,a),d!==null){d.flags&=32767,Tt=d;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{At=6,Tt=null;return}}if(a=a.sibling,a!==null){Tt=a;return}Tt=a=n}while(a!==null);At===0&&(At=5)}function wn(n,a,d){var m=et,x=Cs.transition;try{Cs.transition=null,et=1,Ew(n,a,d,m)}finally{Cs.transition=x,et=m}return null}function Ew(n,a,d,m){do ii();while(Kr!==null);if((Qe&6)!==0)throw Error(r(327));d=n.finishedWork;var x=n.finishedLanes;if(d===null)return null;if(n.finishedWork=null,n.finishedLanes=0,d===n.current)throw Error(r(177));n.callbackNode=null,n.callbackPriority=0;var b=d.lanes|d.childLanes;if(cv(n,b),n===Ft&&(Tt=Ft=null,$t=0),(d.subtreeFlags&2064)===0&&(d.flags&2064)===0||sl||(sl=!0,Cp(co,function(){return ii(),null})),b=(d.flags&15990)!==0,(d.subtreeFlags&15990)!==0||b){b=Cs.transition,Cs.transition=null;var S=et;et=1;var F=Qe;Qe|=4,Ad.current=null,Nw(n,d),mp(d,n),Yv($c),xo=!!Uc,$c=Uc=null,n.current=d,kw(d),ev(),Qe=F,et=S,Cs.transition=b}else n.current=d;if(sl&&(sl=!1,Kr=n,rl=x),b=n.pendingLanes,b===0&&(Gr=null),rv(d.stateNode),as(n,Nt()),a!==null)for(m=n.onRecoverableError,d=0;d<a.length;d++)x=a[d],m(x.value,{componentStack:x.stack,digest:x.digest});if(tl)throw tl=!1,n=Rd,Rd=null,n;return(rl&1)!==0&&n.tag!==0&&ii(),b=n.pendingLanes,(b&1)!==0?n===Dd?xa++:(xa=0,Dd=n):xa=0,Vr(),null}function ii(){if(Kr!==null){var n=dm(rl),a=Cs.transition,d=et;try{if(Cs.transition=null,et=16>n?16:n,Kr===null)var m=!1;else{if(n=Kr,Kr=null,rl=0,(Qe&6)!==0)throw Error(r(331));var x=Qe;for(Qe|=4,_e=n.current;_e!==null;){var b=_e,S=b.child;if((_e.flags&16)!==0){var F=b.deletions;if(F!==null){for(var q=0;q<F.length;q++){var te=F[q];for(_e=te;_e!==null;){var me=_e;switch(me.tag){case 0:case 11:case 15:fa(8,me,b)}var ge=me.child;if(ge!==null)ge.return=me,_e=ge;else for(;_e!==null;){me=_e;var de=me.sibling,ke=me.return;if(lp(me),me===te){_e=null;break}if(de!==null){de.return=ke,_e=de;break}_e=ke}}}var Se=b.alternate;if(Se!==null){var Ce=Se.child;if(Ce!==null){Se.child=null;do{var kt=Ce.sibling;Ce.sibling=null,Ce=kt}while(Ce!==null)}}_e=b}}if((b.subtreeFlags&2064)!==0&&S!==null)S.return=b,_e=S;else e:for(;_e!==null;){if(b=_e,(b.flags&2048)!==0)switch(b.tag){case 0:case 11:case 15:fa(9,b,b.return)}var Q=b.sibling;if(Q!==null){Q.return=b.return,_e=Q;break e}_e=b.return}}var K=n.current;for(_e=K;_e!==null;){S=_e;var Z=S.child;if((S.subtreeFlags&2064)!==0&&Z!==null)Z.return=S,_e=Z;else e:for(S=K;_e!==null;){if(F=_e,(F.flags&2048)!==0)try{switch(F.tag){case 0:case 11:case 15:Zo(9,F)}}catch(Ee){yt(F,F.return,Ee)}if(F===S){_e=null;break e}var ye=F.sibling;if(ye!==null){ye.return=F.return,_e=ye;break e}_e=F.return}}if(Qe=x,Vr(),er&&typeof er.onPostCommitFiberRoot=="function")try{er.onPostCommitFiberRoot(uo,n)}catch{}m=!0}return m}finally{et=d,Cs.transition=a}}return!1}function kp(n,a,d){a=ti(d,a),a=Wf(n,a,1),n=qr(n,a,1),a=es(),n!==null&&(Bi(n,1,a),as(n,a))}function yt(n,a,d){if(n.tag===3)kp(n,n,d);else for(;a!==null;){if(a.tag===3){kp(a,n,d);break}else if(a.tag===1){var m=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(Gr===null||!Gr.has(m))){n=ti(d,n),n=Vf(a,n,1),a=qr(a,n,1),n=es(),a!==null&&(Bi(a,1,n),as(a,n));break}}a=a.return}}function Pw(n,a,d){var m=n.pingCache;m!==null&&m.delete(a),a=es(),n.pingedLanes|=n.suspendedLanes&d,Ft===n&&($t&d)===d&&(At===4||At===3&&($t&130023424)===$t&&500>Nt()-Ld?vn(n,0):Id|=d),as(n,a)}function _p(n,a){a===0&&((n.mode&1)===0?a=1:(a=mo,mo<<=1,(mo&130023424)===0&&(mo=4194304)));var d=es();n=br(n,a),n!==null&&(Bi(n,a,d),as(n,d))}function Aw(n){var a=n.memoizedState,d=0;a!==null&&(d=a.retryLane),_p(n,d)}function Iw(n,a){var d=0;switch(n.tag){case 13:var m=n.stateNode,x=n.memoizedState;x!==null&&(d=x.retryLane);break;case 19:m=n.stateNode;break;default:throw Error(r(314))}m!==null&&m.delete(a),_p(n,d)}var Sp;Sp=function(n,a,d){if(n!==null)if(n.memoizedProps!==a.pendingProps||ss.current)ns=!0;else{if((n.lanes&d)===0&&(a.flags&128)===0)return ns=!1,bw(n,a,d);ns=(n.flags&131072)!==0}else ns=!1,ht&&(a.flags&1048576)!==0&&nf(a,Do,a.index);switch(a.lanes=0,a.tag){case 2:var m=a.type;Jo(n,a),n=a.pendingProps;var x=Gn(a,qt.current);Xn(a,d),x=dd(null,a,m,n,x,d);var b=ud();return a.flags|=1,typeof x=="object"&&x!==null&&typeof x.render=="function"&&x.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,rs(m)?(b=!0,Io(a)):b=!1,a.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,rd(a),x.updater=Ko,a.stateNode=x,x._reactInternals=a,xd(a,m,n,d),a=wd(null,a,m,!0,b,d)):(a.tag=0,ht&&b&&Gc(a),Xt(null,a,x,d),a=a.child),a;case 16:m=a.elementType;e:{switch(Jo(n,a),n=a.pendingProps,x=m._init,m=x(m._payload),a.type=m,x=a.tag=Rw(m),n=Bs(m,n),x){case 0:a=vd(null,a,m,n,d);break e;case 1:a=Zf(null,a,m,n,d);break e;case 11:a=Gf(null,a,m,n,d);break e;case 14:a=Kf(null,a,m,Bs(m.type,n),d);break e}throw Error(r(306,m,""))}return a;case 0:return m=a.type,x=a.pendingProps,x=a.elementType===m?x:Bs(m,x),vd(n,a,m,x,d);case 1:return m=a.type,x=a.pendingProps,x=a.elementType===m?x:Bs(m,x),Zf(n,a,m,x,d);case 3:e:{if(Xf(a),n===null)throw Error(r(387));m=a.pendingProps,b=a.memoizedState,x=b.element,ff(n,a),Bo(a,m,null,d);var S=a.memoizedState;if(m=S.element,b.isDehydrated)if(b={element:m,isDehydrated:!1,cache:S.cache,pendingSuspenseBoundaries:S.pendingSuspenseBoundaries,transitions:S.transitions},a.updateQueue.baseState=b,a.memoizedState=b,a.flags&256){x=ti(Error(r(423)),a),a=ep(n,a,m,d,x);break e}else if(m!==x){x=ti(Error(r(424)),a),a=ep(n,a,m,d,x);break e}else for(ms=$r(a.stateNode.containerInfo.firstChild),hs=a,ht=!0,$s=null,d=hf(a,null,m,d),a.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(Jn(),m===x){a=wr(n,a,d);break e}Xt(n,a,m,d)}a=a.child}return a;case 5:return xf(a),n===null&&Jc(a),m=a.type,x=a.pendingProps,b=n!==null?n.memoizedProps:null,S=x.children,Bc(m,x)?S=null:b!==null&&Bc(m,b)&&(a.flags|=32),Qf(n,a),Xt(n,a,S,d),a.child;case 6:return n===null&&Jc(a),null;case 13:return tp(n,a,d);case 4:return nd(a,a.stateNode.containerInfo),m=a.pendingProps,n===null?a.child=Qn(a,null,m,d):Xt(n,a,m,d),a.child;case 11:return m=a.type,x=a.pendingProps,x=a.elementType===m?x:Bs(m,x),Gf(n,a,m,x,d);case 7:return Xt(n,a,a.pendingProps,d),a.child;case 8:return Xt(n,a,a.pendingProps.children,d),a.child;case 12:return Xt(n,a,a.pendingProps.children,d),a.child;case 10:e:{if(m=a.type._context,x=a.pendingProps,b=a.memoizedProps,S=x.value,nt(Oo,m._currentValue),m._currentValue=S,b!==null)if(Us(b.value,S)){if(b.children===x.children&&!ss.current){a=wr(n,a,d);break e}}else for(b=a.child,b!==null&&(b.return=a);b!==null;){var F=b.dependencies;if(F!==null){S=b.child;for(var q=F.firstContext;q!==null;){if(q.context===m){if(b.tag===1){q=vr(-1,d&-d),q.tag=2;var te=b.updateQueue;if(te!==null){te=te.shared;var me=te.pending;me===null?q.next=q:(q.next=me.next,me.next=q),te.pending=q}}b.lanes|=d,q=b.alternate,q!==null&&(q.lanes|=d),td(b.return,d,a),F.lanes|=d;break}q=q.next}}else if(b.tag===10)S=b.type===a.type?null:b.child;else if(b.tag===18){if(S=b.return,S===null)throw Error(r(341));S.lanes|=d,F=S.alternate,F!==null&&(F.lanes|=d),td(S,d,a),S=b.sibling}else S=b.child;if(S!==null)S.return=b;else for(S=b;S!==null;){if(S===a){S=null;break}if(b=S.sibling,b!==null){b.return=S.return,S=b;break}S=S.return}b=S}Xt(n,a,x.children,d),a=a.child}return a;case 9:return x=a.type,m=a.pendingProps.children,Xn(a,d),x=_s(x),m=m(x),a.flags|=1,Xt(n,a,m,d),a.child;case 14:return m=a.type,x=Bs(m,a.pendingProps),x=Bs(m.type,x),Kf(n,a,m,x,d);case 15:return Yf(n,a,a.type,a.pendingProps,d);case 17:return m=a.type,x=a.pendingProps,x=a.elementType===m?x:Bs(m,x),Jo(n,a),a.tag=1,rs(m)?(n=!0,Io(a)):n=!1,Xn(a,d),$f(a,m,x),xd(a,m,x,d),wd(null,a,m,!0,n,d);case 19:return rp(n,a,d);case 22:return Jf(n,a,d)}throw Error(r(156,a.tag))};function Cp(n,a){return im(n,a)}function Lw(n,a,d,m){this.tag=n,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ts(n,a,d,m){return new Lw(n,a,d,m)}function Bd(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Rw(n){if(typeof n=="function")return Bd(n)?1:0;if(n!=null){if(n=n.$$typeof,n===ue)return 11;if(n===we)return 14}return 2}function Qr(n,a){var d=n.alternate;return d===null?(d=Ts(n.tag,a,n.key,n.mode),d.elementType=n.elementType,d.type=n.type,d.stateNode=n.stateNode,d.alternate=n,n.alternate=d):(d.pendingProps=a,d.type=n.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=n.flags&14680064,d.childLanes=n.childLanes,d.lanes=n.lanes,d.child=n.child,d.memoizedProps=n.memoizedProps,d.memoizedState=n.memoizedState,d.updateQueue=n.updateQueue,a=n.dependencies,d.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},d.sibling=n.sibling,d.index=n.index,d.ref=n.ref,d}function ol(n,a,d,m,x,b){var S=2;if(m=n,typeof n=="function")Bd(n)&&(S=1);else if(typeof n=="string")S=5;else e:switch(n){case P:return jn(d.children,x,b,a);case D:S=8,x|=8;break;case H:return n=Ts(12,d,a,x|2),n.elementType=H,n.lanes=b,n;case le:return n=Ts(13,d,a,x),n.elementType=le,n.lanes=b,n;case fe:return n=Ts(19,d,a,x),n.elementType=fe,n.lanes=b,n;case Y:return ll(d,x,b,a);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case B:S=10;break e;case ae:S=9;break e;case ue:S=11;break e;case we:S=14;break e;case oe:S=16,m=null;break e}throw Error(r(130,n==null?n:typeof n,""))}return a=Ts(S,d,a,x),a.elementType=n,a.type=m,a.lanes=b,a}function jn(n,a,d,m){return n=Ts(7,n,m,a),n.lanes=d,n}function ll(n,a,d,m){return n=Ts(22,n,m,a),n.elementType=Y,n.lanes=d,n.stateNode={isHidden:!1},n}function Wd(n,a,d){return n=Ts(6,n,null,a),n.lanes=d,n}function Vd(n,a,d){return a=Ts(4,n.children!==null?n.children:[],n.key,a),a.lanes=d,a.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},a}function Dw(n,a,d,m,x){this.tag=a,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gc(0),this.expirationTimes=gc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gc(0),this.identifierPrefix=m,this.onRecoverableError=x,this.mutableSourceEagerHydrationData=null}function zd(n,a,d,m,x,b,S,F,q){return n=new Dw(n,a,d,F,q),a===1?(a=1,b===!0&&(a|=8)):a=0,b=Ts(3,null,null,a),n.current=b,b.stateNode=n,b.memoizedState={element:m,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},rd(b),n}function Fw(n,a,d){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:L,key:m==null?null:""+m,children:n,containerInfo:a,implementation:d}}function Tp(n){if(!n)return Wr;n=n._reactInternals;e:{if(fr(n)!==n||n.tag!==1)throw Error(r(170));var a=n;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(rs(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(r(171))}if(n.tag===1){var d=n.type;if(rs(d))return tf(n,d,a)}return a}function Ep(n,a,d,m,x,b,S,F,q){return n=zd(d,m,!0,n,x,b,S,F,q),n.context=Tp(null),d=n.current,m=es(),x=Yr(d),b=vr(m,x),b.callback=a??null,qr(d,b,x),n.current.lanes=x,Bi(n,x,m),as(n,m),n}function cl(n,a,d,m){var x=a.current,b=es(),S=Yr(x);return d=Tp(d),a.context===null?a.context=d:a.pendingContext=d,a=vr(b,S),a.payload={element:n},m=m===void 0?null:m,m!==null&&(a.callback=m),n=qr(x,a,S),n!==null&&(zs(n,x,S,b),$o(n,x,S)),S}function dl(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function Pp(n,a){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var d=n.retryLane;n.retryLane=d!==0&&d<a?d:a}}function qd(n,a){Pp(n,a),(n=n.alternate)&&Pp(n,a)}function Mw(){return null}var Ap=typeof reportError=="function"?reportError:function(n){console.error(n)};function Hd(n){this._internalRoot=n}ul.prototype.render=Hd.prototype.render=function(n){var a=this._internalRoot;if(a===null)throw Error(r(409));cl(n,a,null,null)},ul.prototype.unmount=Hd.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var a=n.containerInfo;bn(function(){cl(null,n,null,null)}),a[pr]=null}};function ul(n){this._internalRoot=n}ul.prototype.unstable_scheduleHydration=function(n){if(n){var a=mm();n={blockedOn:null,target:n,priority:a};for(var d=0;d<Mr.length&&a!==0&&a<Mr[d].priority;d++);Mr.splice(d,0,n),d===0&&gm(n)}};function Gd(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function hl(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function Ip(){}function Ow(n,a,d,m,x){if(x){if(typeof m=="function"){var b=m;m=function(){var te=dl(S);b.call(te)}}var S=Ep(a,m,n,0,null,!1,!1,"",Ip);return n._reactRootContainer=S,n[pr]=S.current,ta(n.nodeType===8?n.parentNode:n),bn(),S}for(;x=n.lastChild;)n.removeChild(x);if(typeof m=="function"){var F=m;m=function(){var te=dl(q);F.call(te)}}var q=zd(n,0,!1,null,null,!1,!1,"",Ip);return n._reactRootContainer=q,n[pr]=q.current,ta(n.nodeType===8?n.parentNode:n),bn(function(){cl(a,q,d,m)}),q}function ml(n,a,d,m,x){var b=d._reactRootContainer;if(b){var S=b;if(typeof x=="function"){var F=x;x=function(){var q=dl(S);F.call(q)}}cl(a,S,n,x)}else S=Ow(d,a,n,x,m);return dl(S)}um=function(n){switch(n.tag){case 3:var a=n.stateNode;if(a.current.memoizedState.isDehydrated){var d=$i(a.pendingLanes);d!==0&&(xc(a,d|1),as(a,Nt()),(Qe&6)===0&&(ni=Nt()+500,Vr()))}break;case 13:bn(function(){var m=br(n,1);if(m!==null){var x=es();zs(m,n,1,x)}}),qd(n,1)}},yc=function(n){if(n.tag===13){var a=br(n,134217728);if(a!==null){var d=es();zs(a,n,134217728,d)}qd(n,134217728)}},hm=function(n){if(n.tag===13){var a=Yr(n),d=br(n,a);if(d!==null){var m=es();zs(d,n,a,m)}qd(n,a)}},mm=function(){return et},fm=function(n,a){var d=et;try{return et=n,a()}finally{et=d}},qe=function(n,a,d){switch(a){case"input":if(ne(n,d),a=d.name,d.type==="radio"&&a!=null){for(d=n;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<d.length;a++){var m=d[a];if(m!==n&&m.form===n.form){var x=Po(m);if(!x)throw Error(r(90));he(m),ne(m,x)}}}break;case"textarea":Ae(n,d);break;case"select":a=d.value,a!=null&&Lt(n,!!d.multiple,a,!1)}},O=Od,U=bn;var Uw={usingClientEntryPoint:!1,Events:[na,qn,Po,se,ft,Od]},ya={findFiberByHostInstance:un,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},$w={bundleType:ya.bundleType,version:ya.version,rendererPackageName:ya.rendererPackageName,rendererConfig:ya.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=rm(n),n===null?null:n.stateNode},findFiberByHostInstance:ya.findFiberByHostInstance||Mw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var fl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!fl.isDisabled&&fl.supportsFiber)try{uo=fl.inject($w),er=fl}catch{}}return os.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Uw,os.createPortal=function(n,a){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Gd(a))throw Error(r(200));return Fw(n,a,null,d)},os.createRoot=function(n,a){if(!Gd(n))throw Error(r(299));var d=!1,m="",x=Ap;return a!=null&&(a.unstable_strictMode===!0&&(d=!0),a.identifierPrefix!==void 0&&(m=a.identifierPrefix),a.onRecoverableError!==void 0&&(x=a.onRecoverableError)),a=zd(n,1,!1,null,null,d,!1,m,x),n[pr]=a.current,ta(n.nodeType===8?n.parentNode:n),new Hd(a)},os.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var a=n._reactInternals;if(a===void 0)throw typeof n.render=="function"?Error(r(188)):(n=Object.keys(n).join(","),Error(r(268,n)));return n=rm(a),n=n===null?null:n.stateNode,n},os.flushSync=function(n){return bn(n)},os.hydrate=function(n,a,d){if(!hl(a))throw Error(r(200));return ml(null,n,a,!0,d)},os.hydrateRoot=function(n,a,d){if(!Gd(n))throw Error(r(405));var m=d!=null&&d.hydratedSources||null,x=!1,b="",S=Ap;if(d!=null&&(d.unstable_strictMode===!0&&(x=!0),d.identifierPrefix!==void 0&&(b=d.identifierPrefix),d.onRecoverableError!==void 0&&(S=d.onRecoverableError)),a=Ep(a,null,n,1,d??null,x,!1,b,S),n[pr]=a.current,ta(n),m)for(n=0;n<m.length;n++)d=m[n],x=d._getVersion,x=x(d._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[d,x]:a.mutableSourceEagerHydrationData.push(d,x);return new ul(a)},os.render=function(n,a,d){if(!hl(a))throw Error(r(200));return ml(null,n,a,!1,d)},os.unmountComponentAtNode=function(n){if(!hl(n))throw Error(r(40));return n._reactRootContainer?(bn(function(){ml(null,null,n,!1,function(){n._reactRootContainer=null,n[pr]=null})}),!0):!1},os.unstable_batchedUpdates=Od,os.unstable_renderSubtreeIntoContainer=function(n,a,d,m){if(!hl(d))throw Error(r(200));if(n==null||n._reactInternals===void 0)throw Error(r(38));return ml(n,a,d,!1,m)},os.version="18.3.1-next-f1338f8080-20240426",os}var $p;function Hx(){if($p)return Jd.exports;$p=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Jd.exports=Gw(),Jd.exports}var Bp;function Kw(){if(Bp)return pl;Bp=1;var t=Hx();return pl.createRoot=t.createRoot,pl.hydrateRoot=t.hydrateRoot,pl}var Yw=Kw();const Jw="modulepreload",Qw=function(t){return"/"+t},Wp={},ys=function(e,r,i){let o=Promise.resolve();if(r&&r.length>0){let l=function(f){return Promise.all(f.map(g=>Promise.resolve(g).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),h=u?.nonce||u?.getAttribute("nonce");o=l(r.map(f=>{if(f=Qw(f),f in Wp)return;Wp[f]=!0;const g=f.endsWith(".css"),p=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${p}`))return;const y=document.createElement("link");if(y.rel=g?"stylesheet":Jw,g||(y.as="script"),y.crossOrigin="",y.href=f,h&&y.setAttribute("nonce",h),document.head.appendChild(y),g)return new Promise((v,w)=>{y.addEventListener("load",v),y.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${f}`)))})}))}function c(l){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=l,window.dispatchEvent(u),!u.defaultPrevented)throw l}return o.then(l=>{for(const u of l||[])u.status==="rejected"&&c(u.reason);return e().catch(c)})};var j=Xu();const je=qx(j);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Zw={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xw=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ne=(t,e)=>{const r=j.forwardRef(({color:i="currentColor",size:o=24,strokeWidth:c=2,absoluteStrokeWidth:l,className:u="",children:h,...f},g)=>j.createElement("svg",{ref:g,...Zw,width:o,height:o,stroke:i,strokeWidth:l?Number(c)*24/Number(o):c,className:["lucide",`lucide-${Xw(t)}`,u].join(" "),...f},[...e.map(([p,y])=>j.createElement(p,y)),...Array.isArray(h)?h:[h]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=Ne("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ki=Ne("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Za=Ne("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e1=Ne("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rl=Ne("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const or=Ne("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=Ne("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vu=Ne("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t1=Ne("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gx=Ne("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=Ne("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=Ne("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kx=Ne("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eh=Ne("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const th=Ne("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=Ne("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vp=Ne("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s1=Ne("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r1=Ne("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yx=Ne("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jx=Ne("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mi=Ne("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kr=Ne("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qx=Ne("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const An=Ne("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zx=Ne("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xx=Ne("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=Ne("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ey=Ne("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xa=Ne("IndianRupee",[["path",{d:"M6 3h12",key:"ggurg9"}],["path",{d:"M6 8h12",key:"6g4wlu"}],["path",{d:"m6 13 8.5 8",key:"u1kupk"}],["path",{d:"M6 13h3",key:"wdp6ag"}],["path",{d:"M9 13c6.667 0 6.667-10 0-10",key:"1nkvk2"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n1=Ne("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ty=Ne("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sy=Ne("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ry=Ne("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _r=Ne("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const va=Ne("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i1=Ne("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ny=Ne("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Si=Ne("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ds=Ne("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iy=Ne("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a1=Ne("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o1=Ne("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=Ne("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sr=Ne("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l1=Ne("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xi=Ne("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fn=Ne("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ay=Ne("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c1=Ne("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ea=Ne("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ci=Ne("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pa=Ne("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oy=Ne("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xd=Ne("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=Ne("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=Ne("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ly=Ne("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cy=Ne("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dy=Ne("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zp=Ne("ShieldOff",[["path",{d:"M19.7 14a6.9 6.9 0 0 0 .3-2V5l-8-3-3.2 1.2",key:"342pvf"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M4.7 4.7 4 5v7c0 6 8 10 8 10a20.3 20.3 0 0 0 5.62-4.38",key:"p0ycf4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rn=Ne("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ua=Ne("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uy=Ne("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d1=Ne("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=Ne("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qp=Ne("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ls=Ne("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u1=Ne("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h1=Ne("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m1=Ne("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=Ne("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ul=Ne("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ar=Ne("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=Ne("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f1=Ne("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);var p1=Hx();const g1=qx(p1);function x1(t){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",e.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}const y1=t=>{switch(t){case"success":return w1;case"info":return N1;case"warning":return j1;case"error":return k1;default:return null}},b1=Array(12).fill(0),v1=({visible:t,className:e})=>je.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":t},je.createElement("div",{className:"sonner-spinner"},b1.map((r,i)=>je.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${i}`})))),w1=je.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},je.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),j1=je.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},je.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),N1=je.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},je.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),k1=je.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},je.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),_1=je.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},je.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),je.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),S1=()=>{const[t,e]=je.useState(document.hidden);return je.useEffect(()=>{const r=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),t};let wu=1;class C1{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{const r=this.subscribers.indexOf(e);this.subscribers.splice(r,1)}),this.publish=e=>{this.subscribers.forEach(r=>r(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var r;const{message:i,...o}=e,c=typeof e?.id=="number"||((r=e.id)==null?void 0:r.length)>0?e.id:wu++,l=this.toasts.find(h=>h.id===c),u=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(c)&&this.dismissedToasts.delete(c),l?this.toasts=this.toasts.map(h=>h.id===c?(this.publish({...h,...e,id:c,title:i}),{...h,...e,id:c,dismissible:u,title:i}):h):this.addToast({title:i,...o,dismissible:u,id:c}),c},this.dismiss=e=>(e?(this.dismissedToasts.add(e),requestAnimationFrame(()=>this.subscribers.forEach(r=>r({id:e,dismiss:!0})))):this.toasts.forEach(r=>{this.subscribers.forEach(i=>i({id:r.id,dismiss:!0}))}),e),this.message=(e,r)=>this.create({...r,message:e}),this.error=(e,r)=>this.create({...r,message:e,type:"error"}),this.success=(e,r)=>this.create({...r,type:"success",message:e}),this.info=(e,r)=>this.create({...r,type:"info",message:e}),this.warning=(e,r)=>this.create({...r,type:"warning",message:e}),this.loading=(e,r)=>this.create({...r,type:"loading",message:e}),this.promise=(e,r)=>{if(!r)return;let i;r.loading!==void 0&&(i=this.create({...r,promise:e,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));const o=Promise.resolve(e instanceof Function?e():e);let c=i!==void 0,l;const u=o.then(async f=>{if(l=["resolve",f],je.isValidElement(f))c=!1,this.create({id:i,type:"default",message:f});else if(E1(f)&&!f.ok){c=!1;const p=typeof r.error=="function"?await r.error(`HTTP error! status: ${f.status}`):r.error,y=typeof r.description=="function"?await r.description(`HTTP error! status: ${f.status}`):r.description,w=typeof p=="object"&&!je.isValidElement(p)?p:{message:p};this.create({id:i,type:"error",description:y,...w})}else if(f instanceof Error){c=!1;const p=typeof r.error=="function"?await r.error(f):r.error,y=typeof r.description=="function"?await r.description(f):r.description,w=typeof p=="object"&&!je.isValidElement(p)?p:{message:p};this.create({id:i,type:"error",description:y,...w})}else if(r.success!==void 0){c=!1;const p=typeof r.success=="function"?await r.success(f):r.success,y=typeof r.description=="function"?await r.description(f):r.description,w=typeof p=="object"&&!je.isValidElement(p)?p:{message:p};this.create({id:i,type:"success",description:y,...w})}}).catch(async f=>{if(l=["reject",f],r.error!==void 0){c=!1;const g=typeof r.error=="function"?await r.error(f):r.error,p=typeof r.description=="function"?await r.description(f):r.description,v=typeof g=="object"&&!je.isValidElement(g)?g:{message:g};this.create({id:i,type:"error",description:p,...v})}}).finally(()=>{c&&(this.dismiss(i),i=void 0),r.finally==null||r.finally.call(r)}),h=()=>new Promise((f,g)=>u.then(()=>l[0]==="reject"?g(l[1]):f(l[1])).catch(g));return typeof i!="string"&&typeof i!="number"?{unwrap:h}:Object.assign(i,{unwrap:h})},this.custom=(e,r)=>{const i=r?.id||wu++;return this.create({jsx:e(i),id:i,...r}),i},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const ls=new C1,T1=(t,e)=>{const r=e?.id||wu++;return ls.addToast({title:t,...e,id:r}),r},E1=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",P1=T1,A1=()=>ls.toasts,I1=()=>ls.getActiveToasts(),J=Object.assign(P1,{success:ls.success,info:ls.info,warning:ls.warning,error:ls.error,custom:ls.custom,message:ls.message,promise:ls.promise,dismiss:ls.dismiss,loading:ls.loading},{getHistory:A1,getToasts:I1});x1("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function gl(t){return t.label!==void 0}const L1=3,R1="24px",D1="16px",Hp=4e3,F1=356,M1=14,O1=45,U1=200;function ir(...t){return t.filter(Boolean).join(" ")}function $1(t){const[e,r]=t.split("-"),i=[];return e&&i.push(e),r&&i.push(r),i}const B1=t=>{var e,r,i,o,c,l,u,h,f;const{invert:g,toast:p,unstyled:y,interacting:v,setHeights:w,visibleToasts:k,heights:N,index:C,toasts:A,expanded:E,removeToast:_,defaultRichColors:R,closeButton:L,style:P,cancelButtonStyle:D,actionButtonStyle:H,className:B="",descriptionClassName:ae="",duration:ue,position:le,gap:fe,expandByDefault:we,classNames:oe,icons:Y,closeButtonAriaLabel:I="Close toast"}=t,[$,W]=je.useState(null),[T,z]=je.useState(null),[G,M]=je.useState(!1),[X,ie]=je.useState(!1),[be,ve]=je.useState(!1),[ee,ce]=je.useState(!1),[Ue,he]=je.useState(!1),[Le,Ke]=je.useState(0),[at,re]=je.useState(0),ne=je.useRef(p.duration||ue||Hp),Oe=je.useRef(null),He=je.useRef(null),wt=C===0,Lt=C+1<=k,st=p.type,Qt=p.dismissible!==!1,Ae=p.className||"",Je=p.descriptionClassName||"",jt=je.useMemo(()=>N.findIndex(se=>se.toastId===p.id)||0,[N,p.id]),St=je.useMemo(()=>{var se;return(se=p.closeButton)!=null?se:L},[p.closeButton,L]),xe=je.useMemo(()=>p.duration||ue||Hp,[p.duration,ue]),ur=je.useRef(0),ts=je.useRef(0),Ds=je.useRef(0),Zs=je.useRef(null),[hr,js]=le.split("-"),zt=je.useMemo(()=>N.reduce((se,ft,O)=>O>=jt?se:se+ft.height,0),[N,jt]),Ir=S1(),dn=p.invert||g,mr=st==="loading";ts.current=je.useMemo(()=>jt*fe+zt,[jt,zt]),je.useEffect(()=>{ne.current=xe},[xe]),je.useEffect(()=>{M(!0)},[]),je.useEffect(()=>{const se=He.current;if(se){const ft=se.getBoundingClientRect().height;return re(ft),w(O=>[{toastId:p.id,height:ft,position:p.position},...O]),()=>w(O=>O.filter(U=>U.toastId!==p.id))}},[w,p.id]),je.useLayoutEffect(()=>{if(!G)return;const se=He.current,ft=se.style.height;se.style.height="auto";const O=se.getBoundingClientRect().height;se.style.height=ft,re(O),w(U=>U.find(pe=>pe.toastId===p.id)?U.map(pe=>pe.toastId===p.id?{...pe,height:O}:pe):[{toastId:p.id,height:O,position:p.position},...U])},[G,p.title,p.description,w,p.id,p.jsx,p.action,p.cancel]);const Zt=je.useCallback(()=>{ie(!0),Ke(ts.current),w(se=>se.filter(ft=>ft.toastId!==p.id)),setTimeout(()=>{_(p)},U1)},[p,_,w,ts]);je.useEffect(()=>{if(p.promise&&st==="loading"||p.duration===1/0||p.type==="loading")return;let se;return E||v||Ir?(()=>{if(Ds.current<ur.current){const U=new Date().getTime()-ur.current;ne.current=ne.current-U}Ds.current=new Date().getTime()})():(()=>{ne.current!==1/0&&(ur.current=new Date().getTime(),se=setTimeout(()=>{p.onAutoClose==null||p.onAutoClose.call(p,p),Zt()},ne.current))})(),()=>clearTimeout(se)},[E,v,p,st,Ir,Zt]),je.useEffect(()=>{p.delete&&(Zt(),p.onDismiss==null||p.onDismiss.call(p,p))},[Zt,p.delete]);function qe(){var se;if(Y?.loading){var ft;return je.createElement("div",{className:ir(oe?.loader,p==null||(ft=p.classNames)==null?void 0:ft.loader,"sonner-loader"),"data-visible":st==="loading"},Y.loading)}return je.createElement(v1,{className:ir(oe?.loader,p==null||(se=p.classNames)==null?void 0:se.loader),visible:st==="loading"})}const Fs=p.icon||Y?.[st]||y1(st);var Ms,Lr;return je.createElement("li",{tabIndex:0,ref:He,className:ir(B,Ae,oe?.toast,p==null||(e=p.classNames)==null?void 0:e.toast,oe?.default,oe?.[st],p==null||(r=p.classNames)==null?void 0:r[st]),"data-sonner-toast":"","data-rich-colors":(Ms=p.richColors)!=null?Ms:R,"data-styled":!(p.jsx||p.unstyled||y),"data-mounted":G,"data-promise":!!p.promise,"data-swiped":Ue,"data-removed":X,"data-visible":Lt,"data-y-position":hr,"data-x-position":js,"data-index":C,"data-front":wt,"data-swiping":be,"data-dismissible":Qt,"data-type":st,"data-invert":dn,"data-swipe-out":ee,"data-swipe-direction":T,"data-expanded":!!(E||we&&G),"data-testid":p.testId,style:{"--index":C,"--toasts-before":C,"--z-index":A.length-C,"--offset":`${X?Le:ts.current}px`,"--initial-height":we?"auto":`${at}px`,...P,...p.style},onDragEnd:()=>{ve(!1),W(null),Zs.current=null},onPointerDown:se=>{se.button!==2&&(mr||!Qt||(Oe.current=new Date,Ke(ts.current),se.target.setPointerCapture(se.pointerId),se.target.tagName!=="BUTTON"&&(ve(!0),Zs.current={x:se.clientX,y:se.clientY})))},onPointerUp:()=>{var se,ft,O;if(ee||!Qt)return;Zs.current=null;const U=Number(((se=He.current)==null?void 0:se.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Re=Number(((ft=He.current)==null?void 0:ft.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),pe=new Date().getTime()-((O=Oe.current)==null?void 0:O.getTime()),De=$==="x"?U:Re,Ie=Math.abs(De)/pe;if(Math.abs(De)>=O1||Ie>.11){Ke(ts.current),p.onDismiss==null||p.onDismiss.call(p,p),z($==="x"?U>0?"right":"left":Re>0?"down":"up"),Zt(),ce(!0);return}else{var $e,Te;($e=He.current)==null||$e.style.setProperty("--swipe-amount-x","0px"),(Te=He.current)==null||Te.style.setProperty("--swipe-amount-y","0px")}he(!1),ve(!1),W(null)},onPointerMove:se=>{var ft,O,U;if(!Zs.current||!Qt||((ft=window.getSelection())==null?void 0:ft.toString().length)>0)return;const pe=se.clientY-Zs.current.y,De=se.clientX-Zs.current.x;var Ie;const $e=(Ie=t.swipeDirections)!=null?Ie:$1(le);!$&&(Math.abs(De)>1||Math.abs(pe)>1)&&W(Math.abs(De)>Math.abs(pe)?"x":"y");let Te={x:0,y:0};const Ye=Ze=>1/(1.5+Math.abs(Ze)/20);if($==="y"){if($e.includes("top")||$e.includes("bottom"))if($e.includes("top")&&pe<0||$e.includes("bottom")&&pe>0)Te.y=pe;else{const Ze=pe*Ye(pe);Te.y=Math.abs(Ze)<Math.abs(pe)?Ze:pe}}else if($==="x"&&($e.includes("left")||$e.includes("right")))if($e.includes("left")&&De<0||$e.includes("right")&&De>0)Te.x=De;else{const Ze=De*Ye(De);Te.x=Math.abs(Ze)<Math.abs(De)?Ze:De}(Math.abs(Te.x)>0||Math.abs(Te.y)>0)&&he(!0),(O=He.current)==null||O.style.setProperty("--swipe-amount-x",`${Te.x}px`),(U=He.current)==null||U.style.setProperty("--swipe-amount-y",`${Te.y}px`)}},St&&!p.jsx&&st!=="loading"?je.createElement("button",{"aria-label":I,"data-disabled":mr,"data-close-button":!0,onClick:mr||!Qt?()=>{}:()=>{Zt(),p.onDismiss==null||p.onDismiss.call(p,p)},className:ir(oe?.closeButton,p==null||(i=p.classNames)==null?void 0:i.closeButton)},(Lr=Y?.close)!=null?Lr:_1):null,(st||p.icon||p.promise)&&p.icon!==null&&(Y?.[st]!==null||p.icon)?je.createElement("div",{"data-icon":"",className:ir(oe?.icon,p==null||(o=p.classNames)==null?void 0:o.icon)},p.promise||p.type==="loading"&&!p.icon?p.icon||qe():null,p.type!=="loading"?Fs:null):null,je.createElement("div",{"data-content":"",className:ir(oe?.content,p==null||(c=p.classNames)==null?void 0:c.content)},je.createElement("div",{"data-title":"",className:ir(oe?.title,p==null||(l=p.classNames)==null?void 0:l.title)},p.jsx?p.jsx:typeof p.title=="function"?p.title():p.title),p.description?je.createElement("div",{"data-description":"",className:ir(ae,Je,oe?.description,p==null||(u=p.classNames)==null?void 0:u.description)},typeof p.description=="function"?p.description():p.description):null),je.isValidElement(p.cancel)?p.cancel:p.cancel&&gl(p.cancel)?je.createElement("button",{"data-button":!0,"data-cancel":!0,style:p.cancelButtonStyle||D,onClick:se=>{gl(p.cancel)&&Qt&&(p.cancel.onClick==null||p.cancel.onClick.call(p.cancel,se),Zt())},className:ir(oe?.cancelButton,p==null||(h=p.classNames)==null?void 0:h.cancelButton)},p.cancel.label):null,je.isValidElement(p.action)?p.action:p.action&&gl(p.action)?je.createElement("button",{"data-button":!0,"data-action":!0,style:p.actionButtonStyle||H,onClick:se=>{gl(p.action)&&(p.action.onClick==null||p.action.onClick.call(p.action,se),!se.defaultPrevented&&Zt())},className:ir(oe?.actionButton,p==null||(f=p.classNames)==null?void 0:f.actionButton)},p.action.label):null)};function Gp(){if(typeof window>"u"||typeof document>"u")return"ltr";const t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function W1(t,e){const r={};return[t,e].forEach((i,o)=>{const c=o===1,l=c?"--mobile-offset":"--offset",u=c?D1:R1;function h(f){["top","right","bottom","left"].forEach(g=>{r[`${l}-${g}`]=typeof f=="number"?`${f}px`:f})}typeof i=="number"||typeof i=="string"?h(i):typeof i=="object"?["top","right","bottom","left"].forEach(f=>{i[f]===void 0?r[`${l}-${f}`]=u:r[`${l}-${f}`]=typeof i[f]=="number"?`${i[f]}px`:i[f]}):h(u)}),r}const V1=je.forwardRef(function(e,r){const{id:i,invert:o,position:c="bottom-right",hotkey:l=["altKey","KeyT"],expand:u,closeButton:h,className:f,offset:g,mobileOffset:p,theme:y="light",richColors:v,duration:w,style:k,visibleToasts:N=L1,toastOptions:C,dir:A=Gp(),gap:E=M1,icons:_,containerAriaLabel:R="Notifications"}=e,[L,P]=je.useState([]),D=je.useMemo(()=>i?L.filter(G=>G.toasterId===i):L.filter(G=>!G.toasterId),[L,i]),H=je.useMemo(()=>Array.from(new Set([c].concat(D.filter(G=>G.position).map(G=>G.position)))),[D,c]),[B,ae]=je.useState([]),[ue,le]=je.useState(!1),[fe,we]=je.useState(!1),[oe,Y]=je.useState(y!=="system"?y:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),I=je.useRef(null),$=l.join("+").replace(/Key/g,"").replace(/Digit/g,""),W=je.useRef(null),T=je.useRef(!1),z=je.useCallback(G=>{P(M=>{var X;return(X=M.find(ie=>ie.id===G.id))!=null&&X.delete||ls.dismiss(G.id),M.filter(({id:ie})=>ie!==G.id)})},[]);return je.useEffect(()=>ls.subscribe(G=>{if(G.dismiss){requestAnimationFrame(()=>{P(M=>M.map(X=>X.id===G.id?{...X,delete:!0}:X))});return}setTimeout(()=>{g1.flushSync(()=>{P(M=>{const X=M.findIndex(ie=>ie.id===G.id);return X!==-1?[...M.slice(0,X),{...M[X],...G},...M.slice(X+1)]:[G,...M]})})})}),[L]),je.useEffect(()=>{if(y!=="system"){Y(y);return}if(y==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?Y("dark"):Y("light")),typeof window>"u")return;const G=window.matchMedia("(prefers-color-scheme: dark)");try{G.addEventListener("change",({matches:M})=>{Y(M?"dark":"light")})}catch{G.addListener(({matches:X})=>{try{Y(X?"dark":"light")}catch(ie){console.error(ie)}})}},[y]),je.useEffect(()=>{L.length<=1&&le(!1)},[L]),je.useEffect(()=>{const G=M=>{var X;if(l.every(ve=>M[ve]||M.code===ve)){var be;le(!0),(be=I.current)==null||be.focus()}M.code==="Escape"&&(document.activeElement===I.current||(X=I.current)!=null&&X.contains(document.activeElement))&&le(!1)};return document.addEventListener("keydown",G),()=>document.removeEventListener("keydown",G)},[l]),je.useEffect(()=>{if(I.current)return()=>{W.current&&(W.current.focus({preventScroll:!0}),W.current=null,T.current=!1)}},[I.current]),je.createElement("section",{ref:r,"aria-label":`${R} ${$}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},H.map((G,M)=>{var X;const[ie,be]=G.split("-");return D.length?je.createElement("ol",{key:G,dir:A==="auto"?Gp():A,tabIndex:-1,ref:I,className:f,"data-sonner-toaster":!0,"data-sonner-theme":oe,"data-y-position":ie,"data-x-position":be,style:{"--front-toast-height":`${((X=B[0])==null?void 0:X.height)||0}px`,"--width":`${F1}px`,"--gap":`${E}px`,...k,...W1(g,p)},onBlur:ve=>{T.current&&!ve.currentTarget.contains(ve.relatedTarget)&&(T.current=!1,W.current&&(W.current.focus({preventScroll:!0}),W.current=null))},onFocus:ve=>{ve.target instanceof HTMLElement&&ve.target.dataset.dismissible==="false"||T.current||(T.current=!0,W.current=ve.relatedTarget)},onMouseEnter:()=>le(!0),onMouseMove:()=>le(!0),onMouseLeave:()=>{fe||le(!1)},onDragEnd:()=>le(!1),onPointerDown:ve=>{ve.target instanceof HTMLElement&&ve.target.dataset.dismissible==="false"||we(!0)},onPointerUp:()=>we(!1)},D.filter(ve=>!ve.position&&M===0||ve.position===G).map((ve,ee)=>{var ce,Ue;return je.createElement(B1,{key:ve.id,icons:_,index:ee,toast:ve,defaultRichColors:v,duration:(ce=C?.duration)!=null?ce:w,className:C?.className,descriptionClassName:C?.descriptionClassName,invert:o,visibleToasts:N,closeButton:(Ue=C?.closeButton)!=null?Ue:h,interacting:fe,position:G,style:C?.style,unstyled:C?.unstyled,classNames:C?.classNames,cancelButtonStyle:C?.cancelButtonStyle,actionButtonStyle:C?.actionButtonStyle,closeButtonAriaLabel:C?.closeButtonAriaLabel,removeToast:z,toasts:D.filter(he=>he.position==ve.position),heights:B.filter(he=>he.position==ve.position),setHeights:ae,expandByDefault:u,gap:E,expanded:ue,swipeDirections:e.swipeDirections})})):null}))});function Jl(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,i=Object.getOwnPropertySymbols(t);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(t,i[o])&&(r[i[o]]=t[i[o]]);return r}function z1(t,e,r,i){function o(c){return c instanceof r?c:new r(function(l){l(c)})}return new(r||(r=Promise))(function(c,l){function u(g){try{f(i.next(g))}catch(p){l(p)}}function h(g){try{f(i.throw(g))}catch(p){l(p)}}function f(g){g.done?c(g.value):o(g.value).then(u,h)}f((i=i.apply(t,e||[])).next())})}const q1=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class sh extends Error{constructor(e,r="FunctionsError",i){super(e),this.name=r,this.context=i}}class H1 extends sh{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Kp extends sh{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Yp extends sh{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var ju;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(ju||(ju={}));class G1{constructor(e,{headers:r={},customFetch:i,region:o=ju.Any}={}){this.url=e,this.headers=r,this.region=o,this.fetch=q1(i)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return z1(this,arguments,void 0,function*(r,i={}){var o;let c,l;try{const{headers:u,method:h,body:f,signal:g,timeout:p}=i;let y={},{region:v}=i;v||(v=this.region);const w=new URL(`${this.url}/${r}`);v&&v!=="any"&&(y["x-region"]=v,w.searchParams.set("forceFunctionRegion",v));let k;f&&(u&&!Object.prototype.hasOwnProperty.call(u,"Content-Type")||!u)?typeof Blob<"u"&&f instanceof Blob||f instanceof ArrayBuffer?(y["Content-Type"]="application/octet-stream",k=f):typeof f=="string"?(y["Content-Type"]="text/plain",k=f):typeof FormData<"u"&&f instanceof FormData?k=f:(y["Content-Type"]="application/json",k=JSON.stringify(f)):f&&typeof f!="string"&&!(typeof Blob<"u"&&f instanceof Blob)&&!(f instanceof ArrayBuffer)&&!(typeof FormData<"u"&&f instanceof FormData)?k=JSON.stringify(f):k=f;let N=g;p&&(l=new AbortController,c=setTimeout(()=>l.abort(),p),g?(N=l.signal,g.addEventListener("abort",()=>l.abort())):N=l.signal);const C=yield this.fetch(w.toString(),{method:h||"POST",headers:Object.assign(Object.assign(Object.assign({},y),this.headers),u),body:k,signal:N}).catch(R=>{throw new H1(R)}),A=C.headers.get("x-relay-error");if(A&&A==="true")throw new Kp(C);if(!C.ok)throw new Yp(C);let E=((o=C.headers.get("Content-Type"))!==null&&o!==void 0?o:"text/plain").split(";")[0].trim(),_;return E==="application/json"?_=yield C.json():E==="application/octet-stream"||E==="application/pdf"?_=yield C.blob():E==="text/event-stream"?_=C:E==="multipart/form-data"?_=yield C.formData():_=yield C.text(),{data:_,error:null,response:C}}catch(u){return{data:null,error:u,response:u instanceof Yp||u instanceof Kp?u.context:void 0}}finally{c&&clearTimeout(c)}})}}var K1=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}},Y1=class{constructor(t){var e,r,i;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(r=t.isMaybeSingle)!==null&&r!==void 0?r:!1,this.urlLengthLimit=(i=t.urlLengthLimit)!==null&&i!==void 0?i:8e3,t.fetch?this.fetch=t.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const i=this.fetch;let o=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{let l=null,u=null,h=null,f=c.status,g=c.statusText;if(c.ok){var p,y;if(r.method!=="HEAD"){var v;const C=await c.text();C===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((v=r.headers.get("Accept"))===null||v===void 0)&&v.includes("application/vnd.pgrst.plan+text"))?u=C:u=JSON.parse(C))}const k=(p=r.headers.get("Prefer"))===null||p===void 0?void 0:p.match(/count=(exact|planned|estimated)/),N=(y=c.headers.get("content-range"))===null||y===void 0?void 0:y.split("/");k&&N&&N.length>1&&(h=parseInt(N[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(u)&&(u.length>1?(l={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,h=null,f=406,g="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{var w;const k=await c.text();try{l=JSON.parse(k),Array.isArray(l)&&c.status===404&&(u=[],l=null,f=200,g="OK")}catch{c.status===404&&k===""?(f=204,g="No Content"):l={message:k}}if(l&&r.isMaybeSingle&&(!(l==null||(w=l.details)===null||w===void 0)&&w.includes("0 rows"))&&(l=null,f=200,g="OK"),l&&r.shouldThrowOnError)throw new K1(l)}return{error:l,data:u,count:h,status:f,statusText:g}});return this.shouldThrowOnError||(o=o.catch(c=>{var l;let u="",h="",f="";const g=c?.cause;if(g){var p,y,v,w;const C=(p=g?.message)!==null&&p!==void 0?p:"",A=(y=g?.code)!==null&&y!==void 0?y:"";u=`${(v=c?.name)!==null&&v!==void 0?v:"FetchError"}: ${c?.message}`,u+=`

Caused by: ${(w=g?.name)!==null&&w!==void 0?w:"Error"}: ${C}`,A&&(u+=` (${A})`),g?.stack&&(u+=`
${g.stack}`)}else{var k;u=(k=c?.stack)!==null&&k!==void 0?k:""}const N=this.url.toString().length;return c?.name==="AbortError"||c?.code==="ABORT_ERR"?(f="",h="Request was aborted (timeout or manual cancellation)",N>this.urlLengthLimit&&(h+=`. Note: Your request URL is ${N} characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side.`)):(g?.name==="HeadersOverflowError"||g?.code==="UND_ERR_HEADERS_OVERFLOW")&&(f="",h="HTTP headers exceeded server limits (typically 16KB)",N>this.urlLengthLimit&&(h+=`. Your request URL is ${N} characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead.`)),{error:{message:`${(l=c?.name)!==null&&l!==void 0?l:"FetchError"}: ${c?.message}`,details:u,hint:h,code:f},data:null,count:null,status:0,statusText:""}})),o.then(t,e)}returns(){return this}overrideTypes(){return this}},J1=class extends Y1{select(t){let e=!1;const r=(t??"*").split("").map(i=>/\s/.test(i)&&!e?"":(i==='"'&&(e=!e),i)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:r,foreignTable:i,referencedTable:o=i}={}){const c=o?`${o}.order`:"order",l=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${l?`${l},`:""}${t}.${e?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:r=e}={}){const i=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${t}`),this}range(t,e,{foreignTable:r,referencedTable:i=r}={}){const o=typeof i>"u"?"offset":`${i}.offset`,c=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(o,`${t}`),this.url.searchParams.set(c,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:r=!1,buffers:i=!1,wal:o=!1,format:c="text"}={}){var l;const u=[t?"analyze":null,e?"verbose":null,r?"settings":null,i?"buffers":null,o?"wal":null].filter(Boolean).join("|"),h=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${c}; for="${h}"; options=${u};`),c==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};const Jp=new RegExp("[,()]");var fi=class extends J1{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}regexMatch(t,e){return this.url.searchParams.append(t,`match.${e}`),this}regexIMatch(t,e){return this.url.searchParams.append(t,`imatch.${e}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}isDistinct(t,e){return this.url.searchParams.append(t,`isdistinct.${e}`),this}in(t,e){const r=Array.from(new Set(e)).map(i=>typeof i=="string"&&Jp.test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}notIn(t,e){const r=Array.from(new Set(e)).map(i=>typeof i=="string"&&Jp.test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(t,`not.in.(${r})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:r,type:i}={}){let o="";i==="plain"?o="pl":i==="phrase"?o="ph":i==="websearch"&&(o="w");const c=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${o}fts${c}.${e}`),this}match(t){return Object.entries(t).forEach(([e,r])=>{this.url.searchParams.append(e,`eq.${r}`)}),this}not(t,e,r){return this.url.searchParams.append(t,`not.${e}.${r}`),this}or(t,{foreignTable:e,referencedTable:r=e}={}){const i=r?`${r}.or`:"or";return this.url.searchParams.append(i,`(${t})`),this}filter(t,e,r){return this.url.searchParams.append(t,`${e}.${r}`),this}},Q1=class{constructor(t,{headers:e={},schema:r,fetch:i,urlLengthLimit:o=8e3}){this.url=t,this.headers=new Headers(e),this.schema=r,this.fetch=i,this.urlLengthLimit=o}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(t,e){const{head:r=!1,count:i}=e??{},o=r?"HEAD":"GET";let c=!1;const l=(t??"*").split("").map(f=>/\s/.test(f)&&!c?"":(f==='"'&&(c=!c),f)).join(""),{url:u,headers:h}=this.cloneRequestState();return u.searchParams.set("select",l),i&&h.append("Prefer",`count=${i}`),new fi({method:o,url:u,headers:h,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(t,{count:e,defaultToNull:r=!0}={}){var i;const o="POST",{url:c,headers:l}=this.cloneRequestState();if(e&&l.append("Prefer",`count=${e}`),r||l.append("Prefer","missing=default"),Array.isArray(t)){const u=t.reduce((h,f)=>h.concat(Object.keys(f)),[]);if(u.length>0){const h=[...new Set(u)].map(f=>`"${f}"`);c.searchParams.set("columns",h.join(","))}}return new fi({method:o,url:c,headers:l,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(t,{onConflict:e,ignoreDuplicates:r=!1,count:i,defaultToNull:o=!0}={}){var c;const l="POST",{url:u,headers:h}=this.cloneRequestState();if(h.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),e!==void 0&&u.searchParams.set("on_conflict",e),i&&h.append("Prefer",`count=${i}`),o||h.append("Prefer","missing=default"),Array.isArray(t)){const f=t.reduce((g,p)=>g.concat(Object.keys(p)),[]);if(f.length>0){const g=[...new Set(f)].map(p=>`"${p}"`);u.searchParams.set("columns",g.join(","))}}return new fi({method:l,url:u,headers:h,schema:this.schema,body:t,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch,urlLengthLimit:this.urlLengthLimit})}update(t,{count:e}={}){var r;const i="PATCH",{url:o,headers:c}=this.cloneRequestState();return e&&c.append("Prefer",`count=${e}`),new fi({method:i,url:o,headers:c,schema:this.schema,body:t,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch,urlLengthLimit:this.urlLengthLimit})}delete({count:t}={}){var e;const r="DELETE",{url:i,headers:o}=this.cloneRequestState();return t&&o.append("Prefer",`count=${t}`),new fi({method:r,url:i,headers:o,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch,urlLengthLimit:this.urlLengthLimit})}};function $a(t){"@babel/helpers - typeof";return $a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$a(t)}function Z1(t,e){if($a(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if($a(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function X1(t){var e=Z1(t,"string");return $a(e)=="symbol"?e:e+""}function ej(t,e,r){return(e=X1(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qp(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,i)}return r}function xl(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Qp(Object(r),!0).forEach(function(i){ej(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Qp(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}var tj=class hy{constructor(e,{headers:r={},schema:i,fetch:o,timeout:c,urlLengthLimit:l=8e3}={}){this.url=e,this.headers=new Headers(r),this.schemaName=i,this.urlLengthLimit=l;const u=o??globalThis.fetch;c!==void 0&&c>0?this.fetch=(h,f)=>{const g=new AbortController,p=setTimeout(()=>g.abort(),c),y=f?.signal;if(y){if(y.aborted)return clearTimeout(p),u(h,f);const v=()=>{clearTimeout(p),g.abort()};return y.addEventListener("abort",v,{once:!0}),u(h,xl(xl({},f),{},{signal:g.signal})).finally(()=>{clearTimeout(p),y.removeEventListener("abort",v)})}return u(h,xl(xl({},f),{},{signal:g.signal})).finally(()=>clearTimeout(p))}:this.fetch=u}from(e){if(!e||typeof e!="string"||e.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new Q1(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(e){return new hy(this.url,{headers:this.headers,schema:e,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(e,r={},{head:i=!1,get:o=!1,count:c}={}){var l;let u;const h=new URL(`${this.url}/rpc/${e}`);let f;const g=v=>v!==null&&typeof v=="object"&&(!Array.isArray(v)||v.some(g)),p=i&&Object.values(r).some(g);p?(u="POST",f=r):i||o?(u=i?"HEAD":"GET",Object.entries(r).filter(([v,w])=>w!==void 0).map(([v,w])=>[v,Array.isArray(w)?`{${w.join(",")}}`:`${w}`]).forEach(([v,w])=>{h.searchParams.append(v,w)})):(u="POST",f=r);const y=new Headers(this.headers);return p?y.set("Prefer",c?`count=${c},return=minimal`:"return=minimal"):c&&y.set("Prefer",`count=${c}`),new fi({method:u,url:h,headers:y,schema:this.schemaName,body:f,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch,urlLengthLimit:this.urlLengthLimit})}};class sj{constructor(){}static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const i=r.versions;if(i&&i.node){const o=i.node,c=parseInt(o.replace(/^v/,"").split(".")[0]);return c>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${c} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${c} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const i=this.getWebSocketConstructor();return new i(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const rj="2.95.3",nj=`realtime-js/${rj}`,ij="1.0.0",my="2.0.0",Zp=my,Nu=1e4,aj=1e3,oj=100;var en;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(en||(en={}));var It;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(It||(It={}));var Ks;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Ks||(Ks={}));var ku;(function(t){t.websocket="websocket"})(ku||(ku={}));var En;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(En||(En={}));class lj{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=e??[]}encode(e,r){if(e.event===this.BROADCAST_EVENT&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(e));let i=[e.join_ref,e.ref,e.topic,e.event,e.payload];return r(JSON.stringify(i))}_binaryEncodeUserBroadcastPush(e){var r;return this._isArrayBuffer((r=e.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var r,i;const o=(i=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&i!==void 0?i:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,o)}_encodeJsonUserBroadcastPush(e){var r,i;const o=(i=(r=e.payload)===null||r===void 0?void 0:r.payload)!==null&&i!==void 0?i:{},l=new TextEncoder().encode(JSON.stringify(o)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,l)}_encodeUserBroadcastPush(e,r,i){var o,c;const l=e.topic,u=(o=e.ref)!==null&&o!==void 0?o:"",h=(c=e.join_ref)!==null&&c!==void 0?c:"",f=e.payload.event,g=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},p=Object.keys(g).length===0?"":JSON.stringify(g);if(h.length>255)throw new Error(`joinRef length ${h.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`ref length ${u.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`topic length ${l.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`userEvent length ${f.length} exceeds maximum of 255`);if(p.length>255)throw new Error(`metadata length ${p.length} exceeds maximum of 255`);const y=this.USER_BROADCAST_PUSH_META_LENGTH+h.length+u.length+l.length+f.length+p.length,v=new ArrayBuffer(this.HEADER_LENGTH+y);let w=new DataView(v),k=0;w.setUint8(k++,this.KINDS.userBroadcastPush),w.setUint8(k++,h.length),w.setUint8(k++,u.length),w.setUint8(k++,l.length),w.setUint8(k++,f.length),w.setUint8(k++,p.length),w.setUint8(k++,r),Array.from(h,C=>w.setUint8(k++,C.charCodeAt(0))),Array.from(u,C=>w.setUint8(k++,C.charCodeAt(0))),Array.from(l,C=>w.setUint8(k++,C.charCodeAt(0))),Array.from(f,C=>w.setUint8(k++,C.charCodeAt(0))),Array.from(p,C=>w.setUint8(k++,C.charCodeAt(0)));var N=new Uint8Array(v.byteLength+i.byteLength);return N.set(new Uint8Array(v),0),N.set(new Uint8Array(i),v.byteLength),N.buffer}decode(e,r){if(this._isArrayBuffer(e)){let i=this._binaryDecode(e);return r(i)}if(typeof e=="string"){const i=JSON.parse(e),[o,c,l,u,h]=i;return r({join_ref:o,ref:c,topic:l,event:u,payload:h})}return r({})}_binaryDecode(e){const r=new DataView(e),i=r.getUint8(0),o=new TextDecoder;switch(i){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,r,o)}}_decodeUserBroadcast(e,r,i){const o=r.getUint8(1),c=r.getUint8(2),l=r.getUint8(3),u=r.getUint8(4);let h=this.HEADER_LENGTH+4;const f=i.decode(e.slice(h,h+o));h=h+o;const g=i.decode(e.slice(h,h+c));h=h+c;const p=i.decode(e.slice(h,h+l));h=h+l;const y=e.slice(h,e.byteLength),v=u===this.JSON_ENCODING?JSON.parse(i.decode(y)):y,w={type:this.BROADCAST_EVENT,event:g,payload:v};return l>0&&(w.meta=JSON.parse(p)),{join_ref:null,ref:null,topic:f,event:this.BROADCAST_EVENT,payload:w}}_isArrayBuffer(e){var r;return e instanceof ArrayBuffer||((r=e?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(e,r){return!e||typeof e!="object"?{}:Object.fromEntries(Object.entries(e).filter(([i])=>r.includes(i)))}}class fy{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var it;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(it||(it={}));const Xp=(t,e,r={})=>{var i;const o=(i=r.skipTypes)!==null&&i!==void 0?i:[];return e?Object.keys(e).reduce((c,l)=>(c[l]=cj(l,t,e,o),c),{}):{}},cj=(t,e,r,i)=>{const o=e.find(u=>u.name===t),c=o?.type,l=r[t];return c&&!i.includes(c)?py(c,l):_u(l)},py=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return mj(e,r)}switch(t){case it.bool:return dj(e);case it.float4:case it.float8:case it.int2:case it.int4:case it.int8:case it.numeric:case it.oid:return uj(e);case it.json:case it.jsonb:return hj(e);case it.timestamp:return fj(e);case it.abstime:case it.date:case it.daterange:case it.int4range:case it.int8range:case it.money:case it.reltime:case it.text:case it.time:case it.timestamptz:case it.timetz:case it.tsrange:case it.tstzrange:return _u(e);default:return _u(e)}},_u=t=>t,dj=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},uj=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},hj=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t},mj=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,i=t[r];if(t[0]==="{"&&i==="}"){let c;const l=t.slice(1,r);try{c=JSON.parse("["+l+"]")}catch{c=l?l.split(","):[]}return c.map(u=>py(e,u))}return t},fj=t=>typeof t=="string"?t.replace(" ","T"):t,gy=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class eu{constructor(e,r,i={},o=Nu){this.channel=e,this.event=r,this.payload=i,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var i;return this._hasReceived(e)&&r((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(i=>i.status===e).forEach(i=>i.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var eg;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(eg||(eg={}));class Aa{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const i=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},o=>{const{onJoin:c,onLeave:l,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Aa.syncState(this.state,o,c,l),this.pendingDiffs.forEach(h=>{this.state=Aa.syncDiff(this.state,h,c,l)}),this.pendingDiffs=[],u()}),this.channel._on(i.diff,{},o=>{const{onJoin:c,onLeave:l,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=Aa.syncDiff(this.state,o,c,l),u())}),this.onJoin((o,c,l)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:c,newPresences:l})}),this.onLeave((o,c,l)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:c,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,i,o){const c=this.cloneDeep(e),l=this.transformState(r),u={},h={};return this.map(c,(f,g)=>{l[f]||(h[f]=g)}),this.map(l,(f,g)=>{const p=c[f];if(p){const y=g.map(N=>N.presence_ref),v=p.map(N=>N.presence_ref),w=g.filter(N=>v.indexOf(N.presence_ref)<0),k=p.filter(N=>y.indexOf(N.presence_ref)<0);w.length>0&&(u[f]=w),k.length>0&&(h[f]=k)}else u[f]=g}),this.syncDiff(c,{joins:u,leaves:h},i,o)}static syncDiff(e,r,i,o){const{joins:c,leaves:l}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return i||(i=()=>{}),o||(o=()=>{}),this.map(c,(u,h)=>{var f;const g=(f=e[u])!==null&&f!==void 0?f:[];if(e[u]=this.cloneDeep(h),g.length>0){const p=e[u].map(v=>v.presence_ref),y=g.filter(v=>p.indexOf(v.presence_ref)<0);e[u].unshift(...y)}i(u,g,h)}),this.map(l,(u,h)=>{let f=e[u];if(!f)return;const g=h.map(p=>p.presence_ref);f=f.filter(p=>g.indexOf(p.presence_ref)<0),e[u]=f,o(u,f,h),f.length===0&&delete e[u]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(i=>r(i,e[i]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,i)=>{const o=e[i];return"metas"in o?r[i]=o.metas.map(c=>(c.presence_ref=c.phx_ref,delete c.phx_ref,delete c.phx_ref_prev,c)):r[i]=o,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var tg;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(tg||(tg={}));var Ia;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Ia||(Ia={}));var Nr;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Nr||(Nr={}));class yi{constructor(e,r={config:{}},i){var o,c;if(this.topic=e,this.params=r,this.socket=i,this.bindings={},this.state=It.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new eu(this,Ks.join,this.params,this.timeout),this.rejoinTimer=new fy(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=It.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(l=>l.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=It.closed,this.socket._remove(this)}),this._onError(l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=It.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=It.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=It.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ks.reply,{},(l,u)=>{this._trigger(this._replyEventName(u),l)}),this.presence=new Aa(this),this.broadcastEndpointURL=gy(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((c=(o=this.params.config)===null||o===void 0?void 0:o.broadcast)===null||c===void 0)&&c.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,r=this.timeout){var i,o,c;if(this.socket.isConnected()||this.socket.connect(),this.state==It.closed){const{config:{broadcast:l,presence:u,private:h}}=this.params,f=(o=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(v=>v.filter))!==null&&o!==void 0?o:[],g=!!this.bindings[Ia.PRESENCE]&&this.bindings[Ia.PRESENCE].length>0||((c=this.params.config.presence)===null||c===void 0?void 0:c.enabled)===!0,p={},y={broadcast:l,presence:Object.assign(Object.assign({},u),{enabled:g}),postgres_changes:f,private:h};this.socket.accessTokenValue&&(p.access_token=this.socket.accessTokenValue),this._onError(v=>e?.(Nr.CHANNEL_ERROR,v)),this._onClose(()=>e?.(Nr.CLOSED)),this.updateJoinPayload(Object.assign({config:y},p)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:v})=>{var w;if(this.socket._isManualToken()||this.socket.setAuth(),v===void 0){e?.(Nr.SUBSCRIBED);return}else{const k=this.bindings.postgres_changes,N=(w=k?.length)!==null&&w!==void 0?w:0,C=[];for(let A=0;A<N;A++){const E=k[A],{filter:{event:_,schema:R,table:L,filter:P}}=E,D=v&&v[A];if(D&&D.event===_&&yi.isFilterValueEqual(D.schema,R)&&yi.isFilterValueEqual(D.table,L)&&yi.isFilterValueEqual(D.filter,P))C.push(Object.assign(Object.assign({},E),{id:D.id}));else{this.unsubscribe(),this.state=It.errored,e?.(Nr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=C,e&&e(Nr.SUBSCRIBED);return}}).receive("error",v=>{this.state=It.errored,e?.(Nr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(v).join(", ")||"error")))}).receive("timeout",()=>{e?.(Nr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,i){return this.state===It.joined&&e===Ia.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,r,i)}async httpSend(e,r,i={}){var o;if(r==null)return Promise.reject("Payload is required for httpSend()");const c={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(c.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:c,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:r,private:this.private}]})},u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(o=i.timeout)!==null&&o!==void 0?o:this.timeout);if(u.status===202)return{success:!0};let h=u.statusText;try{const f=await u.json();h=f.error||f.message||h}catch{}return Promise.reject(new Error(h))}async send(e,r={}){var i,o;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:c,payload:l}=e,u={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(u.Authorization=`Bearer ${this.socket.accessTokenValue}`);const h={method:"POST",headers:u,body:JSON.stringify({messages:[{topic:this.subTopic,event:c,payload:l,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(i=r.timeout)!==null&&i!==void 0?i:this.timeout);return await((o=f.body)===null||o===void 0?void 0:o.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(c=>{var l,u,h;const f=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((h=(u=(l=this.params)===null||l===void 0?void 0:l.config)===null||u===void 0?void 0:u.broadcast)===null||h===void 0)&&h.ack)&&c("ok"),f.receive("ok",()=>c("ok")),f.receive("error",()=>c("error")),f.receive("timeout",()=>c("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=It.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ks.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(o=>{i=new eu(this,Ks.leave,{},e),i.receive("ok",()=>{r(),o("ok")}).receive("timeout",()=>{r(),o("timed out")}).receive("error",()=>{o("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=It.closed,this.bindings={}}async _fetchWithTimeout(e,r,i){const o=new AbortController,c=setTimeout(()=>o.abort(),i),l=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:o.signal}));return clearTimeout(c),l}_push(e,r,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new eu(this,e,r,i);return this._canPush()?o.send():this._addToPushBuffer(o),o}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>oj){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,i){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,i){var o,c;const l=e.toLocaleLowerCase(),{close:u,error:h,leave:f,join:g}=Ks;if(i&&[u,h,f,g].indexOf(l)>=0&&i!==this._joinRef())return;let y=this._onMessage(l,r,i);if(r&&!y)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(v=>{var w,k,N;return((w=v.filter)===null||w===void 0?void 0:w.event)==="*"||((N=(k=v.filter)===null||k===void 0?void 0:k.event)===null||N===void 0?void 0:N.toLocaleLowerCase())===l}).map(v=>v.callback(y,i)):(c=this.bindings[l])===null||c===void 0||c.filter(v=>{var w,k,N,C,A,E;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in v){const _=v.id,R=(w=v.filter)===null||w===void 0?void 0:w.event;return _&&((k=r.ids)===null||k===void 0?void 0:k.includes(_))&&(R==="*"||R?.toLocaleLowerCase()===((N=r.data)===null||N===void 0?void 0:N.type.toLocaleLowerCase()))}else{const _=(A=(C=v?.filter)===null||C===void 0?void 0:C.event)===null||A===void 0?void 0:A.toLocaleLowerCase();return _==="*"||_===((E=r?.event)===null||E===void 0?void 0:E.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===l}).map(v=>{if(typeof y=="object"&&"ids"in y){const w=y.data,{schema:k,table:N,commit_timestamp:C,type:A,errors:E}=w;y=Object.assign(Object.assign({},{schema:k,table:N,commit_timestamp:C,eventType:A,new:{},old:{},errors:E}),this._getPayloadRecords(w))}v.callback(y,i)})}_isClosed(){return this.state===It.closed}_isJoined(){return this.state===It.joined}_isJoining(){return this.state===It.joining}_isLeaving(){return this.state===It.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,i){const o=e.toLocaleLowerCase(),c={type:o,filter:r,callback:i};return this.bindings[o]?this.bindings[o].push(c):this.bindings[o]=[c],this}_off(e,r){const i=e.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(o=>{var c;return!(((c=o.type)===null||c===void 0?void 0:c.toLocaleLowerCase())===i&&yi.isEqual(o.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const i in e)if(e[i]!==r[i])return!1;return!0}static isFilterValueEqual(e,r){return(e??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Ks.close,{},e)}_onError(e){this._on(Ks.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=It.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Xp(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Xp(e.columns,e.old_record)),r}}const tu=()=>{},yl={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},pj=[1e3,2e3,5e3,1e4],gj=1e4,xj=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class yj{constructor(e,r){var i;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Nu,this.transport=null,this.heartbeatIntervalMs=yl.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=tu,this.ref=0,this.reconnectTimer=null,this.vsn=Zp,this.logger=tu,this.conn=null,this.sendBuffer=[],this.serializer=new lj,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=o=>o?(...c)=>o(...c):(...c)=>fetch(...c),!(!((i=r?.params)===null||i===void 0)&&i.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${ku.websocket}`,this.httpEndpoint=gy(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=sj.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const i=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(i),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return r==="ok"&&this._remove(e),this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,i){this.logger(e,r,i)}connectionState(){switch(this.conn&&this.conn.readyState){case en.connecting:return En.Connecting;case en.open:return En.Open;case en.closing:return En.Closing;default:return En.Closed}}isConnected(){return this.connectionState()===En.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const i=`realtime:${e}`,o=this.getChannels().find(c=>c.topic===i);if(o)return o;{const c=new yi(`realtime:${e}`,r,this);return this.channels.push(c),c}}push(e){const{topic:r,event:i,payload:o,ref:c}=e,l=()=>{this.encode(e,u=>{var h;(h=this.conn)===null||h===void 0||h.send(u)})};this.log("push",`${r} ${i} (${c})`,o),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(aj,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},yl.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(i=>i.topic===e&&(i._isJoined()||i._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const f=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",f)}catch(g){this.log("error","error in heartbeat callback",g)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:i,event:o,payload:c,ref:l}=r,u=l?`(${l})`:"",h=c.status||"";this.log("receive",`${h} ${i} ${o} ${u}`.trim(),c),this.channels.filter(f=>f._isMember(i)).forEach(f=>f._trigger(o,c,l)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===en.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===en.open||this.conn.readyState===en.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e);try{this.heartbeatCallback("error")}catch(r){this.log("error","error in heartbeat callback",r)}}_triggerChanError(){this.channels.forEach(e=>e._trigger(Ks.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const i=e.match(/\?/)?"&":"?",o=new URLSearchParams(r);return`${e}${i}${o}`}_workerObjectUrl(e){let r;if(e)r=e;else{const i=new Blob([xj],{type:"application/javascript"});r=URL.createObjectURL(i)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r,i=!1;if(e)r=e,i=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(o){this.log("error","Error fetching access token from callback",o),r=this.accessTokenValue}else r=this.accessTokenValue;i?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(o=>{const c={access_token:r,version:nj};r&&o.updateJoinPayload(c),o.joinedOnce&&o._isJoined()&&o._push(Ks.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(i=>{try{i(r)}catch(o){this.log("error",`error in ${e} callback`,o)}})}catch(i){this.log("error",`error triggering ${e} callbacks`,i)}}_setupReconnectionTimer(){this.reconnectTimer=new fy(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},yl.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,i,o,c,l,u,h,f,g,p,y,v;switch(this.transport=(r=e?.transport)!==null&&r!==void 0?r:null,this.timeout=(i=e?.timeout)!==null&&i!==void 0?i:Nu,this.heartbeatIntervalMs=(o=e?.heartbeatIntervalMs)!==null&&o!==void 0?o:yl.HEARTBEAT_INTERVAL,this.worker=(c=e?.worker)!==null&&c!==void 0?c:!1,this.accessToken=(l=e?.accessToken)!==null&&l!==void 0?l:null,this.heartbeatCallback=(u=e?.heartbeatCallback)!==null&&u!==void 0?u:tu,this.vsn=(h=e?.vsn)!==null&&h!==void 0?h:Zp,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(f=e?.reconnectAfterMs)!==null&&f!==void 0?f:(w=>pj[w-1]||gj),this.vsn){case ij:this.encode=(g=e?.encode)!==null&&g!==void 0?g:((w,k)=>k(JSON.stringify(w))),this.decode=(p=e?.decode)!==null&&p!==void 0?p:((w,k)=>k(JSON.parse(w)));break;case my:this.encode=(y=e?.encode)!==null&&y!==void 0?y:this.serializer.encode.bind(this.serializer),this.decode=(v=e?.decode)!==null&&v!==void 0?v:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}var Ba=class extends Error{constructor(t,e){super(t),this.name="IcebergError",this.status=e.status,this.icebergType=e.icebergType,this.icebergCode=e.icebergCode,this.details=e.details,this.isCommitStateUnknown=e.icebergType==="CommitStateUnknownException"||[500,502,504].includes(e.status)&&e.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function bj(t,e,r){const i=new URL(e,t);if(r)for(const[o,c]of Object.entries(r))c!==void 0&&i.searchParams.set(o,c);return i.toString()}async function vj(t){return!t||t.type==="none"?{}:t.type==="bearer"?{Authorization:`Bearer ${t.token}`}:t.type==="header"?{[t.name]:t.value}:t.type==="custom"?await t.getHeaders():{}}function wj(t){const e=t.fetchImpl??globalThis.fetch;return{async request({method:r,path:i,query:o,body:c,headers:l}){const u=bj(t.baseUrl,i,o),h=await vj(t.auth),f=await e(u,{method:r,headers:{...c?{"Content-Type":"application/json"}:{},...h,...l},body:c?JSON.stringify(c):void 0}),g=await f.text(),p=(f.headers.get("content-type")||"").includes("application/json"),y=p&&g?JSON.parse(g):g;if(!f.ok){const v=p?y:void 0,w=v?.error;throw new Ba(w?.message??`Request failed with status ${f.status}`,{status:f.status,icebergType:w?.type,icebergCode:w?.code,details:v})}return{status:f.status,headers:f.headers,data:y}}}}function bl(t){return t.join("")}var jj=class{constructor(t,e=""){this.client=t,this.prefix=e}async listNamespaces(t){const e=t?{parent:bl(t.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:e})).data.namespaces.map(i=>({namespace:i}))}async createNamespace(t,e){const r={namespace:t.namespace,properties:e?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${bl(t.namespace)}`})}async loadNamespaceMetadata(t){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${bl(t.namespace)}`})).data.properties}}async namespaceExists(t){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${bl(t.namespace)}`}),!0}catch(e){if(e instanceof Ba&&e.status===404)return!1;throw e}}async createNamespaceIfNotExists(t,e){try{return await this.createNamespace(t,e)}catch(r){if(r instanceof Ba&&r.status===409)return;throw r}}};function ai(t){return t.join("")}var Nj=class{constructor(t,e="",r){this.client=t,this.prefix=e,this.accessDelegation=r}async listTables(t){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ai(t.namespace)}/tables`})).data.identifiers}async createTable(t,e){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ai(t.namespace)}/tables`,body:e,headers:r})).data.metadata}async updateTable(t,e){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${ai(t.namespace)}/tables/${t.name}`,body:e});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(t,e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${ai(t.namespace)}/tables/${t.name}`,query:{purgeRequested:String(e?.purge??!1)}})}async loadTable(t){const e={};return this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ai(t.namespace)}/tables/${t.name}`,headers:e})).data.metadata}async tableExists(t){const e={};this.accessDelegation&&(e["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${ai(t.namespace)}/tables/${t.name}`,headers:e}),!0}catch(r){if(r instanceof Ba&&r.status===404)return!1;throw r}}async createTableIfNotExists(t,e){try{return await this.createTable(t,e)}catch(r){if(r instanceof Ba&&r.status===409)return await this.loadTable({namespace:t.namespace,name:e.name});throw r}}},kj=class{constructor(t){let e="v1";t.catalogName&&(e+=`/${t.catalogName}`);const r=t.baseUrl.endsWith("/")?t.baseUrl:`${t.baseUrl}/`;this.client=wj({baseUrl:r,auth:t.auth,fetchImpl:t.fetch}),this.accessDelegation=t.accessDelegation?.join(","),this.namespaceOps=new jj(this.client,e),this.tableOps=new Nj(this.client,e,this.accessDelegation)}async listNamespaces(t){return this.namespaceOps.listNamespaces(t)}async createNamespace(t,e){return this.namespaceOps.createNamespace(t,e)}async dropNamespace(t){await this.namespaceOps.dropNamespace(t)}async loadNamespaceMetadata(t){return this.namespaceOps.loadNamespaceMetadata(t)}async listTables(t){return this.tableOps.listTables(t)}async createTable(t,e){return this.tableOps.createTable(t,e)}async updateTable(t,e){return this.tableOps.updateTable(t,e)}async dropTable(t,e){await this.tableOps.dropTable(t,e)}async loadTable(t){return this.tableOps.loadTable(t)}async namespaceExists(t){return this.namespaceOps.namespaceExists(t)}async tableExists(t){return this.tableOps.tableExists(t)}async createNamespaceIfNotExists(t,e){return this.namespaceOps.createNamespaceIfNotExists(t,e)}async createTableIfNotExists(t,e){return this.tableOps.createTableIfNotExists(t,e)}},Ql=class extends Error{constructor(t,e="storage",r,i){super(t),this.__isStorageError=!0,this.namespace=e,this.name=e==="vectors"?"StorageVectorsError":"StorageError",this.status=r,this.statusCode=i}};function Zl(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}var vl=class extends Ql{constructor(t,e,r,i="storage"){super(t,i,e,r),this.name=i==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=e,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},xy=class extends Ql{constructor(t,e,r="storage"){super(t,r),this.name=r==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=e}};const _j=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),Sj=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},Su=t=>{if(Array.isArray(t))return t.map(r=>Su(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,i])=>{const o=r.replace(/([-_][a-z])/gi,c=>c.toUpperCase().replace(/[-_]/g,""));e[o]=Su(i)}),e},Cj=t=>!t||typeof t!="string"||t.length===0||t.length>100||t.trim()!==t||t.includes("/")||t.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(t);function Wa(t){"@babel/helpers - typeof";return Wa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wa(t)}function Tj(t,e){if(Wa(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(Wa(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ej(t){var e=Tj(t,"string");return Wa(e)=="symbol"?e:e+""}function Pj(t,e,r){return(e=Ej(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sg(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,i)}return r}function Ve(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?sg(Object(r),!0).forEach(function(i){Pj(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):sg(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}const rg=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},Aj=async(t,e,r,i)=>{if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!r?.noResolveJson){const o=t,c=o.status||500;if(typeof o.json=="function")o.json().then(l=>{const u=l?.statusCode||l?.code||c+"";e(new vl(rg(l),c,u,i))}).catch(()=>{if(i==="vectors"){const l=c+"";e(new vl(o.statusText||`HTTP ${c} error`,c,l,i))}else{const l=c+"";e(new vl(o.statusText||`HTTP ${c} error`,c,l,i))}});else{const l=c+"";e(new vl(o.statusText||`HTTP ${c} error`,c,l,i))}}else e(new xy(rg(t),t,i))},Ij=(t,e,r,i)=>{const o={method:t,headers:e?.headers||{}};return t==="GET"||t==="HEAD"||!i?Ve(Ve({},o),r):(Sj(i)?(o.headers=Ve({"Content-Type":"application/json"},e?.headers),o.body=JSON.stringify(i)):o.body=i,e?.duplex&&(o.duplex=e.duplex),Ve(Ve({},o),r))};async function wa(t,e,r,i,o,c,l){return new Promise((u,h)=>{t(r,Ij(e,i,o,c)).then(f=>{if(!f.ok)throw f;if(i?.noResolveJson)return f;if(l==="vectors"){const g=f.headers.get("content-type");if(f.headers.get("content-length")==="0"||f.status===204)return{};if(!g||!g.includes("application/json"))return{}}return f.json()}).then(f=>u(f)).catch(f=>Aj(f,h,i,l))})}function yy(t="storage"){return{get:async(e,r,i,o)=>wa(e,"GET",r,i,o,void 0,t),post:async(e,r,i,o,c)=>wa(e,"POST",r,o,c,i,t),put:async(e,r,i,o,c)=>wa(e,"PUT",r,o,c,i,t),head:async(e,r,i,o)=>wa(e,"HEAD",r,Ve(Ve({},i),{},{noResolveJson:!0}),o,void 0,t),remove:async(e,r,i,o,c)=>wa(e,"DELETE",r,o,c,i,t)}}const Lj=yy("storage"),{get:Va,post:Gs,put:Cu,head:Rj,remove:rh}=Lj,gs=yy("vectors");var Li=class{constructor(t,e={},r,i="storage"){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.fetch=_j(r),this.namespace=i}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(t){var e=this;try{return{data:await t(),error:null}}catch(r){if(e.shouldThrowOnError)throw r;if(Zl(r))return{data:null,error:r};throw r}}},Dj=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}async execute(){var t=this;try{return{data:(await t.downloadFn()).body,error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(Zl(e))return{data:null,error:e};throw e}}};let by;by=Symbol.toStringTag;var Fj=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[by]="BlobDownloadBuilder",this.promise=null}asStream(){return new Dj(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var t=this;try{return{data:await(await t.downloadFn()).blob(),error:null}}catch(e){if(t.shouldThrowOnError)throw e;if(Zl(e))return{data:null,error:e};throw e}}};const Mj={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ng={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Oj=class extends Li{constructor(t,e={},r,i){super(t,e,i,"storage"),this.bucketId=r}async uploadOrUpdate(t,e,r,i){var o=this;return o.handleOperation(async()=>{let c;const l=Ve(Ve({},ng),i);let u=Ve(Ve({},o.headers),t==="POST"&&{"x-upsert":String(l.upsert)});const h=l.metadata;typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",l.cacheControl),h&&c.append("metadata",o.encodeMetadata(h)),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.has("cacheControl")||c.append("cacheControl",l.cacheControl),h&&!c.has("metadata")&&c.append("metadata",o.encodeMetadata(h))):(c=r,u["cache-control"]=`max-age=${l.cacheControl}`,u["content-type"]=l.contentType,h&&(u["x-metadata"]=o.toBase64(o.encodeMetadata(h))),(typeof ReadableStream<"u"&&c instanceof ReadableStream||c&&typeof c=="object"&&"pipe"in c&&typeof c.pipe=="function")&&!l.duplex&&(l.duplex="half")),i?.headers&&(u=Ve(Ve({},u),i.headers));const f=o._removeEmptyFolders(e),g=o._getFinalPath(f),p=await(t=="PUT"?Cu:Gs)(o.fetch,`${o.url}/object/${g}`,c,Ve({headers:u},l?.duplex?{duplex:l.duplex}:{}));return{path:f,id:p.Id,fullPath:p.Key}})}async upload(t,e,r){return this.uploadOrUpdate("POST",t,e,r)}async uploadToSignedUrl(t,e,r,i){var o=this;const c=o._removeEmptyFolders(t),l=o._getFinalPath(c),u=new URL(o.url+`/object/upload/sign/${l}`);return u.searchParams.set("token",e),o.handleOperation(async()=>{let h;const f=Ve({upsert:ng.upsert},i),g=Ve(Ve({},o.headers),{"x-upsert":String(f.upsert)});return typeof Blob<"u"&&r instanceof Blob?(h=new FormData,h.append("cacheControl",f.cacheControl),h.append("",r)):typeof FormData<"u"&&r instanceof FormData?(h=r,h.append("cacheControl",f.cacheControl)):(h=r,g["cache-control"]=`max-age=${f.cacheControl}`,g["content-type"]=f.contentType),{path:c,fullPath:(await Cu(o.fetch,u.toString(),h,{headers:g})).Key}})}async createSignedUploadUrl(t,e){var r=this;return r.handleOperation(async()=>{let i=r._getFinalPath(t);const o=Ve({},r.headers);e?.upsert&&(o["x-upsert"]="true");const c=await Gs(r.fetch,`${r.url}/object/upload/sign/${i}`,{},{headers:o}),l=new URL(r.url+c.url),u=l.searchParams.get("token");if(!u)throw new Ql("No token returned by API");return{signedUrl:l.toString(),path:t,token:u}})}async update(t,e,r){return this.uploadOrUpdate("PUT",t,e,r)}async move(t,e,r){var i=this;return i.handleOperation(async()=>await Gs(i.fetch,`${i.url}/object/move`,{bucketId:i.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r?.destinationBucket},{headers:i.headers}))}async copy(t,e,r){var i=this;return i.handleOperation(async()=>({path:(await Gs(i.fetch,`${i.url}/object/copy`,{bucketId:i.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r?.destinationBucket},{headers:i.headers})).Key}))}async createSignedUrl(t,e,r){var i=this;return i.handleOperation(async()=>{let o=i._getFinalPath(t),c=await Gs(i.fetch,`${i.url}/object/sign/${o}`,Ve({expiresIn:e},r?.transform?{transform:r.transform}:{}),{headers:i.headers});const l=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{signedUrl:encodeURI(`${i.url}${c.signedURL}${l}`)}})}async createSignedUrls(t,e,r){var i=this;return i.handleOperation(async()=>{const o=await Gs(i.fetch,`${i.url}/object/sign/${i.bucketId}`,{expiresIn:e,paths:t},{headers:i.headers}),c=r?.download?`&download=${r.download===!0?"":r.download}`:"";return o.map(l=>Ve(Ve({},l),{},{signedUrl:l.signedURL?encodeURI(`${i.url}${l.signedURL}${c}`):null}))})}download(t,e,r){const i=typeof e?.transform<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString(e?.transform||{}),c=o?`?${o}`:"",l=this._getFinalPath(t),u=()=>Va(this.fetch,`${this.url}/${i}/${l}${c}`,{headers:this.headers,noResolveJson:!0},r);return new Fj(u,this.shouldThrowOnError)}async info(t){var e=this;const r=e._getFinalPath(t);return e.handleOperation(async()=>Su(await Va(e.fetch,`${e.url}/object/info/${r}`,{headers:e.headers})))}async exists(t){var e=this;const r=e._getFinalPath(t);try{return await Rj(e.fetch,`${e.url}/object/${r}`,{headers:e.headers}),{data:!0,error:null}}catch(i){if(e.shouldThrowOnError)throw i;if(Zl(i)&&i instanceof xy){const o=i.originalError;if([400,404].includes(o?.status))return{data:!1,error:i}}throw i}}getPublicUrl(t,e){const r=this._getFinalPath(t),i=[],o=e?.download?`download=${e.download===!0?"":e.download}`:"";o!==""&&i.push(o);const c=typeof e?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(e?.transform||{});l!==""&&i.push(l);let u=i.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${r}${u}`)}}}async remove(t){var e=this;return e.handleOperation(async()=>await rh(e.fetch,`${e.url}/object/${e.bucketId}`,{prefixes:t},{headers:e.headers}))}async list(t,e,r){var i=this;return i.handleOperation(async()=>{const o=Ve(Ve(Ve({},Mj),e),{},{prefix:t||""});return await Gs(i.fetch,`${i.url}/object/list/${i.bucketId}`,o,{headers:i.headers},r)})}async listV2(t,e){var r=this;return r.handleOperation(async()=>{const i=Ve({},t);return await Gs(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,i,{headers:r.headers},e)})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};const Uj="2.95.3",eo={"X-Client-Info":`storage-js/${Uj}`};var $j=class extends Li{constructor(t,e={},r,i){const o=new URL(t);i?.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase."));const c=o.href.replace(/\/$/,""),l=Ve(Ve({},eo),e);super(c,l,r,"storage")}async listBuckets(t){var e=this;return e.handleOperation(async()=>{const r=e.listBucketOptionsToQueryString(t);return await Va(e.fetch,`${e.url}/bucket${r}`,{headers:e.headers})})}async getBucket(t){var e=this;return e.handleOperation(async()=>await Va(e.fetch,`${e.url}/bucket/${t}`,{headers:e.headers}))}async createBucket(t,e={public:!1}){var r=this;return r.handleOperation(async()=>await Gs(r.fetch,`${r.url}/bucket`,{id:t,name:t,type:e.type,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:r.headers}))}async updateBucket(t,e){var r=this;return r.handleOperation(async()=>await Cu(r.fetch,`${r.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:r.headers}))}async emptyBucket(t){var e=this;return e.handleOperation(async()=>await Gs(e.fetch,`${e.url}/bucket/${t}/empty`,{},{headers:e.headers}))}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await rh(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}))}listBucketOptionsToQueryString(t){const e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}},Bj=class extends Li{constructor(t,e={},r){const i=t.replace(/\/$/,""),o=Ve(Ve({},eo),e);super(i,o,r,"storage")}async createBucket(t){var e=this;return e.handleOperation(async()=>await Gs(e.fetch,`${e.url}/bucket`,{name:t},{headers:e.headers}))}async listBuckets(t){var e=this;return e.handleOperation(async()=>{const r=new URLSearchParams;t?.limit!==void 0&&r.set("limit",t.limit.toString()),t?.offset!==void 0&&r.set("offset",t.offset.toString()),t?.sortColumn&&r.set("sortColumn",t.sortColumn),t?.sortOrder&&r.set("sortOrder",t.sortOrder),t?.search&&r.set("search",t.search);const i=r.toString(),o=i?`${e.url}/bucket?${i}`:`${e.url}/bucket`;return await Va(e.fetch,o,{headers:e.headers})})}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await rh(e.fetch,`${e.url}/bucket/${t}`,{},{headers:e.headers}))}from(t){var e=this;if(!Cj(t))throw new Ql("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new kj({baseUrl:this.url,catalogName:t,auth:{type:"custom",getHeaders:async()=>e.headers},fetch:this.fetch}),i=this.shouldThrowOnError;return new Proxy(r,{get(o,c){const l=o[c];return typeof l!="function"?l:async(...u)=>{try{return{data:await l.apply(o,u),error:null}}catch(h){if(i)throw h;return{data:null,error:h}}}}})}},Wj=class extends Li{constructor(t,e={},r){const i=t.replace(/\/$/,""),o=Ve(Ve({},eo),{},{"Content-Type":"application/json"},e);super(i,o,r,"vectors")}async createIndex(t){var e=this;return e.handleOperation(async()=>await gs.post(e.fetch,`${e.url}/CreateIndex`,t,{headers:e.headers})||{})}async getIndex(t,e){var r=this;return r.handleOperation(async()=>await gs.post(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:r.headers}))}async listIndexes(t){var e=this;return e.handleOperation(async()=>await gs.post(e.fetch,`${e.url}/ListIndexes`,t,{headers:e.headers}))}async deleteIndex(t,e){var r=this;return r.handleOperation(async()=>await gs.post(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:r.headers})||{})}},Vj=class extends Li{constructor(t,e={},r){const i=t.replace(/\/$/,""),o=Ve(Ve({},eo),{},{"Content-Type":"application/json"},e);super(i,o,r,"vectors")}async putVectors(t){var e=this;if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return e.handleOperation(async()=>await gs.post(e.fetch,`${e.url}/PutVectors`,t,{headers:e.headers})||{})}async getVectors(t){var e=this;return e.handleOperation(async()=>await gs.post(e.fetch,`${e.url}/GetVectors`,t,{headers:e.headers}))}async listVectors(t){var e=this;if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return e.handleOperation(async()=>await gs.post(e.fetch,`${e.url}/ListVectors`,t,{headers:e.headers}))}async queryVectors(t){var e=this;return e.handleOperation(async()=>await gs.post(e.fetch,`${e.url}/QueryVectors`,t,{headers:e.headers}))}async deleteVectors(t){var e=this;if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return e.handleOperation(async()=>await gs.post(e.fetch,`${e.url}/DeleteVectors`,t,{headers:e.headers})||{})}},zj=class extends Li{constructor(t,e={},r){const i=t.replace(/\/$/,""),o=Ve(Ve({},eo),{},{"Content-Type":"application/json"},e);super(i,o,r,"vectors")}async createBucket(t){var e=this;return e.handleOperation(async()=>await gs.post(e.fetch,`${e.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{})}async getBucket(t){var e=this;return e.handleOperation(async()=>await gs.post(e.fetch,`${e.url}/GetVectorBucket`,{vectorBucketName:t},{headers:e.headers}))}async listBuckets(t={}){var e=this;return e.handleOperation(async()=>await gs.post(e.fetch,`${e.url}/ListVectorBuckets`,t,{headers:e.headers}))}async deleteBucket(t){var e=this;return e.handleOperation(async()=>await gs.post(e.fetch,`${e.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:e.headers})||{})}},qj=class extends zj{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new Hj(this.url,this.headers,t,this.fetch)}async createBucket(t){var e=()=>super.createBucket,r=this;return e().call(r,t)}async getBucket(t){var e=()=>super.getBucket,r=this;return e().call(r,t)}async listBuckets(t={}){var e=()=>super.listBuckets,r=this;return e().call(r,t)}async deleteBucket(t){var e=()=>super.deleteBucket,r=this;return e().call(r,t)}},Hj=class extends Wj{constructor(t,e,r,i){super(t,e,i),this.vectorBucketName=r}async createIndex(t){var e=()=>super.createIndex,r=this;return e().call(r,Ve(Ve({},t),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(t={}){var e=()=>super.listIndexes,r=this;return e().call(r,Ve(Ve({},t),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(t){var e=()=>super.getIndex,r=this;return e().call(r,r.vectorBucketName,t)}async deleteIndex(t){var e=()=>super.deleteIndex,r=this;return e().call(r,r.vectorBucketName,t)}index(t){return new Gj(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},Gj=class extends Vj{constructor(t,e,r,i,o){super(t,e,o),this.vectorBucketName=r,this.indexName=i}async putVectors(t){var e=()=>super.putVectors,r=this;return e().call(r,Ve(Ve({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(t){var e=()=>super.getVectors,r=this;return e().call(r,Ve(Ve({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(t={}){var e=()=>super.listVectors,r=this;return e().call(r,Ve(Ve({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(t){var e=()=>super.queryVectors,r=this;return e().call(r,Ve(Ve({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(t){var e=()=>super.deleteVectors,r=this;return e().call(r,Ve(Ve({},t),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},Kj=class extends $j{constructor(t,e={},r,i){super(t,e,r,i)}from(t){return new Oj(this.url,this.headers,t,this.fetch)}get vectors(){return new qj(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Bj(this.url+"/iceberg",this.headers,this.fetch)}};const vy="2.95.3",pi=30*1e3,Tu=3,su=Tu*pi,Yj="http://localhost:9999",Jj="supabase.auth.token",Qj={"X-Client-Info":`gotrue-js/${vy}`},Eu="X-Supabase-Api-Version",wy={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Zj=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Xj=600*1e3;class za extends Error{constructor(e,r,i){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=i}}function Pe(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class eN extends za{constructor(e,r,i){super(e,r,i),this.name="AuthApiError",this.status=r,this.code=i}}function tN(t){return Pe(t)&&t.name==="AuthApiError"}class Pn extends za{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class Pr extends za{constructor(e,r,i,o){super(e,i,o),this.name=r,this.status=i}}class ps extends Pr{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function ru(t){return Pe(t)&&t.name==="AuthSessionMissingError"}class oi extends Pr{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class wl extends Pr{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class jl extends Pr{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function sN(t){return Pe(t)&&t.name==="AuthImplicitGrantRedirectError"}class ig extends Pr{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class rN extends Pr{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Pu extends Pr{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function nu(t){return Pe(t)&&t.name==="AuthRetryableFetchError"}class ag extends Pr{constructor(e,r,i){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=i}}class Au extends Pr{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const $l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),og=` 	
\r=`.split(""),nN=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<og.length;e+=1)t[og[e].charCodeAt(0)]=-2;for(let e=0;e<$l.length;e+=1)t[$l[e].charCodeAt(0)]=e;return t})();function lg(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;r($l[i]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const i=e.queue>>e.queuedBits-6&63;r($l[i]),e.queuedBits-=6}}function jy(t,e,r){const i=nN[t];if(i>-1)for(e.queue=e.queue<<6|i,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function cg(t){const e=[],r=l=>{e.push(String.fromCodePoint(l))},i={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},c=l=>{oN(l,i,r)};for(let l=0;l<t.length;l+=1)jy(t.charCodeAt(l),o,c);return e.join("")}function iN(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function aN(t,e){for(let r=0;r<t.length;r+=1){let i=t.charCodeAt(r);if(i>55295&&i<=56319){const o=(i-55296)*1024&65535;i=(t.charCodeAt(r+1)-56320&65535|o)+65536,r+=1}iN(i,e)}}function oN(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let i=1;i<6;i+=1)if((t>>7-i&1)===0){e.utf8seq=i;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function _i(t){const e=[],r={queue:0,queuedBits:0},i=o=>{e.push(o)};for(let o=0;o<t.length;o+=1)jy(t.charCodeAt(o),r,i);return new Uint8Array(e)}function lN(t){const e=[];return aN(t,r=>e.push(r)),new Uint8Array(e)}function In(t){const e=[],r={queue:0,queuedBits:0},i=o=>{e.push(o)};return t.forEach(o=>lg(o,r,i)),lg(null,r,i),e.join("")}function cN(t){return Math.round(Date.now()/1e3)+t}function dN(){return Symbol("auth-callback")}const Wt=()=>typeof window<"u"&&typeof document<"u",Nn={tested:!1,writable:!1},Ny=()=>{if(!Wt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Nn.tested)return Nn.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Nn.tested=!0,Nn.writable=!0}catch{Nn.tested=!0,Nn.writable=!1}return Nn.writable};function uN(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((o,c)=>{e[c]=o})}catch{}return r.searchParams.forEach((i,o)=>{e[o]=i}),e}const ky=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),hN=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",gi=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},kn=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Bt=async(t,e)=>{await t.removeItem(e)};class Xl{constructor(){this.promise=new Xl.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}Xl.promiseConstructor=Promise;function Nl(t){const e=t.split(".");if(e.length!==3)throw new Au("Invalid JWT structure");for(let i=0;i<e.length;i++)if(!Zj.test(e[i]))throw new Au("JWT not in base64url format");return{header:JSON.parse(cg(e[0])),payload:JSON.parse(cg(e[1])),signature:_i(e[2]),raw:{header:e[0],payload:e[1]}}}async function mN(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function fN(t,e){return new Promise((i,o)=>{(async()=>{for(let c=0;c<1/0;c++)try{const l=await t(c);if(!e(c,null,l)){i(l);return}}catch(l){if(!e(c,l)){o(l);return}}})()})}function pN(t){return("0"+t.toString(16)).substr(-2)}function gN(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=r.length;let o="";for(let c=0;c<56;c++)o+=r.charAt(Math.floor(Math.random()*i));return o}return crypto.getRandomValues(e),Array.from(e,pN).join("")}async function xN(t){const r=new TextEncoder().encode(t),i=await crypto.subtle.digest("SHA-256",r),o=new Uint8Array(i);return Array.from(o).map(c=>String.fromCharCode(c)).join("")}async function yN(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await xN(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function li(t,e,r=!1){const i=gN();let o=i;r&&(o+="/PASSWORD_RECOVERY"),await gi(t,`${e}-code-verifier`,o);const c=await yN(i);return[c,i===c?"plain":"s256"]}const bN=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function vN(t){const e=t.headers.get(Eu);if(!e||!e.match(bN))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function wN(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function jN(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const NN=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ci(t){if(!NN.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function iu(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const i=r.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function kN(t,e){return new Proxy(t,{get:(r,i,o)=>{if(i==="__isInsecureUserWarningProxy")return!0;if(typeof i=="symbol"){const c=i.toString();if(c==="Symbol(Symbol.toPrimitive)"||c==="Symbol(Symbol.toStringTag)"||c==="Symbol(util.inspect.custom)"||c==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,i,o)}return!e.value&&typeof i=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(r,i,o)}})}function dg(t){return JSON.parse(JSON.stringify(t))}const Sn=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),_N=[502,503,504];async function ug(t){var e;if(!hN(t))throw new Pu(Sn(t),0);if(_N.includes(t.status))throw new Pu(Sn(t),t.status);let r;try{r=await t.json()}catch(c){throw new Pn(Sn(c),c)}let i;const o=vN(t);if(o&&o.getTime()>=wy["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?i=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(i=r.error_code),i){if(i==="weak_password")throw new ag(Sn(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(i==="session_not_found")throw new ps}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((c,l)=>c&&typeof l=="string",!0))throw new ag(Sn(r),t.status,r.weak_password.reasons);throw new eN(Sn(r),t.status||500,i)}const SN=(t,e,r,i)=>{const o={method:t,headers:e?.headers||{}};return t==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),o.body=JSON.stringify(i),Object.assign(Object.assign({},o),r))};async function Be(t,e,r,i){var o;const c=Object.assign({},i?.headers);c[Eu]||(c[Eu]=wy["2024-01-01"].name),i?.jwt&&(c.Authorization=`Bearer ${i.jwt}`);const l=(o=i?.query)!==null&&o!==void 0?o:{};i?.redirectTo&&(l.redirect_to=i.redirectTo);const u=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",h=await CN(t,e,r+u,{headers:c,noResolveJson:i?.noResolveJson},{},i?.body);return i?.xform?i?.xform(h):{data:Object.assign({},h),error:null}}async function CN(t,e,r,i,o,c){const l=SN(e,i,o,c);let u;try{u=await t(r,Object.assign({},l))}catch(h){throw console.error(h),new Pu(Sn(h),0)}if(u.ok||await ug(u),i?.noResolveJson)return u;try{return await u.json()}catch(h){await ug(h)}}function qs(t){var e;let r=null;PN(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=cN(t.expires_in)));const i=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:i},error:null}}function hg(t){const e=qs(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,i)=>r&&typeof i=="string",!0)&&(e.data.weak_password=t.weak_password),e}function tn(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function TN(t){return{data:t,error:null}}function EN(t){const{action_link:e,email_otp:r,hashed_token:i,redirect_to:o,verification_type:c}=t,l=Jl(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:e,email_otp:r,hashed_token:i,redirect_to:o,verification_type:c},h=Object.assign({},l);return{data:{properties:u,user:h},error:null}}function mg(t){return t}function PN(t){return t.access_token&&t.refresh_token&&t.expires_in}const au=["global","local","others"];class AN{constructor({url:e="",headers:r={},fetch:i}){this.url=e,this.headers=r,this.fetch=ky(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,r=au[0]){if(au.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${au.join(", ")}`);try{return await Be(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(i){if(Pe(i))return{data:null,error:i};throw i}}async inviteUserByEmail(e,r={}){try{return await Be(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:tn})}catch(i){if(Pe(i))return{data:{user:null},error:i};throw i}}async generateLink(e){try{const{options:r}=e,i=Jl(e,["options"]),o=Object.assign(Object.assign({},i),r);return"newEmail"in i&&(o.new_email=i?.newEmail,delete o.newEmail),await Be(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:EN,redirectTo:r?.redirectTo})}catch(r){if(Pe(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await Be(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:tn})}catch(r){if(Pe(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,i,o,c,l,u,h;try{const f={nextPage:null,lastPage:0,total:0},g=await Be(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:"",per_page:(c=(o=e?.perPage)===null||o===void 0?void 0:o.toString())!==null&&c!==void 0?c:""},xform:mg});if(g.error)throw g.error;const p=await g.json(),y=(l=g.headers.get("x-total-count"))!==null&&l!==void 0?l:0,v=(h=(u=g.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&h!==void 0?h:[];return v.length>0&&(v.forEach(w=>{const k=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),N=JSON.parse(w.split(";")[1].split("=")[1]);f[`${N}Page`]=k}),f.total=parseInt(y)),{data:Object.assign(Object.assign({},p),f),error:null}}catch(f){if(Pe(f))return{data:{users:[]},error:f};throw f}}async getUserById(e){ci(e);try{return await Be(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:tn})}catch(r){if(Pe(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){ci(e);try{return await Be(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:tn})}catch(i){if(Pe(i))return{data:{user:null},error:i};throw i}}async deleteUser(e,r=!1){ci(e);try{return await Be(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:tn})}catch(i){if(Pe(i))return{data:{user:null},error:i};throw i}}async _listFactors(e){ci(e.userId);try{const{data:r,error:i}=await Be(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:r,error:i}}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async _deleteFactor(e){ci(e.userId),ci(e.id);try{return{data:await Be(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async _listOAuthClients(e){var r,i,o,c,l,u,h;try{const f={nextPage:null,lastPage:0,total:0},g=await Be(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:"",per_page:(c=(o=e?.perPage)===null||o===void 0?void 0:o.toString())!==null&&c!==void 0?c:""},xform:mg});if(g.error)throw g.error;const p=await g.json(),y=(l=g.headers.get("x-total-count"))!==null&&l!==void 0?l:0,v=(h=(u=g.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&h!==void 0?h:[];return v.length>0&&(v.forEach(w=>{const k=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),N=JSON.parse(w.split(";")[1].split("=")[1]);f[`${N}Page`]=k}),f.total=parseInt(y)),{data:Object.assign(Object.assign({},p),f),error:null}}catch(f){if(Pe(f))return{data:{clients:[]},error:f};throw f}}async _createOAuthClient(e){try{return await Be(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async _getOAuthClient(e){try{return await Be(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async _updateOAuthClient(e,r){try{return await Be(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:r,headers:this.headers,xform:i=>({data:i,error:null})})}catch(i){if(Pe(i))return{data:null,error:i};throw i}}async _deleteOAuthClient(e){try{return await Be(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(e){try{return await Be(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Pe(r))return{data:null,error:r};throw r}}}function fg(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}const di={debug:!!(globalThis&&Ny()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class _y extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class IN extends _y{}async function LN(t,e,r){di.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const i=new globalThis.AbortController;return e>0&&setTimeout(()=>{i.abort(),di.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async o=>{if(o){di.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,o.name);try{return await r()}finally{di.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,o.name)}}else{if(e===0)throw di.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new IN(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(di.debug)try{const c=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(c,null,"  "))}catch(c){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",c)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function RN(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function Sy(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function DN(t){return parseInt(t,16)}function FN(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,i=>i.toString(16).padStart(2,"0")).join("")}function MN(t){var e;const{chainId:r,domain:i,expirationTime:o,issuedAt:c=new Date,nonce:l,notBefore:u,requestId:h,resources:f,scheme:g,uri:p,version:y}=t;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!i)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(l&&l.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${l}`);if(!p)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(y!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${y}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const v=Sy(t.address),w=g?`${g}://${i}`:i,k=t.statement?`${t.statement}
`:"",N=`${w} wants you to sign in with your Ethereum account:
${v}

${k}`;let C=`URI: ${p}
Version: ${y}
Chain ID: ${r}${l?`
Nonce: ${l}`:""}
Issued At: ${c.toISOString()}`;if(o&&(C+=`
Expiration Time: ${o.toISOString()}`),u&&(C+=`
Not Before: ${u.toISOString()}`),h&&(C+=`
Request ID: ${h}`),f){let A=`
Resources:`;for(const E of f){if(!E||typeof E!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${E}`);A+=`
- ${E}`}C+=A}return`${N}
${C}`}class Et extends Error{constructor({message:e,code:r,cause:i,name:o}){var c;super(e,{cause:i}),this.__isWebAuthnError=!0,this.name=(c=o??(i instanceof Error?i.name:void 0))!==null&&c!==void 0?c:"Unknown Error",this.code=r}}class Bl extends Et{constructor(e,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:e}),this.name="WebAuthnUnknownError",this.originalError=r}}function ON({error:t,options:e}){var r,i,o;const{publicKey:c}=e;if(!c)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Et({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=c.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Et({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((i=c.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new Et({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((o=c.authenticatorSelection)===null||o===void 0?void 0:o.userVerification)==="required")return new Et({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new Et({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new Et({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return c.pubKeyCredParams.filter(u=>u.type==="public-key").length===0?new Et({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new Et({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const l=window.location.hostname;if(Cy(l)){if(c.rp.id!==l)return new Et({message:`The RP ID "${c.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Et({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(c.user.id.byteLength<1||c.user.id.byteLength>64)return new Et({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new Et({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Et({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function UN({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Et({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new Et({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const i=window.location.hostname;if(Cy(i)){if(r.rpId!==i)return new Et({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Et({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new Et({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Et({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class $N{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const BN=new $N;function WN(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:r,excludeCredentials:i}=t,o=Jl(t,["challenge","user","excludeCredentials"]),c=_i(e).buffer,l=Object.assign(Object.assign({},r),{id:_i(r.id).buffer}),u=Object.assign(Object.assign({},o),{challenge:c,user:l});if(i&&i.length>0){u.excludeCredentials=new Array(i.length);for(let h=0;h<i.length;h++){const f=i[h];u.excludeCredentials[h]=Object.assign(Object.assign({},f),{id:_i(f.id).buffer,type:f.type||"public-key",transports:f.transports})}}return u}function VN(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:r}=t,i=Jl(t,["challenge","allowCredentials"]),o=_i(e).buffer,c=Object.assign(Object.assign({},i),{challenge:o});if(r&&r.length>0){c.allowCredentials=new Array(r.length);for(let l=0;l<r.length;l++){const u=r[l];c.allowCredentials[l]=Object.assign(Object.assign({},u),{id:_i(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return c}function zN(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t;return{id:t.id,rawId:t.id,response:{attestationObject:In(new Uint8Array(t.response.attestationObject)),clientDataJSON:In(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function qN(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t,i=t.getClientExtensionResults(),o=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:In(new Uint8Array(o.authenticatorData)),clientDataJSON:In(new Uint8Array(o.clientDataJSON)),signature:In(new Uint8Array(o.signature)),userHandle:o.userHandle?In(new Uint8Array(o.userHandle)):void 0},type:"public-key",clientExtensionResults:i,authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Cy(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function pg(){var t,e;return!!(Wt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function HN(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Bl("Browser returned unexpected credential type",e)}:{data:null,error:new Bl("Empty credential response",e)}}catch(e){return{data:null,error:ON({error:e,options:t})}}}async function GN(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Bl("Browser returned unexpected credential type",e)}:{data:null,error:new Bl("Empty credential response",e)}}catch(e){return{data:null,error:UN({error:e,options:t})}}}const KN={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},YN={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Wl(...t){const e=o=>o!==null&&typeof o=="object"&&!Array.isArray(o),r=o=>o instanceof ArrayBuffer||ArrayBuffer.isView(o),i={};for(const o of t)if(o)for(const c in o){const l=o[c];if(l!==void 0)if(Array.isArray(l))i[c]=l;else if(r(l))i[c]=l;else if(e(l)){const u=i[c];e(u)?i[c]=Wl(u,l):i[c]=Wl(l)}else i[c]=l}return i}function JN(t,e){return Wl(KN,t,e||{})}function QN(t,e){return Wl(YN,t,e||{})}class ZN{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:r,friendlyName:i,signal:o},c){var l;try{const{data:u,error:h}=await this.client.mfa.challenge({factorId:e,webauthn:r});if(!u)return{data:null,error:h};const f=o??BN.createNewAbortSignal();if(u.webauthn.type==="create"){const{user:g}=u.webauthn.credential_options.publicKey;if(!g.name){const p=i;if(p)g.name=`${g.id}:${p}`;else{const v=(await this.client.getUser()).data.user,w=((l=v?.user_metadata)===null||l===void 0?void 0:l.name)||v?.email||v?.id||"User";g.name=`${g.id}:${w}`}}g.displayName||(g.displayName=g.name)}switch(u.webauthn.type){case"create":{const g=JN(u.webauthn.credential_options.publicKey,c?.create),{data:p,error:y}=await HN({publicKey:g,signal:f});return p?{data:{factorId:e,challengeId:u.id,webauthn:{type:u.webauthn.type,credential_response:p}},error:null}:{data:null,error:y}}case"request":{const g=QN(u.webauthn.credential_options.publicKey,c?.request),{data:p,error:y}=await GN(Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:g,signal:f}));return p?{data:{factorId:e,challengeId:u.id,webauthn:{type:u.webauthn.type,credential_response:p}},error:null}:{data:null,error:y}}}}catch(u){return Pe(u)?{data:null,error:u}:{data:null,error:new Pn("Unexpected error in challenge",u)}}}async _verify({challengeId:e,factorId:r,webauthn:i}){return this.client.mfa.verify({factorId:r,challengeId:e,webauthn:i})}async _authenticate({factorId:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:o}={}},c){if(!r)return{data:null,error:new za("rpId is required for WebAuthn authentication")};try{if(!pg())return{data:null,error:new Pn("Browser does not support WebAuthn",null)};const{data:l,error:u}=await this.challenge({factorId:e,webauthn:{rpId:r,rpOrigins:i},signal:o},{request:c});if(!l)return{data:null,error:u};const{webauthn:h}=l;return this._verify({factorId:e,challengeId:l.challengeId,webauthn:{type:h.type,rpId:r,rpOrigins:i,credential_response:h.credential_response}})}catch(l){return Pe(l)?{data:null,error:l}:{data:null,error:new Pn("Unexpected error in authenticate",l)}}}async _register({friendlyName:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:o}={}},c){if(!r)return{data:null,error:new za("rpId is required for WebAuthn registration")};try{if(!pg())return{data:null,error:new Pn("Browser does not support WebAuthn",null)};const{data:l,error:u}=await this._enroll({friendlyName:e});if(!l)return await this.client.mfa.listFactors().then(g=>{var p;return(p=g.data)===null||p===void 0?void 0:p.all.find(y=>y.factor_type==="webauthn"&&y.friendly_name===e&&y.status!=="unverified")}).then(g=>g?this.client.mfa.unenroll({factorId:g?.id}):void 0),{data:null,error:u};const{data:h,error:f}=await this._challenge({factorId:l.id,friendlyName:l.friendly_name,webauthn:{rpId:r,rpOrigins:i},signal:o},{create:c});return h?this._verify({factorId:l.id,challengeId:h.challengeId,webauthn:{rpId:r,rpOrigins:i,type:h.webauthn.type,credential_response:h.webauthn.credential_response}}):{data:null,error:f}}catch(l){return Pe(l)?{data:null,error:l}:{data:null,error:new Pn("Unexpected error in register",l)}}}}RN();const XN={url:Yj,storageKey:Jj,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Qj,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function gg(t,e,r){return await r()}const ui={};class qa{get jwks(){var e,r;return(r=(e=ui[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){ui[this.storageKey]=Object.assign(Object.assign({},ui[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=ui[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){ui[this.storageKey]=Object.assign(Object.assign({},ui[this.storageKey]),{cachedAt:e})}constructor(e){var r,i,o;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const c=Object.assign(Object.assign({},XN),e);if(this.storageKey=c.storageKey,this.instanceID=(r=qa.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,qa.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!c.debug,typeof c.debug=="function"&&(this.logger=c.debug),this.instanceID>0&&Wt()){const l=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(l),this.logDebugMessages&&console.trace(l)}if(this.persistSession=c.persistSession,this.autoRefreshToken=c.autoRefreshToken,this.admin=new AN({url:c.url,headers:c.headers,fetch:c.fetch}),this.url=c.url,this.headers=c.headers,this.fetch=ky(c.fetch),this.lock=c.lock||gg,this.detectSessionInUrl=c.detectSessionInUrl,this.flowType=c.flowType,this.hasCustomAuthorizationHeader=c.hasCustomAuthorizationHeader,this.throwOnError=c.throwOnError,this.lockAcquireTimeout=c.lockAcquireTimeout,c.lock?this.lock=c.lock:this.persistSession&&Wt()&&(!((i=globalThis?.navigator)===null||i===void 0)&&i.locks)?this.lock=LN:this.lock=gg,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new ZN(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(c.storage?this.storage=c.storage:Ny()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=fg(this.memoryStorage)),c.userStorage&&(this.userStorage=c.userStorage)):(this.memoryStorage={},this.storage=fg(this.memoryStorage)),Wt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(o=this.broadcastChannel)===null||o===void 0||o.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l);try{await this._notifyAllSubscribers(l.data.event,l.data.session,!1)}catch(u){this._debug("#broadcastChannel","error",u)}})}this.initialize().catch(l=>{this._debug("#initialize()","error",l)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${vy}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let r={},i="none";if(Wt()&&(r=uN(window.location.href),this._isImplicitGrantCallback(r)?i="implicit":await this._isPKCECallback(r)&&(i="pkce")),Wt()&&this.detectSessionInUrl&&i!=="none"){const{data:o,error:c}=await this._getSessionFromURL(r,i);if(c){if(this._debug("#_initialize()","error detecting session from URL",c),sN(c)){const h=(e=c.details)===null||e===void 0?void 0:e.code;if(h==="identity_already_exists"||h==="identity_not_found"||h==="single_identity_not_deletable")return{error:c}}return{error:c}}const{session:l,redirectType:u}=o;return this._debug("#_initialize()","detected session in URL",l,"redirect type",u),await this._saveSession(l),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Pe(r)?this._returnResult({error:r}):this._returnResult({error:new Pn("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,i,o;try{const c=await Be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(i=(r=e?.options)===null||r===void 0?void 0:r.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:(o=e?.options)===null||o===void 0?void 0:o.captchaToken}},xform:qs}),{data:l,error:u}=c;if(u||!l)return this._returnResult({data:{user:null,session:null},error:u});const h=l.session,f=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:f,session:h},error:null})}catch(c){if(Pe(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async signUp(e){var r,i,o;try{let c;if("email"in e){const{email:g,password:p,options:y}=e;let v=null,w=null;this.flowType==="pkce"&&([v,w]=await li(this.storage,this.storageKey)),c=await Be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:y?.emailRedirectTo,body:{email:g,password:p,data:(r=y?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:y?.captchaToken},code_challenge:v,code_challenge_method:w},xform:qs})}else if("phone"in e){const{phone:g,password:p,options:y}=e;c=await Be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:g,password:p,data:(i=y?.data)!==null&&i!==void 0?i:{},channel:(o=y?.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:y?.captchaToken}},xform:qs})}else throw new wl("You must provide either an email or phone number and a password");const{data:l,error:u}=c;if(u||!l)return await Bt(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:u});const h=l.session,f=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:f,session:h},error:null})}catch(c){if(await Bt(this.storage,`${this.storageKey}-code-verifier`),Pe(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async signInWithPassword(e){try{let r;if("email"in e){const{email:c,password:l,options:u}=e;r=await Be(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:c,password:l,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:hg})}else if("phone"in e){const{phone:c,password:l,options:u}=e;r=await Be(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:c,password:l,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:hg})}else throw new wl("You must provide either an email or phone number and a password");const{data:i,error:o}=r;if(o)return this._returnResult({data:{user:null,session:null},error:o});if(!i||!i.session||!i.user){const c=new oi;return this._returnResult({data:{user:null,session:null},error:c})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:o})}catch(r){if(Pe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(e){var r,i,o,c;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(i=e.options)===null||i===void 0?void 0:i.scopes,queryParams:(o=e.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(c=e.options)===null||c===void 0?void 0:c.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,i,o,c,l,u,h,f,g,p,y;let v,w;if("message"in e)v=e.message,w=e.signature;else{const{chain:k,wallet:N,statement:C,options:A}=e;let E;if(Wt())if(typeof N=="object")E=N;else{const H=window;if("ethereum"in H&&typeof H.ethereum=="object"&&"request"in H.ethereum&&typeof H.ethereum.request=="function")E=H.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof N!="object"||!A?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");E=N}const _=new URL((r=A?.url)!==null&&r!==void 0?r:window.location.href),R=await E.request({method:"eth_requestAccounts"}).then(H=>H).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!R||R.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const L=Sy(R[0]);let P=(i=A?.signInWithEthereum)===null||i===void 0?void 0:i.chainId;if(!P){const H=await E.request({method:"eth_chainId"});P=DN(H)}const D={domain:_.host,address:L,statement:C,uri:_.href,version:"1",chainId:P,nonce:(o=A?.signInWithEthereum)===null||o===void 0?void 0:o.nonce,issuedAt:(l=(c=A?.signInWithEthereum)===null||c===void 0?void 0:c.issuedAt)!==null&&l!==void 0?l:new Date,expirationTime:(u=A?.signInWithEthereum)===null||u===void 0?void 0:u.expirationTime,notBefore:(h=A?.signInWithEthereum)===null||h===void 0?void 0:h.notBefore,requestId:(f=A?.signInWithEthereum)===null||f===void 0?void 0:f.requestId,resources:(g=A?.signInWithEthereum)===null||g===void 0?void 0:g.resources};v=MN(D),w=await E.request({method:"personal_sign",params:[FN(v),L]})}try{const{data:k,error:N}=await Be(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:v,signature:w},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(y=e.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:qs});if(N)throw N;if(!k||!k.session||!k.user){const C=new oi;return this._returnResult({data:{user:null,session:null},error:C})}return k.session&&(await this._saveSession(k.session),await this._notifyAllSubscribers("SIGNED_IN",k.session)),this._returnResult({data:Object.assign({},k),error:N})}catch(k){if(Pe(k))return this._returnResult({data:{user:null,session:null},error:k});throw k}}async signInWithSolana(e){var r,i,o,c,l,u,h,f,g,p,y,v;let w,k;if("message"in e)w=e.message,k=e.signature;else{const{chain:N,wallet:C,statement:A,options:E}=e;let _;if(Wt())if(typeof C=="object")_=C;else{const L=window;if("solana"in L&&typeof L.solana=="object"&&("signIn"in L.solana&&typeof L.solana.signIn=="function"||"signMessage"in L.solana&&typeof L.solana.signMessage=="function"))_=L.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof C!="object"||!E?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=C}const R=new URL((r=E?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in _&&_.signIn){const L=await _.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},E?.signInWithSolana),{version:"1",domain:R.host,uri:R.href}),A?{statement:A}:null));let P;if(Array.isArray(L)&&L[0]&&typeof L[0]=="object")P=L[0];else if(L&&typeof L=="object"&&"signedMessage"in L&&"signature"in L)P=L;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in P&&"signature"in P&&(typeof P.signedMessage=="string"||P.signedMessage instanceof Uint8Array)&&P.signature instanceof Uint8Array)w=typeof P.signedMessage=="string"?P.signedMessage:new TextDecoder().decode(P.signedMessage),k=P.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in _)||typeof _.signMessage!="function"||!("publicKey"in _)||typeof _!="object"||!_.publicKey||!("toBase58"in _.publicKey)||typeof _.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");w=[`${R.host} wants you to sign in with your Solana account:`,_.publicKey.toBase58(),...A?["",A,""]:[""],"Version: 1",`URI: ${R.href}`,`Issued At: ${(o=(i=E?.signInWithSolana)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date().toISOString()}`,...!((c=E?.signInWithSolana)===null||c===void 0)&&c.notBefore?[`Not Before: ${E.signInWithSolana.notBefore}`]:[],...!((l=E?.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${E.signInWithSolana.expirationTime}`]:[],...!((u=E?.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${E.signInWithSolana.chainId}`]:[],...!((h=E?.signInWithSolana)===null||h===void 0)&&h.nonce?[`Nonce: ${E.signInWithSolana.nonce}`]:[],...!((f=E?.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${E.signInWithSolana.requestId}`]:[],...!((p=(g=E?.signInWithSolana)===null||g===void 0?void 0:g.resources)===null||p===void 0)&&p.length?["Resources",...E.signInWithSolana.resources.map(P=>`- ${P}`)]:[]].join(`
`);const L=await _.signMessage(new TextEncoder().encode(w),"utf8");if(!L||!(L instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");k=L}}try{const{data:N,error:C}=await Be(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:w,signature:In(k)},!((y=e.options)===null||y===void 0)&&y.captchaToken?{gotrue_meta_security:{captcha_token:(v=e.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:qs});if(C)throw C;if(!N||!N.session||!N.user){const A=new oi;return this._returnResult({data:{user:null,session:null},error:A})}return N.session&&(await this._saveSession(N.session),await this._notifyAllSubscribers("SIGNED_IN",N.session)),this._returnResult({data:Object.assign({},N),error:C})}catch(N){if(Pe(N))return this._returnResult({data:{user:null,session:null},error:N});throw N}}async _exchangeCodeForSession(e){const r=await kn(this.storage,`${this.storageKey}-code-verifier`),[i,o]=(r??"").split("/");try{if(!i&&this.flowType==="pkce")throw new rN;const{data:c,error:l}=await Be(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:i},xform:qs});if(await Bt(this.storage,`${this.storageKey}-code-verifier`),l)throw l;if(!c||!c.session||!c.user){const u=new oi;return this._returnResult({data:{user:null,session:null,redirectType:null},error:u})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:Object.assign(Object.assign({},c),{redirectType:o??null}),error:l})}catch(c){if(await Bt(this.storage,`${this.storageKey}-code-verifier`),Pe(c))return this._returnResult({data:{user:null,session:null,redirectType:null},error:c});throw c}}async signInWithIdToken(e){try{const{options:r,provider:i,token:o,access_token:c,nonce:l}=e,u=await Be(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:i,id_token:o,access_token:c,nonce:l,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:qs}),{data:h,error:f}=u;if(f)return this._returnResult({data:{user:null,session:null},error:f});if(!h||!h.session||!h.user){const g=new oi;return this._returnResult({data:{user:null,session:null},error:g})}return h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),this._returnResult({data:h,error:f})}catch(r){if(Pe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(e){var r,i,o,c,l;try{if("email"in e){const{email:u,options:h}=e;let f=null,g=null;this.flowType==="pkce"&&([f,g]=await li(this.storage,this.storageKey));const{error:p}=await Be(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(r=h?.data)!==null&&r!==void 0?r:{},create_user:(i=h?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:f,code_challenge_method:g},redirectTo:h?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:p})}if("phone"in e){const{phone:u,options:h}=e,{data:f,error:g}=await Be(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(o=h?.data)!==null&&o!==void 0?o:{},create_user:(c=h?.shouldCreateUser)!==null&&c!==void 0?c:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},channel:(l=h?.channel)!==null&&l!==void 0?l:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:f?.message_id},error:g})}throw new wl("You must provide either an email or phone number.")}catch(u){if(await Bt(this.storage,`${this.storageKey}-code-verifier`),Pe(u))return this._returnResult({data:{user:null,session:null},error:u});throw u}}async verifyOtp(e){var r,i;try{let o,c;"options"in e&&(o=(r=e.options)===null||r===void 0?void 0:r.redirectTo,c=(i=e.options)===null||i===void 0?void 0:i.captchaToken);const{data:l,error:u}=await Be(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:c}}),redirectTo:o,xform:qs});if(u)throw u;if(!l)throw new Error("An error occurred on token verification.");const h=l.session,f=l.user;return h?.access_token&&(await this._saveSession(h),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",h)),this._returnResult({data:{user:f,session:h},error:null})}catch(o){if(Pe(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signInWithSSO(e){var r,i,o,c,l;try{let u=null,h=null;this.flowType==="pkce"&&([u,h]=await li(this.storage,this.storageKey));const f=await Be(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(i=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&i!==void 0?i:void 0}),!((o=e?.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:u,code_challenge_method:h}),headers:this.headers,xform:TN});return!((c=f.data)===null||c===void 0)&&c.url&&Wt()&&!(!((l=e.options)===null||l===void 0)&&l.skipBrowserRedirect)&&window.location.assign(f.data.url),this._returnResult(f)}catch(u){if(await Bt(this.storage,`${this.storageKey}-code-verifier`),Pe(u))return this._returnResult({data:null,error:u});throw u}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:i}=e;if(i)throw i;if(!r)throw new ps;const{error:o}=await Be(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:o})})}catch(e){if(Pe(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:i,type:o,options:c}=e,{error:l}=await Be(this.fetch,"POST",r,{headers:this.headers,body:{email:i,type:o,gotrue_meta_security:{captcha_token:c?.captchaToken}},redirectTo:c?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:l})}else if("phone"in e){const{phone:i,type:o,options:c}=e,{data:l,error:u}=await Be(this.fetch,"POST",r,{headers:this.headers,body:{phone:i,type:o,gotrue_meta_security:{captcha_token:c?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:l?.message_id},error:u})}throw new wl("You must provide either an email or phone number and a type")}catch(r){if(Pe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const i=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await i,await r()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const i=r();for(this.pendingInLock.push((async()=>{try{await i}catch{}})()),await i;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await i}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await kn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const i=e.expires_at?e.expires_at*1e3-Date.now()<su:!1;if(this._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",e.expires_at),!i){if(this.userStorage){const l=await kn(this.userStorage,this.storageKey+"-user");l?.user?e.user=l.user:e.user=iu()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const l={value:this.suppressGetSessionWarning};e.user=kN(e.user,l),l.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:o,error:c}=await this._callRefreshToken(e.refresh_token);return c?this._returnResult({data:{session:null},error:c}):this._returnResult({data:{session:o},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(e){try{return e?await Be(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:tn}):await this._useSession(async r=>{var i,o,c;const{data:l,error:u}=r;if(u)throw u;return!(!((i=l.session)===null||i===void 0)&&i.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ps}:await Be(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(c=(o=l.session)===null||o===void 0?void 0:o.access_token)!==null&&c!==void 0?c:void 0,xform:tn})})}catch(r){if(Pe(r))return ru(r)&&(await this._removeSession(),await Bt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async i=>{const{data:o,error:c}=i;if(c)throw c;if(!o.session)throw new ps;const l=o.session;let u=null,h=null;this.flowType==="pkce"&&e.email!=null&&([u,h]=await li(this.storage,this.storageKey));const{data:f,error:g}=await Be(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:u,code_challenge_method:h}),jwt:l.access_token,xform:tn});if(g)throw g;return l.user=f.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),this._returnResult({data:{user:l.user},error:null})})}catch(i){if(await Bt(this.storage,`${this.storageKey}-code-verifier`),Pe(i))return this._returnResult({data:{user:null},error:i});throw i}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ps;const r=Date.now()/1e3;let i=r,o=!0,c=null;const{payload:l}=Nl(e.access_token);if(l.exp&&(i=l.exp,o=i<=r),o){const{data:u,error:h}=await this._callRefreshToken(e.refresh_token);if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!u)return{data:{user:null,session:null},error:null};c=u}else{const{data:u,error:h}=await this._getUser(e.access_token);if(h)return this._returnResult({data:{user:null,session:null},error:h});c={access_token:e.access_token,refresh_token:e.refresh_token,user:u.user,token_type:"bearer",expires_in:i-r,expires_at:i},await this._saveSession(c),await this._notifyAllSubscribers("SIGNED_IN",c)}return this._returnResult({data:{user:c.user,session:c},error:null})}catch(r){if(Pe(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var i;if(!e){const{data:l,error:u}=r;if(u)throw u;e=(i=l.session)!==null&&i!==void 0?i:void 0}if(!e?.refresh_token)throw new ps;const{data:o,error:c}=await this._callRefreshToken(e.refresh_token);return c?this._returnResult({data:{user:null,session:null},error:c}):o?this._returnResult({data:{user:o.user,session:o},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Pe(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(e,r){try{if(!Wt())throw new jl("No browser detected.");if(e.error||e.error_description||e.error_code)throw new jl(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new ig("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new jl("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new ig("No code detected.");const{data:A,error:E}=await this._exchangeCodeForSession(e.code);if(E)throw E;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:A.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:o,access_token:c,refresh_token:l,expires_in:u,expires_at:h,token_type:f}=e;if(!c||!u||!l||!f)throw new jl("No session defined in URL");const g=Math.round(Date.now()/1e3),p=parseInt(u);let y=g+p;h&&(y=parseInt(h));const v=y-g;v*1e3<=pi&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${p}s`);const w=y-p;g-w>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",w,y,g):g-w<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",w,y,g);const{data:k,error:N}=await this._getUser(c);if(N)throw N;const C={provider_token:i,provider_refresh_token:o,access_token:c,expires_in:p,expires_at:y,refresh_token:l,token_type:f,user:k.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:C,redirectType:e.type},error:null})}catch(i){if(Pe(i))return this._returnResult({data:{session:null,redirectType:null},error:i});throw i}}_isImplicitGrantCallback(e){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await kn(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var i;const{data:o,error:c}=r;if(c&&!ru(c))return this._returnResult({error:c});const l=(i=o.session)===null||i===void 0?void 0:i.access_token;if(l){const{error:u}=await this.admin.signOut(l,e);if(u&&!(tN(u)&&(u.status===404||u.status===401||u.status===403)||ru(u)))return this._returnResult({error:u})}return e!=="others"&&(await this._removeSession(),await Bt(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const r=dN(),i={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,i),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:i}}}async _emitInitialSession(e){return await this._useSession(async r=>{var i,o;try{const{data:{session:c},error:l}=r;if(l)throw l;await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",c)),this._debug("INITIAL_SESSION","callback id",e,"session",c)}catch(c){await((o=this.stateChangeEmitters.get(e))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",c),console.error(c)}})}async resetPasswordForEmail(e,r={}){let i=null,o=null;this.flowType==="pkce"&&([i,o]=await li(this.storage,this.storageKey,!0));try{return await Be(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:i,code_challenge_method:o,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(c){if(await Bt(this.storage,`${this.storageKey}-code-verifier`),Pe(c))return this._returnResult({data:null,error:c});throw c}}async getUserIdentities(){var e;try{const{data:r,error:i}=await this.getUser();if(i)throw i;return this._returnResult({data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(r){if(Pe(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var r;try{const{data:i,error:o}=await this._useSession(async c=>{var l,u,h,f,g;const{data:p,error:y}=c;if(y)throw y;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(l=e.options)===null||l===void 0?void 0:l.redirectTo,scopes:(u=e.options)===null||u===void 0?void 0:u.scopes,queryParams:(h=e.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:!0});return await Be(this.fetch,"GET",v,{headers:this.headers,jwt:(g=(f=p.session)===null||f===void 0?void 0:f.access_token)!==null&&g!==void 0?g:void 0})});if(o)throw o;return Wt()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(i?.url),this._returnResult({data:{provider:e.provider,url:i?.url},error:null})}catch(i){if(Pe(i))return this._returnResult({data:{provider:e.provider,url:null},error:i});throw i}}async linkIdentityIdToken(e){return await this._useSession(async r=>{var i;try{const{error:o,data:{session:c}}=r;if(o)throw o;const{options:l,provider:u,token:h,access_token:f,nonce:g}=e,p=await Be(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(i=c?.access_token)!==null&&i!==void 0?i:void 0,body:{provider:u,id_token:h,access_token:f,nonce:g,link_identity:!0,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:qs}),{data:y,error:v}=p;return v?this._returnResult({data:{user:null,session:null},error:v}):!y||!y.session||!y.user?this._returnResult({data:{user:null,session:null},error:new oi}):(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("USER_UPDATED",y.session)),this._returnResult({data:y,error:v}))}catch(o){if(await Bt(this.storage,`${this.storageKey}-code-verifier`),Pe(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}})}async unlinkIdentity(e){try{return await this._useSession(async r=>{var i,o;const{data:c,error:l}=r;if(l)throw l;return await Be(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(o=(i=c.session)===null||i===void 0?void 0:i.access_token)!==null&&o!==void 0?o:void 0})})}catch(r){if(Pe(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const i=Date.now();return await fN(async o=>(o>0&&await mN(200*Math.pow(2,o-1)),this._debug(r,"refreshing attempt",o),await Be(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:qs})),(o,c)=>{const l=200*Math.pow(2,o);return c&&nu(c)&&Date.now()+l-i<pi})}catch(i){if(this._debug(r,"error",i),Pe(i))return this._returnResult({data:{session:null,user:null},error:i});throw i}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const i=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",i),Wt()&&!r.skipBrowserRedirect&&window.location.assign(i),{data:{provider:e,url:i},error:null}}async _recoverAndRefresh(){var e,r;const i="#_recoverAndRefresh()";this._debug(i,"begin");try{const o=await kn(this.storage,this.storageKey);if(o&&this.userStorage){let l=await kn(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:o.user},await gi(this.userStorage,this.storageKey+"-user",l)),o.user=(e=l?.user)!==null&&e!==void 0?e:iu()}else if(o&&!o.user&&!o.user){const l=await kn(this.storage,this.storageKey+"-user");l&&l?.user?(o.user=l.user,await Bt(this.storage,this.storageKey+"-user"),await gi(this.storage,this.storageKey,o)):o.user=iu()}if(this._debug(i,"session from storage",o),!this._isValidSession(o)){this._debug(i,"session is not valid"),o!==null&&await this._removeSession();return}const c=((r=o.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<su;if(this._debug(i,`session has${c?"":" not"} expired with margin of ${su}s`),c){if(this.autoRefreshToken&&o.refresh_token){const{error:l}=await this._callRefreshToken(o.refresh_token);l&&(console.error(l),nu(l)||(this._debug(i,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(o.user&&o.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:u}=await this._getUser(o.access_token);!u&&l?.user?(o.user=l.user,await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)):this._debug(i,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(i,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",o)}catch(o){this._debug(i,"error",o),console.error(o);return}finally{this._debug(i,"end")}}async _callRefreshToken(e){var r,i;if(!e)throw new ps;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new Xl;const{data:c,error:l}=await this._refreshAccessToken(e);if(l)throw l;if(!c.session)throw new ps;await this._saveSession(c.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",c.session);const u={data:c.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(c){if(this._debug(o,"error",c),Pe(c)){const l={data:null,error:c};return nu(c)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(l),l}throw(i=this.refreshingDeferred)===null||i===void 0||i.reject(c),c}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(e,r,i=!0){const o=`#_notifyAllSubscribers(${e})`;this._debug(o,"begin",r,`broadcast = ${i}`);try{this.broadcastChannel&&i&&this.broadcastChannel.postMessage({event:e,session:r});const c=[],l=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(e,r)}catch(h){c.push(h)}});if(await Promise.all(l),c.length>0){for(let u=0;u<c.length;u+=1)console.error(c[u]);throw c[0]}}finally{this._debug(o,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Bt(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},e),i=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!i&&r.user&&await gi(this.userStorage,this.storageKey+"-user",{user:r.user});const o=Object.assign({},r);delete o.user;const c=dg(o);await gi(this.storage,this.storageKey,c)}else{const o=dg(r);await gi(this.storage,this.storageKey,o)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Bt(this.storage,this.storageKey),await Bt(this.storage,this.storageKey+"-code-verifier"),await Bt(this.storage,this.storageKey+"-user"),this.userStorage&&await Bt(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Wt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),pi);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:i}}=r;if(!i||!i.refresh_token||!i.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((i.expires_at*1e3-e)/pi);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${pi}ms, refresh threshold is ${Tu} ticks`),o<=Tu&&await this._callRefreshToken(i.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof _y)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Wt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(e){this._debug("#visibilityChangedCallback","error",e)}},window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,i){const o=[`provider=${encodeURIComponent(r)}`];if(i?.redirectTo&&o.push(`redirect_to=${encodeURIComponent(i.redirectTo)}`),i?.scopes&&o.push(`scopes=${encodeURIComponent(i.scopes)}`),this.flowType==="pkce"){const[c,l]=await li(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(c)}`,code_challenge_method:`${encodeURIComponent(l)}`});o.push(u.toString())}if(i?.queryParams){const c=new URLSearchParams(i.queryParams);o.push(c.toString())}return i?.skipBrowserRedirect&&o.push(`skip_http_redirect=${i.skipBrowserRedirect}`),`${e}?${o.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var i;const{data:o,error:c}=r;return c?this._returnResult({data:null,error:c}):await Be(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(i=o?.session)===null||i===void 0?void 0:i.access_token})})}catch(r){if(Pe(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(e){try{return await this._useSession(async r=>{var i,o;const{data:c,error:l}=r;if(l)return this._returnResult({data:null,error:l});const u=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:h,error:f}=await Be(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(i=c?.session)===null||i===void 0?void 0:i.access_token});return f?this._returnResult({data:null,error:f}):(e.factorType==="totp"&&h.type==="totp"&&(!((o=h?.totp)===null||o===void 0)&&o.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),this._returnResult({data:h,error:null}))})}catch(r){if(Pe(r))return this._returnResult({data:null,error:r});throw r}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var i;const{data:o,error:c}=r;if(c)return this._returnResult({data:null,error:c});const l=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?zN(e.webauthn.credential_response):qN(e.webauthn.credential_response)})}:{code:e.code}),{data:u,error:h}=await Be(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:l,headers:this.headers,jwt:(i=o?.session)===null||i===void 0?void 0:i.access_token});return h?this._returnResult({data:null,error:h}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+u.expires_in},u)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",u),this._returnResult({data:u,error:h}))})}catch(r){if(Pe(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var i;const{data:o,error:c}=r;if(c)return this._returnResult({data:null,error:c});const l=await Be(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(i=o?.session)===null||i===void 0?void 0:i.access_token});if(l.error)return l;const{data:u}=l;if(u.type!=="webauthn")return{data:u,error:null};switch(u.webauthn.type){case"create":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:WN(u.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},u),{webauthn:Object.assign(Object.assign({},u.webauthn),{credential_options:Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:VN(u.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Pe(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(e){const{data:r,error:i}=await this._challenge({factorId:e.factorId});return i?this._returnResult({data:null,error:i}):await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){var e;const{data:{user:r},error:i}=await this.getUser();if(i)return{data:null,error:i};const o={all:[],phone:[],totp:[],webauthn:[]};for(const c of(e=r?.factors)!==null&&e!==void 0?e:[])o.all.push(c),c.status==="verified"&&o[c.factor_type].push(c);return{data:o,error:null}}async _getAuthenticatorAssuranceLevel(e){var r,i,o,c;if(e)try{const{payload:v}=Nl(e);let w=null;v.aal&&(w=v.aal);let k=w;const{data:{user:N},error:C}=await this.getUser(e);if(C)return this._returnResult({data:null,error:C});((i=(r=N?.factors)===null||r===void 0?void 0:r.filter(_=>_.status==="verified"))!==null&&i!==void 0?i:[]).length>0&&(k="aal2");const E=v.amr||[];return{data:{currentLevel:w,nextLevel:k,currentAuthenticationMethods:E},error:null}}catch(v){if(Pe(v))return this._returnResult({data:null,error:v});throw v}const{data:{session:l},error:u}=await this.getSession();if(u)return this._returnResult({data:null,error:u});if(!l)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:h}=Nl(l.access_token);let f=null;h.aal&&(f=h.aal);let g=f;((c=(o=l.user.factors)===null||o===void 0?void 0:o.filter(v=>v.status==="verified"))!==null&&c!==void 0?c:[]).length>0&&(g="aal2");const y=h.amr||[];return{data:{currentLevel:f,nextLevel:g,currentAuthenticationMethods:y},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async r=>{const{data:{session:i},error:o}=r;return o?this._returnResult({data:null,error:o}):i?await Be(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:i.access_token,xform:c=>({data:c,error:null})}):this._returnResult({data:null,error:new ps})})}catch(r){if(Pe(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(e,r){try{return await this._useSession(async i=>{const{data:{session:o},error:c}=i;if(c)return this._returnResult({data:null,error:c});if(!o)return this._returnResult({data:null,error:new ps});const l=await Be(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:o.access_token,body:{action:"approve"},xform:u=>({data:u,error:null})});return l.data&&l.data.redirect_url&&Wt()&&!r?.skipBrowserRedirect&&window.location.assign(l.data.redirect_url),l})}catch(i){if(Pe(i))return this._returnResult({data:null,error:i});throw i}}async _denyAuthorization(e,r){try{return await this._useSession(async i=>{const{data:{session:o},error:c}=i;if(c)return this._returnResult({data:null,error:c});if(!o)return this._returnResult({data:null,error:new ps});const l=await Be(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:o.access_token,body:{action:"deny"},xform:u=>({data:u,error:null})});return l.data&&l.data.redirect_url&&Wt()&&!r?.skipBrowserRedirect&&window.location.assign(l.data.redirect_url),l})}catch(i){if(Pe(i))return this._returnResult({data:null,error:i});throw i}}async _listOAuthGrants(){try{return await this._useSession(async e=>{const{data:{session:r},error:i}=e;return i?this._returnResult({data:null,error:i}):r?await Be(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:o=>({data:o,error:null})}):this._returnResult({data:null,error:new ps})})}catch(e){if(Pe(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async r=>{const{data:{session:i},error:o}=r;return o?this._returnResult({data:null,error:o}):i?(await Be(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:i.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new ps})})}catch(r){if(Pe(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(e,r={keys:[]}){let i=r.keys.find(u=>u.kid===e);if(i)return i;const o=Date.now();if(i=this.jwks.keys.find(u=>u.kid===e),i&&this.jwks_cached_at+Xj>o)return i;const{data:c,error:l}=await Be(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!c.keys||c.keys.length===0||(this.jwks=c,this.jwks_cached_at=o,i=c.keys.find(u=>u.kid===e),!i)?null:i}async getClaims(e,r={}){try{let i=e;if(!i){const{data:v,error:w}=await this.getSession();if(w||!v.session)return this._returnResult({data:null,error:w});i=v.session.access_token}const{header:o,payload:c,signature:l,raw:{header:u,payload:h}}=Nl(i);r?.allowExpired||wN(c.exp);const f=!o.alg||o.alg.startsWith("HS")||!o.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(o.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!f){const{error:v}=await this.getUser(i);if(v)throw v;return{data:{claims:c,header:o,signature:l},error:null}}const g=jN(o.alg),p=await crypto.subtle.importKey("jwk",f,g,!0,["verify"]);if(!await crypto.subtle.verify(g,p,l,lN(`${u}.${h}`)))throw new Au("Invalid JWT signature");return{data:{claims:c,header:o,signature:l},error:null}}catch(i){if(Pe(i))return this._returnResult({data:null,error:i});throw i}}}qa.nextInstanceID={};const e2=qa,t2="2.95.3";let ka="";typeof Deno<"u"?ka="deno":typeof document<"u"?ka="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ka="react-native":ka="node";const s2={"X-Client-Info":`supabase-js-${ka}/${t2}`},r2={headers:s2},n2={schema:"public"},i2={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},a2={};function Ha(t){"@babel/helpers - typeof";return Ha=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ha(t)}function o2(t,e){if(Ha(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var i=r.call(t,e);if(Ha(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function l2(t){var e=o2(t,"string");return Ha(e)=="symbol"?e:e+""}function c2(t,e,r){return(e=l2(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function xg(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),r.push.apply(r,i)}return r}function bt(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?xg(Object(r),!0).forEach(function(i){c2(t,i,r[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):xg(Object(r)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(r,i))})}return t}const d2=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),u2=()=>Headers,h2=(t,e,r)=>{const i=d2(r),o=u2();return async(c,l)=>{var u;const h=(u=await e())!==null&&u!==void 0?u:t;let f=new o(l?.headers);return f.has("apikey")||f.set("apikey",t),f.has("Authorization")||f.set("Authorization",`Bearer ${h}`),i(c,bt(bt({},l),{},{headers:f}))}};function m2(t){return t.endsWith("/")?t:t+"/"}function f2(t,e){var r,i;const{db:o,auth:c,realtime:l,global:u}=t,{db:h,auth:f,realtime:g,global:p}=e,y={db:bt(bt({},h),o),auth:bt(bt({},f),c),realtime:bt(bt({},g),l),storage:{},global:bt(bt(bt({},p),u),{},{headers:bt(bt({},(r=p?.headers)!==null&&r!==void 0?r:{}),(i=u?.headers)!==null&&i!==void 0?i:{})}),accessToken:async()=>""};return t.accessToken?y.accessToken=t.accessToken:delete y.accessToken,y}function p2(t){const e=t?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(m2(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var g2=class extends e2{constructor(t){super(t)}},x2=class{constructor(t,e,r){var i,o;this.supabaseUrl=t,this.supabaseKey=e;const c=p2(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const l=`sb-${c.hostname.split(".")[0]}-auth-token`,u={db:n2,realtime:a2,auth:bt(bt({},i2),{},{storageKey:l}),global:r2},h=f2(r??{},u);if(this.storageKey=(i=h.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(o=h.global.headers)!==null&&o!==void 0?o:{},h.accessToken)this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(g,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}});else{var f;this.auth=this._initSupabaseAuthClient((f=h.auth)!==null&&f!==void 0?f:{},this.headers,h.global.fetch)}this.fetch=h2(e,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(bt({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(g=>this.realtime.setAuth(g)).catch(g=>console.warn("Failed to set initial Realtime auth token:",g)),this.rest=new tj(new URL("rest/v1",c).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch,timeout:h.db.timeout,urlLengthLimit:h.db.urlLengthLimit}),this.storage=new Kj(this.storageUrl.href,this.headers,this.fetch,r?.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new G1(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,r)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t=this,e,r;if(t.accessToken)return await t.accessToken();const{data:i}=await t.auth.getSession();return(e=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&e!==void 0?e:t.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:i,userStorage:o,storageKey:c,flowType:l,lock:u,debug:h,throwOnError:f},g,p){const y={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new g2({url:this.authUrl.href,headers:bt(bt({},y),g),storageKey:c,autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:i,userStorage:o,flowType:l,lock:u,debug:h,throwOnError:f,fetch:p,hasCustomAuthorizationHeader:Object.keys(this.headers).some(v=>v.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new yj(this.realtimeUrl.href,bt(bt({},t),{},{params:bt(bt({},{apikey:this.supabaseKey}),t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,e)=>{this._handleTokenChanged(t,"CLIENT",e?.access_token)})}_handleTokenChanged(t,e,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const y2=(t,e,r)=>new x2(t,e,r);function b2(){if(typeof window<"u")return!1;const t=globalThis.process;if(!t)return!1;const e=t.version;if(e==null)return!1;const r=e.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}b2()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Ty=typeof window<"u"&&window.location.hostname.includes("figma"),Ey="https://drofnrntrbedtjtpseve.supabase.co",v2="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRyb2Zucm50cmJlZHRqdHBzZXZlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM3ODMzMjQsImV4cCI6MjA3OTM1OTMyNH0.HONRnz8phA-6j0hwf6XLhD8aRX4zwQR-2x6pQHcUBAo";Ty||(console.log(" Supabase Configuration:"),console.log("   URL:",Ey),console.log("   Key:"," Present"));const V=y2(Ey,v2,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce"},global:{headers:{"X-Client-Info":"oldcycle-web"}},realtime:{params:{eventsPerSecond:10}}});Ty||(console.log(" Supabase client initialized with PKCE flow (auto-refresh ON)"),console.log(" Supabase client ready. Connection will be established on first query."));function w2(){return`client_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}function Py(t,e){localStorage.setItem("oldcycle_user",JSON.stringify(t)),localStorage.setItem("oldcycle_token",e)}function tt(){const t=localStorage.getItem("oldcycle_user");if(!t)return null;try{return JSON.parse(t)}catch{return null}}function nn(){return localStorage.getItem("oldcycle_token")}async function to(){const t=tt();if(!t)return console.log("[getOwnerToken] No current user"),null;try{const{data:e,error:r}=await V.from("profiles").select("owner_token").eq("id",t.id).single();return r?(console.error("[getOwnerToken] Error fetching owner token:",r),r.code==="42703"?(console.warn("[getOwnerToken] owner_token column not found, using client token as fallback"),nn()):null):!e||!e.owner_token?(console.warn("[getOwnerToken] No owner token found in profile, using client token as fallback"),nn()):e.owner_token}catch(e){return console.error("[getOwnerToken] Exception:",e),nn()}}function j2(){return!!tt()&&!!nn()}async function Iu(){const t=tt();if(!t)return!1;try{const{data:e,error:r}=await V.from("profiles").select("is_admin").eq("id",t.id).single();return r||!e?(console.error(" Error checking admin status:",r),!1):e.is_admin===!0}catch(e){return console.error(" checkIsAdmin failed:",e),!1}}async function Ay(){await V.auth.signOut(),localStorage.removeItem("oldcycle_user"),localStorage.removeItem("oldcycle_token"),console.log(" User logged out")}async function Iy(t){console.log(" Logging in with client token...");try{const{data:e,error:r}=await V.from("profiles").select("*").eq("client_token",t).single();if(r||!e)throw console.error(" Profile not found:",r),new Error("Invalid credentials");const i={id:e.id,name:e.display_name||e.name||e.email?.split("@")[0]||e.phone_number||"User",email:e.email||"",phone:e.phone_number||e.phone||"",whatsappSame:e.whatsapp_same??!0,whatsappNumber:e.whatsapp_number||void 0,authUserId:e.id,clientToken:t,profilePic:e.avatar_url||void 0};return Py(i,t),console.log(" User logged in successfully with client token"),{user:i,clientToken:t}}catch(e){throw console.error(" loginWithClientToken failed:",e),e}}async function N2(t){console.log(" Checking if email exists:",t);try{const{data:e,error:r}=await V.from("profiles").select("email").eq("email",t).limit(1);if(r)return console.error(" Database error:",r),!1;const i=!!(e&&e.length>0);return console.log(i?" Email found in database":" Email not found in database"),i}catch(e){return console.error(" checkEmailExists failed:",e.message),!1}}async function k2(t){console.log(" Sending verification email to:",t);const e=`temp_${Math.random().toString(36).slice(2,15)}_${Date.now()}`,{data:r,error:i}=await V.auth.signUp({email:t,password:e,options:{emailRedirectTo:`${window.location.origin}/`,data:{needs_password_setup:!0}}});if(i){if(console.error(" Signup error details:",{message:i.message,status:i.status,name:i.name}),i.message?.toLowerCase().includes("already")||i.message?.toLowerCase().includes("registered")||i.status===400){console.log(" User might exist, attempting to resend...");try{await Ly(t),console.log(" Resend successful!");return}catch(o){console.error(" Resend also failed:",o),console.log(" Treating as success to avoid confusing user");return}}throw i}r.user&&!r.user.confirmed_at&&r.session===null?console.log(" Verification email sent (user needs to confirm)"):console.log(" Verification email sent successfully")}async function Ly(t){console.log(" Resending verification email to:",t);const{data:e,error:r}=await V.auth.resend({type:"signup",email:t,options:{emailRedirectTo:`${window.location.origin}/`}});if(r)throw console.error(" Resend error details:",{message:r.message,status:r.status,name:r.name}),r.message?.toLowerCase().includes("confirmed")||r.message?.toLowerCase().includes("verified")?(console.log(" Email already confirmed, user should try logging in"),new Error("This email is already verified. Please try logging in with your password.")):r;console.log(" Verification email resent successfully:",e)}async function _2(t,e){console.log(" Logging in with password:",t);const{data:r,error:i}=await V.auth.signInWithPassword({email:t,password:e});if(i)throw console.error(" Login error:",i),i;if(!r.user)throw new Error("No user returned after login");console.log(" Supabase login successful");let o=await V.from("profiles").select("*").eq("id",r.user.id).single();const c=w2();if(o.error){console.log(" Creating new profile...");const{data:u,error:h}=await V.from("profiles").insert({id:r.user.id,email:r.user.email,name:r.user.user_metadata?.name||r.user.email?.split("@")[0]||"User",client_token:c}).select().single();if(h)throw h;o.data=u}else await V.from("profiles").update({client_token:c}).eq("id",r.user.id);const l={id:r.user.id,name:o.data.name||r.user.user_metadata?.name||"User",email:r.user.email,phone:o.data.phone||"",whatsappSame:o.data.whatsapp_same??!0,authUserId:r.user.id,clientToken:c};return Py(l,c),console.log(" User logged in successfully"),{user:l,clientToken:c}}async function S2(t){console.log(" Sending password reset email to:",t);const{error:e}=await V.auth.resetPasswordForEmail(t,{redirectTo:`${window.location.origin}/`});if(e)throw console.error(" Error sending password reset email:",e),e;console.log(" Password reset email sent successfully")}async function C2(t){console.log(" Setting new password...");const{error:e}=await V.auth.updateUser({password:t,data:{needs_password_setup:!1}});if(e)throw console.error(" Error setting password:",e),e;console.log(" Password set successfully")}async function T2(){const{data:{user:t}}=await V.auth.getUser();return t?t.user_metadata?.needs_password_setup===!0:!1}async function Ry(t){const e=tt(),r=nn();if(!e||!r)throw new Error("User not authenticated");console.log(" Updating user profile...",t);try{const{error:i}=await V.from("profiles").update({name:t.name,phone:t.phone,whatsapp_same:t.whatsappSame}).eq("id",e.id);if(i)throw console.error(" Error updating profile:",i),i;const o={...e,...t};localStorage.setItem("oldcycle_user",JSON.stringify(o)),console.log(" Profile updated successfully")}catch(i){throw console.error(" updateUserProfileInDB failed:",i),i}}const Dy=Object.freeze(Object.defineProperty({__proto__:null,checkEmailExists:N2,checkIsAdmin:Iu,getClientToken:nn,getCurrentUser:tt,getOwnerToken:to,isAuthenticated:j2,loginWithClientToken:Iy,loginWithPassword:_2,logout:Ay,needsPasswordSetup:T2,resendVerificationEmail:Ly,sendPasswordResetEmail:S2,sendVerificationEmail:k2,setNewPassword:C2,updateUserProfileInDB:Ry},Symbol.toStringTag,{value:"Module"})),E2={"bangalore-btm-1st-stage":{latitude:12.9116,longitude:77.6103},"bangalore-btm-2nd-stage":{latitude:12.9165,longitude:77.6101},"bangalore-btm-layout":{latitude:12.9141,longitude:77.6097},"bangalore-koramangala-1st-block":{latitude:12.9352,longitude:77.6245},"bangalore-koramangala-2nd-block":{latitude:12.9279,longitude:77.6271},"bangalore-koramangala-3rd-block":{latitude:12.9279,longitude:77.6271},"bangalore-koramangala-4th-block":{latitude:12.9352,longitude:77.6245},"bangalore-koramangala-5th-block":{latitude:12.9352,longitude:77.6245},"bangalore-koramangala-6th-block":{latitude:12.9279,longitude:77.6271},"bangalore-koramangala-7th-block":{latitude:12.9279,longitude:77.6271},"bangalore-koramangala-8th-block":{latitude:12.9352,longitude:77.6245},"bangalore-hsr-sector-1":{latitude:12.9116,longitude:77.6388},"bangalore-hsr-sector-2":{latitude:12.908,longitude:77.647},"bangalore-hsr-sector-3":{latitude:12.914,longitude:77.647},"bangalore-hsr-sector-4":{latitude:12.92,longitude:77.647},"bangalore-hsr-sector-5":{latitude:12.916,longitude:77.653},"bangalore-hsr-sector-6":{latitude:12.91,longitude:77.653},"bangalore-hsr-sector-7":{latitude:12.906,longitude:77.659},"bangalore-whitefield":{latitude:12.9698,longitude:77.7499},"bangalore-marathahalli":{latitude:12.9591,longitude:77.7011},"bangalore-electronic-city":{latitude:12.8456,longitude:77.6603},"bangalore-indiranagar":{latitude:12.9784,longitude:77.6408},"bangalore-jayanagar":{latitude:12.925,longitude:77.59},"bangalore-banashankari":{latitude:12.925,longitude:77.55},"bangalore-jp-nagar":{latitude:12.907,longitude:77.585},"bangalore-malleshwaram":{latitude:13.0067,longitude:77.5703},"bangalore-rajajinagar":{latitude:12.9916,longitude:77.5525},"bangalore-yeshwanthpur":{latitude:13.028,longitude:77.552},"bangalore-hebbal":{latitude:13.0358,longitude:77.597},"bangalore-bellandur":{latitude:12.9266,longitude:77.6766},"bangalore-sarjapur-road":{latitude:12.901,longitude:77.69},"mumbai-andheri-west":{latitude:19.1136,longitude:72.8697},"mumbai-andheri-east":{latitude:19.1136,longitude:72.8697},"mumbai-bandra-west":{latitude:19.0596,longitude:72.8295},"mumbai-bandra-east":{latitude:19.0596,longitude:72.842},"mumbai-powai":{latitude:19.1176,longitude:72.906},"mumbai-goregaon":{latitude:19.1653,longitude:72.849},"mumbai-malad":{latitude:19.187,longitude:72.848},"mumbai-borivali":{latitude:19.2307,longitude:72.8567},"mumbai-dadar":{latitude:19.0178,longitude:72.8478},"mumbai-kurla":{latitude:19.0728,longitude:72.8826},"mumbai-ghatkopar":{latitude:19.086,longitude:72.9081},"mumbai-mulund":{latitude:19.1626,longitude:72.956},"mumbai-thane":{latitude:19.2183,longitude:72.9781},"mumbai-navi-mumbai":{latitude:19.0759,longitude:72.9988},"mumbai-vashi":{latitude:19.0759,longitude:72.9988},"mumbai-worli":{latitude:19.0176,longitude:72.817},"mumbai-lower-parel":{latitude:19.0004,longitude:72.831},"delhi-connaught-place":{latitude:28.6315,longitude:77.2167},"delhi-dwarka":{latitude:28.5921,longitude:77.046},"delhi-rohini":{latitude:28.7468,longitude:77.0688},"delhi-janakpuri":{latitude:28.6219,longitude:77.0854},"delhi-lajpat-nagar":{latitude:28.5678,longitude:77.2432},"delhi-saket":{latitude:28.5244,longitude:77.2066},"delhi-hauz-khas":{latitude:28.5494,longitude:77.2001},"delhi-greater-kailash":{latitude:28.5494,longitude:77.2428},"delhi-noida":{latitude:28.5678,longitude:77.3244},"delhi-gurgaon":{latitude:28.4595,longitude:77.0266},"delhi-faridabad":{latitude:28.4089,longitude:77.3178},"delhi-mayur-vihar":{latitude:28.6085,longitude:77.2958},"delhi-laxmi-nagar":{latitude:28.6345,longitude:77.2769},"chennai-t-nagar":{latitude:13.0418,longitude:80.2341},"chennai-anna-nagar":{latitude:13.085,longitude:80.2101},"chennai-adyar":{latitude:13.0067,longitude:80.257},"chennai-velachery":{latitude:12.975,longitude:80.221},"chennai-tambaram":{latitude:12.925,longitude:80.127},"chennai-porur":{latitude:13.0358,longitude:80.157},"chennai-omr":{latitude:12.94,longitude:80.235},"chennai-ecr":{latitude:12.91,longitude:80.25},"chennai-guindy":{latitude:13.0103,longitude:80.2206},"chennai-mylapore":{latitude:13.0339,longitude:80.2619},"pune-hinjewadi":{latitude:18.5989,longitude:73.7389},"pune-wakad":{latitude:18.5989,longitude:73.7589},"pune-baner":{latitude:18.5589,longitude:73.7889},"pune-aundh":{latitude:18.5589,longitude:73.8089},"pune-kharadi":{latitude:18.5479,longitude:73.9343},"pune-viman-nagar":{latitude:18.5679,longitude:73.9143},"pune-hadapsar":{latitude:18.5089,longitude:73.926},"pune-magarpatta":{latitude:18.5189,longitude:73.931},"pune-kothrud":{latitude:18.5074,longitude:73.8077},"pune-shivajinagar":{latitude:18.5304,longitude:73.8567},"hyderabad-hitech-city":{latitude:17.4483,longitude:78.3808},"hyderabad-gachibowli":{latitude:17.4399,longitude:78.3483},"hyderabad-madhapur":{latitude:17.4483,longitude:78.3915},"hyderabad-kondapur":{latitude:17.4683,longitude:78.3615},"hyderabad-kukatpally":{latitude:17.485,longitude:78.4015},"hyderabad-miyapur":{latitude:17.495,longitude:78.3583},"hyderabad-banjara-hills":{latitude:17.4239,longitude:78.4482},"hyderabad-jubilee-hills":{latitude:17.4239,longitude:78.409},"hyderabad-secunderabad":{latitude:17.4399,longitude:78.4983},"hyderabad-ameerpet":{latitude:17.4378,longitude:78.4482},"kolkata-salt-lake":{latitude:22.5726,longitude:88.4139},"kolkata-new-town":{latitude:22.6026,longitude:88.4639},"kolkata-park-street":{latitude:22.5543,longitude:88.3516},"kolkata-ballygunge":{latitude:22.5326,longitude:88.3639},"kolkata-jadavpur":{latitude:22.4976,longitude:88.3639},"kolkata-howrah":{latitude:22.5726,longitude:88.3239},"kolkata-dum-dum":{latitude:22.6426,longitude:88.4139},"kolkata-behala":{latitude:22.4976,longitude:88.3139}};function Fy(t){return E2[t]||null}const kl=[{id:"1",name:"Mumbai",state:"Maharashtra",latitude:19.076,longitude:72.8777,areas:[{id:"1",name:"Andheri",cityId:"1",latitude:19.1136,longitude:72.8697,sub_areas:[]},{id:"2",name:"Bandra",cityId:"1",latitude:19.0596,longitude:72.8295,sub_areas:[]},{id:"3",name:"Powai",cityId:"1",latitude:19.1176,longitude:72.906,sub_areas:[]}]},{id:"2",name:"Delhi",state:"Delhi",latitude:28.7041,longitude:77.1025,areas:[{id:"4",name:"Connaught Place",cityId:"2",latitude:28.6315,longitude:77.2167,sub_areas:[]},{id:"5",name:"Dwarka",cityId:"2",latitude:28.5921,longitude:77.046,sub_areas:[]},{id:"6",name:"Rohini",cityId:"2",latitude:28.7468,longitude:77.0688,sub_areas:[]}]},{id:"3",name:"Bangalore",state:"Karnataka",latitude:12.9716,longitude:77.5946,areas:[{id:"7",name:"Koramangala",cityId:"3",latitude:12.9352,longitude:77.6245,sub_areas:[]},{id:"8",name:"Whitefield",cityId:"3",latitude:12.9698,longitude:77.7499,sub_areas:[]},{id:"9",name:"Indiranagar",cityId:"3",latitude:12.9784,longitude:77.6408,sub_areas:[]}]}];async function nh(){try{console.log(" [Locations] Fetching cities with 3-level hierarchy (City  Area  Sub-Area)...");let{data:t,error:e}=await V.from("cities").select(`
        id,
        name,
        areas (
          id,
          name,
          slug,
          city_id,
          latitude,
          longitude,
          sub_areas (
            id,
            name,
            area_id,
            latitude,
            longitude,
            landmark,
            slug
          )
        )
      `).order("name");if(console.log(" [Locations] Raw Supabase response:",{cities:t,error:e}),e&&e.code==="42703"){console.warn(" [Locations] Some columns missing, fetching basic data...");const o=await V.from("cities").select(`
          id,
          name,
          areas (
            id,
            name,
            city_id
          )
        `).order("name");if(o.error)return console.error(" [Locations] Fallback fetch failed:",o.error),console.log(" Using mock location data"),kl;t=(o.data||[]).map(c=>({id:c.id,name:c.name,areas:(c.areas||[]).map(l=>({id:l.id,name:l.name,city_id:l.city_id,latitude:null,longitude:null,sub_areas:[]}))})),e=null}if(e)return console.error(" [Locations] Error fetching cities:",e),console.log(" Using mock location data"),kl;if(!t)return console.log(" [Locations] No cities data, using mock"),kl;const r={Mumbai:{lat:19.076,lng:72.8777},Delhi:{lat:28.7041,lng:77.1025},Bangalore:{lat:12.9716,lng:77.5946},Hyderabad:{lat:17.385,lng:78.4867},Chennai:{lat:13.0827,lng:80.2707},Pune:{lat:18.5204,lng:73.8567},Kolkata:{lat:22.5726,lng:88.3639},Mysore:{lat:12.2958,lng:76.6394},Visakhapatnam:{lat:17.6869,lng:83.2185}},i=t.map(o=>{const c=r[o.name]||{lat:20.5937,lng:78.9629},l={id:o.id,name:o.name,state:o.name,latitude:c.lat,longitude:c.lng,areas:(o.areas||[]).map(h=>{let f=h.latitude?parseFloat(h.latitude):null,g=h.longitude?parseFloat(h.longitude):null;if(!f||!g){const y=Fy(h.id);y?(f=y.latitude,g=y.longitude):(f=c.lat,g=c.lng)}const p=(h.sub_areas||[]).map(y=>({id:y.id,area_id:y.area_id,name:y.name,slug:y.slug,latitude:y.latitude?parseFloat(y.latitude):f,longitude:y.longitude?parseFloat(y.longitude):g,landmark:y.landmark}));return p.length>0&&console.log(` [Locations] "${h.name}" has ${p.length} sub-areas:`,p.map(y=>y.name).join(", ")),{id:h.id,name:h.name,slug:h.slug,cityId:h.city_id,latitude:f,longitude:g,sub_areas:p}})},u=l.areas.reduce((h,f)=>h+f.sub_areas.length,0);return console.log(` [Locations] "${o.name}": ${l.areas.length} areas, ${u} sub-areas`),l});return console.log(` [Locations] Loaded ${i.length} cities with 3-level location hierarchy`),i}catch(t){return console.error(" [Locations] Exception:",t),console.log(" Using mock location data"),kl}}function Ri(){return tt()?.id||null}async function Di(t,e,r,i,o,c,l,u="listing"){try{const h=Ri();if(!h)return{conversation:null,error:"Not authenticated"};const f=tt();if(console.log(" [getOrCreateConversation] Starting..."),console.log("  Listing ID:",t),console.log("  Listing Type:",u),console.log("  Current User ID:",h),console.log("  Seller ID (input):",o),!o||o.trim()==="")return console.error(" Invalid seller ID"),{conversation:null,error:"Invalid seller information"};if(o===h)return console.log(" User trying to chat with themselves"),{conversation:null,error:"You cannot chat with yourself"};console.log(" Looking up seller profile...");let g=null,p=o,y=c||"User",v=l||null;const{data:w,error:k}=await V.from("profiles").select("id, client_token, owner_token, display_name, avatar_url").eq("id",o).maybeSingle();if(k&&console.warn(" Error looking up profile by ID:",k),w)console.log(" Found seller profile by ID:",w.id),g=w;else{const{data:_,error:R}=await V.from("profiles").select("id, client_token, owner_token, display_name, avatar_url").eq("owner_token",o).maybeSingle();if(R&&console.warn(" Error looking up profile by owner_token:",R),_)console.log(" Found seller profile by owner_token:",_.id),g=_;else{const{data:L,error:P}=await V.from("profiles").select("id, client_token, owner_token, display_name, avatar_url").eq("client_token",o).maybeSingle();P&&console.warn(" Error looking up profile by client_token:",P),L&&(console.log(" Found seller profile by client_token:",L.id),g=L)}}if(g?(p=g.id,y=g.display_name||c||"User",v=g.avatar_url||l||null,console.log(" Found seller profile:",{id:p,name:y})):(console.warn(" Seller profile not found for ID:",o),console.warn(" Tried: ID lookup, owner_token lookup, client_token lookup"),console.warn(" Creating conversation with provided seller info (orphaned data)"),p=o,y=c||"User",v=l||null),o===h||p===h)return console.log(" User trying to chat with themselves"),{conversation:null,error:"You cannot chat with yourself"};console.log(" Checking for existing conversation...");const{data:N}=await V.from("conversations").select("*").eq("listing_id",t).or(`and(buyer_id.eq.${h},seller_id.eq.${p}),and(buyer_id.eq.${p},seller_id.eq.${h})`).maybeSingle();if(N)return console.log(" Found existing conversation:",N.id),{conversation:N,error:null};console.log(" Creating new conversation...");const C={listing_id:t,listing_title:e,listing_image:r||null,listing_price:i||0,buyer_id:h,buyer_name:f.name,buyer_avatar:f.profilePic||null,seller_id:p,seller_name:y,seller_avatar:v,listingtype:u};console.log(" Conversation data:",C);const{data:A,error:E}=await V.from("conversations").insert(C).select().single();return E?(console.error(" Failed to create conversation:",E),{conversation:null,error:E.message}):(console.log(" Conversation created:",A.id),{conversation:A,error:null})}catch(h){return console.error(" Exception in getOrCreateConversation:",h),{conversation:null,error:h.message||"Failed to create conversation"}}}async function My(){try{const t=Ri();if(!t)return{conversations:[],error:"Not authenticated"};console.log(" [getConversations] Fetching for user:",t);const{data:e,error:r}=await V.from("conversations").select("*").or(`buyer_id.eq.${t},seller_id.eq.${t}`).order("updated_at",{ascending:!1});if(r)return console.error(" Error fetching conversations:",r),{conversations:[],error:null};console.log(` Found ${e?.length||0} conversations`);const o=(await Promise.all((e||[]).map(async l=>{const u=l.listingtype||"listing";if(console.log(` Checking conversation ${l.id.slice(0,8)}... type: ${u}`),u==="task"||u==="wish")return console.log(`   Keeping ${u} conversation`),l;if(u==="listing"){const{data:f}=await V.from("tasks").select("id").eq("id",l.listing_id).maybeSingle();if(f)return console.log("   Found in tasks table, keeping and updating type..."),await V.from("conversations").update({listingtype:"task"}).eq("id",l.id),{...l,listingtype:"task"};const{data:g}=await V.from("wishes").select("id").eq("id",l.listing_id).maybeSingle();if(g)return console.log("   Found in wishes table, keeping and updating type..."),await V.from("conversations").update({listingtype:"wish"}).eq("id",l.id),{...l,listingtype:"wish"}}const{data:h}=await V.from("listings").select("id, is_active").eq("id",l.listing_id).eq("is_active",!0).maybeSingle();return h?(console.log("   Keeping active marketplace listing"),l):(console.log("   Filtering out inactive/deleted marketplace listing"),null)}))).filter(l=>l!==null),c=await Promise.all(o.map(async l=>{const{count:u}=await V.from("messages").select("*",{count:"exact",head:!0}).eq("conversation_id",l.id).neq("sender_id",t).eq("read",!1);return{...l,unread_count:u||0}}));return console.log(` Returning ${c.length} conversations`),{conversations:c,error:null}}catch(t){return console.error(" Exception in getConversations:",t),{conversations:[],error:null}}}async function Oy(t){try{const{data:e,error:r}=await V.from("messages").select("*").eq("conversation_id",t).order("created_at",{ascending:!0});if(r)throw r;return{messages:e||[],error:null}}catch(e){return console.error("Error in getMessages:",e),{messages:[],error:e.message}}}async function Uy(t,e){try{const r=Ri();if(!r)return{message:null,error:"Not authenticated"};const i=tt(),o=e.trim();if(!o)return{message:null,error:"Message cannot be empty"};console.log(" Sending message...");const{data:c,error:l}=await V.from("messages").insert({conversation_id:t,sender_id:r,sender_name:i.name,sender_avatar:i.profilePic,content:o,read:!1}).select().single();if(l)return console.error(" Failed to send message:",l),{message:null,error:l.message};await V.from("conversations").update({last_message:o,last_message_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",t);try{const{data:u}=await V.from("conversations").select("buyer_id, seller_id, listing_title").eq("id",t).single();if(u){const h=u.buyer_id===r?u.seller_id:u.buyer_id,{sendChatMessageNotification:f}=await ys(async()=>{const{sendChatMessageNotification:g}=await Promise.resolve().then(()=>ec);return{sendChatMessageNotification:g}},void 0);await f(h,r,i.name,t,u.listing_title||"Conversation",o)}}catch(u){console.warn(" Notification failed:",u)}return console.log(" Message sent"),{message:c,error:null}}catch(r){return console.error(" Exception in sendMessage:",r),{message:null,error:r.message}}}async function Dl(t){try{const e=Ri();if(!e)return{success:!1,error:"Not authenticated"};const{error:r}=await V.from("messages").update({read:!0}).eq("conversation_id",t).neq("sender_id",e).eq("read",!1);if(r)throw r;return{success:!0,error:null}}catch(e){return console.error("Error in markMessagesAsRead:",e),{success:!1,error:e.message}}}async function $y(){try{const t=Ri();if(!t)return 0;const{data:e}=await V.from("conversations").select("id").or(`buyer_id.eq.${t},seller_id.eq.${t}`);if(!e||e.length===0)return 0;const r=e.map(o=>o.id),{count:i}=await V.from("messages").select("*",{count:"exact",head:!0}).in("conversation_id",r).neq("sender_id",t).eq("read",!1);return i||0}catch(t){return console.error("Error in getTotalUnreadCount:",t),0}}const By=$y;async function Wy(){try{const t=Ri();if(!t)return{success:!1,error:"Not authenticated"};const{data:e}=await V.from("conversations").select("id").or(`buyer_id.eq.${t},seller_id.eq.${t}`);if(!e||e.length===0)return{success:!0,error:null,count:0};const r=e.map(c=>c.id),{count:i}=await V.from("messages").select("*",{count:"exact",head:!0}).in("conversation_id",r).neq("sender_id",t).eq("read",!1);if(!i||i===0)return{success:!0,error:null,count:0};const{error:o}=await V.from("messages").update({read:!0}).in("conversation_id",r).neq("sender_id",t).eq("read",!1);if(o)throw o;return{success:!0,error:null,count:i}}catch(t){return console.error("Error in markAllMessagesAsRead:",t),{success:!1,error:t.message}}}function Vy(t,e){const r=V.channel(`messages:${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`conversation_id=eq.${t}`},i=>{e(i.new)}).subscribe();return()=>{r.unsubscribe(),V.removeChannel(r)}}function ih(t){console.log(" Setting up real-time subscriptions...");const e=V.channel("conversations-changes").on("postgres_changes",{event:"*",schema:"public",table:"conversations"},()=>{console.log(" Conversation changed"),t()}).on("postgres_changes",{event:"*",schema:"public",table:"messages"},()=>{console.log(" Message changed"),t()}).subscribe(r=>{r==="SUBSCRIBED"&&console.log(" Real-time subscriptions active")});return{unsubscribe:()=>{e.unsubscribe(),V.removeChannel(e)}}}async function zy(){return{threadId:null,error:null}}async function qy(){return{threadId:null,error:null}}const yg=Object.freeze(Object.defineProperty({__proto__:null,createTaskChatThread:qy,createWishChatThread:zy,getConversations:My,getMessages:Oy,getOrCreateConversation:Di,getTotalUnreadCount:$y,getUnreadCount:By,markAllMessagesAsRead:Wy,markMessagesAsRead:Dl,sendMessage:Uy,subscribeToConversations:ih,subscribeToMessages:Vy},Symbol.toStringTag,{value:"Module"}));let _l=null,Sl=null;const P2=[{id:"1",title:"iPhone 13 Pro - Excellent Condition",description:"Selling my iPhone 13 Pro in excellent condition. Battery health 95%. No scratches.",price:45e3,categoryId:"1",categoryName:"Electronics",cityId:"1",cityName:"Mumbai",areaId:"1",areaName:"Andheri",images:[],userId:"mock-user-1",createdAt:new Date().toISOString(),isHidden:!1,latitude:19.1136,longitude:72.8697},{id:"2",title:"Study Table with Chair",description:"Wooden study table with matching chair. Good condition, barely used.",price:3500,categoryId:"2",categoryName:"Furniture",cityId:"1",cityName:"Mumbai",areaId:"2",areaName:"Bandra",images:[],userId:"mock-user-2",createdAt:new Date(Date.now()-864e5).toISOString(),isHidden:!1,latitude:19.0596,longitude:72.8295}];function Hy(t,e,r,i){const c=(r-t)*Math.PI/180,l=(i-e)*Math.PI/180,u=Math.sin(c/2)*Math.sin(c/2)+Math.cos(t*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(l/2)*Math.sin(l/2);return 6371*(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)))}async function A2(){if(_l)return _l;try{const{data:t,error:e}=await V.from("categories").select("*").order("name");return e?e.message?.includes("AbortError")||e.code==="PGRST301"?[]:(console.error("[getCategories] Error:",e),[]):(_l=t||[],_l)}catch(t){return t?.message?.includes("AbortError")?[]:(console.error("[getCategories] Unexpected error:",t),[])}}async function I2(){if(Sl)return Sl;try{const{data:t,error:e}=await V.from("cities").select("*").order("name");if(e)return e.message?.includes("AbortError")||e.code==="PGRST301"?[]:(console.error("[getCities] Error fetching cities:",e),[]);const{data:r,error:i}=await V.from("areas").select("*").order("name");return i&&!i.message?.includes("AbortError")&&i.code!=="PGRST301"&&console.error("[getCities] Error fetching areas:",i),Sl=(t||[]).map(c=>({...c,areas:(r||[]).filter(l=>l.city_id===c.id).map(l=>({...l,slug:l.id}))})),Sl}catch(t){return t?.message?.includes("AbortError")?[]:(console.error("[getCities] Unexpected error:",t),[])}}async function Gy(t){const e=await A2(),r=await I2(),i=e.find(l=>l.slug===t.category_slug),o=r.find(l=>l.name===t.city),c=o?.areas.find(l=>l.slug===t.area_slug);return{id:t.id,title:t.title,description:t.description,price:t.price,categoryId:i?.id||"",categoryName:i?.name||"Other",categoryEmoji:i?.emoji||"",cityId:o?.id||"",cityName:o?.name||t.city||"",areaId:c?.id||"",areaName:c?.name||t.area_slug||"",images:t.images||[],phone:t.owner_phone,hasWhatsapp:t.whatsapp_enabled||!1,whatsapp:t.whatsapp_number,userId:t.owner_token,userName:t.owner_name,createdAt:t.created_at,isHidden:!t.is_active,latitude:t.latitude,longitude:t.longitude,distance:t.distance,exactLocation:t.exact_location,address:t.address}}async function ah(t={}){console.log("[Service] getListings called with filters:",t),console.log("[Service]  DEBUGGING: Starting getListings function");const{cursor:e,limit:r=20,includeOwn:i=!1}=t;try{const{getCurrentUser:o}=await ys(async()=>{const{getCurrentUser:N}=await Promise.resolve().then(()=>Dy);return{getCurrentUser:N}},void 0),c=o();console.log(" [getListings] Current user:",c?`ID: ${c.id}`:"GUEST (not logged in)"),console.log(" [getListings] includeOwn flag:",i);let l=V.from("listings").select("*").eq("is_active",!0);console.log(" [getListings] Base query created"),c?.id&&!i?(l=l.neq("owner_token",c.id),console.log(" [Service] Filtering out current user's own listings:",c.id)):console.log(i?" [Service] DEV MODE: Including own listings for testing":" [Service] Guest user - showing ALL listings (no owner filter)"),t.categorySlug&&t.categorySlug!==""&&(console.log("[Service] Filtering by category:",t.categorySlug),l=l.eq("category_slug",t.categorySlug)),t.city&&t.city!==""&&(console.log("[Service] Filtering by city:",t.city),l=l.eq("city",t.city)),t.areaSlug&&t.areaSlug!==""&&(console.log("[Service] Filtering by area:",t.areaSlug),l=l.eq("area_slug",t.areaSlug)),t.searchQuery&&t.searchQuery!==""&&(console.log("[Service] Filtering by search:",t.searchQuery),l=l.ilike("title",`%${t.searchQuery}%`)),t.minPrice&&t.minPrice>0&&(console.log("[Service] Filtering by minPrice:",t.minPrice),l=l.gte("price",t.minPrice)),t.maxPrice&&t.maxPrice>0&&(console.log("[Service] Filtering by maxPrice:",t.maxPrice),l=l.lte("price",t.maxPrice)),e&&(l=l.lt("created_at",e)),l=l.order("created_at",{ascending:!1}).limit(r+1);const{data:u,error:h}=await l;if(h)throw console.error("[Service] Error fetching listings:",h),h;if(console.log(` [getListings] Fetched ${u?.length||0} listings from database`),!u||u.length===0)return console.log(" [getListings] No listings found in database - returning empty array"),{data:[],nextCursor:null};const f=u.length>r,g=f?u.slice(0,r):u,p=f?g[g.length-1].created_at:null,y=await Promise.all(g.map(async N=>{const{data:C}=await V.from("listing_images").select("image_url").eq("listing_id",N.id).order("display_order",{ascending:!0}),A=C?.map(E=>E.image_url)||[];return{...N,images:A}})),k=(await Promise.all(y.map(N=>Gy(N)))).map(N=>{if(t.userLat&&t.userLon&&N.latitude&&N.longitude){const C=Hy(t.userLat,t.userLon,N.latitude,N.longitude);return{...N,distance:C}}return N}).sort((N,C)=>N.distance===void 0&&C.distance===void 0?0:N.distance===void 0?1:C.distance===void 0?-1:N.distance-C.distance);return console.log(` [Listings] Sorted ${k.length} listings by distance`),k.length>0&&k[0].distance!==void 0&&console.log(` [Listings] Nearest: ${k[0].title} at ${k[0].distance.toFixed(1)} km`),{data:k,nextCursor:p}}catch(o){return console.error("[Service] getListings error:",o),console.log(" Using mock listings data as fallback"),{data:P2,nextCursor:null}}}async function hi(t,e,r){if(console.log("[Service] getListingById called with id:",t),!t||t==="undefined"||t==="null"||typeof t!="string")return console.error("[Service] Invalid listing ID:",t),null;try{const{data:i,error:o}=await V.from("listings").select("*").eq("id",t).eq("is_active",!0).maybeSingle();if(o)throw console.error("[Service] Error fetching listing:",o),o;if(!i)return console.log("[Service] Listing not found or inactive:",t),null;const{data:c}=await V.from("listing_images").select("image_url").eq("listing_id",t).order("display_order",{ascending:!0}),l=c?.map(f=>f.image_url)||[],u={...i,images:l},h=await Gy(u);if(e&&r&&h.latitude&&h.longitude){const f=Hy(e,r,h.latitude,h.longitude);return console.log(` [ListingService] Listing distance: ${f.toFixed(2)} km`),{...h,distance:f}}return h}catch(i){throw console.error("[Service] getListingById error:",i),i}}async function L2(t){console.log("[Service] createListing called with payload:",t);try{const e=localStorage.getItem("oldcycle_token"),r=localStorage.getItem("oldcycle_user");if(!e)throw new Error("User not authenticated. Please login first.");console.log("[Service]  Fetching profile to get user ID...");const{data:i,error:o}=await V.from("profiles").select("id, name, phone").eq("client_token",e).order("created_at",{ascending:!0}).limit(1);if(o||!i||i.length===0)throw console.error("[Service]  Error fetching profile:",o),new Error("User profile not found. Please login again.");const c=i[0];console.log("[Service]  Got profile with ID:",c.id);let l=c.name,u=c.phone;if(r)try{const g=JSON.parse(r);l=g.name||c.name,u=g.phone||c.phone}catch(g){console.error("Failed to parse user data:",g)}const{data:h,error:f}=await V.from("listings").insert({owner_token:c.id,owner_name:l,owner_phone:u||t.phone,title:t.title,description:t.description,price:t.price,category_slug:t.categorySlug,area_slug:t.areaSlug,city:t.city,whatsapp_enabled:t.whatsappEnabled,whatsapp_number:t.whatsappNumber,latitude:t.latitude,longitude:t.longitude,address:t.address||null,is_active:!0}).select().single();if(f)throw console.error("[Service] Error creating listing:",f),f;return console.log("[Service] Listing created successfully:",h),console.log("[Service]  Listing owner_token:",h.owner_token),h}catch(e){throw console.error("[Service] createListing error:",e),e}}async function Ky(t,e){console.log("[Service] uploadListingImages called with files:",t.length);try{const r=t.map(async(i,o)=>{const c=i.name.split(".").pop(),l=`${e}/${Date.now()}_${o}.${c}`,{data:u,error:h}=await V.storage.from("listing-images").upload(l,i,{cacheControl:"3600",upsert:!1});if(h)throw h;const{data:f}=V.storage.from("listing-images").getPublicUrl(u.path),{error:g}=await V.from("listing_images").insert({listing_id:e,image_url:f.publicUrl,display_order:o});if(g)throw g;return f.publicUrl});return await Promise.all(r)}catch(r){throw console.error("[Service] uploadListingImages error:",r),r}}async function R2(t){if(console.log(" [Service] getMyListings called with clientToken:",t?"EXISTS":"MISSING"),!t)return console.log(" [Service] No clientToken provided"),[];try{console.log(" [Service] Fetching profile for clientToken...");const{data:e,error:r}=await V.from("profiles").select("id").eq("client_token",t).limit(1);if(console.log(" [Service] Profile query result:",{profilesCount:e?.length||0,hasError:!!r,error:r}),r)return console.error(" [Service] Error fetching profile:",r),[];if(!e||e.length===0)return console.error(" [Service] No profile found for this clientToken"),[];const i=e[0];console.log(" [Service] Got profile ID:",i.id),console.log(" [Service] Fetching listings for user...");const{data:o,error:c}=await V.from("listings").select("*").eq("owner_token",i.id).order("created_at",{ascending:!1});if(console.log(" [Service] Listings query result:",{count:o?.length||0,hasError:!!c,error:c}),c)return console.error(" [Service] Error fetching my listings:",c),[];if(!o||o.length===0)return console.log(" [Service] No listings found for this user"),[];console.log(" [Service] Found",o.length,"listing(s)"),console.log(" [Service] Fetching images for each listing...");const l=await Promise.all(o.map(async u=>{try{const{data:h,error:f}=await V.from("listing_images").select("image_url, display_order").eq("listing_id",u.id).order("display_order",{ascending:!0});if(f)return console.error(` [Service] Error fetching images for listing ${u.id}:`,f),{...u,images:[]};const g=h?h.map(p=>p.image_url):[];return console.log(`   Listing ${u.id}: ${g.length} image(s)`),{...u,images:g}}catch(h){return console.error(` [Service] Error processing images for listing ${u.id}:`,h),{...u,images:[]}}}));return console.log(" [Service] All listings with images prepared"),l}catch(e){return console.error(" [Service] getMyListings error:",e),[]}}async function D2(t,e){console.log("[Service] deleteListing called with id:",t);try{const{data:r,error:i}=await V.from("profiles").select("id").eq("client_token",e).order("created_at",{ascending:!0}).limit(1);if(i||!r||r.length===0)throw console.error("[Service] Error fetching profile for delete:",i),new Error("User profile not found.");const o=r[0].id,{error:c}=await V.from("listings").update({is_active:!1,is_hidden:!0,updated_at:new Date().toISOString()}).eq("id",t).eq("owner_token",o);if(c)throw console.error("[Service] Error deleting listing:",c),c;console.log("[Service]  Listing soft-deleted (hidden from public view)")}catch(r){throw console.error("[Service] deleteListing error:",r),r}}async function F2(t,e){console.log("[Service] updateListing called with id:",t,"updates:",e);try{const r=localStorage.getItem("oldcycle_token");if(!r)throw new Error("User not authenticated. Please login first.");console.log("[Service]  Fetching profile to verify ownership...");const{data:i,error:o}=await V.from("profiles").select("id").eq("client_token",r).order("created_at",{ascending:!0}).limit(1);if(o||!i||i.length===0)throw console.error("[Service]  Error fetching profile:",o),new Error("User profile not found. Please login again.");const c=i[0].id;console.log("[Service]  Got profile UUID");const l={};e.title!==void 0&&(l.title=e.title),e.description!==void 0&&(l.description=e.description),e.price!==void 0&&(l.price=e.price),e.categorySlug!==void 0&&(l.category_slug=e.categorySlug),e.areaSlug!==void 0&&(l.area_slug=e.areaSlug),e.city!==void 0&&(l.city=e.city),e.phone!==void 0&&(l.owner_phone=e.phone),e.whatsappEnabled!==void 0&&(l.whatsapp_enabled=e.whatsappEnabled),e.whatsappNumber!==void 0&&(l.whatsapp_number=e.whatsappNumber),console.log("[Service]  Updating listing with data:",l);const{data:u,error:h}=await V.from("listings").update(l).eq("id",t).eq("owner_token",c).select().single();if(h)throw console.error("[Service] Error updating listing:",h),h;if(!u)throw new Error("Listing not found or you do not have permission to edit it.");return console.log("[Service]  Listing updated successfully"),u}catch(r){throw console.error("[Service] updateListing error:",r),r}}async function M2(t,e){console.log("[Service] deleteListingImages called with:",e.length,"images");try{const r=e.map(async i=>{const{error:o}=await V.from("listing_images").delete().eq("listing_id",t).eq("image_url",i);o&&console.error("[Service] Error deleting image record:",o);try{const c=i.split("/listing-images/");if(c.length>1){const l=c[1].split("?")[0],{error:u}=await V.storage.from("listing-images").remove([l]);u&&console.error("[Service] Error deleting image from storage:",u)}}catch(c){console.error("[Service] Error parsing image URL:",c)}});await Promise.all(r),console.log("[Service]  Images deleted successfully")}catch(r){throw console.error("[Service] deleteListingImages error:",r),r}}const bg=[{id:"1",name:"Electronics",slug:"electronics",emoji:"",type:"listing",sortOrder:1},{id:"2",name:"Furniture",slug:"furniture",emoji:"",type:"listing",sortOrder:2},{id:"3",name:"Clothing",slug:"clothing",emoji:"",type:"listing",sortOrder:3},{id:"4",name:"Books",slug:"books",emoji:"",type:"listing",sortOrder:4},{id:"5",name:"Sports",slug:"sports",emoji:"",type:"listing",sortOrder:5}],vg=[{id:"11",name:"Electronics",slug:"electronics",emoji:"",type:"wish",sortOrder:1},{id:"12",name:"Furniture",slug:"furniture",emoji:"",type:"wish",sortOrder:2},{id:"13",name:"Clothing",slug:"clothing",emoji:"",type:"wish",sortOrder:3},{id:"14",name:"Books",slug:"books",emoji:"",type:"wish",sortOrder:4}],wg=[{id:"21",name:"Home Services",slug:"home-services",emoji:"",type:"task",sortOrder:1},{id:"22",name:"Delivery",slug:"delivery",emoji:"",type:"task",sortOrder:2},{id:"23",name:"Tutoring",slug:"tutoring",emoji:"",type:"task",sortOrder:3},{id:"24",name:"Tech Support",slug:"tech-support",emoji:"",type:"task",sortOrder:4}];async function O2(){try{const{data:t,error:e}=await V.from("categories").select("*").eq("type","listing").order("sort_order",{ascending:!0});return e?(console.error("Failed to fetch marketplace categories:",e),bg):(t||[]).map(r=>({id:r.id,name:r.name,slug:r.slug,emoji:r.emoji||"",type:"listing",sortOrder:r.sort_order}))}catch(t){return console.error("Exception in getMarketplaceCategories:",t),bg}}async function Ti(){return O2()}async function oh(){try{const{data:t,error:e}=await V.from("categories").select("*").eq("type","wish").order("sort_order",{ascending:!0});return e?(console.error("Failed to fetch wish categories:",e),vg):(t||[]).map(r=>({id:r.id,name:r.name,slug:r.slug,emoji:r.emoji||"",type:"wish",sortOrder:r.sort_order}))}catch(t){return console.error("Exception in getWishCategories:",t),vg}}async function lh(){try{const{data:t,error:e}=await V.from("categories").select("*").eq("type","task").order("sort_order",{ascending:!0});return e?(console.error("Failed to fetch task categories:",e),wg):(t||[]).map(r=>({id:r.id,name:r.name,slug:r.slug,emoji:r.emoji||"",type:"task",sortOrder:r.sort_order}))}catch(t){return console.error("Exception in getTaskCategories:",t),wg}}async function Yy({recipients:t,title:e,message:r,type:i,link:o}){try{console.log(" [BROADCAST] Starting broadcast notification..."),console.log("  Recipients mode:",t==="all"?"ALL USERS":`${t.length} specific users`),console.log("  Title:",e),console.log("  Message:",r),console.log("  Type:",i);const c=tt();if(!c?.id)return console.error(" [BROADCAST] Not authenticated - no user found in localStorage"),{success:!1,error:"Not authenticated"};const l=c.id;console.log(" [BROADCAST] Authenticated as:",l);const u=t==="all"?null:t;console.log(" [BROADCAST] Calling PostgreSQL function broadcast_notification()..."),console.log("  Admin ID:",l),console.log("  User IDs (sample):",u?u.slice(0,3):"ALL USERS");const{data:h,error:f}=await V.rpc("broadcast_notification",{p_admin_id:l,p_title:e,p_message:r,p_type:i,p_action_url:o||null,p_user_ids:u});if(f)throw console.error(" [BROADCAST] Error calling function:",f),f;const g=h?.[0];return g?(console.log(" [BROADCAST] Function result:",g),g.success?(console.log(` [BROADCAST] Successfully created ${g.inserted_count} notifications`),console.log(` Broadcast notification sent to ${g.inserted_count} users`),{success:!0,count:g.inserted_count}):(console.error(" [BROADCAST] Function returned error:",g.error_message),{success:!1,error:g.error_message||"Failed to send notification"})):(console.error(" [BROADCAST] No result from function"),{success:!1,error:"No response from broadcast function"})}catch(c){return console.error(" [BROADCAST] Failed to send broadcast notification:",c),console.error("  Error details:",c),{success:!1,error:c.message||"Failed to send notification"}}}async function ch(t){return Qy(t)}async function Jy(t){try{if(!t)return 0;const{count:e,error:r}=await V.from("notifications").select("*",{count:"exact",head:!0}).eq("user_id",t).eq("is_read",!1);if(r){console.warn(" Full notification error object:",JSON.stringify(r,null,2)),console.warn(" Error type:",typeof r),console.warn(" Error keys:",Object.keys(r));const i=r.message||"",o=r.code||"";console.warn(" Extracted - code:",o,"message:",i);const c=Object.keys(r);return c.length===1&&c[0]==="message"&&!i?(console.warn("  NOTIFICATIONS TABLE MISSING!"),console.warn("  ACTION REQUIRED: Run /DATABASE_SETUP_NOTIFICATIONS.sql in Supabase SQL Editor"),console.warn("  Location: Supabase Dashboard  SQL Editor  Paste & Run the SQL file"),0):o==="42P01"||o==="PGRST204"||o==="404"||i.includes("does not exist")||i.includes("relation")||i.includes("not found")?(console.warn(" Notifications table not found. Run DATABASE_SETUP_NOTIFICATIONS.sql"),0):(console.error(" Unknown notification error structure. Returning 0 for safety."),0)}return e||0}catch(e){return console.error("Failed to get unread count (caught exception):",e),0}}async function Qy(t){try{if(!t)return[];const{data:e,error:r}=await V.from("notifications").select("*").eq("user_id",t).order("created_at",{ascending:!1}).limit(50);if(r){console.warn(" Full notification error object:",JSON.stringify(r,null,2)),console.warn(" Error type:",typeof r),console.warn(" Error keys:",Object.keys(r));const i=r.message||"",o=r.code||"";console.warn(" Extracted - code:",o,"message:",i);const c=Object.keys(r);return c.length===1&&c[0]==="message"&&!i?(console.warn("  NOTIFICATIONS TABLE MISSING!"),console.warn("  ACTION REQUIRED: Run /DATABASE_SETUP_NOTIFICATIONS.sql in Supabase SQL Editor"),console.warn("  Location: Supabase Dashboard  SQL Editor  Paste & Run the SQL file"),[]):o==="42P01"||o==="PGRST204"||o==="404"||i.includes("does not exist")||i.includes("relation")||i.includes("not found")?(console.warn(" Notifications table not found. Run DATABASE_SETUP_NOTIFICATIONS.sql"),[]):(console.error(" Unknown notification error structure. Returning empty array for safety."),[])}return e||[]}catch(e){return console.error("Failed to get notifications (caught exception):",e),[]}}async function dh(t){try{const{error:e}=await V.from("notifications").update({is_read:!0}).eq("id",t);if(e)throw e}catch(e){console.error("Failed to mark notification as read:",e)}}async function uh(t){try{const{error:e}=await V.from("notifications").update({is_read:!0}).eq("user_id",t).eq("is_read",!1);if(e)throw e}catch(e){console.error("Failed to mark all as read:",e)}}async function hh(t){try{const{error:e}=await V.from("notifications").delete().eq("id",t);if(e)throw e}catch(e){console.error("Failed to delete notification:",e)}}async function Zy(t){try{const{error:e}=await V.from("notifications").insert({user_id:t,title:"Test Notification",message:"This is a test notification",type:"info",is_read:!1,created_at:new Date().toISOString()});if(e)throw e;console.log(" Test notification created")}catch(e){console.error("Failed to create test notification:",e)}}function mh(t,e){return V.channel("notifications").on("postgres_changes",{event:"*",schema:"public",table:"notifications",filter:`user_id=eq.${t}`},()=>{e()}).subscribe()}async function U2(t,e,r,i){try{const{data:o,error:c}=await V.from("profiles").select("id").eq("id",t).single();if(c||!o)return console.warn(` Cannot send task accepted notification - user ${t} not found in profiles table`),!1;const{error:l}=await V.from("notifications").insert({user_id:t,title:"Task Accepted!",message:`${i} has accepted your task`,type:"task_accepted",related_type:"task",related_id:e,metadata:{taskTitle:r,helperName:i},is_read:!1,created_at:new Date().toISOString()});return l?(console.error("Failed to send task accepted notification:",l),!1):!0}catch(o){return console.error("Failed to send task accepted notification:",o),!1}}async function $2(t,e,r,i){try{const{data:o,error:c}=await V.from("profiles").select("id").eq("id",t).single();if(c||!o)return console.warn(` Cannot send task cancelled notification - user ${t} not found in profiles table`),!1;const{error:l}=await V.from("notifications").insert({user_id:t,title:"Task Cancelled",message:`${i} has cancelled the task`,type:"task_cancelled",related_type:"task",related_id:e,metadata:{taskTitle:r,cancellerName:i},is_read:!1,created_at:new Date().toISOString()});return l?(console.error("Failed to send task cancelled notification:",l),!1):!0}catch(o){return console.error("Failed to send task cancelled notification:",o),!1}}async function B2(t,e,r,i,o,c){try{if(t===e)return console.log(" Skipping notification - sender is recipient"),!0;const{data:l,error:u}=await V.from("profiles").select("id").eq("id",t).single();if(u||!l)return console.warn(` Cannot send notification - recipient ${t} not found in profiles table`),console.warn("   This can happen if the profile was deleted or conversation has invalid user_id"),!1;const{error:h}=await V.from("notifications").insert({user_id:t,title:"New Message",message:`${r}: ${c.substring(0,50)}${c.length>50?"...":""}`,type:"chat_message",related_type:"chat",related_id:i,action_url:`/chat/${i}`,metadata:{conversationId:i,senderId:e,senderName:r,listingTitle:o,messagePreview:c},is_read:!1,created_at:new Date().toISOString()});return h?(console.error(" Failed to send chat message notification:",h),!1):(console.log(` Chat notification sent to ${t}`),!0)}catch(l){return console.error(" Failed to send chat message notification:",l),!1}}async function W2(t,e,r,i){try{const{data:o,error:c}=await V.from("profiles").select("id").eq("id",t).single();if(c||!o)return console.warn(` Cannot send listing inquiry notification - owner ${t} not found`),!1;const{error:l}=await V.from("notifications").insert({user_id:t,title:"New Inquiry",message:`${i} is interested in "${r}"`,type:"listing",related_type:"listing",related_id:e,action_url:`/listing/${e}`,metadata:{listingTitle:r,inquirerName:i,listingId:e},is_read:!1,created_at:new Date().toISOString()});return l?(console.error(" Failed to send listing inquiry notification:",l),!1):(console.log(` Listing inquiry notification sent to ${t}`),!0)}catch(o){return console.error(" Failed to send listing inquiry notification:",o),!1}}async function V2(t,e,r,i){try{const{data:o,error:c}=await V.from("profiles").select("id").eq("id",t).single();if(c||!o)return console.warn(` Cannot send wish offer notification - owner ${t} not found`),!1;const{error:l}=await V.from("notifications").insert({user_id:t,title:"Someone Can Help! ",message:`${i} wants to help with "${r}"`,type:"wish",related_type:"wish",related_id:e,action_url:`/wish/${e}`,metadata:{wishTitle:r,helperName:i,wishId:e},is_read:!1,created_at:new Date().toISOString()});return l?(console.error(" Failed to send wish offer notification:",l),!1):(console.log(` Wish offer notification sent to ${t}`),!0)}catch(o){return console.error(" Failed to send wish offer notification:",o),!1}}async function z2(t,e,r,i){try{const{data:o,error:c}=await V.from("profiles").select("id").eq("id",t).single();if(c||!o)return console.warn(` Cannot send wish accepted notification - helper ${t} not found`),!1;const{error:l}=await V.from("notifications").insert({user_id:t,title:"Your Help Was Accepted! ",message:`${i} accepted your offer to help with "${r}"`,type:"wish",related_type:"wish",related_id:e,action_url:`/wish/${e}`,metadata:{wishTitle:r,wishOwnerName:i,wishId:e},is_read:!1,created_at:new Date().toISOString()});return l?(console.error(" Failed to send wish accepted notification:",l),!1):(console.log(` Wish accepted notification sent to ${t}`),!0)}catch(o){return console.error(" Failed to send wish accepted notification:",o),!1}}async function q2(t,e,r,i,o){try{const{data:c,error:l}=await V.from("profiles").select("id").eq("id",t).single();if(l||!c)return console.warn(` Cannot send wish status notification - user ${t} not found`),!1;let u="Wish Updated",h="";switch(i){case"completed":u="Wish Completed! ",h=`Your wish "${r}" has been completed`;break;case"cancelled":u="Wish Cancelled",h=`The wish "${r}" was cancelled by ${o}`;break;case"in_progress":u="Wish In Progress",h=`Work has started on "${r}"`;break;default:h=`Status changed to ${i} for "${r}"`}const{error:f}=await V.from("notifications").insert({user_id:t,title:u,message:h,type:"wish",related_type:"wish",related_id:e,action_url:`/wish/${e}`,metadata:{wishTitle:r,newStatus:i,changedByName:o,wishId:e},is_read:!1,created_at:new Date().toISOString()});return f?(console.error(" Failed to send wish status notification:",f),!1):(console.log(` Wish status notification sent to ${t}`),!0)}catch(c){return console.error(" Failed to send wish status notification:",c),!1}}async function H2(t,e,r,i){try{const{data:o,error:c}=await V.from("profiles").select("id").eq("id",t).single();if(c||!o)return console.warn(` Cannot send task completion request - owner ${t} not found`),!1;const{error:l}=await V.from("notifications").insert({user_id:t,title:"Task Completion Request",message:`${i} has marked "${r}" as complete. Please confirm.`,type:"task_completion_request",related_type:"task",related_id:e,action_url:`/task/${e}`,metadata:{taskTitle:r,helperName:i,taskId:e},is_read:!1,created_at:new Date().toISOString()});return l?(console.error(" Failed to send task completion request:",l),!1):(console.log(` Task completion request sent to ${t}`),!0)}catch(o){return console.error(" Failed to send task completion request:",o),!1}}async function G2(t,e,r,i){try{const{data:o,error:c}=await V.from("profiles").select("id").eq("id",t).single();if(c||!o)return console.warn(` Cannot send task completed notification - helper ${t} not found`),!1;const{error:l}=await V.from("notifications").insert({user_id:t,title:"Task Completed! ",message:`${i} confirmed completion of "${r}"`,type:"task_completed",related_type:"task",related_id:e,action_url:`/task/${e}`,metadata:{taskTitle:r,taskOwnerName:i,taskId:e},is_read:!1,created_at:new Date().toISOString()});return l?(console.error(" Failed to send task completed notification:",l),!1):(console.log(` Task completed notification sent to ${t}`),!0)}catch(o){return console.error(" Failed to send task completed notification:",o),!1}}async function K2(t,e,r,i,o){try{const{data:c,error:l}=await V.from("profiles").select("id").eq("id",t).single();if(l||!c)return console.warn(` Cannot send task offer notification - owner ${t} not found`),!1;const{error:u}=await V.from("notifications").insert({user_id:t,title:"New Task Offer ",message:`${o} offered ${i.toLocaleString("en-IN")} for "${r}"`,type:"task",related_type:"task",related_id:e,action_url:`/task/${e}`,metadata:{taskTitle:r,offerAmount:i,helperName:o,taskId:e},is_read:!1,created_at:new Date().toISOString()});return u?(console.error(" Failed to send task offer notification:",u),!1):(console.log(` Task offer notification sent to ${t}`),!0)}catch(c){return console.error(" Failed to send task offer notification:",c),!1}}async function Y2(t){try{const{data:e,error:r}=await V.from("profiles").select("id").eq("id",t.userId).single();if(r||!e)return console.warn(` Cannot send notification - user ${t.userId} not found in profiles table`),!1;let i=t.type,o=t.taskId||t.wishId||t.listingId||void 0;const c={...t.metadata,actionLabel:t.actionLabel},{error:l}=await V.from("notifications").insert({user_id:t.userId,title:t.title,message:t.message,type:t.type,related_type:i,related_id:o,action_url:t.actionUrl,metadata:c,is_read:!1,created_at:new Date().toISOString()});return l?(console.error(" Failed to create notification:",l),!1):(console.log(` Notification created for user ${t.userId}`),!0)}catch(e){return console.error(" Failed to create notification:",e),!1}}const ec=Object.freeze(Object.defineProperty({__proto__:null,createNotification:Y2,createTestNotification:Zy,deleteNotification:hh,getNotifications:ch,getUnreadCount:Jy,getUserNotifications:Qy,markAllAsRead:uh,markAsRead:dh,sendBroadcastNotification:Yy,sendChatMessageNotification:B2,sendListingInquiryNotification:W2,sendTaskAcceptedNotification:U2,sendTaskCancelledNotification:$2,sendTaskCompletedNotification:G2,sendTaskCompletionRequestNotification:H2,sendTaskOfferNotification:K2,sendWishOfferAcceptedNotification:z2,sendWishOfferNotification:V2,sendWishStatusChangeNotification:q2,subscribeToNotifications:mh},Symbol.toStringTag,{value:"Module"})),Cl=t=>!t||t==="auto-detected"||t==="undefined"||t==="null"?null:t;function Fi(t){const[e,r]=j.useState(null),[i,o]=j.useState(!0),[c,l]=j.useState(null),[u,h]=j.useState(!1),f={cityId:null,city:"Bangalore",areaId:null,area:"",latitude:12.9716,longitude:77.5946,address:"Bangalore, Karnataka, India",state:"Karnataka",detectionMethod:"manual"};j.useEffect(()=>{if(!t){const v=localStorage.getItem("localfelo_guest_location")||localStorage.getItem("oldcycle_guest_location");if(v)try{const w=JSON.parse(v);console.log(" [useLocation] Loaded guest location from localStorage:",w),r(w)}catch(w){console.error(" [useLocation] Failed to parse guest location:",w),localStorage.removeItem("localfelo_guest_location"),localStorage.removeItem("oldcycle_guest_location"),console.log(" [useLocation] Setting default location: Bangalore"),r(f)}else console.log(" [useLocation] No saved location - setting default: Bangalore"),r(f);o(!1),h(!0);return}g()},[t]),j.useEffect(()=>{const v=k=>{if(k.key==="localfelo_location_version")if(console.log(" [useLocation] Location version changed (cross-tab) - reloading location"),t)g();else{const N=localStorage.getItem("localfelo_guest_location")||localStorage.getItem("oldcycle_guest_location");if(N)try{const C=JSON.parse(N);console.log(" [useLocation] Reloaded guest location after change:",C),r(C)}catch(C){console.error(" [useLocation] Failed to parse guest location after change:",C)}}},w=k=>{const N=k;console.log(" [useLocation] Location changed (same-tab) - updating location:",N.detail),r(N.detail)};return window.addEventListener("storage",v),window.addEventListener("locationChanged",w),()=>{window.removeEventListener("storage",v),window.removeEventListener("locationChanged",w)}},[t]);const g=async()=>{if(t)try{o(!0);const v=localStorage.getItem("localfelo_guest_location")||localStorage.getItem("oldcycle_guest_location");let w=null;if(v)try{w=JSON.parse(v),console.log(" [useLocation] Found localStorage fallback:",w),r(w)}catch(C){console.error(" [useLocation] Failed to parse localStorage fallback:",C)}const{data:k,error:N}=await V.from("profiles").select("city_id, city, area_id, area, sub_area_id, sub_area, latitude, longitude, location_updated_at").eq("id",t).single();if(N){if(N.code==="42703"||N.code==="PGRST204"){console.warn(" [useLocation] sub_area columns not found, using 2-level location");const{data:C,error:A}=await V.from("profiles").select("city_id, city, area_id, area, latitude, longitude, location_updated_at").eq("id",t).single();if(A){console.error(" [useLocation] Error loading location (retry):",A),w||r(null),l(null),o(!1),h(!0);return}C&&C.city&&C.latitude&&C.longitude?r({cityId:Cl(C.city_id),city:C.city,areaId:Cl(C.area_id)||"",area:C.area||"",latitude:parseFloat(C.latitude),longitude:parseFloat(C.longitude),updatedAt:C.location_updated_at}):w||r(null),o(!1),h(!0);return}console.error(" [useLocation] Error loading location:",N),w||l("Failed to load location"),o(!1),h(!0);return}if(k&&k.city&&k.latitude&&k.longitude){const C={cityId:Cl(k.city_id),city:k.city,areaId:Cl(k.area_id)||"",area:k.area||"",subAreaId:k.sub_area_id||void 0,subArea:k.sub_area||void 0,latitude:parseFloat(k.latitude),longitude:parseFloat(k.longitude),updatedAt:k.location_updated_at};console.log(" [useLocation] Loaded location from database:",C),r(C)}else console.log(" [useLocation] No location in database"),w?console.log(" [useLocation] Using localStorage fallback since database is empty"):(console.log(" [useLocation] Setting default location for logged-in user: Bangalore"),r(f));o(!1),h(!0)}catch(v){console.error(" [useLocation] Exception:",v),l("Failed to load location"),o(!1),h(!0)}};return{location:e,loading:i,error:c,hasAttemptedLoad:u,updateLocation:async v=>{if(console.log(" [useLocation] updateLocation called"),console.log(" [useLocation] New location:",v),console.log(" [useLocation] User ID:",t),!t){console.log(" [useLocation] Saving to localStorage (guest user)");const w=v.latitude,k=v.longitude;if(!w||!k){console.error(" [useLocation] No coordinates provided for guest location"),l("Location coordinates missing");return}const N={...v,latitude:w,longitude:k,updatedAt:new Date().toISOString()};localStorage.setItem("localfelo_guest_location",JSON.stringify(N)),localStorage.setItem("oldcycle_guest_location",JSON.stringify(N)),localStorage.setItem("localfelo_location_version",Date.now().toString()),console.log(" [useLocation] Guest location saved and version updated:",N),window.dispatchEvent(new CustomEvent("locationChanged",{detail:N})),r(N),l(null);return}try{o(!0),l(null);let w=v.latitude,k=v.longitude;if((!w||!k)&&(console.log(" [useLocation] No coordinates provided, fetching from area..."),v.areaId)){const A=Fy(v.areaId);if(A)w=A.latitude,k=A.longitude,console.log(` [useLocation] Using fallback coords for area ${v.areaId}: ${w}, ${k}`);else{const{data:E,error:_}=await V.from("areas").select("latitude, longitude").eq("id",v.areaId).single();!_&&E&&E.latitude&&E.longitude&&(w=parseFloat(E.latitude),k=parseFloat(E.longitude),console.log(` [useLocation] Using database coords for area: ${w}, ${k}`))}}if(!w||!k){console.error(" [useLocation] Could not determine coordinates"),l("Failed to determine location coordinates"),o(!1);return}console.log(" [useLocation] Final coordinates (from AREA):",{finalLat:w,finalLon:k});const{error:N}=await V.from("profiles").update({city_id:v.cityId,city:v.city,area_id:v.areaId||null,area:v.area||null,sub_area_id:v.subAreaId||null,sub_area:v.subArea||null,latitude:w,longitude:k,location_updated_at:new Date().toISOString()}).eq("id",t);if(N){if(N.code==="PGRST204"||N.code==="42703"){console.warn(" [useLocation] sub_area columns not found, updating without them (2-level)"),console.log(" [useLocation] To enable 3-level location, run /COMPLETE_3_LEVEL_LOCATION_SETUP.sql");const{error:A}=await V.from("profiles").update({city_id:v.cityId,city:v.city,area_id:v.areaId||null,area:v.area||null,latitude:w,longitude:k,location_updated_at:new Date().toISOString()}).eq("id",t);if(A){console.error(" [useLocation] Retry update failed:",A),l("Failed to update location"),o(!1);return}console.log(" [useLocation] Location saved (2-level only, no sub-area)"),localStorage.setItem("localfelo_location_version",Date.now().toString()),r({...v,subAreaId:void 0,subArea:void 0,latitude:w,longitude:k,updatedAt:new Date().toISOString()}),o(!1);return}console.error(" [useLocation] Update failed:",N),l("Failed to update location"),o(!1);return}console.log(" [useLocation] Location saved to database (3-level)"),localStorage.setItem("localfelo_location_version",Date.now().toString());const C={...v,latitude:w,longitude:k,updatedAt:new Date().toISOString()};window.dispatchEvent(new CustomEvent("locationChanged",{detail:C})),r(C),o(!1)}catch(w){console.error(" [useLocation] Exception:",w),l("Failed to update location"),o(!1)}},clearLocation:async()=>{if(!t){localStorage.removeItem("localfelo_guest_location"),localStorage.removeItem("oldcycle_guest_location"),r(null);return}try{o(!0);const{error:v}=await V.from("profiles").update({city_id:null,city:null,area_id:null,area:null,sub_area_id:null,sub_area:null,latitude:null,longitude:null,location_updated_at:null}).eq("id",t);if(v)if(v.code==="PGRST204"||v.code==="42703"){const{error:w}=await V.from("profiles").update({city_id:null,city:null,area_id:null,area:null,latitude:null,longitude:null,location_updated_at:null}).eq("id",t);if(w){console.error(" [useLocation] Error clearing location:",w),l("Failed to clear location"),o(!1);return}}else{console.error(" [useLocation] Error clearing location:",v),l("Failed to clear location"),o(!1);return}r(null),o(!1)}catch(v){console.error(" [useLocation] Exception:",v),l("Failed to clear location"),o(!1)}}}}function J2(t){const[e,r]=j.useState([]),[i,o]=j.useState(0),[c,l]=j.useState(!0);j.useEffect(()=>{if(!t){r([]),o(0),l(!1);return}u()},[t]),j.useEffect(()=>{if(!t)return;const p=mh(t,()=>{u()});return()=>{p.unsubscribe()}},[t]);const u=async()=>{if(t)try{l(!0);const[p,y]=await Promise.all([ch(t),Jy(t)]);r(p),o(y)}catch(p){console.error("Failed to load notifications:",p)}finally{l(!1)}};return{notifications:e,unreadCount:i,loading:c,markAsRead:async p=>{try{await dh(p),r(y=>y.map(v=>v.id===p?{...v,is_read:!0}:v)),o(y=>Math.max(0,y-1))}catch(y){console.error("Failed to mark as read:",y)}},markAllAsRead:async()=>{if(t)try{await uh(t),r(p=>p.map(y=>({...y,is_read:!0}))),o(0)}catch(p){console.error("Failed to mark all as read:",p)}},deleteNotification:async p=>{const y=e.find(v=>v.id===p);try{await hh(p),r(v=>v.filter(w=>w.id!==p)),y&&!y.is_read&&o(v=>Math.max(0,v-1))}catch(v){console.error("Failed to delete notification:",v)}},refresh:u}}async function Q2(){try{return console.log("[PushClient] requestPushPermission called (stub implementation)"),!1}catch(t){return console.error("[PushClient] Error requesting push permission:",t),!1}}async function Z2(t){try{return console.log("[PushClient] registerPushToken called (stub implementation)",{tokenLength:t?.length||0,tokenPreview:t?.substring(0,10)+"..."}),!0}catch(e){return console.error("[PushClient] Error registering push token:",e),!1}}function X2(){try{const t=window.isSecureContext,e="Notification"in window,r="serviceWorker"in navigator,i=t&&e&&r;return i||console.log("[PushClient] Push notifications not supported:",{isSecureContext:t,hasNotificationAPI:e,hasServiceWorker:r}),i}catch(t){return console.error("[PushClient] Error checking push support:",t),!1}}function Xy(){try{return"Notification"in window?Notification.permission:"unavailable"}catch(t){return console.error("[PushClient] Error getting permission status:",t),"unavailable"}}function ek(t){const[e,r]=j.useState({isSupported:!1,permission:"unavailable",isRegistered:!1,isLoading:!1}),i=j.useRef(!1),o=j.useRef(null);return j.useEffect(()=>{if(!t){console.log("[usePushNotifications] No userId provided, skipping"),i.current=!1,o.current=null,r({isSupported:!1,permission:"unavailable",isRegistered:!1,isLoading:!1});return}o.current&&o.current!==t&&(console.log("[usePushNotifications] User changed, resetting registration"),i.current=!1),o.current=t;const c=X2(),l=Xy();if(r(u=>({...u,isSupported:c,permission:l})),!(!c||i.current))return i.current=!0,tk(t,r),()=>{console.log("[usePushNotifications] Cleanup")}},[t]),e}async function tk(t,e){try{console.log("[usePushNotifications] Attempting push registration for user:",t),e(l=>({...l,isLoading:!0}));const r=await Q2();if(e(l=>({...l,permission:r?"granted":Xy()})),!r){console.log("[usePushNotifications] Permission not granted, skipping registration"),e(l=>({...l,isLoading:!1}));return}const i=await sk();if(!i){console.log("[usePushNotifications] No push token available"),e(l=>({...l,isLoading:!1}));return}if(!await Z2(i)){console.log("[usePushNotifications] Failed to register token with backend"),e(l=>({...l,isLoading:!1}));return}const c=await rk(t,i);e(l=>({...l,isRegistered:c,isLoading:!1})),c&&console.log("[usePushNotifications]  Push notifications registered successfully")}catch(r){console.error("[usePushNotifications] Error during registration:",r),e(i=>({...i,isLoading:!1,isRegistered:!1}))}}async function sk(){try{return console.log("[usePushNotifications] getPushTokenFromProvider (stub implementation)"),null}catch(t){return console.error("[usePushNotifications] Error getting push token:",t),null}}async function rk(t,e){try{console.log("[usePushNotifications] Storing push token in database");const{error:r}=await V.from("push_tokens").upsert({user_id:t,token:e,platform:"web",is_active:!0,updated_at:new Date().toISOString()},{onConflict:"token"});return r?(console.error("[usePushNotifications] Database error:",r),!1):(console.log("[usePushNotifications]  Token stored in database"),!0)}catch(r){return console.error("[usePushNotifications] Error storing token:",r),!1}}function Ar({isOpen:t,onClose:e,title:r,children:i,showClose:o=!0,preventClose:c=!1}){if(j.useEffect(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[t]),!t)return null;const l=()=>{c||e()};return s.jsxs("div",{className:"fixed inset-0 z-[100] flex items-end md:items-center justify-center",children:[s.jsx("div",{className:"absolute inset-0 bg-black/60",onClick:l}),s.jsxs("div",{className:"relative w-full max-w-lg bg-card rounded-t md:rounded border border-border max-h-[90vh] overflow-hidden flex flex-col animate-in",children:[(r||o)&&s.jsxs("div",{className:"flex items-center justify-between p-5 border-b border-border",children:[r&&s.jsx("h2",{className:"text-heading m-0 font-bold text-[20px]",children:r}),o&&s.jsx("button",{onClick:l,disabled:c,className:"p-2 -mr-2 hover:bg-input rounded active:scale-95 transition-all disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Close",children:s.jsx(ut,{className:"w-5 h-5 text-heading"})})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-5",children:i})]})]})}const fh=j.createContext({});function ph(t){const e=j.useRef(null);return e.current===null&&(e.current=t()),e.current}const tc=j.createContext(null),gh=j.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class nk extends j.Component{getSnapshotBeforeUpdate(e){const r=this.props.childRef.current;if(r&&e.isPresent&&!this.props.isPresent){const i=this.props.sizeRef.current;i.height=r.offsetHeight||0,i.width=r.offsetWidth||0,i.top=r.offsetTop,i.left=r.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function ik({children:t,isPresent:e}){const r=j.useId(),i=j.useRef(null),o=j.useRef({width:0,height:0,top:0,left:0}),{nonce:c}=j.useContext(gh);return j.useInsertionEffect(()=>{const{width:l,height:u,top:h,left:f}=o.current;if(e||!i.current||!l||!u)return;i.current.dataset.motionPopId=r;const g=document.createElement("style");return c&&(g.nonce=c),document.head.appendChild(g),g.sheet&&g.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${l}px !important;
            height: ${u}px !important;
            top: ${h}px !important;
            left: ${f}px !important;
          }
        `),()=>{document.head.removeChild(g)}},[e]),s.jsx(nk,{isPresent:e,childRef:i,sizeRef:o,children:j.cloneElement(t,{ref:i})})}const ak=({children:t,initial:e,isPresent:r,onExitComplete:i,custom:o,presenceAffectsLayout:c,mode:l})=>{const u=ph(ok),h=j.useId(),f=j.useCallback(p=>{u.set(p,!0);for(const y of u.values())if(!y)return;i&&i()},[u,i]),g=j.useMemo(()=>({id:h,initial:e,isPresent:r,custom:o,onExitComplete:f,register:p=>(u.set(p,!1),()=>u.delete(p))}),c?[Math.random(),f]:[r,f]);return j.useMemo(()=>{u.forEach((p,y)=>u.set(y,!1))},[r]),j.useEffect(()=>{!r&&!u.size&&i&&i()},[r]),l==="popLayout"&&(t=s.jsx(ik,{isPresent:r,children:t})),s.jsx(tc.Provider,{value:g,children:t})};function ok(){return new Map}function e0(t=!0){const e=j.useContext(tc);if(e===null)return[!0,null];const{isPresent:r,onExitComplete:i,register:o}=e,c=j.useId();j.useEffect(()=>{t&&o(c)},[t]);const l=j.useCallback(()=>t&&i&&i(c),[c,i,t]);return!r&&i?[!1,l]:[!0]}const Tl=t=>t.key||"";function jg(t){const e=[];return j.Children.forEach(t,r=>{j.isValidElement(r)&&e.push(r)}),e}const xh=typeof window<"u",t0=xh?j.useLayoutEffect:j.useEffect,lk=({children:t,custom:e,initial:r=!0,onExitComplete:i,presenceAffectsLayout:o=!0,mode:c="sync",propagate:l=!1})=>{const[u,h]=e0(l),f=j.useMemo(()=>jg(t),[t]),g=l&&!u?[]:f.map(Tl),p=j.useRef(!0),y=j.useRef(f),v=ph(()=>new Map),[w,k]=j.useState(f),[N,C]=j.useState(f);t0(()=>{p.current=!1,y.current=f;for(let _=0;_<N.length;_++){const R=Tl(N[_]);g.includes(R)?v.delete(R):v.get(R)!==!0&&v.set(R,!1)}},[N,g.length,g.join("-")]);const A=[];if(f!==w){let _=[...f];for(let R=0;R<N.length;R++){const L=N[R],P=Tl(L);g.includes(P)||(_.splice(R,0,L),A.push(L))}c==="wait"&&A.length&&(_=A),C(jg(_)),k(f);return}const{forceRender:E}=j.useContext(fh);return s.jsx(s.Fragment,{children:N.map(_=>{const R=Tl(_),L=l&&!u?!1:f===N||g.includes(R),P=()=>{if(v.has(R))v.set(R,!0);else return;let D=!0;v.forEach(H=>{H||(D=!1)}),D&&(E?.(),C(y.current),l&&h?.(),i&&i())};return s.jsx(ak,{isPresent:L,initial:!p.current||r?void 0:!1,custom:L?void 0:e,presenceAffectsLayout:o,mode:c,onExitComplete:L?void 0:P,children:_},R)})})},vs=t=>t;let s0=vs;const ck={useManualTiming:!1};function dk(t){let e=new Set,r=new Set,i=!1,o=!1;const c=new WeakSet;let l={delta:0,timestamp:0,isProcessing:!1};function u(f){c.has(f)&&(h.schedule(f),t()),f(l)}const h={schedule:(f,g=!1,p=!1)=>{const v=p&&i?e:r;return g&&c.add(f),v.has(f)||v.add(f),f},cancel:f=>{r.delete(f),c.delete(f)},process:f=>{if(l=f,i){o=!0;return}i=!0,[e,r]=[r,e],e.forEach(u),e.clear(),i=!1,o&&(o=!1,h.process(f))}};return h}const El=["read","resolveKeyframes","update","preRender","render","postRender"],uk=40;function r0(t,e){let r=!1,i=!0;const o={delta:0,timestamp:0,isProcessing:!1},c=()=>r=!0,l=El.reduce((C,A)=>(C[A]=dk(c),C),{}),{read:u,resolveKeyframes:h,update:f,preRender:g,render:p,postRender:y}=l,v=()=>{const C=performance.now();r=!1,o.delta=i?1e3/60:Math.max(Math.min(C-o.timestamp,uk),1),o.timestamp=C,o.isProcessing=!0,u.process(o),h.process(o),f.process(o),g.process(o),p.process(o),y.process(o),o.isProcessing=!1,r&&e&&(i=!1,t(v))},w=()=>{r=!0,i=!0,o.isProcessing||t(v)};return{schedule:El.reduce((C,A)=>{const E=l[A];return C[A]=(_,R=!1,L=!1)=>(r||w(),E.schedule(_,R,L)),C},{}),cancel:C=>{for(let A=0;A<El.length;A++)l[El[A]].cancel(C)},state:o,steps:l}}const{schedule:dt,cancel:an,state:Vt,steps:ou}=r0(typeof requestAnimationFrame<"u"?requestAnimationFrame:vs,!0),n0=j.createContext({strict:!1}),Ng={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Ei={};for(const t in Ng)Ei[t]={isEnabled:e=>Ng[t].some(r=>!!e[r])};function hk(t){for(const e in t)Ei[e]={...Ei[e],...t[e]}}const mk=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Vl(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||mk.has(t)}let i0=t=>!Vl(t);function fk(t){t&&(i0=e=>e.startsWith("on")?!Vl(e):t(e))}try{fk(require("@emotion/is-prop-valid").default)}catch{}function pk(t,e,r){const i={};for(const o in t)o==="values"&&typeof t.values=="object"||(i0(o)||r===!0&&Vl(o)||!e&&!Vl(o)||t.draggable&&o.startsWith("onDrag"))&&(i[o]=t[o]);return i}function gk(t){if(typeof Proxy>"u")return t;const e=new Map,r=(...i)=>t(...i);return new Proxy(r,{get:(i,o)=>o==="create"?t:(e.has(o)||e.set(o,t(o)),e.get(o))})}const sc=j.createContext({});function Ga(t){return typeof t=="string"||Array.isArray(t)}function rc(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const yh=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],bh=["initial",...yh];function nc(t){return rc(t.animate)||bh.some(e=>Ga(t[e]))}function a0(t){return!!(nc(t)||t.variants)}function xk(t,e){if(nc(t)){const{initial:r,animate:i}=t;return{initial:r===!1||Ga(r)?r:void 0,animate:Ga(i)?i:void 0}}return t.inherit!==!1?e:{}}function yk(t){const{initial:e,animate:r}=xk(t,j.useContext(sc));return j.useMemo(()=>({initial:e,animate:r}),[kg(e),kg(r)])}function kg(t){return Array.isArray(t)?t.join(" "):t}const bk=Symbol.for("motionComponentSymbol");function bi(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function vk(t,e,r){return j.useCallback(i=>{i&&t.onMount&&t.onMount(i),e&&(i?e.mount(i):e.unmount()),r&&(typeof r=="function"?r(i):bi(r)&&(r.current=i))},[e])}const vh=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),wk="framerAppearId",o0="data-"+vh(wk),{schedule:wh}=r0(queueMicrotask,!1),l0=j.createContext({});function jk(t,e,r,i,o){var c,l;const{visualElement:u}=j.useContext(sc),h=j.useContext(n0),f=j.useContext(tc),g=j.useContext(gh).reducedMotion,p=j.useRef(null);i=i||h.renderer,!p.current&&i&&(p.current=i(t,{visualState:e,parent:u,props:r,presenceContext:f,blockInitialAnimation:f?f.initial===!1:!1,reducedMotionConfig:g}));const y=p.current,v=j.useContext(l0);y&&!y.projection&&o&&(y.type==="html"||y.type==="svg")&&Nk(p.current,r,o,v);const w=j.useRef(!1);j.useInsertionEffect(()=>{y&&w.current&&y.update(r,f)});const k=r[o0],N=j.useRef(!!k&&!(!((c=window.MotionHandoffIsComplete)===null||c===void 0)&&c.call(window,k))&&((l=window.MotionHasOptimisedAnimation)===null||l===void 0?void 0:l.call(window,k)));return t0(()=>{y&&(w.current=!0,window.MotionIsMounted=!0,y.updateFeatures(),wh.render(y.render),N.current&&y.animationState&&y.animationState.animateChanges())}),j.useEffect(()=>{y&&(!N.current&&y.animationState&&y.animationState.animateChanges(),N.current&&(queueMicrotask(()=>{var C;(C=window.MotionHandoffMarkAsComplete)===null||C===void 0||C.call(window,k)}),N.current=!1))}),y}function Nk(t,e,r,i){const{layoutId:o,layout:c,drag:l,dragConstraints:u,layoutScroll:h,layoutRoot:f}=e;t.projection=new r(t.latestValues,e["data-framer-portal-id"]?void 0:c0(t.parent)),t.projection.setOptions({layoutId:o,layout:c,alwaysMeasureLayout:!!l||u&&bi(u),visualElement:t,animationType:typeof c=="string"?c:"both",initialPromotionConfig:i,layoutScroll:h,layoutRoot:f})}function c0(t){if(t)return t.options.allowProjection!==!1?t.projection:c0(t.parent)}function kk({preloadedFeatures:t,createVisualElement:e,useRender:r,useVisualState:i,Component:o}){var c,l;t&&hk(t);function u(f,g){let p;const y={...j.useContext(gh),...f,layoutId:_k(f)},{isStatic:v}=y,w=yk(f),k=i(f,v);if(!v&&xh){Sk();const N=Ck(y);p=N.MeasureLayout,w.visualElement=jk(o,k,y,e,N.ProjectionNode)}return s.jsxs(sc.Provider,{value:w,children:[p&&w.visualElement?s.jsx(p,{visualElement:w.visualElement,...y}):null,r(o,f,vk(k,w.visualElement,g),k,v,w.visualElement)]})}u.displayName=`motion.${typeof o=="string"?o:`create(${(l=(c=o.displayName)!==null&&c!==void 0?c:o.name)!==null&&l!==void 0?l:""})`}`;const h=j.forwardRef(u);return h[bk]=o,h}function _k({layoutId:t}){const e=j.useContext(fh).id;return e&&t!==void 0?e+"-"+t:t}function Sk(t,e){j.useContext(n0).strict}function Ck(t){const{drag:e,layout:r}=Ei;if(!e&&!r)return{};const i={...e,...r};return{MeasureLayout:e?.isEnabled(t)||r?.isEnabled(t)?i.MeasureLayout:void 0,ProjectionNode:i.ProjectionNode}}const Tk=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function jh(t){return typeof t!="string"||t.includes("-")?!1:!!(Tk.indexOf(t)>-1||/[A-Z]/u.test(t))}function _g(t){const e=[{},{}];return t?.values.forEach((r,i)=>{e[0][i]=r.get(),e[1][i]=r.getVelocity()}),e}function Nh(t,e,r,i){if(typeof e=="function"){const[o,c]=_g(i);e=e(r!==void 0?r:t.custom,o,c)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[o,c]=_g(i);e=e(r!==void 0?r:t.custom,o,c)}return e}const Lu=t=>Array.isArray(t),Ek=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),Pk=t=>Lu(t)?t[t.length-1]||0:t,Jt=t=>!!(t&&t.getVelocity);function Fl(t){const e=Jt(t)?t.get():t;return Ek(e)?e.toValue():e}function Ak({scrapeMotionValuesFromProps:t,createRenderState:e,onUpdate:r},i,o,c){const l={latestValues:Ik(i,o,c,t),renderState:e()};return r&&(l.onMount=u=>r({props:i,current:u,...l}),l.onUpdate=u=>r(u)),l}const d0=t=>(e,r)=>{const i=j.useContext(sc),o=j.useContext(tc),c=()=>Ak(t,e,i,o);return r?c():ph(c)};function Ik(t,e,r,i){const o={},c=i(t,{});for(const y in c)o[y]=Fl(c[y]);let{initial:l,animate:u}=t;const h=nc(t),f=a0(t);e&&f&&!h&&t.inherit!==!1&&(l===void 0&&(l=e.initial),u===void 0&&(u=e.animate));let g=r?r.initial===!1:!1;g=g||l===!1;const p=g?u:l;if(p&&typeof p!="boolean"&&!rc(p)){const y=Array.isArray(p)?p:[p];for(let v=0;v<y.length;v++){const w=Nh(t,y[v]);if(w){const{transitionEnd:k,transition:N,...C}=w;for(const A in C){let E=C[A];if(Array.isArray(E)){const _=g?E.length-1:0;E=E[_]}E!==null&&(o[A]=E)}for(const A in k)o[A]=k[A]}}}return o}const Mi=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Mn=new Set(Mi),u0=t=>e=>typeof e=="string"&&e.startsWith(t),h0=u0("--"),Lk=u0("var(--"),kh=t=>Lk(t)?Rk.test(t.split("/*")[0].trim()):!1,Rk=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,m0=(t,e)=>e&&typeof t=="number"?e.transform(t):t,Er=(t,e,r)=>r>e?e:r<t?t:r,Oi={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Ka={...Oi,transform:t=>Er(0,1,t)},Pl={...Oi,default:1},so=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Xr=so("deg"),cr=so("%"),We=so("px"),Dk=so("vh"),Fk=so("vw"),Sg={...cr,parse:t=>cr.parse(t)/100,transform:t=>cr.transform(t*100)},Mk={borderWidth:We,borderTopWidth:We,borderRightWidth:We,borderBottomWidth:We,borderLeftWidth:We,borderRadius:We,radius:We,borderTopLeftRadius:We,borderTopRightRadius:We,borderBottomRightRadius:We,borderBottomLeftRadius:We,width:We,maxWidth:We,height:We,maxHeight:We,top:We,right:We,bottom:We,left:We,padding:We,paddingTop:We,paddingRight:We,paddingBottom:We,paddingLeft:We,margin:We,marginTop:We,marginRight:We,marginBottom:We,marginLeft:We,backgroundPositionX:We,backgroundPositionY:We},Ok={rotate:Xr,rotateX:Xr,rotateY:Xr,rotateZ:Xr,scale:Pl,scaleX:Pl,scaleY:Pl,scaleZ:Pl,skew:Xr,skewX:Xr,skewY:Xr,distance:We,translateX:We,translateY:We,translateZ:We,x:We,y:We,z:We,perspective:We,transformPerspective:We,opacity:Ka,originX:Sg,originY:Sg,originZ:We},Cg={...Oi,transform:Math.round},_h={...Mk,...Ok,zIndex:Cg,size:We,fillOpacity:Ka,strokeOpacity:Ka,numOctaves:Cg},Uk={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},$k=Mi.length;function Bk(t,e,r){let i="",o=!0;for(let c=0;c<$k;c++){const l=Mi[c],u=t[l];if(u===void 0)continue;let h=!0;if(typeof u=="number"?h=u===(l.startsWith("scale")?1:0):h=parseFloat(u)===0,!h||r){const f=m0(u,_h[l]);if(!h){o=!1;const g=Uk[l]||l;i+=`${g}(${f}) `}r&&(e[l]=f)}}return i=i.trim(),r?i=r(e,o?"":i):o&&(i="none"),i}function Sh(t,e,r){const{style:i,vars:o,transformOrigin:c}=t;let l=!1,u=!1;for(const h in e){const f=e[h];if(Mn.has(h)){l=!0;continue}else if(h0(h)){o[h]=f;continue}else{const g=m0(f,_h[h]);h.startsWith("origin")?(u=!0,c[h]=g):i[h]=g}}if(e.transform||(l||r?i.transform=Bk(e,t.transform,r):i.transform&&(i.transform="none")),u){const{originX:h="50%",originY:f="50%",originZ:g=0}=c;i.transformOrigin=`${h} ${f} ${g}`}}const Wk={offset:"stroke-dashoffset",array:"stroke-dasharray"},Vk={offset:"strokeDashoffset",array:"strokeDasharray"};function zk(t,e,r=1,i=0,o=!0){t.pathLength=1;const c=o?Wk:Vk;t[c.offset]=We.transform(-i);const l=We.transform(e),u=We.transform(r);t[c.array]=`${l} ${u}`}function Tg(t,e,r){return typeof t=="string"?t:We.transform(e+r*t)}function qk(t,e,r){const i=Tg(e,t.x,t.width),o=Tg(r,t.y,t.height);return`${i} ${o}`}function Ch(t,{attrX:e,attrY:r,attrScale:i,originX:o,originY:c,pathLength:l,pathSpacing:u=1,pathOffset:h=0,...f},g,p){if(Sh(t,f,p),g){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:y,style:v,dimensions:w}=t;y.transform&&(w&&(v.transform=y.transform),delete y.transform),w&&(o!==void 0||c!==void 0||v.transform)&&(v.transformOrigin=qk(w,o!==void 0?o:.5,c!==void 0?c:.5)),e!==void 0&&(y.x=e),r!==void 0&&(y.y=r),i!==void 0&&(y.scale=i),l!==void 0&&zk(y,l,u,h,!1)}const Th=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),f0=()=>({...Th(),attrs:{}}),Eh=t=>typeof t=="string"&&t.toLowerCase()==="svg";function p0(t,{style:e,vars:r},i,o){Object.assign(t.style,e,o&&o.getProjectionStyles(i));for(const c in r)t.style.setProperty(c,r[c])}const g0=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function x0(t,e,r,i){p0(t,e,void 0,i);for(const o in e.attrs)t.setAttribute(g0.has(o)?o:vh(o),e.attrs[o])}const zl={};function Hk(t){Object.assign(zl,t)}function y0(t,{layout:e,layoutId:r}){return Mn.has(t)||t.startsWith("origin")||(e||r!==void 0)&&(!!zl[t]||t==="opacity")}function Ph(t,e,r){var i;const{style:o}=t,c={};for(const l in o)(Jt(o[l])||e.style&&Jt(e.style[l])||y0(l,t)||((i=r?.getValue(l))===null||i===void 0?void 0:i.liveStyle)!==void 0)&&(c[l]=o[l]);return c}function b0(t,e,r){const i=Ph(t,e,r);for(const o in t)if(Jt(t[o])||Jt(e[o])){const c=Mi.indexOf(o)!==-1?"attr"+o.charAt(0).toUpperCase()+o.substring(1):o;i[c]=t[o]}return i}function Gk(t,e){try{e.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const Eg=["x","y","width","height","cx","cy","r"],Kk={useVisualState:d0({scrapeMotionValuesFromProps:b0,createRenderState:f0,onUpdate:({props:t,prevProps:e,current:r,renderState:i,latestValues:o})=>{if(!r)return;let c=!!t.drag;if(!c){for(const u in o)if(Mn.has(u)){c=!0;break}}if(!c)return;let l=!e;if(e)for(let u=0;u<Eg.length;u++){const h=Eg[u];t[h]!==e[h]&&(l=!0)}l&&dt.read(()=>{Gk(r,i),dt.render(()=>{Ch(i,o,Eh(r.tagName),t.transformTemplate),x0(r,i)})})}})},Yk={useVisualState:d0({scrapeMotionValuesFromProps:Ph,createRenderState:Th})};function v0(t,e,r){for(const i in e)!Jt(e[i])&&!y0(i,r)&&(t[i]=e[i])}function Jk({transformTemplate:t},e){return j.useMemo(()=>{const r=Th();return Sh(r,e,t),Object.assign({},r.vars,r.style)},[e])}function Qk(t,e){const r=t.style||{},i={};return v0(i,r,t),Object.assign(i,Jk(t,e)),i}function Zk(t,e){const r={},i=Qk(t,e);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,i.userSelect=i.WebkitUserSelect=i.WebkitTouchCallout="none",i.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=i,r}function Xk(t,e,r,i){const o=j.useMemo(()=>{const c=f0();return Ch(c,e,Eh(i),t.transformTemplate),{...c.attrs,style:{...c.style}}},[e]);if(t.style){const c={};v0(c,t.style,t),o.style={...c,...o.style}}return o}function e_(t=!1){return(r,i,o,{latestValues:c},l)=>{const h=(jh(r)?Xk:Zk)(i,c,l,r),f=pk(i,typeof r=="string",t),g=r!==j.Fragment?{...f,...h,ref:o}:{},{children:p}=i,y=j.useMemo(()=>Jt(p)?p.get():p,[p]);return j.createElement(r,{...g,children:y})}}function t_(t,e){return function(i,{forwardMotionProps:o}={forwardMotionProps:!1}){const l={...jh(i)?Kk:Yk,preloadedFeatures:t,useRender:e_(o),createVisualElement:e,Component:i};return kk(l)}}function w0(t,e){if(!Array.isArray(e))return!1;const r=e.length;if(r!==t.length)return!1;for(let i=0;i<r;i++)if(e[i]!==t[i])return!1;return!0}function ic(t,e,r){const i=t.getProps();return Nh(i,e,r!==void 0?r:i.custom,t)}function Ah(t,e){return t?t[e]||t.default||t:void 0}const j0=new Set(["width","height","top","left","right","bottom",...Mi]);let Ml;function s_(){Ml=void 0}const dr={now:()=>(Ml===void 0&&dr.set(Vt.isProcessing||ck.useManualTiming?Vt.timestamp:performance.now()),Ml),set:t=>{Ml=t,queueMicrotask(s_)}};function Ih(t,e){t.indexOf(e)===-1&&t.push(e)}function Lh(t,e){const r=t.indexOf(e);r>-1&&t.splice(r,1)}class Rh{constructor(){this.subscriptions=[]}add(e){return Ih(this.subscriptions,e),()=>Lh(this.subscriptions,e)}notify(e,r,i){const o=this.subscriptions.length;if(o)if(o===1)this.subscriptions[0](e,r,i);else for(let c=0;c<o;c++){const l=this.subscriptions[c];l&&l(e,r,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function N0(t,e){return e?t*(1e3/e):0}const Pg=30,r_=t=>!isNaN(parseFloat(t));class n_{constructor(e,r={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(i,o=!0)=>{const c=dr.now();this.updatedAt!==c&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(i),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),o&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=r.owner}setCurrent(e){this.current=e,this.updatedAt=dr.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=r_(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,r){this.events[e]||(this.events[e]=new Rh);const i=this.events[e].add(r);return e==="change"?()=>{i(),dt.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,r){this.passiveEffect=e,this.stopPassiveEffect=r}set(e,r=!0){!r||!this.passiveEffect?this.updateAndNotify(e,r):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,r,i){this.set(r),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-i}jump(e,r=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=dr.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>Pg)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,Pg);return N0(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(e){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=e(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Ya(t,e){return new n_(t,e)}function i_(t,e,r){t.hasValue(e)?t.getValue(e).set(r):t.addValue(e,Ya(r))}function a_(t,e){const r=ic(t,e);let{transitionEnd:i={},transition:o={},...c}=r||{};c={...c,...i};for(const l in c){const u=Pk(c[l]);i_(t,l,u)}}function o_(t){return!!(Jt(t)&&t.add)}function Ru(t,e){const r=t.getValue("willChange");if(o_(r))return r.add(e)}function k0(t){return t.props[o0]}function Dh(t){let e;return()=>(e===void 0&&(e=t()),e)}const l_=Dh(()=>window.ScrollTimeline!==void 0);class c_{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,r){for(let i=0;i<this.animations.length;i++)this.animations[i][e]=r}attachTimeline(e,r){const i=this.animations.map(o=>{if(l_()&&o.attachTimeline)return o.attachTimeline(e);if(typeof r=="function")return r(o)});return()=>{i.forEach((o,c)=>{o&&o(),this.animations[c].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let r=0;r<this.animations.length;r++)e=Math.max(e,this.animations[r].duration);return e}runAll(e){this.animations.forEach(r=>r[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class d_ extends c_{then(e,r){return Promise.all(this.animations).then(e).catch(r)}}const Cr=t=>t*1e3,Tr=t=>t/1e3;function Fh(t){return typeof t=="function"}function Ag(t,e){t.timeline=e,t.onfinish=null}const Mh=t=>Array.isArray(t)&&typeof t[0]=="number",u_={linearEasing:void 0};function h_(t,e){const r=Dh(t);return()=>{var i;return(i=u_[e])!==null&&i!==void 0?i:r()}}const ql=h_(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Pi=(t,e,r)=>{const i=e-t;return i===0?1:(r-t)/i},_0=(t,e,r=10)=>{let i="";const o=Math.max(Math.round(e/r),2);for(let c=0;c<o;c++)i+=t(Pi(0,o-1,c))+", ";return`linear(${i.substring(0,i.length-2)})`};function S0(t){return!!(typeof t=="function"&&ql()||!t||typeof t=="string"&&(t in Du||ql())||Mh(t)||Array.isArray(t)&&t.every(S0))}const _a=([t,e,r,i])=>`cubic-bezier(${t}, ${e}, ${r}, ${i})`,Du={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:_a([0,.65,.55,1]),circOut:_a([.55,0,1,.45]),backIn:_a([.31,.01,.66,-.59]),backOut:_a([.33,1.53,.69,.99])};function C0(t,e){if(t)return typeof t=="function"&&ql()?_0(t,e):Mh(t)?_a(t):Array.isArray(t)?t.map(r=>C0(r,e)||Du.easeOut):Du[t]}const T0=(t,e,r)=>(((1-3*r+3*e)*t+(3*r-6*e))*t+3*e)*t,m_=1e-7,f_=12;function p_(t,e,r,i,o){let c,l,u=0;do l=e+(r-e)/2,c=T0(l,i,o)-t,c>0?r=l:e=l;while(Math.abs(c)>m_&&++u<f_);return l}function ro(t,e,r,i){if(t===e&&r===i)return vs;const o=c=>p_(c,0,1,t,r);return c=>c===0||c===1?c:T0(o(c),e,i)}const E0=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,P0=t=>e=>1-t(1-e),A0=ro(.33,1.53,.69,.99),Oh=P0(A0),I0=E0(Oh),L0=t=>(t*=2)<1?.5*Oh(t):.5*(2-Math.pow(2,-10*(t-1))),Uh=t=>1-Math.sin(Math.acos(t)),R0=P0(Uh),D0=E0(Uh),F0=t=>/^0[^.\s]+$/u.test(t);function g_(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||F0(t):!0}const La=t=>Math.round(t*1e5)/1e5,$h=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function x_(t){return t==null}const y_=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Bh=(t,e)=>r=>!!(typeof r=="string"&&y_.test(r)&&r.startsWith(t)||e&&!x_(r)&&Object.prototype.hasOwnProperty.call(r,e)),M0=(t,e,r)=>i=>{if(typeof i!="string")return i;const[o,c,l,u]=i.match($h);return{[t]:parseFloat(o),[e]:parseFloat(c),[r]:parseFloat(l),alpha:u!==void 0?parseFloat(u):1}},b_=t=>Er(0,255,t),lu={...Oi,transform:t=>Math.round(b_(t))},Ln={test:Bh("rgb","red"),parse:M0("red","green","blue"),transform:({red:t,green:e,blue:r,alpha:i=1})=>"rgba("+lu.transform(t)+", "+lu.transform(e)+", "+lu.transform(r)+", "+La(Ka.transform(i))+")"};function v_(t){let e="",r="",i="",o="";return t.length>5?(e=t.substring(1,3),r=t.substring(3,5),i=t.substring(5,7),o=t.substring(7,9)):(e=t.substring(1,2),r=t.substring(2,3),i=t.substring(3,4),o=t.substring(4,5),e+=e,r+=r,i+=i,o+=o),{red:parseInt(e,16),green:parseInt(r,16),blue:parseInt(i,16),alpha:o?parseInt(o,16)/255:1}}const Fu={test:Bh("#"),parse:v_,transform:Ln.transform},vi={test:Bh("hsl","hue"),parse:M0("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:r,alpha:i=1})=>"hsla("+Math.round(t)+", "+cr.transform(La(e))+", "+cr.transform(La(r))+", "+La(Ka.transform(i))+")"},Yt={test:t=>Ln.test(t)||Fu.test(t)||vi.test(t),parse:t=>Ln.test(t)?Ln.parse(t):vi.test(t)?vi.parse(t):Fu.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Ln.transform(t):vi.transform(t)},w_=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function j_(t){var e,r;return isNaN(t)&&typeof t=="string"&&(((e=t.match($h))===null||e===void 0?void 0:e.length)||0)+(((r=t.match(w_))===null||r===void 0?void 0:r.length)||0)>0}const O0="number",U0="color",N_="var",k_="var(",Ig="${}",__=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Ja(t){const e=t.toString(),r=[],i={color:[],number:[],var:[]},o=[];let c=0;const u=e.replace(__,h=>(Yt.test(h)?(i.color.push(c),o.push(U0),r.push(Yt.parse(h))):h.startsWith(k_)?(i.var.push(c),o.push(N_),r.push(h)):(i.number.push(c),o.push(O0),r.push(parseFloat(h))),++c,Ig)).split(Ig);return{values:r,split:u,indexes:i,types:o}}function $0(t){return Ja(t).values}function B0(t){const{split:e,types:r}=Ja(t),i=e.length;return o=>{let c="";for(let l=0;l<i;l++)if(c+=e[l],o[l]!==void 0){const u=r[l];u===O0?c+=La(o[l]):u===U0?c+=Yt.transform(o[l]):c+=o[l]}return c}}const S_=t=>typeof t=="number"?0:t;function C_(t){const e=$0(t);return B0(t)(e.map(S_))}const on={test:j_,parse:$0,createTransformer:B0,getAnimatableNone:C_},T_=new Set(["brightness","contrast","saturate","opacity"]);function E_(t){const[e,r]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[i]=r.match($h)||[];if(!i)return t;const o=r.replace(i,"");let c=T_.has(e)?1:0;return i!==r&&(c*=100),e+"("+c+o+")"}const P_=/\b([a-z-]*)\(.*?\)/gu,Mu={...on,getAnimatableNone:t=>{const e=t.match(P_);return e?e.map(E_).join(" "):t}},A_={..._h,color:Yt,backgroundColor:Yt,outlineColor:Yt,fill:Yt,stroke:Yt,borderColor:Yt,borderTopColor:Yt,borderRightColor:Yt,borderBottomColor:Yt,borderLeftColor:Yt,filter:Mu,WebkitFilter:Mu},Wh=t=>A_[t];function W0(t,e){let r=Wh(t);return r!==Mu&&(r=on),r.getAnimatableNone?r.getAnimatableNone(e):void 0}const I_=new Set(["auto","none","0"]);function L_(t,e,r){let i=0,o;for(;i<t.length&&!o;){const c=t[i];typeof c=="string"&&!I_.has(c)&&Ja(c).values.length&&(o=t[i]),i++}if(o&&r)for(const c of e)t[c]=W0(r,o)}const Lg=t=>t===Oi||t===We,Rg=(t,e)=>parseFloat(t.split(", ")[e]),Dg=(t,e)=>(r,{transform:i})=>{if(i==="none"||!i)return 0;const o=i.match(/^matrix3d\((.+)\)$/u);if(o)return Rg(o[1],e);{const c=i.match(/^matrix\((.+)\)$/u);return c?Rg(c[1],t):0}},R_=new Set(["x","y","z"]),D_=Mi.filter(t=>!R_.has(t));function F_(t){const e=[];return D_.forEach(r=>{const i=t.getValue(r);i!==void 0&&(e.push([r,i.get()]),i.set(r.startsWith("scale")?1:0))}),e}const Ai={width:({x:t},{paddingLeft:e="0",paddingRight:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),height:({y:t},{paddingTop:e="0",paddingBottom:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:Dg(4,13),y:Dg(5,14)};Ai.translateX=Ai.x;Ai.translateY=Ai.y;const Dn=new Set;let Ou=!1,Uu=!1;function V0(){if(Uu){const t=Array.from(Dn).filter(i=>i.needsMeasurement),e=new Set(t.map(i=>i.element)),r=new Map;e.forEach(i=>{const o=F_(i);o.length&&(r.set(i,o),i.render())}),t.forEach(i=>i.measureInitialState()),e.forEach(i=>{i.render();const o=r.get(i);o&&o.forEach(([c,l])=>{var u;(u=i.getValue(c))===null||u===void 0||u.set(l)})}),t.forEach(i=>i.measureEndState()),t.forEach(i=>{i.suspendedScrollY!==void 0&&window.scrollTo(0,i.suspendedScrollY)})}Uu=!1,Ou=!1,Dn.forEach(t=>t.complete()),Dn.clear()}function z0(){Dn.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(Uu=!0)})}function M_(){z0(),V0()}class Vh{constructor(e,r,i,o,c,l=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=r,this.name=i,this.motionValue=o,this.element=c,this.isAsync=l}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Dn.add(this),Ou||(Ou=!0,dt.read(z0),dt.resolveKeyframes(V0))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:r,element:i,motionValue:o}=this;for(let c=0;c<e.length;c++)if(e[c]===null)if(c===0){const l=o?.get(),u=e[e.length-1];if(l!==void 0)e[0]=l;else if(i&&r){const h=i.readValue(r,u);h!=null&&(e[0]=h)}e[0]===void 0&&(e[0]=u),o&&l===void 0&&o.set(e[0])}else e[c]=e[c-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Dn.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Dn.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const q0=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),O_=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function U_(t){const e=O_.exec(t);if(!e)return[,];const[,r,i,o]=e;return[`--${r??i}`,o]}function H0(t,e,r=1){const[i,o]=U_(t);if(!i)return;const c=window.getComputedStyle(e).getPropertyValue(i);if(c){const l=c.trim();return q0(l)?parseFloat(l):l}return kh(o)?H0(o,e,r+1):o}const G0=t=>e=>e.test(t),$_={test:t=>t==="auto",parse:t=>t},K0=[Oi,We,cr,Xr,Fk,Dk,$_],Fg=t=>K0.find(G0(t));class Y0 extends Vh{constructor(e,r,i,o,c){super(e,r,i,o,c,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:r,name:i}=this;if(!r||!r.current)return;super.readKeyframes();for(let h=0;h<e.length;h++){let f=e[h];if(typeof f=="string"&&(f=f.trim(),kh(f))){const g=H0(f,r.current);g!==void 0&&(e[h]=g),h===e.length-1&&(this.finalKeyframe=f)}}if(this.resolveNoneKeyframes(),!j0.has(i)||e.length!==2)return;const[o,c]=e,l=Fg(o),u=Fg(c);if(l!==u)if(Lg(l)&&Lg(u))for(let h=0;h<e.length;h++){const f=e[h];typeof f=="string"&&(e[h]=parseFloat(f))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:r}=this,i=[];for(let o=0;o<e.length;o++)g_(e[o])&&i.push(o);i.length&&L_(e,i,r)}measureInitialState(){const{element:e,unresolvedKeyframes:r,name:i}=this;if(!e||!e.current)return;i==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Ai[i](e.measureViewportBox(),window.getComputedStyle(e.current)),r[0]=this.measuredOrigin;const o=r[r.length-1];o!==void 0&&e.getValue(i,o).jump(o,!1)}measureEndState(){var e;const{element:r,name:i,unresolvedKeyframes:o}=this;if(!r||!r.current)return;const c=r.getValue(i);c&&c.jump(this.measuredOrigin,!1);const l=o.length-1,u=o[l];o[l]=Ai[i](r.measureViewportBox(),window.getComputedStyle(r.current)),u!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=u),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([h,f])=>{r.getValue(h).set(f)}),this.resolveNoneKeyframes()}}const Mg=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(on.test(t)||t==="0")&&!t.startsWith("url("));function B_(t){const e=t[0];if(t.length===1)return!0;for(let r=0;r<t.length;r++)if(t[r]!==e)return!0}function W_(t,e,r,i){const o=t[0];if(o===null)return!1;if(e==="display"||e==="visibility")return!0;const c=t[t.length-1],l=Mg(o,e),u=Mg(c,e);return!l||!u?!1:B_(t)||(r==="spring"||Fh(r))&&i}const V_=t=>t!==null;function ac(t,{repeat:e,repeatType:r="loop"},i){const o=t.filter(V_),c=e&&r!=="loop"&&e%2===1?0:o.length-1;return!c||i===void 0?o[c]:i}const z_=40;class J0{constructor({autoplay:e=!0,delay:r=0,type:i="keyframes",repeat:o=0,repeatDelay:c=0,repeatType:l="loop",...u}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=dr.now(),this.options={autoplay:e,delay:r,type:i,repeat:o,repeatDelay:c,repeatType:l,...u},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>z_?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&M_(),this._resolved}onKeyframesResolved(e,r){this.resolvedAt=dr.now(),this.hasAttemptedResolve=!0;const{name:i,type:o,velocity:c,delay:l,onComplete:u,onUpdate:h,isGenerator:f}=this.options;if(!f&&!W_(e,i,o,c))if(l)this.options.duration=0;else{h&&h(ac(e,this.options,r)),u&&u(),this.resolveFinishedPromise();return}const g=this.initPlayback(e,r);g!==!1&&(this._resolved={keyframes:e,finalKeyframe:r,...g},this.onPostResolved())}onPostResolved(){}then(e,r){return this.currentFinishedPromise.then(e,r)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const $u=2e4;function Q0(t){let e=0;const r=50;let i=t.next(e);for(;!i.done&&e<$u;)e+=r,i=t.next(e);return e>=$u?1/0:e}const xt=(t,e,r)=>t+(e-t)*r;function cu(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function q_({hue:t,saturation:e,lightness:r,alpha:i}){t/=360,e/=100,r/=100;let o=0,c=0,l=0;if(!e)o=c=l=r;else{const u=r<.5?r*(1+e):r+e-r*e,h=2*r-u;o=cu(h,u,t+1/3),c=cu(h,u,t),l=cu(h,u,t-1/3)}return{red:Math.round(o*255),green:Math.round(c*255),blue:Math.round(l*255),alpha:i}}function Hl(t,e){return r=>r>0?e:t}const du=(t,e,r)=>{const i=t*t,o=r*(e*e-i)+i;return o<0?0:Math.sqrt(o)},H_=[Fu,Ln,vi],G_=t=>H_.find(e=>e.test(t));function Og(t){const e=G_(t);if(!e)return!1;let r=e.parse(t);return e===vi&&(r=q_(r)),r}const Ug=(t,e)=>{const r=Og(t),i=Og(e);if(!r||!i)return Hl(t,e);const o={...r};return c=>(o.red=du(r.red,i.red,c),o.green=du(r.green,i.green,c),o.blue=du(r.blue,i.blue,c),o.alpha=xt(r.alpha,i.alpha,c),Ln.transform(o))},K_=(t,e)=>r=>e(t(r)),no=(...t)=>t.reduce(K_),Bu=new Set(["none","hidden"]);function Y_(t,e){return Bu.has(t)?r=>r<=0?t:e:r=>r>=1?e:t}function J_(t,e){return r=>xt(t,e,r)}function zh(t){return typeof t=="number"?J_:typeof t=="string"?kh(t)?Hl:Yt.test(t)?Ug:X_:Array.isArray(t)?Z0:typeof t=="object"?Yt.test(t)?Ug:Q_:Hl}function Z0(t,e){const r=[...t],i=r.length,o=t.map((c,l)=>zh(c)(c,e[l]));return c=>{for(let l=0;l<i;l++)r[l]=o[l](c);return r}}function Q_(t,e){const r={...t,...e},i={};for(const o in r)t[o]!==void 0&&e[o]!==void 0&&(i[o]=zh(t[o])(t[o],e[o]));return o=>{for(const c in i)r[c]=i[c](o);return r}}function Z_(t,e){var r;const i=[],o={color:0,var:0,number:0};for(let c=0;c<e.values.length;c++){const l=e.types[c],u=t.indexes[l][o[l]],h=(r=t.values[u])!==null&&r!==void 0?r:0;i[c]=h,o[l]++}return i}const X_=(t,e)=>{const r=on.createTransformer(e),i=Ja(t),o=Ja(e);return i.indexes.var.length===o.indexes.var.length&&i.indexes.color.length===o.indexes.color.length&&i.indexes.number.length>=o.indexes.number.length?Bu.has(t)&&!o.values.length||Bu.has(e)&&!i.values.length?Y_(t,e):no(Z0(Z_(i,o),o.values),r):Hl(t,e)};function X0(t,e,r){return typeof t=="number"&&typeof e=="number"&&typeof r=="number"?xt(t,e,r):zh(t)(t,e)}const eS=5;function eb(t,e,r){const i=Math.max(e-eS,0);return N0(r-t(i),e-i)}const vt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},uu=.001;function tS({duration:t=vt.duration,bounce:e=vt.bounce,velocity:r=vt.velocity,mass:i=vt.mass}){let o,c,l=1-e;l=Er(vt.minDamping,vt.maxDamping,l),t=Er(vt.minDuration,vt.maxDuration,Tr(t)),l<1?(o=f=>{const g=f*l,p=g*t,y=g-r,v=Wu(f,l),w=Math.exp(-p);return uu-y/v*w},c=f=>{const p=f*l*t,y=p*r+r,v=Math.pow(l,2)*Math.pow(f,2)*t,w=Math.exp(-p),k=Wu(Math.pow(f,2),l);return(-o(f)+uu>0?-1:1)*((y-v)*w)/k}):(o=f=>{const g=Math.exp(-f*t),p=(f-r)*t+1;return-uu+g*p},c=f=>{const g=Math.exp(-f*t),p=(r-f)*(t*t);return g*p});const u=5/t,h=rS(o,c,u);if(t=Cr(t),isNaN(h))return{stiffness:vt.stiffness,damping:vt.damping,duration:t};{const f=Math.pow(h,2)*i;return{stiffness:f,damping:l*2*Math.sqrt(i*f),duration:t}}}const sS=12;function rS(t,e,r){let i=r;for(let o=1;o<sS;o++)i=i-t(i)/e(i);return i}function Wu(t,e){return t*Math.sqrt(1-e*e)}const nS=["duration","bounce"],iS=["stiffness","damping","mass"];function $g(t,e){return e.some(r=>t[r]!==void 0)}function aS(t){let e={velocity:vt.velocity,stiffness:vt.stiffness,damping:vt.damping,mass:vt.mass,isResolvedFromDuration:!1,...t};if(!$g(t,iS)&&$g(t,nS))if(t.visualDuration){const r=t.visualDuration,i=2*Math.PI/(r*1.2),o=i*i,c=2*Er(.05,1,1-(t.bounce||0))*Math.sqrt(o);e={...e,mass:vt.mass,stiffness:o,damping:c}}else{const r=tS(t);e={...e,...r,mass:vt.mass},e.isResolvedFromDuration=!0}return e}function tb(t=vt.visualDuration,e=vt.bounce){const r=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:i,restDelta:o}=r;const c=r.keyframes[0],l=r.keyframes[r.keyframes.length-1],u={done:!1,value:c},{stiffness:h,damping:f,mass:g,duration:p,velocity:y,isResolvedFromDuration:v}=aS({...r,velocity:-Tr(r.velocity||0)}),w=y||0,k=f/(2*Math.sqrt(h*g)),N=l-c,C=Tr(Math.sqrt(h/g)),A=Math.abs(N)<5;i||(i=A?vt.restSpeed.granular:vt.restSpeed.default),o||(o=A?vt.restDelta.granular:vt.restDelta.default);let E;if(k<1){const R=Wu(C,k);E=L=>{const P=Math.exp(-k*C*L);return l-P*((w+k*C*N)/R*Math.sin(R*L)+N*Math.cos(R*L))}}else if(k===1)E=R=>l-Math.exp(-C*R)*(N+(w+C*N)*R);else{const R=C*Math.sqrt(k*k-1);E=L=>{const P=Math.exp(-k*C*L),D=Math.min(R*L,300);return l-P*((w+k*C*N)*Math.sinh(D)+R*N*Math.cosh(D))/R}}const _={calculatedDuration:v&&p||null,next:R=>{const L=E(R);if(v)u.done=R>=p;else{let P=0;k<1&&(P=R===0?Cr(w):eb(E,R,L));const D=Math.abs(P)<=i,H=Math.abs(l-L)<=o;u.done=D&&H}return u.value=u.done?l:L,u},toString:()=>{const R=Math.min(Q0(_),$u),L=_0(P=>_.next(R*P).value,R,30);return R+"ms "+L}};return _}function Bg({keyframes:t,velocity:e=0,power:r=.8,timeConstant:i=325,bounceDamping:o=10,bounceStiffness:c=500,modifyTarget:l,min:u,max:h,restDelta:f=.5,restSpeed:g}){const p=t[0],y={done:!1,value:p},v=D=>u!==void 0&&D<u||h!==void 0&&D>h,w=D=>u===void 0?h:h===void 0||Math.abs(u-D)<Math.abs(h-D)?u:h;let k=r*e;const N=p+k,C=l===void 0?N:l(N);C!==N&&(k=C-p);const A=D=>-k*Math.exp(-D/i),E=D=>C+A(D),_=D=>{const H=A(D),B=E(D);y.done=Math.abs(H)<=f,y.value=y.done?C:B};let R,L;const P=D=>{v(y.value)&&(R=D,L=tb({keyframes:[y.value,w(y.value)],velocity:eb(E,D,y.value),damping:o,stiffness:c,restDelta:f,restSpeed:g}))};return P(0),{calculatedDuration:null,next:D=>{let H=!1;return!L&&R===void 0&&(H=!0,_(D),P(D)),R!==void 0&&D>=R?L.next(D-R):(!H&&_(D),y)}}}const oS=ro(.42,0,1,1),lS=ro(0,0,.58,1),sb=ro(.42,0,.58,1),cS=t=>Array.isArray(t)&&typeof t[0]!="number",dS={linear:vs,easeIn:oS,easeInOut:sb,easeOut:lS,circIn:Uh,circInOut:D0,circOut:R0,backIn:Oh,backInOut:I0,backOut:A0,anticipate:L0},Wg=t=>{if(Mh(t)){s0(t.length===4);const[e,r,i,o]=t;return ro(e,r,i,o)}else if(typeof t=="string")return dS[t];return t};function uS(t,e,r){const i=[],o=r||X0,c=t.length-1;for(let l=0;l<c;l++){let u=o(t[l],t[l+1]);if(e){const h=Array.isArray(e)?e[l]||vs:e;u=no(h,u)}i.push(u)}return i}function hS(t,e,{clamp:r=!0,ease:i,mixer:o}={}){const c=t.length;if(s0(c===e.length),c===1)return()=>e[0];if(c===2&&e[0]===e[1])return()=>e[1];const l=t[0]===t[1];t[0]>t[c-1]&&(t=[...t].reverse(),e=[...e].reverse());const u=uS(e,i,o),h=u.length,f=g=>{if(l&&g<t[0])return e[0];let p=0;if(h>1)for(;p<t.length-2&&!(g<t[p+1]);p++);const y=Pi(t[p],t[p+1],g);return u[p](y)};return r?g=>f(Er(t[0],t[c-1],g)):f}function mS(t,e){const r=t[t.length-1];for(let i=1;i<=e;i++){const o=Pi(0,e,i);t.push(xt(r,1,o))}}function fS(t){const e=[0];return mS(e,t.length-1),e}function pS(t,e){return t.map(r=>r*e)}function gS(t,e){return t.map(()=>e||sb).splice(0,t.length-1)}function Gl({duration:t=300,keyframes:e,times:r,ease:i="easeInOut"}){const o=cS(i)?i.map(Wg):Wg(i),c={done:!1,value:e[0]},l=pS(r&&r.length===e.length?r:fS(e),t),u=hS(l,e,{ease:Array.isArray(o)?o:gS(e,o)});return{calculatedDuration:t,next:h=>(c.value=u(h),c.done=h>=t,c)}}const xS=t=>{const e=({timestamp:r})=>t(r);return{start:()=>dt.update(e,!0),stop:()=>an(e),now:()=>Vt.isProcessing?Vt.timestamp:dr.now()}},yS={decay:Bg,inertia:Bg,tween:Gl,keyframes:Gl,spring:tb},bS=t=>t/100;class qh extends J0{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:h}=this.options;h&&h()};const{name:r,motionValue:i,element:o,keyframes:c}=this.options,l=o?.KeyframeResolver||Vh,u=(h,f)=>this.onKeyframesResolved(h,f);this.resolver=new l(c,u,r,i,o),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:r="keyframes",repeat:i=0,repeatDelay:o=0,repeatType:c,velocity:l=0}=this.options,u=Fh(r)?r:yS[r]||Gl;let h,f;u!==Gl&&typeof e[0]!="number"&&(h=no(bS,X0(e[0],e[1])),e=[0,100]);const g=u({...this.options,keyframes:e});c==="mirror"&&(f=u({...this.options,keyframes:[...e].reverse(),velocity:-l})),g.calculatedDuration===null&&(g.calculatedDuration=Q0(g));const{calculatedDuration:p}=g,y=p+o,v=y*(i+1)-o;return{generator:g,mirroredGenerator:f,mapPercentToKeyframes:h,calculatedDuration:p,resolvedDuration:y,totalDuration:v}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,r=!1){const{resolved:i}=this;if(!i){const{keyframes:D}=this.options;return{done:!0,value:D[D.length-1]}}const{finalKeyframe:o,generator:c,mirroredGenerator:l,mapPercentToKeyframes:u,keyframes:h,calculatedDuration:f,totalDuration:g,resolvedDuration:p}=i;if(this.startTime===null)return c.next(0);const{delay:y,repeat:v,repeatType:w,repeatDelay:k,onUpdate:N}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-g/this.speed,this.startTime)),r?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const C=this.currentTime-y*(this.speed>=0?1:-1),A=this.speed>=0?C<0:C>g;this.currentTime=Math.max(C,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=g);let E=this.currentTime,_=c;if(v){const D=Math.min(this.currentTime,g)/p;let H=Math.floor(D),B=D%1;!B&&D>=1&&(B=1),B===1&&H--,H=Math.min(H,v+1),!!(H%2)&&(w==="reverse"?(B=1-B,k&&(B-=k/p)):w==="mirror"&&(_=l)),E=Er(0,1,B)*p}const R=A?{done:!1,value:h[0]}:_.next(E);u&&(R.value=u(R.value));let{done:L}=R;!A&&f!==null&&(L=this.speed>=0?this.currentTime>=g:this.currentTime<=0);const P=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&L);return P&&o!==void 0&&(R.value=ac(h,this.options,o)),N&&N(R.value),P&&this.finish(),R}get duration(){const{resolved:e}=this;return e?Tr(e.calculatedDuration):0}get time(){return Tr(this.currentTime)}set time(e){e=Cr(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const r=this.playbackSpeed!==e;this.playbackSpeed=e,r&&(this.time=Tr(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=xS,onPlay:r,startTime:i}=this.options;this.driver||(this.driver=e(c=>this.tick(c))),r&&r();const o=this.driver.now();this.holdTime!==null?this.startTime=o-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=o):this.startTime=i??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const vS=new Set(["opacity","clipPath","filter","transform"]);function wS(t,e,r,{delay:i=0,duration:o=300,repeat:c=0,repeatType:l="loop",ease:u="easeInOut",times:h}={}){const f={[e]:r};h&&(f.offset=h);const g=C0(u,o);return Array.isArray(g)&&(f.easing=g),t.animate(f,{delay:i,duration:o,easing:Array.isArray(g)?"linear":g,fill:"both",iterations:c+1,direction:l==="reverse"?"alternate":"normal"})}const jS=Dh(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Kl=10,NS=2e4;function kS(t){return Fh(t.type)||t.type==="spring"||!S0(t.ease)}function _S(t,e){const r=new qh({...e,keyframes:t,repeat:0,delay:0,isGenerator:!0});let i={done:!1,value:t[0]};const o=[];let c=0;for(;!i.done&&c<NS;)i=r.sample(c),o.push(i.value),c+=Kl;return{times:void 0,keyframes:o,duration:c-Kl,ease:"linear"}}const rb={anticipate:L0,backInOut:I0,circInOut:D0};function SS(t){return t in rb}class Vg extends J0{constructor(e){super(e);const{name:r,motionValue:i,element:o,keyframes:c}=this.options;this.resolver=new Y0(c,(l,u)=>this.onKeyframesResolved(l,u),r,i,o),this.resolver.scheduleResolve()}initPlayback(e,r){let{duration:i=300,times:o,ease:c,type:l,motionValue:u,name:h,startTime:f}=this.options;if(!u.owner||!u.owner.current)return!1;if(typeof c=="string"&&ql()&&SS(c)&&(c=rb[c]),kS(this.options)){const{onComplete:p,onUpdate:y,motionValue:v,element:w,...k}=this.options,N=_S(e,k);e=N.keyframes,e.length===1&&(e[1]=e[0]),i=N.duration,o=N.times,c=N.ease,l="keyframes"}const g=wS(u.owner.current,h,e,{...this.options,duration:i,times:o,ease:c});return g.startTime=f??this.calcStartTime(),this.pendingTimeline?(Ag(g,this.pendingTimeline),this.pendingTimeline=void 0):g.onfinish=()=>{const{onComplete:p}=this.options;u.set(ac(e,this.options,r)),p&&p(),this.cancel(),this.resolveFinishedPromise()},{animation:g,duration:i,times:o,type:l,ease:c,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:r}=e;return Tr(r)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:r}=e;return Tr(r.currentTime||0)}set time(e){const{resolved:r}=this;if(!r)return;const{animation:i}=r;i.currentTime=Cr(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:r}=e;return r.playbackRate}set speed(e){const{resolved:r}=this;if(!r)return;const{animation:i}=r;i.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:r}=e;return r.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:r}=e;return r.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:r}=this;if(!r)return vs;const{animation:i}=r;Ag(i,e)}return vs}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:r}=e;r.playState==="finished"&&this.updateFinishedPromise(),r.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:r}=e;r.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:r,keyframes:i,duration:o,type:c,ease:l,times:u}=e;if(r.playState==="idle"||r.playState==="finished")return;if(this.time){const{motionValue:f,onUpdate:g,onComplete:p,element:y,...v}=this.options,w=new qh({...v,keyframes:i,duration:o,type:c,ease:l,times:u,isGenerator:!0}),k=Cr(this.time);f.setWithVelocity(w.sample(k-Kl).value,w.sample(k).value,Kl)}const{onStop:h}=this.options;h&&h(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:r,name:i,repeatDelay:o,repeatType:c,damping:l,type:u}=e;if(!r||!r.owner||!(r.owner.current instanceof HTMLElement))return!1;const{onUpdate:h,transformTemplate:f}=r.owner.getProps();return jS()&&i&&vS.has(i)&&!h&&!f&&!o&&c!=="mirror"&&l!==0&&u!=="inertia"}}const CS={type:"spring",stiffness:500,damping:25,restSpeed:10},TS=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),ES={type:"keyframes",duration:.8},PS={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},AS=(t,{keyframes:e})=>e.length>2?ES:Mn.has(t)?t.startsWith("scale")?TS(e[1]):CS:PS;function IS({when:t,delay:e,delayChildren:r,staggerChildren:i,staggerDirection:o,repeat:c,repeatType:l,repeatDelay:u,from:h,elapsed:f,...g}){return!!Object.keys(g).length}const Hh=(t,e,r,i={},o,c)=>l=>{const u=Ah(i,t)||{},h=u.delay||i.delay||0;let{elapsed:f=0}=i;f=f-Cr(h);let g={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:e.getVelocity(),...u,delay:-f,onUpdate:y=>{e.set(y),u.onUpdate&&u.onUpdate(y)},onComplete:()=>{l(),u.onComplete&&u.onComplete()},name:t,motionValue:e,element:c?void 0:o};IS(u)||(g={...g,...AS(t,g)}),g.duration&&(g.duration=Cr(g.duration)),g.repeatDelay&&(g.repeatDelay=Cr(g.repeatDelay)),g.from!==void 0&&(g.keyframes[0]=g.from);let p=!1;if((g.type===!1||g.duration===0&&!g.repeatDelay)&&(g.duration=0,g.delay===0&&(p=!0)),p&&!c&&e.get()!==void 0){const y=ac(g.keyframes,u);if(y!==void 0)return dt.update(()=>{g.onUpdate(y),g.onComplete()}),new d_([])}return!c&&Vg.supports(g)?new Vg(g):new qh(g)};function LS({protectedKeys:t,needsAnimating:e},r){const i=t.hasOwnProperty(r)&&e[r]!==!0;return e[r]=!1,i}function nb(t,e,{delay:r=0,transitionOverride:i,type:o}={}){var c;let{transition:l=t.getDefaultTransition(),transitionEnd:u,...h}=e;i&&(l=i);const f=[],g=o&&t.animationState&&t.animationState.getState()[o];for(const p in h){const y=t.getValue(p,(c=t.latestValues[p])!==null&&c!==void 0?c:null),v=h[p];if(v===void 0||g&&LS(g,p))continue;const w={delay:r,...Ah(l||{},p)};let k=!1;if(window.MotionHandoffAnimation){const C=k0(t);if(C){const A=window.MotionHandoffAnimation(C,p,dt);A!==null&&(w.startTime=A,k=!0)}}Ru(t,p),y.start(Hh(p,y,v,t.shouldReduceMotion&&j0.has(p)?{type:!1}:w,t,k));const N=y.animation;N&&f.push(N)}return u&&Promise.all(f).then(()=>{dt.update(()=>{u&&a_(t,u)})}),f}function Vu(t,e,r={}){var i;const o=ic(t,e,r.type==="exit"?(i=t.presenceContext)===null||i===void 0?void 0:i.custom:void 0);let{transition:c=t.getDefaultTransition()||{}}=o||{};r.transitionOverride&&(c=r.transitionOverride);const l=o?()=>Promise.all(nb(t,o,r)):()=>Promise.resolve(),u=t.variantChildren&&t.variantChildren.size?(f=0)=>{const{delayChildren:g=0,staggerChildren:p,staggerDirection:y}=c;return RS(t,e,g+f,p,y,r)}:()=>Promise.resolve(),{when:h}=c;if(h){const[f,g]=h==="beforeChildren"?[l,u]:[u,l];return f().then(()=>g())}else return Promise.all([l(),u(r.delay)])}function RS(t,e,r=0,i=0,o=1,c){const l=[],u=(t.variantChildren.size-1)*i,h=o===1?(f=0)=>f*i:(f=0)=>u-f*i;return Array.from(t.variantChildren).sort(DS).forEach((f,g)=>{f.notify("AnimationStart",e),l.push(Vu(f,e,{...c,delay:r+h(g)}).then(()=>f.notify("AnimationComplete",e)))}),Promise.all(l)}function DS(t,e){return t.sortNodePosition(e)}function FS(t,e,r={}){t.notify("AnimationStart",e);let i;if(Array.isArray(e)){const o=e.map(c=>Vu(t,c,r));i=Promise.all(o)}else if(typeof e=="string")i=Vu(t,e,r);else{const o=typeof e=="function"?ic(t,e,r.custom):e;i=Promise.all(nb(t,o,r))}return i.then(()=>{t.notify("AnimationComplete",e)})}const MS=bh.length;function ib(t){if(!t)return;if(!t.isControllingVariants){const r=t.parent?ib(t.parent)||{}:{};return t.props.initial!==void 0&&(r.initial=t.props.initial),r}const e={};for(let r=0;r<MS;r++){const i=bh[r],o=t.props[i];(Ga(o)||o===!1)&&(e[i]=o)}return e}const OS=[...yh].reverse(),US=yh.length;function $S(t){return e=>Promise.all(e.map(({animation:r,options:i})=>FS(t,r,i)))}function BS(t){let e=$S(t),r=zg(),i=!0;const o=h=>(f,g)=>{var p;const y=ic(t,g,h==="exit"?(p=t.presenceContext)===null||p===void 0?void 0:p.custom:void 0);if(y){const{transition:v,transitionEnd:w,...k}=y;f={...f,...k,...w}}return f};function c(h){e=h(t)}function l(h){const{props:f}=t,g=ib(t.parent)||{},p=[],y=new Set;let v={},w=1/0;for(let N=0;N<US;N++){const C=OS[N],A=r[C],E=f[C]!==void 0?f[C]:g[C],_=Ga(E),R=C===h?A.isActive:null;R===!1&&(w=N);let L=E===g[C]&&E!==f[C]&&_;if(L&&i&&t.manuallyAnimateOnMount&&(L=!1),A.protectedKeys={...v},!A.isActive&&R===null||!E&&!A.prevProp||rc(E)||typeof E=="boolean")continue;const P=WS(A.prevProp,E);let D=P||C===h&&A.isActive&&!L&&_||N>w&&_,H=!1;const B=Array.isArray(E)?E:[E];let ae=B.reduce(o(C),{});R===!1&&(ae={});const{prevResolvedValues:ue={}}=A,le={...ue,...ae},fe=Y=>{D=!0,y.has(Y)&&(H=!0,y.delete(Y)),A.needsAnimating[Y]=!0;const I=t.getValue(Y);I&&(I.liveStyle=!1)};for(const Y in le){const I=ae[Y],$=ue[Y];if(v.hasOwnProperty(Y))continue;let W=!1;Lu(I)&&Lu($)?W=!w0(I,$):W=I!==$,W?I!=null?fe(Y):y.add(Y):I!==void 0&&y.has(Y)?fe(Y):A.protectedKeys[Y]=!0}A.prevProp=E,A.prevResolvedValues=ae,A.isActive&&(v={...v,...ae}),i&&t.blockInitialAnimation&&(D=!1),D&&(!(L&&P)||H)&&p.push(...B.map(Y=>({animation:Y,options:{type:C}})))}if(y.size){const N={};y.forEach(C=>{const A=t.getBaseTarget(C),E=t.getValue(C);E&&(E.liveStyle=!0),N[C]=A??null}),p.push({animation:N})}let k=!!p.length;return i&&(f.initial===!1||f.initial===f.animate)&&!t.manuallyAnimateOnMount&&(k=!1),i=!1,k?e(p):Promise.resolve()}function u(h,f){var g;if(r[h].isActive===f)return Promise.resolve();(g=t.variantChildren)===null||g===void 0||g.forEach(y=>{var v;return(v=y.animationState)===null||v===void 0?void 0:v.setActive(h,f)}),r[h].isActive=f;const p=l(h);for(const y in r)r[y].protectedKeys={};return p}return{animateChanges:l,setActive:u,setAnimateFunction:c,getState:()=>r,reset:()=>{r=zg(),i=!0}}}function WS(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!w0(e,t):!1}function _n(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function zg(){return{animate:_n(!0),whileInView:_n(),whileHover:_n(),whileTap:_n(),whileDrag:_n(),whileFocus:_n(),exit:_n()}}class cn{constructor(e){this.isMounted=!1,this.node=e}update(){}}class VS extends cn{constructor(e){super(e),e.animationState||(e.animationState=BS(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();rc(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:r}=this.node.prevProps||{};e!==r&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let zS=0;class qS extends cn{constructor(){super(...arguments),this.id=zS++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:r}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===i)return;const o=this.node.animationState.setActive("exit",!e);r&&!e&&o.then(()=>r(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const HS={animation:{Feature:VS},exit:{Feature:qS}},Hs={x:!1,y:!1};function ab(){return Hs.x||Hs.y}function GS(t){return t==="x"||t==="y"?Hs[t]?null:(Hs[t]=!0,()=>{Hs[t]=!1}):Hs.x||Hs.y?null:(Hs.x=Hs.y=!0,()=>{Hs.x=Hs.y=!1})}const Gh=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1;function Qa(t,e,r,i={passive:!0}){return t.addEventListener(e,r,i),()=>t.removeEventListener(e,r)}function io(t){return{point:{x:t.pageX,y:t.pageY}}}const KS=t=>e=>Gh(e)&&t(e,io(e));function Ra(t,e,r,i){return Qa(t,e,KS(r),i)}const qg=(t,e)=>Math.abs(t-e);function YS(t,e){const r=qg(t.x,e.x),i=qg(t.y,e.y);return Math.sqrt(r**2+i**2)}class ob{constructor(e,r,{transformPagePoint:i,contextWindow:o,dragSnapToOrigin:c=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const p=mu(this.lastMoveEventInfo,this.history),y=this.startEvent!==null,v=YS(p.offset,{x:0,y:0})>=3;if(!y&&!v)return;const{point:w}=p,{timestamp:k}=Vt;this.history.push({...w,timestamp:k});const{onStart:N,onMove:C}=this.handlers;y||(N&&N(this.lastMoveEvent,p),this.startEvent=this.lastMoveEvent),C&&C(this.lastMoveEvent,p)},this.handlePointerMove=(p,y)=>{this.lastMoveEvent=p,this.lastMoveEventInfo=hu(y,this.transformPagePoint),dt.update(this.updatePoint,!0)},this.handlePointerUp=(p,y)=>{this.end();const{onEnd:v,onSessionEnd:w,resumeAnimation:k}=this.handlers;if(this.dragSnapToOrigin&&k&&k(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const N=mu(p.type==="pointercancel"?this.lastMoveEventInfo:hu(y,this.transformPagePoint),this.history);this.startEvent&&v&&v(p,N),w&&w(p,N)},!Gh(e))return;this.dragSnapToOrigin=c,this.handlers=r,this.transformPagePoint=i,this.contextWindow=o||window;const l=io(e),u=hu(l,this.transformPagePoint),{point:h}=u,{timestamp:f}=Vt;this.history=[{...h,timestamp:f}];const{onSessionStart:g}=r;g&&g(e,mu(u,this.history)),this.removeListeners=no(Ra(this.contextWindow,"pointermove",this.handlePointerMove),Ra(this.contextWindow,"pointerup",this.handlePointerUp),Ra(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),an(this.updatePoint)}}function hu(t,e){return e?{point:e(t.point)}:t}function Hg(t,e){return{x:t.x-e.x,y:t.y-e.y}}function mu({point:t},e){return{point:t,delta:Hg(t,lb(e)),offset:Hg(t,JS(e)),velocity:QS(e,.1)}}function JS(t){return t[0]}function lb(t){return t[t.length-1]}function QS(t,e){if(t.length<2)return{x:0,y:0};let r=t.length-1,i=null;const o=lb(t);for(;r>=0&&(i=t[r],!(o.timestamp-i.timestamp>Cr(e)));)r--;if(!i)return{x:0,y:0};const c=Tr(o.timestamp-i.timestamp);if(c===0)return{x:0,y:0};const l={x:(o.x-i.x)/c,y:(o.y-i.y)/c};return l.x===1/0&&(l.x=0),l.y===1/0&&(l.y=0),l}const cb=1e-4,ZS=1-cb,XS=1+cb,db=.01,eC=0-db,tC=0+db;function ws(t){return t.max-t.min}function sC(t,e,r){return Math.abs(t-e)<=r}function Gg(t,e,r,i=.5){t.origin=i,t.originPoint=xt(e.min,e.max,t.origin),t.scale=ws(r)/ws(e),t.translate=xt(r.min,r.max,t.origin)-t.originPoint,(t.scale>=ZS&&t.scale<=XS||isNaN(t.scale))&&(t.scale=1),(t.translate>=eC&&t.translate<=tC||isNaN(t.translate))&&(t.translate=0)}function Da(t,e,r,i){Gg(t.x,e.x,r.x,i?i.originX:void 0),Gg(t.y,e.y,r.y,i?i.originY:void 0)}function Kg(t,e,r){t.min=r.min+e.min,t.max=t.min+ws(e)}function rC(t,e,r){Kg(t.x,e.x,r.x),Kg(t.y,e.y,r.y)}function Yg(t,e,r){t.min=e.min-r.min,t.max=t.min+ws(e)}function Fa(t,e,r){Yg(t.x,e.x,r.x),Yg(t.y,e.y,r.y)}function nC(t,{min:e,max:r},i){return e!==void 0&&t<e?t=i?xt(e,t,i.min):Math.max(t,e):r!==void 0&&t>r&&(t=i?xt(r,t,i.max):Math.min(t,r)),t}function Jg(t,e,r){return{min:e!==void 0?t.min+e:void 0,max:r!==void 0?t.max+r-(t.max-t.min):void 0}}function iC(t,{top:e,left:r,bottom:i,right:o}){return{x:Jg(t.x,r,o),y:Jg(t.y,e,i)}}function Qg(t,e){let r=e.min-t.min,i=e.max-t.max;return e.max-e.min<t.max-t.min&&([r,i]=[i,r]),{min:r,max:i}}function aC(t,e){return{x:Qg(t.x,e.x),y:Qg(t.y,e.y)}}function oC(t,e){let r=.5;const i=ws(t),o=ws(e);return o>i?r=Pi(e.min,e.max-i,t.min):i>o&&(r=Pi(t.min,t.max-o,e.min)),Er(0,1,r)}function lC(t,e){const r={};return e.min!==void 0&&(r.min=e.min-t.min),e.max!==void 0&&(r.max=e.max-t.min),r}const zu=.35;function cC(t=zu){return t===!1?t=0:t===!0&&(t=zu),{x:Zg(t,"left","right"),y:Zg(t,"top","bottom")}}function Zg(t,e,r){return{min:Xg(t,e),max:Xg(t,r)}}function Xg(t,e){return typeof t=="number"?t:t[e]||0}const ex=()=>({translate:0,scale:1,origin:0,originPoint:0}),wi=()=>({x:ex(),y:ex()}),tx=()=>({min:0,max:0}),_t=()=>({x:tx(),y:tx()});function Ps(t){return[t("x"),t("y")]}function ub({top:t,left:e,right:r,bottom:i}){return{x:{min:e,max:r},y:{min:t,max:i}}}function dC({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function uC(t,e){if(!e)return t;const r=e({x:t.left,y:t.top}),i=e({x:t.right,y:t.bottom});return{top:r.y,left:r.x,bottom:i.y,right:i.x}}function fu(t){return t===void 0||t===1}function qu({scale:t,scaleX:e,scaleY:r}){return!fu(t)||!fu(e)||!fu(r)}function Cn(t){return qu(t)||hb(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function hb(t){return sx(t.x)||sx(t.y)}function sx(t){return t&&t!=="0%"}function Yl(t,e,r){const i=t-r,o=e*i;return r+o}function rx(t,e,r,i,o){return o!==void 0&&(t=Yl(t,o,i)),Yl(t,r,i)+e}function Hu(t,e=0,r=1,i,o){t.min=rx(t.min,e,r,i,o),t.max=rx(t.max,e,r,i,o)}function mb(t,{x:e,y:r}){Hu(t.x,e.translate,e.scale,e.originPoint),Hu(t.y,r.translate,r.scale,r.originPoint)}const nx=.999999999999,ix=1.0000000000001;function hC(t,e,r,i=!1){const o=r.length;if(!o)return;e.x=e.y=1;let c,l;for(let u=0;u<o;u++){c=r[u],l=c.projectionDelta;const{visualElement:h}=c.options;h&&h.props.style&&h.props.style.display==="contents"||(i&&c.options.layoutScroll&&c.scroll&&c!==c.root&&Ni(t,{x:-c.scroll.offset.x,y:-c.scroll.offset.y}),l&&(e.x*=l.x.scale,e.y*=l.y.scale,mb(t,l)),i&&Cn(c.latestValues)&&Ni(t,c.latestValues))}e.x<ix&&e.x>nx&&(e.x=1),e.y<ix&&e.y>nx&&(e.y=1)}function ji(t,e){t.min=t.min+e,t.max=t.max+e}function ax(t,e,r,i,o=.5){const c=xt(t.min,t.max,o);Hu(t,e,r,c,i)}function Ni(t,e){ax(t.x,e.x,e.scaleX,e.scale,e.originX),ax(t.y,e.y,e.scaleY,e.scale,e.originY)}function fb(t,e){return ub(uC(t.getBoundingClientRect(),e))}function mC(t,e,r){const i=fb(t,r),{scroll:o}=e;return o&&(ji(i.x,o.offset.x),ji(i.y,o.offset.y)),i}const pb=({current:t})=>t?t.ownerDocument.defaultView:null,fC=new WeakMap;class pC{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=_t(),this.visualElement=e}start(e,{snapToCursor:r=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const o=g=>{const{dragSnapToOrigin:p}=this.getProps();p?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(io(g).point)},c=(g,p)=>{const{drag:y,dragPropagation:v,onDragStart:w}=this.getProps();if(y&&!v&&(this.openDragLock&&this.openDragLock(),this.openDragLock=GS(y),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ps(N=>{let C=this.getAxisMotionValue(N).get()||0;if(cr.test(C)){const{projection:A}=this.visualElement;if(A&&A.layout){const E=A.layout.layoutBox[N];E&&(C=ws(E)*(parseFloat(C)/100))}}this.originPoint[N]=C}),w&&dt.postRender(()=>w(g,p)),Ru(this.visualElement,"transform");const{animationState:k}=this.visualElement;k&&k.setActive("whileDrag",!0)},l=(g,p)=>{const{dragPropagation:y,dragDirectionLock:v,onDirectionLock:w,onDrag:k}=this.getProps();if(!y&&!this.openDragLock)return;const{offset:N}=p;if(v&&this.currentDirection===null){this.currentDirection=gC(N),this.currentDirection!==null&&w&&w(this.currentDirection);return}this.updateAxis("x",p.point,N),this.updateAxis("y",p.point,N),this.visualElement.render(),k&&k(g,p)},u=(g,p)=>this.stop(g,p),h=()=>Ps(g=>{var p;return this.getAnimationState(g)==="paused"&&((p=this.getAxisMotionValue(g).animation)===null||p===void 0?void 0:p.play())}),{dragSnapToOrigin:f}=this.getProps();this.panSession=new ob(e,{onSessionStart:o,onStart:c,onMove:l,onSessionEnd:u,resumeAnimation:h},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:f,contextWindow:pb(this.visualElement)})}stop(e,r){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:o}=r;this.startAnimation(o);const{onDragEnd:c}=this.getProps();c&&dt.postRender(()=>c(e,r))}cancel(){this.isDragging=!1;const{projection:e,animationState:r}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(e,r,i){const{drag:o}=this.getProps();if(!i||!Al(e,o,this.currentDirection))return;const c=this.getAxisMotionValue(e);let l=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(l=nC(l,this.constraints[e],this.elastic[e])),c.set(l)}resolveConstraints(){var e;const{dragConstraints:r,dragElastic:i}=this.getProps(),o=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,c=this.constraints;r&&bi(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&o?this.constraints=iC(o.layoutBox,r):this.constraints=!1,this.elastic=cC(i),c!==this.constraints&&o&&this.constraints&&!this.hasMutatedConstraints&&Ps(l=>{this.constraints!==!1&&this.getAxisMotionValue(l)&&(this.constraints[l]=lC(o.layoutBox[l],this.constraints[l]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:r}=this.getProps();if(!e||!bi(e))return!1;const i=e.current,{projection:o}=this.visualElement;if(!o||!o.layout)return!1;const c=mC(i,o.root,this.visualElement.getTransformPagePoint());let l=aC(o.layout.layoutBox,c);if(r){const u=r(dC(l));this.hasMutatedConstraints=!!u,u&&(l=ub(u))}return l}startAnimation(e){const{drag:r,dragMomentum:i,dragElastic:o,dragTransition:c,dragSnapToOrigin:l,onDragTransitionEnd:u}=this.getProps(),h=this.constraints||{},f=Ps(g=>{if(!Al(g,r,this.currentDirection))return;let p=h&&h[g]||{};l&&(p={min:0,max:0});const y=o?200:1e6,v=o?40:1e7,w={type:"inertia",velocity:i?e[g]:0,bounceStiffness:y,bounceDamping:v,timeConstant:750,restDelta:1,restSpeed:10,...c,...p};return this.startAxisValueAnimation(g,w)});return Promise.all(f).then(u)}startAxisValueAnimation(e,r){const i=this.getAxisMotionValue(e);return Ru(this.visualElement,e),i.start(Hh(e,i,0,r,this.visualElement,!1))}stopAnimation(){Ps(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Ps(e=>{var r;return(r=this.getAxisMotionValue(e).animation)===null||r===void 0?void 0:r.pause()})}getAnimationState(e){var r;return(r=this.getAxisMotionValue(e).animation)===null||r===void 0?void 0:r.state}getAxisMotionValue(e){const r=`_drag${e.toUpperCase()}`,i=this.visualElement.getProps(),o=i[r];return o||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){Ps(r=>{const{drag:i}=this.getProps();if(!Al(r,i,this.currentDirection))return;const{projection:o}=this.visualElement,c=this.getAxisMotionValue(r);if(o&&o.layout){const{min:l,max:u}=o.layout.layoutBox[r];c.set(e[r]-xt(l,u,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:r}=this.getProps(),{projection:i}=this.visualElement;if(!bi(r)||!i||!this.constraints)return;this.stopAnimation();const o={x:0,y:0};Ps(l=>{const u=this.getAxisMotionValue(l);if(u&&this.constraints!==!1){const h=u.get();o[l]=oC({min:h,max:h},this.constraints[l])}});const{transformTemplate:c}=this.visualElement.getProps();this.visualElement.current.style.transform=c?c({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),Ps(l=>{if(!Al(l,e,null))return;const u=this.getAxisMotionValue(l),{min:h,max:f}=this.constraints[l];u.set(xt(h,f,o[l]))})}addListeners(){if(!this.visualElement.current)return;fC.set(this.visualElement,this);const e=this.visualElement.current,r=Ra(e,"pointerdown",h=>{const{drag:f,dragListener:g=!0}=this.getProps();f&&g&&this.start(h)}),i=()=>{const{dragConstraints:h}=this.getProps();bi(h)&&h.current&&(this.constraints=this.resolveRefConstraints())},{projection:o}=this.visualElement,c=o.addEventListener("measure",i);o&&!o.layout&&(o.root&&o.root.updateScroll(),o.updateLayout()),dt.read(i);const l=Qa(window,"resize",()=>this.scalePositionWithinConstraints()),u=o.addEventListener("didUpdate",(({delta:h,hasLayoutChanged:f})=>{this.isDragging&&f&&(Ps(g=>{const p=this.getAxisMotionValue(g);p&&(this.originPoint[g]+=h[g].translate,p.set(p.get()+h[g].translate))}),this.visualElement.render())}));return()=>{l(),r(),c(),u&&u()}}getProps(){const e=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:i=!1,dragPropagation:o=!1,dragConstraints:c=!1,dragElastic:l=zu,dragMomentum:u=!0}=e;return{...e,drag:r,dragDirectionLock:i,dragPropagation:o,dragConstraints:c,dragElastic:l,dragMomentum:u}}}function Al(t,e,r){return(e===!0||e===t)&&(r===null||r===t)}function gC(t,e=10){let r=null;return Math.abs(t.y)>e?r="y":Math.abs(t.x)>e&&(r="x"),r}class xC extends cn{constructor(e){super(e),this.removeGroupControls=vs,this.removeListeners=vs,this.controls=new pC(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||vs}unmount(){this.removeGroupControls(),this.removeListeners()}}const ox=t=>(e,r)=>{t&&dt.postRender(()=>t(e,r))};class yC extends cn{constructor(){super(...arguments),this.removePointerDownListener=vs}onPointerDown(e){this.session=new ob(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:pb(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:r,onPan:i,onPanEnd:o}=this.node.getProps();return{onSessionStart:ox(e),onStart:ox(r),onMove:i,onEnd:(c,l)=>{delete this.session,o&&dt.postRender(()=>o(c,l))}}}mount(){this.removePointerDownListener=Ra(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Ol={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function lx(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const ja={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(We.test(t))t=parseFloat(t);else return t;const r=lx(t,e.target.x),i=lx(t,e.target.y);return`${r}% ${i}%`}},bC={correct:(t,{treeScale:e,projectionDelta:r})=>{const i=t,o=on.parse(t);if(o.length>5)return i;const c=on.createTransformer(t),l=typeof o[0]!="number"?1:0,u=r.x.scale*e.x,h=r.y.scale*e.y;o[0+l]/=u,o[1+l]/=h;const f=xt(u,h,.5);return typeof o[2+l]=="number"&&(o[2+l]/=f),typeof o[3+l]=="number"&&(o[3+l]/=f),c(o)}};class vC extends j.Component{componentDidMount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:i,layoutId:o}=this.props,{projection:c}=e;Hk(wC),c&&(r.group&&r.group.add(c),i&&i.register&&o&&i.register(c),c.root.didUpdate(),c.addEventListener("animationComplete",()=>{this.safeToRemove()}),c.setOptions({...c.options,onExitComplete:()=>this.safeToRemove()})),Ol.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:r,visualElement:i,drag:o,isPresent:c}=this.props,l=i.projection;return l&&(l.isPresent=c,o||e.layoutDependency!==r||r===void 0?l.willUpdate():this.safeToRemove(),e.isPresent!==c&&(c?l.promote():l.relegate()||dt.postRender(()=>{const u=l.getStack();(!u||!u.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),wh.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:i}=this.props,{projection:o}=e;o&&(o.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(o),i&&i.deregister&&i.deregister(o))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function gb(t){const[e,r]=e0(),i=j.useContext(fh);return s.jsx(vC,{...t,layoutGroup:i,switchLayoutGroup:j.useContext(l0),isPresent:e,safeToRemove:r})}const wC={borderRadius:{...ja,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:ja,borderTopRightRadius:ja,borderBottomLeftRadius:ja,borderBottomRightRadius:ja,boxShadow:bC};function jC(t,e,r){const i=Jt(t)?t:Ya(t);return i.start(Hh("",i,e,r)),i.animation}function NC(t){return t instanceof SVGElement&&t.tagName!=="svg"}const kC=(t,e)=>t.depth-e.depth;class _C{constructor(){this.children=[],this.isDirty=!1}add(e){Ih(this.children,e),this.isDirty=!0}remove(e){Lh(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(kC),this.isDirty=!1,this.children.forEach(e)}}function SC(t,e){const r=dr.now(),i=({timestamp:o})=>{const c=o-r;c>=e&&(an(i),t(c-e))};return dt.read(i,!0),()=>an(i)}const xb=["TopLeft","TopRight","BottomLeft","BottomRight"],CC=xb.length,cx=t=>typeof t=="string"?parseFloat(t):t,dx=t=>typeof t=="number"||We.test(t);function TC(t,e,r,i,o,c){o?(t.opacity=xt(0,r.opacity!==void 0?r.opacity:1,EC(i)),t.opacityExit=xt(e.opacity!==void 0?e.opacity:1,0,PC(i))):c&&(t.opacity=xt(e.opacity!==void 0?e.opacity:1,r.opacity!==void 0?r.opacity:1,i));for(let l=0;l<CC;l++){const u=`border${xb[l]}Radius`;let h=ux(e,u),f=ux(r,u);if(h===void 0&&f===void 0)continue;h||(h=0),f||(f=0),h===0||f===0||dx(h)===dx(f)?(t[u]=Math.max(xt(cx(h),cx(f),i),0),(cr.test(f)||cr.test(h))&&(t[u]+="%")):t[u]=f}(e.rotate||r.rotate)&&(t.rotate=xt(e.rotate||0,r.rotate||0,i))}function ux(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const EC=yb(0,.5,R0),PC=yb(.5,.95,vs);function yb(t,e,r){return i=>i<t?0:i>e?1:r(Pi(t,e,i))}function hx(t,e){t.min=e.min,t.max=e.max}function Es(t,e){hx(t.x,e.x),hx(t.y,e.y)}function mx(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function fx(t,e,r,i,o){return t-=e,t=Yl(t,1/r,i),o!==void 0&&(t=Yl(t,1/o,i)),t}function AC(t,e=0,r=1,i=.5,o,c=t,l=t){if(cr.test(e)&&(e=parseFloat(e),e=xt(l.min,l.max,e/100)-l.min),typeof e!="number")return;let u=xt(c.min,c.max,i);t===c&&(u-=e),t.min=fx(t.min,e,r,u,o),t.max=fx(t.max,e,r,u,o)}function px(t,e,[r,i,o],c,l){AC(t,e[r],e[i],e[o],e.scale,c,l)}const IC=["x","scaleX","originX"],LC=["y","scaleY","originY"];function gx(t,e,r,i){px(t.x,e,IC,r?r.x:void 0,i?i.x:void 0),px(t.y,e,LC,r?r.y:void 0,i?i.y:void 0)}function xx(t){return t.translate===0&&t.scale===1}function bb(t){return xx(t.x)&&xx(t.y)}function yx(t,e){return t.min===e.min&&t.max===e.max}function RC(t,e){return yx(t.x,e.x)&&yx(t.y,e.y)}function bx(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function vb(t,e){return bx(t.x,e.x)&&bx(t.y,e.y)}function vx(t){return ws(t.x)/ws(t.y)}function wx(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class DC{constructor(){this.members=[]}add(e){Ih(this.members,e),e.scheduleRender()}remove(e){if(Lh(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(e){const r=this.members.findIndex(o=>e===o);if(r===0)return!1;let i;for(let o=r;o>=0;o--){const c=this.members[o];if(c.isPresent!==!1){i=c;break}}return i?(this.promote(i),!0):!1}promote(e,r){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,r&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:o}=e.options;o===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:r,resumingFrom:i}=e;r.onExitComplete&&r.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function FC(t,e,r){let i="";const o=t.x.translate/e.x,c=t.y.translate/e.y,l=r?.z||0;if((o||c||l)&&(i=`translate3d(${o}px, ${c}px, ${l}px) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),r){const{transformPerspective:f,rotate:g,rotateX:p,rotateY:y,skewX:v,skewY:w}=r;f&&(i=`perspective(${f}px) ${i}`),g&&(i+=`rotate(${g}deg) `),p&&(i+=`rotateX(${p}deg) `),y&&(i+=`rotateY(${y}deg) `),v&&(i+=`skewX(${v}deg) `),w&&(i+=`skewY(${w}deg) `)}const u=t.x.scale*e.x,h=t.y.scale*e.y;return(u!==1||h!==1)&&(i+=`scale(${u}, ${h})`),i||"none"}const Tn={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},Sa=typeof window<"u"&&window.MotionDebug!==void 0,pu=["","X","Y","Z"],MC={visibility:"hidden"},jx=1e3;let OC=0;function gu(t,e,r,i){const{latestValues:o}=e;o[t]&&(r[t]=o[t],e.setStaticValue(t,0),i&&(i[t]=0))}function wb(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const r=k0(e);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:o,layoutId:c}=t.options;window.MotionCancelOptimisedAnimation(r,"transform",dt,!(o||c))}const{parent:i}=t;i&&!i.hasCheckedOptimisedAppear&&wb(i)}function jb({attachResizeListener:t,defaultParent:e,measureScroll:r,checkIsScrollRoot:i,resetTransform:o}){return class{constructor(l={},u=e?.()){this.id=OC++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Sa&&(Tn.totalNodes=Tn.resolvedTargetDeltas=Tn.recalculatedProjection=0),this.nodes.forEach(BC),this.nodes.forEach(HC),this.nodes.forEach(GC),this.nodes.forEach(WC),Sa&&window.MotionDebug.record(Tn)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=l,this.root=u?u.root||u:this,this.path=u?[...u.path,u]:[],this.parent=u,this.depth=u?u.depth+1:0;for(let h=0;h<this.path.length;h++)this.path[h].shouldResetTransform=!0;this.root===this&&(this.nodes=new _C)}addEventListener(l,u){return this.eventHandlers.has(l)||this.eventHandlers.set(l,new Rh),this.eventHandlers.get(l).add(u)}notifyListeners(l,...u){const h=this.eventHandlers.get(l);h&&h.notify(...u)}hasListeners(l){return this.eventHandlers.has(l)}mount(l,u=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=NC(l),this.instance=l;const{layoutId:h,layout:f,visualElement:g}=this.options;if(g&&!g.current&&g.mount(l),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),u&&(f||h)&&(this.isLayoutDirty=!0),t){let p;const y=()=>this.root.updateBlockedByResize=!1;t(l,()=>{this.root.updateBlockedByResize=!0,p&&p(),p=SC(y,250),Ol.hasAnimatedSinceResize&&(Ol.hasAnimatedSinceResize=!1,this.nodes.forEach(kx))})}h&&this.root.registerSharedNode(h,this),this.options.animate!==!1&&g&&(h||f)&&this.addEventListener("didUpdate",({delta:p,hasLayoutChanged:y,hasRelativeTargetChanged:v,layout:w})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const k=this.options.transition||g.getDefaultTransition()||ZC,{onLayoutAnimationStart:N,onLayoutAnimationComplete:C}=g.getProps(),A=!this.targetLayout||!vb(this.targetLayout,w)||v,E=!y&&v;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||E||y&&(A||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(p,E);const _={...Ah(k,"layout"),onPlay:N,onComplete:C};(g.shouldReduceMotion||this.options.layoutRoot)&&(_.delay=0,_.type=!1),this.startAnimation(_)}else y||kx(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=w})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const l=this.getStack();l&&l.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,an(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(KC),this.animationId++)}getTransformTemplate(){const{visualElement:l}=this.options;return l&&l.getProps().transformTemplate}willUpdate(l=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&wb(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let g=0;g<this.path.length;g++){const p=this.path[g];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:u,layout:h}=this.options;if(u===void 0&&!h)return;const f=this.getTransformTemplate();this.prevTransformTemplateValue=f?f(this.latestValues,""):void 0,this.updateSnapshot(),l&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Nx);return}this.isUpdating||this.nodes.forEach(zC),this.isUpdating=!1,this.nodes.forEach(qC),this.nodes.forEach(UC),this.nodes.forEach($C),this.clearAllSnapshots();const u=dr.now();Vt.delta=Er(0,1e3/60,u-Vt.timestamp),Vt.timestamp=u,Vt.isProcessing=!0,ou.update.process(Vt),ou.preRender.process(Vt),ou.render.process(Vt),Vt.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,wh.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(VC),this.sharedNodes.forEach(YC)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,dt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){dt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let h=0;h<this.path.length;h++)this.path[h].updateScroll();const l=this.layout;this.layout=this.measure(!1),this.layoutCorrected=_t(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:u}=this.options;u&&u.notify("LayoutMeasure",this.layout.layoutBox,l?l.layoutBox:void 0)}updateScroll(l="measure"){let u=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===l&&(u=!1),u){const h=i(this.instance);this.scroll={animationId:this.root.animationId,phase:l,isRoot:h,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:h}}}resetTransform(){if(!o)return;const l=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,u=this.projectionDelta&&!bb(this.projectionDelta),h=this.getTransformTemplate(),f=h?h(this.latestValues,""):void 0,g=f!==this.prevTransformTemplateValue;l&&(u||Cn(this.latestValues)||g)&&(o(this.instance,f),this.shouldResetTransform=!1,this.scheduleRender())}measure(l=!0){const u=this.measurePageBox();let h=this.removeElementScroll(u);return l&&(h=this.removeTransform(h)),XC(h),{animationId:this.root.animationId,measuredBox:u,layoutBox:h,latestValues:{},source:this.id}}measurePageBox(){var l;const{visualElement:u}=this.options;if(!u)return _t();const h=u.measureViewportBox();if(!(((l=this.scroll)===null||l===void 0?void 0:l.wasRoot)||this.path.some(e5))){const{scroll:g}=this.root;g&&(ji(h.x,g.offset.x),ji(h.y,g.offset.y))}return h}removeElementScroll(l){var u;const h=_t();if(Es(h,l),!((u=this.scroll)===null||u===void 0)&&u.wasRoot)return h;for(let f=0;f<this.path.length;f++){const g=this.path[f],{scroll:p,options:y}=g;g!==this.root&&p&&y.layoutScroll&&(p.wasRoot&&Es(h,l),ji(h.x,p.offset.x),ji(h.y,p.offset.y))}return h}applyTransform(l,u=!1){const h=_t();Es(h,l);for(let f=0;f<this.path.length;f++){const g=this.path[f];!u&&g.options.layoutScroll&&g.scroll&&g!==g.root&&Ni(h,{x:-g.scroll.offset.x,y:-g.scroll.offset.y}),Cn(g.latestValues)&&Ni(h,g.latestValues)}return Cn(this.latestValues)&&Ni(h,this.latestValues),h}removeTransform(l){const u=_t();Es(u,l);for(let h=0;h<this.path.length;h++){const f=this.path[h];if(!f.instance||!Cn(f.latestValues))continue;qu(f.latestValues)&&f.updateSnapshot();const g=_t(),p=f.measurePageBox();Es(g,p),gx(u,f.latestValues,f.snapshot?f.snapshot.layoutBox:void 0,g)}return Cn(this.latestValues)&&gx(u,this.latestValues),u}setTargetDelta(l){this.targetDelta=l,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(l){this.options={...this.options,...l,crossfade:l.crossfade!==void 0?l.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Vt.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(l=!1){var u;const h=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=h.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=h.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=h.isSharedProjectionDirty);const f=!!this.resumingFrom||this!==h;if(!(l||f&&this.isSharedProjectionDirty||this.isProjectionDirty||!((u=this.parent)===null||u===void 0)&&u.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:p,layoutId:y}=this.options;if(!(!this.layout||!(p||y))){if(this.resolvedRelativeTargetAt=Vt.timestamp,!this.targetDelta&&!this.relativeTarget){const v=this.getClosestProjectingParent();v&&v.layout&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=_t(),this.relativeTargetOrigin=_t(),Fa(this.relativeTargetOrigin,this.layout.layoutBox,v.layout.layoutBox),Es(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=_t(),this.targetWithTransforms=_t()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),rC(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Es(this.target,this.layout.layoutBox),mb(this.target,this.targetDelta)):Es(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const v=this.getClosestProjectingParent();v&&!!v.resumingFrom==!!this.resumingFrom&&!v.options.layoutScroll&&v.target&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=_t(),this.relativeTargetOrigin=_t(),Fa(this.relativeTargetOrigin,this.target,v.target),Es(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Sa&&Tn.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||qu(this.parent.latestValues)||hb(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var l;const u=this.getLead(),h=!!this.resumingFrom||this!==u;let f=!0;if((this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty)&&(f=!1),h&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(f=!1),this.resolvedRelativeTargetAt===Vt.timestamp&&(f=!1),f)return;const{layout:g,layoutId:p}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(g||p))return;Es(this.layoutCorrected,this.layout.layoutBox);const y=this.treeScale.x,v=this.treeScale.y;hC(this.layoutCorrected,this.treeScale,this.path,h),u.layout&&!u.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(u.target=u.layout.layoutBox,u.targetWithTransforms=_t());const{target:w}=u;if(!w){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(mx(this.prevProjectionDelta.x,this.projectionDelta.x),mx(this.prevProjectionDelta.y,this.projectionDelta.y)),Da(this.projectionDelta,this.layoutCorrected,w,this.latestValues),(this.treeScale.x!==y||this.treeScale.y!==v||!wx(this.projectionDelta.x,this.prevProjectionDelta.x)||!wx(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",w)),Sa&&Tn.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(l=!0){var u;if((u=this.options.visualElement)===null||u===void 0||u.scheduleRender(),l){const h=this.getStack();h&&h.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=wi(),this.projectionDelta=wi(),this.projectionDeltaWithTransform=wi()}setAnimationOrigin(l,u=!1){const h=this.snapshot,f=h?h.latestValues:{},g={...this.latestValues},p=wi();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!u;const y=_t(),v=h?h.source:void 0,w=this.layout?this.layout.source:void 0,k=v!==w,N=this.getStack(),C=!N||N.members.length<=1,A=!!(k&&!C&&this.options.crossfade===!0&&!this.path.some(QC));this.animationProgress=0;let E;this.mixTargetDelta=_=>{const R=_/1e3;_x(p.x,l.x,R),_x(p.y,l.y,R),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Fa(y,this.layout.layoutBox,this.relativeParent.layout.layoutBox),JC(this.relativeTarget,this.relativeTargetOrigin,y,R),E&&RC(this.relativeTarget,E)&&(this.isProjectionDirty=!1),E||(E=_t()),Es(E,this.relativeTarget)),k&&(this.animationValues=g,TC(g,f,this.latestValues,R,A,C)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=R},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(l){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(an(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=dt.update(()=>{Ol.hasAnimatedSinceResize=!0,this.currentAnimation=jC(0,jx,{...l,onUpdate:u=>{this.mixTargetDelta(u),l.onUpdate&&l.onUpdate(u)},onComplete:()=>{l.onComplete&&l.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const l=this.getStack();l&&l.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(jx),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const l=this.getLead();let{targetWithTransforms:u,target:h,layout:f,latestValues:g}=l;if(!(!u||!h||!f)){if(this!==l&&this.layout&&f&&Nb(this.options.animationType,this.layout.layoutBox,f.layoutBox)){h=this.target||_t();const p=ws(this.layout.layoutBox.x);h.x.min=l.target.x.min,h.x.max=h.x.min+p;const y=ws(this.layout.layoutBox.y);h.y.min=l.target.y.min,h.y.max=h.y.min+y}Es(u,h),Ni(u,g),Da(this.projectionDeltaWithTransform,this.layoutCorrected,u,g)}}registerSharedNode(l,u){this.sharedNodes.has(l)||this.sharedNodes.set(l,new DC),this.sharedNodes.get(l).add(u);const f=u.options.initialPromotionConfig;u.promote({transition:f?f.transition:void 0,preserveFollowOpacity:f&&f.shouldPreserveFollowOpacity?f.shouldPreserveFollowOpacity(u):void 0})}isLead(){const l=this.getStack();return l?l.lead===this:!0}getLead(){var l;const{layoutId:u}=this.options;return u?((l=this.getStack())===null||l===void 0?void 0:l.lead)||this:this}getPrevLead(){var l;const{layoutId:u}=this.options;return u?(l=this.getStack())===null||l===void 0?void 0:l.prevLead:void 0}getStack(){const{layoutId:l}=this.options;if(l)return this.root.sharedNodes.get(l)}promote({needsReset:l,transition:u,preserveFollowOpacity:h}={}){const f=this.getStack();f&&f.promote(this,h),l&&(this.projectionDelta=void 0,this.needsReset=!0),u&&this.setOptions({transition:u})}relegate(){const l=this.getStack();return l?l.relegate(this):!1}resetSkewAndRotation(){const{visualElement:l}=this.options;if(!l)return;let u=!1;const{latestValues:h}=l;if((h.z||h.rotate||h.rotateX||h.rotateY||h.rotateZ||h.skewX||h.skewY)&&(u=!0),!u)return;const f={};h.z&&gu("z",l,f,this.animationValues);for(let g=0;g<pu.length;g++)gu(`rotate${pu[g]}`,l,f,this.animationValues),gu(`skew${pu[g]}`,l,f,this.animationValues);l.render();for(const g in f)l.setStaticValue(g,f[g]),this.animationValues&&(this.animationValues[g]=f[g]);l.scheduleRender()}getProjectionStyles(l){var u,h;if(!this.instance||this.isSVG)return;if(!this.isVisible)return MC;const f={visibility:""},g=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,f.opacity="",f.pointerEvents=Fl(l?.pointerEvents)||"",f.transform=g?g(this.latestValues,""):"none",f;const p=this.getLead();if(!this.projectionDelta||!this.layout||!p.target){const k={};return this.options.layoutId&&(k.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,k.pointerEvents=Fl(l?.pointerEvents)||""),this.hasProjected&&!Cn(this.latestValues)&&(k.transform=g?g({},""):"none",this.hasProjected=!1),k}const y=p.animationValues||p.latestValues;this.applyTransformsToTarget(),f.transform=FC(this.projectionDeltaWithTransform,this.treeScale,y),g&&(f.transform=g(y,f.transform));const{x:v,y:w}=this.projectionDelta;f.transformOrigin=`${v.origin*100}% ${w.origin*100}% 0`,p.animationValues?f.opacity=p===this?(h=(u=y.opacity)!==null&&u!==void 0?u:this.latestValues.opacity)!==null&&h!==void 0?h:1:this.preserveOpacity?this.latestValues.opacity:y.opacityExit:f.opacity=p===this?y.opacity!==void 0?y.opacity:"":y.opacityExit!==void 0?y.opacityExit:0;for(const k in zl){if(y[k]===void 0)continue;const{correct:N,applyTo:C}=zl[k],A=f.transform==="none"?y[k]:N(y[k],p);if(C){const E=C.length;for(let _=0;_<E;_++)f[C[_]]=A}else f[k]=A}return this.options.layoutId&&(f.pointerEvents=p===this?Fl(l?.pointerEvents)||"":"none"),f}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(l=>{var u;return(u=l.currentAnimation)===null||u===void 0?void 0:u.stop()}),this.root.nodes.forEach(Nx),this.root.sharedNodes.clear()}}}function UC(t){t.updateLayout()}function $C(t){var e;const r=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&r&&t.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:o}=t.layout,{animationType:c}=t.options,l=r.source!==t.layout.source;c==="size"?Ps(p=>{const y=l?r.measuredBox[p]:r.layoutBox[p],v=ws(y);y.min=i[p].min,y.max=y.min+v}):Nb(c,r.layoutBox,i)&&Ps(p=>{const y=l?r.measuredBox[p]:r.layoutBox[p],v=ws(i[p]);y.max=y.min+v,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[p].max=t.relativeTarget[p].min+v)});const u=wi();Da(u,i,r.layoutBox);const h=wi();l?Da(h,t.applyTransform(o,!0),r.measuredBox):Da(h,i,r.layoutBox);const f=!bb(u);let g=!1;if(!t.resumeFrom){const p=t.getClosestProjectingParent();if(p&&!p.resumeFrom){const{snapshot:y,layout:v}=p;if(y&&v){const w=_t();Fa(w,r.layoutBox,y.layoutBox);const k=_t();Fa(k,i,v.layoutBox),vb(w,k)||(g=!0),p.options.layoutRoot&&(t.relativeTarget=k,t.relativeTargetOrigin=w,t.relativeParent=p)}}}t.notifyListeners("didUpdate",{layout:i,snapshot:r,delta:h,layoutDelta:u,hasLayoutChanged:f,hasRelativeTargetChanged:g})}else if(t.isLead()){const{onExitComplete:i}=t.options;i&&i()}t.options.transition=void 0}function BC(t){Sa&&Tn.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function WC(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function VC(t){t.clearSnapshot()}function Nx(t){t.clearMeasurements()}function zC(t){t.isLayoutDirty=!1}function qC(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function kx(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function HC(t){t.resolveTargetDelta()}function GC(t){t.calcProjection()}function KC(t){t.resetSkewAndRotation()}function YC(t){t.removeLeadSnapshot()}function _x(t,e,r){t.translate=xt(e.translate,0,r),t.scale=xt(e.scale,1,r),t.origin=e.origin,t.originPoint=e.originPoint}function Sx(t,e,r,i){t.min=xt(e.min,r.min,i),t.max=xt(e.max,r.max,i)}function JC(t,e,r,i){Sx(t.x,e.x,r.x,i),Sx(t.y,e.y,r.y,i)}function QC(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const ZC={duration:.45,ease:[.4,0,.1,1]},Cx=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),Tx=Cx("applewebkit/")&&!Cx("chrome/")?Math.round:vs;function Ex(t){t.min=Tx(t.min),t.max=Tx(t.max)}function XC(t){Ex(t.x),Ex(t.y)}function Nb(t,e,r){return t==="position"||t==="preserve-aspect"&&!sC(vx(e),vx(r),.2)}function e5(t){var e;return t!==t.root&&((e=t.scroll)===null||e===void 0?void 0:e.wasRoot)}const t5=jb({attachResizeListener:(t,e)=>Qa(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),xu={current:void 0},kb=jb({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!xu.current){const t=new t5({});t.mount(window),t.setOptions({layoutScroll:!0}),xu.current=t}return xu.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),s5={pan:{Feature:yC},drag:{Feature:xC,ProjectionNode:kb,MeasureLayout:gb}};function r5(t,e,r){var i;if(t instanceof Element)return[t];if(typeof t=="string"){let o=document;const c=(i=void 0)!==null&&i!==void 0?i:o.querySelectorAll(t);return c?Array.from(c):[]}return Array.from(t)}function _b(t,e){const r=r5(t),i=new AbortController,o={passive:!0,...e,signal:i.signal};return[r,o,()=>i.abort()]}function Px(t){return e=>{e.pointerType==="touch"||ab()||t(e)}}function n5(t,e,r={}){const[i,o,c]=_b(t,r),l=Px(u=>{const{target:h}=u,f=e(u);if(typeof f!="function"||!h)return;const g=Px(p=>{f(p),h.removeEventListener("pointerleave",g)});h.addEventListener("pointerleave",g,o)});return i.forEach(u=>{u.addEventListener("pointerenter",l,o)}),c}function Ax(t,e,r){const{props:i}=t;t.animationState&&i.whileHover&&t.animationState.setActive("whileHover",r==="Start");const o="onHover"+r,c=i[o];c&&dt.postRender(()=>c(e,io(e)))}class i5 extends cn{mount(){const{current:e}=this.node;e&&(this.unmount=n5(e,r=>(Ax(this.node,r,"Start"),i=>Ax(this.node,i,"End"))))}unmount(){}}class a5 extends cn{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=no(Qa(this.node.current,"focus",()=>this.onFocus()),Qa(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const Sb=(t,e)=>e?t===e?!0:Sb(t,e.parentElement):!1,o5=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function l5(t){return o5.has(t.tagName)||t.tabIndex!==-1}const Ca=new WeakSet;function Ix(t){return e=>{e.key==="Enter"&&t(e)}}function yu(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const c5=(t,e)=>{const r=t.currentTarget;if(!r)return;const i=Ix(()=>{if(Ca.has(r))return;yu(r,"down");const o=Ix(()=>{yu(r,"up")}),c=()=>yu(r,"cancel");r.addEventListener("keyup",o,e),r.addEventListener("blur",c,e)});r.addEventListener("keydown",i,e),r.addEventListener("blur",()=>r.removeEventListener("keydown",i),e)};function Lx(t){return Gh(t)&&!ab()}function d5(t,e,r={}){const[i,o,c]=_b(t,r),l=u=>{const h=u.currentTarget;if(!Lx(u)||Ca.has(h))return;Ca.add(h);const f=e(u),g=(v,w)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",y),!(!Lx(v)||!Ca.has(h))&&(Ca.delete(h),typeof f=="function"&&f(v,{success:w}))},p=v=>{g(v,r.useGlobalTarget||Sb(h,v.target))},y=v=>{g(v,!1)};window.addEventListener("pointerup",p,o),window.addEventListener("pointercancel",y,o)};return i.forEach(u=>{!l5(u)&&u.getAttribute("tabindex")===null&&(u.tabIndex=0),(r.useGlobalTarget?window:u).addEventListener("pointerdown",l,o),u.addEventListener("focus",f=>c5(f,o),o)}),c}function Rx(t,e,r){const{props:i}=t;t.animationState&&i.whileTap&&t.animationState.setActive("whileTap",r==="Start");const o="onTap"+(r==="End"?"":r),c=i[o];c&&dt.postRender(()=>c(e,io(e)))}class u5 extends cn{mount(){const{current:e}=this.node;e&&(this.unmount=d5(e,r=>(Rx(this.node,r,"Start"),(i,{success:o})=>Rx(this.node,i,o?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Gu=new WeakMap,bu=new WeakMap,h5=t=>{const e=Gu.get(t.target);e&&e(t)},m5=t=>{t.forEach(h5)};function f5({root:t,...e}){const r=t||document;bu.has(r)||bu.set(r,{});const i=bu.get(r),o=JSON.stringify(e);return i[o]||(i[o]=new IntersectionObserver(m5,{root:t,...e})),i[o]}function p5(t,e,r){const i=f5(e);return Gu.set(t,r),i.observe(t),()=>{Gu.delete(t),i.unobserve(t)}}const g5={some:0,all:1};class x5 extends cn{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:r,margin:i,amount:o="some",once:c}=e,l={root:r?r.current:void 0,rootMargin:i,threshold:typeof o=="number"?o:g5[o]},u=h=>{const{isIntersecting:f}=h;if(this.isInView===f||(this.isInView=f,c&&!f&&this.hasEnteredView))return;f&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",f);const{onViewportEnter:g,onViewportLeave:p}=this.node.getProps(),y=f?g:p;y&&y(h)};return p5(this.node.current,l,u)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:r}=this.node;["amount","margin","root"].some(y5(e,r))&&this.startObserver()}unmount(){}}function y5({viewport:t={}},{viewport:e={}}={}){return r=>t[r]!==e[r]}const b5={inView:{Feature:x5},tap:{Feature:u5},focus:{Feature:a5},hover:{Feature:i5}},v5={layout:{ProjectionNode:kb,MeasureLayout:gb}},Ku={current:null},Cb={current:!1};function w5(){if(Cb.current=!0,!!xh)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>Ku.current=t.matches;t.addListener(e),e()}else Ku.current=!1}const j5=[...K0,Yt,on],N5=t=>j5.find(G0(t)),Dx=new WeakMap;function k5(t,e,r){for(const i in e){const o=e[i],c=r[i];if(Jt(o))t.addValue(i,o);else if(Jt(c))t.addValue(i,Ya(o,{owner:t}));else if(c!==o)if(t.hasValue(i)){const l=t.getValue(i);l.liveStyle===!0?l.jump(o):l.hasAnimated||l.set(o)}else{const l=t.getStaticValue(i);t.addValue(i,Ya(l!==void 0?l:o,{owner:t}))}}for(const i in r)e[i]===void 0&&t.removeValue(i);return e}const Fx=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class _5{scrapeMotionValuesFromProps(e,r,i){return{}}constructor({parent:e,props:r,presenceContext:i,reducedMotionConfig:o,blockInitialAnimation:c,visualState:l},u={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Vh,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const v=dr.now();this.renderScheduledAt<v&&(this.renderScheduledAt=v,dt.render(this.render,!1,!0))};const{latestValues:h,renderState:f,onUpdate:g}=l;this.onUpdate=g,this.latestValues=h,this.baseTarget={...h},this.initialValues=r.initial?{...h}:{},this.renderState=f,this.parent=e,this.props=r,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=o,this.options=u,this.blockInitialAnimation=!!c,this.isControllingVariants=nc(r),this.isVariantNode=a0(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:p,...y}=this.scrapeMotionValuesFromProps(r,{},this);for(const v in y){const w=y[v];h[v]!==void 0&&Jt(w)&&w.set(h[v],!1)}}mount(e){this.current=e,Dx.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,i)=>this.bindToMotionValue(i,r)),Cb.current||w5(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Ku.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){Dx.delete(this.current),this.projection&&this.projection.unmount(),an(this.notifyUpdate),an(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const r=this.features[e];r&&(r.unmount(),r.isMounted=!1)}this.current=null}bindToMotionValue(e,r){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const i=Mn.has(e),o=r.on("change",u=>{this.latestValues[e]=u,this.props.onUpdate&&dt.preRender(this.notifyUpdate),i&&this.projection&&(this.projection.isTransformDirty=!0)}),c=r.on("renderRequest",this.scheduleRender);let l;window.MotionCheckAppearSync&&(l=window.MotionCheckAppearSync(this,e,r)),this.valueSubscriptions.set(e,()=>{o(),c(),l&&l(),r.owner&&r.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Ei){const r=Ei[e];if(!r)continue;const{isEnabled:i,Feature:o}=r;if(!this.features[e]&&o&&i(this.props)&&(this.features[e]=new o(this)),this.features[e]){const c=this.features[e];c.isMounted?c.update():(c.mount(),c.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):_t()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,r){this.latestValues[e]=r}update(e,r){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let i=0;i<Fx.length;i++){const o=Fx[i];this.propEventSubscriptions[o]&&(this.propEventSubscriptions[o](),delete this.propEventSubscriptions[o]);const c="on"+o,l=e[c];l&&(this.propEventSubscriptions[o]=this.on(o,l))}this.prevMotionValues=k5(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(e),()=>r.variantChildren.delete(e)}addValue(e,r){const i=this.values.get(e);r!==i&&(i&&this.removeValue(e),this.bindToMotionValue(e,r),this.values.set(e,r),this.latestValues[e]=r.get())}removeValue(e){this.values.delete(e);const r=this.valueSubscriptions.get(e);r&&(r(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,r){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&r!==void 0&&(i=Ya(r===null?void 0:r,{owner:this}),this.addValue(e,i)),i}readValue(e,r){var i;let o=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(i=this.getBaseTargetFromProps(this.props,e))!==null&&i!==void 0?i:this.readValueFromInstance(this.current,e,this.options);return o!=null&&(typeof o=="string"&&(q0(o)||F0(o))?o=parseFloat(o):!N5(o)&&on.test(r)&&(o=W0(e,r)),this.setBaseTarget(e,Jt(o)?o.get():o)),Jt(o)?o.get():o}setBaseTarget(e,r){this.baseTarget[e]=r}getBaseTarget(e){var r;const{initial:i}=this.props;let o;if(typeof i=="string"||typeof i=="object"){const l=Nh(this.props,i,(r=this.presenceContext)===null||r===void 0?void 0:r.custom);l&&(o=l[e])}if(i&&o!==void 0)return o;const c=this.getBaseTargetFromProps(this.props,e);return c!==void 0&&!Jt(c)?c:this.initialValues[e]!==void 0&&o===void 0?void 0:this.baseTarget[e]}on(e,r){return this.events[e]||(this.events[e]=new Rh),this.events[e].add(r)}notify(e,...r){this.events[e]&&this.events[e].notify(...r)}}class Tb extends _5{constructor(){super(...arguments),this.KeyframeResolver=Y0}sortInstanceNodePosition(e,r){return e.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(e,r){return e.style?e.style[r]:void 0}removeValueFromRenderState(e,{vars:r,style:i}){delete r[e],delete i[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Jt(e)&&(this.childSubscription=e.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function S5(t){return window.getComputedStyle(t)}class C5 extends Tb{constructor(){super(...arguments),this.type="html",this.renderInstance=p0}readValueFromInstance(e,r){if(Mn.has(r)){const i=Wh(r);return i&&i.default||0}else{const i=S5(e),o=(h0(r)?i.getPropertyValue(r):i[r])||0;return typeof o=="string"?o.trim():o}}measureInstanceViewportBox(e,{transformPagePoint:r}){return fb(e,r)}build(e,r,i){Sh(e,r,i.transformTemplate)}scrapeMotionValuesFromProps(e,r,i){return Ph(e,r,i)}}class T5 extends Tb{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=_t}getBaseTargetFromProps(e,r){return e[r]}readValueFromInstance(e,r){if(Mn.has(r)){const i=Wh(r);return i&&i.default||0}return r=g0.has(r)?r:vh(r),e.getAttribute(r)}scrapeMotionValuesFromProps(e,r,i){return b0(e,r,i)}build(e,r,i){Ch(e,r,this.isSVGTag,i.transformTemplate)}renderInstance(e,r,i,o){x0(e,r,i,o)}mount(e){this.isSVGTag=Eh(e.tagName),super.mount(e)}}const E5=(t,e)=>jh(t)?new T5(e):new C5(e,{allowProjection:t!==j.Fragment}),P5=t_({...HS,...b5,...s5,...v5},E5),Na=gk(P5);function Mx({phone:t,onVerify:e,onResend:r,onBack:i,onClose:o,isLoading:c=!1,isEmail:l=!1}){const[u,h]=j.useState(["","","","","",""]),[f,g]=j.useState(""),[p,y]=j.useState(30),[v,w]=j.useState(!1),k=j.useRef([]);j.useEffect(()=>{if(p>0){const H=setTimeout(()=>{y(B=>B-1)},1e3);return()=>clearTimeout(H)}else w(!0)},[p]);const N=(H,B)=>{if(B&&!/^\d$/.test(B))return;const ae=[...u];ae[H]=B,h(ae),g(""),B&&H<5&&k.current[H+1]?.focus()},C=(H,B)=>{B.key==="Backspace"&&!u[H]&&H>0&&k.current[H-1]?.focus()},A=H=>{H.preventDefault();const B=H.clipboardData.getData("text").trim();if(!/^\d{6}$/.test(B))return;const ae=B.split("");h(ae),g(""),k.current[5]?.focus()},E=async()=>{const H=u.join("");if(H.length!==6){g("Please enter complete OTP");return}try{g(""),await e(H)}catch(B){g(B.message||"Invalid OTP. Please try again.")}},_=async()=>{if(v)try{g(""),h(["","","","","",""]),await r(),y(30),w(!1),k.current[0]?.focus()}catch(H){g(H.message||"Failed to resend OTP")}},R=u.every(H=>H!==""),L=l?t:`+91 ${t.slice(0,5)} ${t.slice(5)}`,P=l?"":"",D=l?"email":"phone";return s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-background rounded-2xl shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[s.jsx("button",{onClick:i,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",disabled:c,children:s.jsx(Za,{className:"w-5 h-5"})}),s.jsx("h2",{className:"text-heading",children:"Verify OTP"}),s.jsx("button",{onClick:o,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",disabled:c,children:s.jsx(ut,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 rounded-xl bg-primary/10 flex items-center justify-center mx-auto mb-4",children:s.jsx("span",{className:"text-4xl",children:P})}),s.jsxs("p",{className:"text-body text-sm",children:["We've sent a 6-digit OTP to your ",D]}),s.jsx("p",{className:"text-heading mt-1 break-all px-4",children:L})]}),s.jsxs("div",{children:[s.jsx("div",{className:"flex gap-2 justify-center",onPaste:A,children:u.map((H,B)=>s.jsx("input",{ref:ae=>k.current[B]=ae,type:"text",inputMode:"numeric",maxLength:1,value:H,onChange:ae=>N(B,ae.target.value),onKeyDown:ae=>C(B,ae),className:"w-12 h-14 text-center border-2 border-border rounded-lg focus:border-primary focus:outline-none transition-colors",disabled:c,autoFocus:B===0},B))}),f&&s.jsx("p",{className:"text-xs text-rose-500 text-center mt-3",children:f})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-sm text-muted mb-2",children:"Didn't receive OTP?"}),v?s.jsx("button",{onClick:_,className:"text-sm text-primary hover:underline",disabled:c,children:"Resend OTP"}):s.jsxs("p",{className:"text-sm text-muted",children:["Resend in ",p,"s"]})]}),s.jsx("button",{onClick:E,disabled:!R||c,className:"btn-primary w-full disabled:opacity-50 disabled:cursor-not-allowed",children:c?"Verifying...":"Verify OTP"})]})]})})}function As(t){const e=t.replace(/\D/g,"");return e.length===10?{display:`+91 ${e.slice(0,5)} ${e.slice(5)}`,clean:e}:{display:t,clean:t}}function Eb(t){const e=t.replace(/\D/g,"");return/^\d{10}$/.test(e)}async function Il(t){const e=As(t);if(!Eb(e.clean))throw new Error("Invalid phone number. Please enter a valid 10-digit number.");try{console.log(" Sending OTP to:",e.display);const{data:r,error:i}=await V.functions.invoke("send-otp",{body:{phone:e.clean}});if(i)throw console.error(" Send OTP edge function error:",i),new Error("Failed to send OTP. Please try again.");if(!r||!r.success)throw console.error(" Send OTP failed:",r?.error),new Error(r?.error||"Failed to send OTP. Please try again.");return console.log(" OTP sent successfully, session:",r.sessionId),{sessionId:r.sessionId,isNewUser:r.isNewUser,expiresIn:r.expiresIn||600}}catch(r){throw console.error(" Send OTP error:",r),new Error(r.message||"Failed to send OTP. Please try again.")}}async function Ox(t,e,r,i){const o=As(r);try{console.log(" Verifying OTP for session:",t);const{data:c,error:l}=await V.functions.invoke("verify-otp",{body:{sessionId:t,otp:e,phone:o.clean,name:i?.trim()}});if(l)throw console.error(" Verify OTP edge function error:",l),new Error("Failed to verify OTP. Please try again.");if(!c||!c.success)throw console.error(" Verify OTP failed:",c?.error),new Error(c?.error||"Invalid OTP. Please check and try again.");if(console.log(" OTP verified successfully"),!i)return{verified:!0};if(c.accessToken&&c.refreshToken){const{error:h}=await V.auth.setSession({access_token:c.accessToken,refresh_token:c.refreshToken});h?console.error(" Failed to set session:",h):console.log(" Supabase session set")}const u={id:c.user.id,name:c.user.name,email:c.user.email,phone:c.user.phone,whatsappSame:c.user.whatsappSame??!0,authUserId:c.user.id,clientToken:c.user.clientToken,profilePic:c.user.profilePic};return localStorage.setItem("oldcycle_user",JSON.stringify(u)),localStorage.setItem("oldcycle_token",c.user.clientToken),console.log(" User logged in via phone OTP:",u.id),{isNewUser:c.isNewUser,user:u,accessToken:c.accessToken,refreshToken:c.refreshToken}}catch(c){throw console.error(" Verify OTP error:",c),c}}const Kh="/assets/logo-DD39crl_.svg";class A5{canvas=null;ctx=null;particles=[];animationFrame=null;isAnimating=!1;initCanvas(){this.canvas||(this.canvas=document.createElement("canvas"),this.canvas.style.position="fixed",this.canvas.style.top="0",this.canvas.style.left="0",this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.pointerEvents="none",this.canvas.style.zIndex="9999",this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.ctx=this.canvas.getContext("2d",{alpha:!0}),document.body.appendChild(this.canvas),window.addEventListener("resize",this.handleResize))}handleResize=()=>{this.canvas&&(this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight)};createParticles(e,r,i,o){const c=[];for(let l=0;l<e;l++){const u=Math.random()*Math.PI*2,h=3+Math.random()*8,f=r[Math.floor(Math.random()*r.length)];c.push({x:i,y:o,vx:Math.cos(u)*h,vy:Math.sin(u)*h-(3+Math.random()*3),rotation:Math.random()*Math.PI*2,rotationSpeed:(Math.random()-.5)*.3,emoji:f,size:20+Math.random()*20,gravity:.15+Math.random()*.1,drift:(Math.random()-.5)*.2,opacity:1,life:1})}this.particles.push(...c)}animate=()=>{!this.ctx||!this.canvas||(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.particles=this.particles.filter(e=>(e.vy+=e.gravity,e.vx+=e.drift,e.x+=e.vx,e.y+=e.vy,e.rotation+=e.rotationSpeed,e.life-=.01,e.opacity=Math.max(0,e.life),e.y>window.innerHeight+50||e.x<-50||e.x>window.innerWidth+50||e.life<=0?!1:(this.ctx&&(this.ctx.save(),this.ctx.globalAlpha=e.opacity,this.ctx.translate(e.x,e.y),this.ctx.rotate(e.rotation),this.ctx.font=`${e.size}px Arial`,this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillText(e.emoji,0,0),this.ctx.restore()),!0))),this.particles.length>0?this.animationFrame=requestAnimationFrame(this.animate):this.stop())};blast(e){const{emojis:r=["","","","","",""],count:i=40,origin:o={x:window.innerWidth/2,y:window.innerHeight/2}}=e||{};this.initCanvas(),this.createParticles(i,r,o.x,o.y),this.isAnimating||(this.isAnimating=!0,this.animate())}stop(){this.isAnimating=!1,this.animationFrame&&(cancelAnimationFrame(this.animationFrame),this.animationFrame=null),this.particles.length===0&&this.canvas&&(document.body.removeChild(this.canvas),this.canvas=null,this.ctx=null,window.removeEventListener("resize",this.handleResize))}destroy(){this.stop(),this.particles=[],this.canvas&&(document.body.removeChild(this.canvas),this.canvas=null,this.ctx=null),window.removeEventListener("resize",this.handleResize)}}const I5=new A5,L5={registration:{emojis:["","","","","",""],count:50}};function oc(t,e){const r=L5.registration,i={x:window.innerWidth/2,y:window.innerHeight*.3};I5.blast({...r,origin:i})}function R5({onSuccess:t,onClose:e}){const[r,i]=j.useState("enter-phone"),[o,c]=j.useState(""),[l,u]=j.useState(""),[h,f]=j.useState(""),[g,p]=j.useState(""),[y,v]=j.useState(!1),[w,k]=j.useState(!1),[N,C]=j.useState(!1),[A,E]=j.useState(""),[_,R]=j.useState(""),[L,P]=j.useState(!1),[D,H]=j.useState(null),B=async()=>{if(E(""),!Eb(o)){E("Please enter a valid 10-digit mobile number");return}C(!0);try{const I=As(o),$=`+91${I.clean}`;console.log(" Checking phone:",$);let W=null,T=null;const{data:z,error:G}=await V.from("profiles").select("*").eq("phone",$).maybeSingle();if(z)W=z,console.log(" Found user by phone column:",W);else if(!G||G.code==="PGRST116"){const{data:M,error:X}=await V.from("profiles").select("*").eq("phone_number",$).maybeSingle();M?(W=M,console.log(" Found user by phone_number column:",W)):T=X}else T=G;if(T&&T.code!=="PGRST116")throw T;if(console.log(" Profile check result:",{exists:!!W,hasPassword:!!W?.password_hash,hasPasswordValue:W?.password_hash?"YES (length: "+W.password_hash.length+")":"NO",phone:W?.phone||W?.phone_number,name:W?.name||W?.display_name,clientToken:W?.client_token?"EXISTS":"MISSING",profileId:W?.id,allFields:W?Object.keys(W):[]}),W&&console.log(" FULL PROFILE DATA:",JSON.stringify({id:W.id,phone:W.phone,phone_number:W.phone_number,name:W.name,display_name:W.display_name,has_password_hash:!!W.password_hash,password_hash_preview:W.password_hash?W.password_hash.substring(0,20)+"...":"NULL",client_token:W.client_token?"EXISTS":"NULL",created_at:W.created_at},null,2)),W&&W.password_hash)console.log(" Returning user - showing password screen"),console.log("   Password hash exists:",W.password_hash.substring(0,20)+"..."),H(W),P(!1),i("enter-password"),C(!1);else if(W&&!W.password_hash){console.log(" Legacy user without password - sending OTP"),H(W),P(!1);const M=await Il(I.clean);R(M.sessionId),i("verify-otp"),C(!1),J.success("OTP sent! Check your SMS.")}else{console.log(" New user - sending OTP");const M=await Il(I.clean);R(M.sessionId),P(!0),i("verify-otp"),C(!1),J.success("OTP sent! Check your SMS.")}}catch(I){console.error(" Phone continue error:",I),E(I.message||"Failed to continue. Please try again."),C(!1)}},ae=async I=>{C(!0),E("");try{const $=As(o),W=await Ox(_,I,$.clean,void 0);C(!1),i("set-password")}catch($){throw C(!1),$}},ue=async()=>{const I=As(o),$=await Il(I.clean);R($.sessionId),J.success("New OTP sent!")},le=async()=>{if(E(""),!h){E("Please enter your password");return}C(!0);try{const{verifyPassword:I}=await ys(async()=>{const{verifyPassword:T}=await import("./passwordHash-BrtvX-38.js");return{verifyPassword:T}},[]);if(!await I(h,D.password_hash)){E("Incorrect password"),C(!1);return}C(!1);const W={id:D.id,name:D.name||D.display_name,phone:D.phone,clientToken:D.client_token,profilePic:D.avatar_url};localStorage.setItem("oldcycle_user",JSON.stringify(W)),localStorage.setItem("oldcycle_token",D.client_token),J.success("Welcome back!"),t(W)}catch(I){console.error("Login error:",I),E("Login failed. Please try again."),C(!1)}},fe=async()=>{if(E(""),!l||l.trim().length<2){E("Please enter your name (minimum 2 characters)");return}if(!h||h.length<6){E("Password must be at least 6 characters");return}if(h!==g){E("Passwords do not match");return}C(!0);try{const I=As(o),$=`+91${I.clean}`,{hashPassword:W}=await ys(async()=>{const{hashPassword:z}=await import("./passwordHash-BrtvX-38.js");return{hashPassword:z}},[]),T=await W(h);if(D){console.log(" Updating legacy user with password...");const{error:z}=await V.from("profiles").update({password_hash:T,name:l.trim(),display_name:l.trim()}).eq("id",D.id);if(z)throw console.error("Profile update error:",z),new Error("Failed to update account. Please try again.");const G={id:D.id,name:l.trim(),phone:$,clientToken:D.client_token,profilePic:D.avatar_url};localStorage.setItem("oldcycle_user",JSON.stringify(G)),localStorage.setItem("oldcycle_token",D.client_token),C(!1),J.success("Password set successfully!"),t(G)}else{console.log(" Creating new user...");const z=`token_${Date.now()}_${Math.random().toString(36).substr(2,12)}`,G=`token_${Date.now()}_${Math.random().toString(36).substr(2,12)}`,M=crypto.randomUUID(),{error:X}=await V.from("profiles").insert({id:M,phone:$,phone_number:$,email:`${I.clean}@localfelo.app`,name:l.trim(),display_name:l.trim(),password_hash:T,client_token:z,owner_token:G,whatsapp_same:!0,created_at:new Date().toISOString()});if(X)throw console.error("Profile creation error:",X),new Error("Failed to create account. Please try again.");const ie={id:M,name:l.trim(),phone:$,clientToken:z,profilePic:void 0};localStorage.setItem("oldcycle_user",JSON.stringify(ie)),localStorage.setItem("oldcycle_token",z),C(!1),J.success("Account created successfully!"),oc(),t(ie)}}catch(I){console.error("Set password error:",I),E(I.message||"Failed to save password. Please try again."),C(!1)}},we=async()=>{E(""),C(!0);try{const I=As(o),$=await Il(I.clean);R($.sessionId),i("forgot-password-otp"),C(!1),J.success("OTP sent! Check your SMS.")}catch(I){E(I.message||"Failed to send OTP"),C(!1)}},oe=async I=>{C(!0);try{const $=As(o);await Ox(_,I,$.clean,void 0),C(!1),i("reset-password")}catch($){throw C(!1),$}},Y=async()=>{if(E(""),!h||h.length<6){E("Password must be at least 6 characters");return}if(h!==g){E("Passwords do not match");return}C(!0);try{const $=`+91${As(o).clean}`,{hashPassword:W}=await ys(async()=>{const{hashPassword:G}=await import("./passwordHash-BrtvX-38.js");return{hashPassword:G}},[]),T=await W(h),{error:z}=await V.from("profiles").update({password_hash:T}).eq("phone",$);if(z)throw z;C(!1),J.success("Password updated successfully!"),i("enter-password"),f(""),p("")}catch(I){console.error("Reset password error:",I),E("Failed to reset password. Please try again."),C(!1)}};return r==="verify-otp"?s.jsx(Mx,{phone:As(o).display,onVerify:ae,onResend:ue,onBack:()=>i("enter-phone"),onClose:e,isLoading:N,isEmail:!1}):r==="forgot-password-otp"?s.jsx(Mx,{phone:As(o).display,onVerify:oe,onResend:ue,onBack:()=>i("enter-password"),onClose:e,isLoading:N,isEmail:!1}):s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:s.jsxs(Na.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white rounded-lg shadow-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("img",{src:Kh,alt:"LocalFelo",className:"h-12 w-28 sm:h-14 sm:w-32 object-contain object-left"}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 text-2xl",children:""})]})}),s.jsx("div",{className:"p-6",children:s.jsxs(lk,{mode:"wait",children:[r==="enter-phone"&&s.jsxs(Na.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Welcome! "}),s.jsx("p",{className:"text-gray-600 text-sm",children:"Enter your phone number to continue"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm sm:text-sm font-medium mb-2",children:"Phone Number"}),s.jsxs("div",{className:"relative",children:[s.jsx(Ci,{className:"absolute left-3 top-1/2 -translate-y-1/2 auth-icon text-gray-400"}),s.jsx("input",{type:"tel",placeholder:"9876543210",value:o,onChange:I=>c(I.target.value.replace(/\D/g,"").slice(0,10)),className:"auth-input-field w-full pl-12 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",maxLength:10,autoFocus:!0,onKeyPress:I=>I.key==="Enter"&&B()})]}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"10-digit Indian mobile number"})]}),A&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:A}),s.jsx("button",{onClick:B,disabled:N||o.length!==10,className:"auth-button w-full btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:N?s.jsx(_r,{className:"auth-icon animate-spin mx-auto"}):s.jsxs("span",{className:"flex items-center justify-center gap-2",children:["Continue ",s.jsx(e1,{className:"auth-icon"})]})})]},"enter-phone"),r==="enter-password"&&s.jsxs(Na.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Welcome back! "}),s.jsx("p",{className:"text-gray-600 text-sm",children:As(o).display})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(va,{className:"absolute left-3 top-1/2 -translate-y-1/2 auth-icon text-gray-400"}),s.jsx("input",{type:y?"text":"password",placeholder:"Enter your password",value:h,onChange:I=>f(I.target.value),className:"auth-input-field has-right-icon w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",autoFocus:!0,onKeyPress:I=>I.key==="Enter"&&le()}),s.jsx("button",{type:"button",onClick:()=>v(!y),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:y?s.jsx(mi,{className:"auth-icon"}):s.jsx(kr,{className:"auth-icon"})})]})]}),A&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:A}),s.jsx("button",{onClick:le,disabled:N||!h,className:"auth-button w-full btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:N?s.jsx(_r,{className:"auth-icon animate-spin mx-auto"}):"Login"}),s.jsx("div",{className:"text-center",children:s.jsx("button",{onClick:we,className:"text-sm text-primary hover:underline",children:"Forgot Password?"})}),s.jsx("button",{onClick:()=>i("enter-phone"),className:"w-full text-gray-600 hover:text-gray-800 text-sm",children:" Back to phone number"})]},"enter-password"),r==="set-password"&&s.jsxs(Na.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Create Account "}),s.jsx("p",{className:"text-gray-600 text-sm",children:"Just a few more details..."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Your Name"}),s.jsxs("div",{className:"relative",children:[s.jsx(Js,{className:"absolute left-3 top-1/2 -translate-y-1/2 auth-icon text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Enter your name",value:l,onChange:I=>u(I.target.value),className:"auth-input-field w-full pl-12 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",autoFocus:!0})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Set Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(va,{className:"absolute left-3 top-1/2 -translate-y-1/2 auth-icon text-gray-400"}),s.jsx("input",{type:y?"text":"password",placeholder:"Minimum 6 characters",value:h,onChange:I=>f(I.target.value),className:"auth-input-field has-right-icon w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"}),s.jsx("button",{type:"button",onClick:()=>v(!y),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:y?s.jsx(mi,{className:"auth-icon"}):s.jsx(kr,{className:"auth-icon"})})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Confirm Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(va,{className:"absolute left-3 top-1/2 -translate-y-1/2 auth-icon text-gray-400"}),s.jsx("input",{type:w?"text":"password",placeholder:"Re-enter password",value:g,onChange:I=>p(I.target.value),className:"auth-input-field has-right-icon w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",onKeyPress:I=>I.key==="Enter"&&fe()}),s.jsx("button",{type:"button",onClick:()=>k(!w),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:w?s.jsx(mi,{className:"auth-icon"}):s.jsx(kr,{className:"auth-icon"})})]})]}),A&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:A}),s.jsx("button",{onClick:fe,disabled:N||!l||!h||!g,className:"auth-button w-full btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:N?s.jsx(_r,{className:"auth-icon animate-spin mx-auto"}):"Create Account"})]},"set-password"),r==="reset-password"&&s.jsxs(Na.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Reset Password "}),s.jsx("p",{className:"text-gray-600 text-sm",children:"Enter your new password"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"New Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(va,{className:"absolute left-3 top-1/2 -translate-y-1/2 auth-icon text-gray-400"}),s.jsx("input",{type:y?"text":"password",placeholder:"Minimum 6 characters",value:h,onChange:I=>f(I.target.value),className:"auth-input-field has-right-icon w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",autoFocus:!0}),s.jsx("button",{type:"button",onClick:()=>v(!y),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:y?s.jsx(mi,{className:"auth-icon"}):s.jsx(kr,{className:"auth-icon"})})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-2",children:"Confirm New Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(va,{className:"absolute left-3 top-1/2 -translate-y-1/2 auth-icon text-gray-400"}),s.jsx("input",{type:w?"text":"password",placeholder:"Re-enter password",value:g,onChange:I=>p(I.target.value),className:"auth-input-field has-right-icon w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",onKeyPress:I=>I.key==="Enter"&&Y()}),s.jsx("button",{type:"button",onClick:()=>k(!w),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:w?s.jsx(mi,{className:"auth-icon"}):s.jsx(kr,{className:"auth-icon"})})]})]}),A&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:A}),s.jsx("button",{onClick:Y,disabled:N||!h||!g,className:"auth-button w-full btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:N?s.jsx(_r,{className:"auth-icon animate-spin mx-auto"}):"Reset Password"})]},"reset-password")]})})]})})}function D5({currentScreen:t,onNavigate:e,unreadCount:r=0,chatUnreadCount:i=0,activeTasksCount:o=0,onMenuClick:c}){const l=[{id:"home",icon:ey,label:"Home"},{id:"marketplace",icon:Ua,label:"Market"},{id:"wishes",icon:bs,label:"Wishes"},{id:"tasks",icon:Ot,label:"Tasks"},{id:"chat",icon:ct,label:"Chat"}];return s.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-white border-t-2 border-gray-100 z-40 sm:hidden",children:s.jsx("div",{className:"grid grid-cols-5 h-16",children:l.map(u=>{const h=u.icon,f=t===u.id,g=u.id==="chat"?i:u.id==="tasks"?o:0;return s.jsxs("button",{onClick:()=>e(u.id),className:`flex flex-col items-center justify-center gap-1 transition-all ${f?"text-black":"text-gray-600"}`,children:[s.jsxs("div",{className:"relative",children:[s.jsx(h,{className:`w-5 h-5 ${f?"stroke-[2.5]":"stroke-[2]"}`}),g>0&&s.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-[#CDFF00] text-black text-[10px] font-black rounded-full flex items-center justify-center",children:g>9?"9+":g})]}),s.jsx("span",{className:`text-[10px] ${f?"font-bold":"font-medium"}`,children:u.label})]},u.id)})})})}function Ii(t){if(!t)return"Unknown date";const e=typeof t=="string"?new Date(t):t;if(isNaN(e.getTime()))return"Invalid date";const i=new Date().getTime()-e.getTime(),o=Math.floor(i/1e3),c=Math.floor(o/60),l=Math.floor(c/60),u=Math.floor(l/24),h=Math.floor(u/30),f=Math.floor(u/365);return o<60?"just now":c<60?`${c} ${c===1?"minute":"minutes"} ago`:l<24?`${l} ${l===1?"hour":"hours"} ago`:u<30?`${u} ${u===1?"day":"days"} ago`:h<12?`${h} ${h===1?"month":"months"} ago`:`${f} ${f===1?"year":"years"} ago`}function F5({notifications:t,unreadCount:e,onMarkAsRead:r,onMarkAllAsRead:i,onDelete:o,onClose:c,onNotificationClick:l}){const u=f=>f.includes("task")?s.jsx(Ot,{className:"w-4 h-4 text-black"}):f.includes("wish")?s.jsx(bs,{className:"w-4 h-4 text-black"}):f.includes("chat")?s.jsx(ct,{className:"w-4 h-4 text-black"}):s.jsx(Fn,{className:"w-4 h-4 text-black"}),h=f=>f.is_read?"":f.type==="task_cancelled"||f.type.includes("rejected")?"bg-red-600":"bg-black";return s.jsxs("div",{className:"fixed inset-0 z-[9999] sm:relative sm:inset-auto",children:[s.jsx("div",{className:"sm:hidden fixed inset-0 bg-black/50",onClick:c}),s.jsxs("div",{className:"fixed inset-x-0 bottom-0 sm:fixed sm:top-14 sm:right-4 sm:left-auto sm:bottom-auto bg-white sm:rounded-lg sm:shadow-xl border-t sm:border border-gray-200 w-full sm:w-96 max-h-[80vh] sm:max-h-[500px] flex flex-col sm:mt-2 rounded-t-3xl sm:rounded-t-lg",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h3",{className:"font-semibold",children:"Notifications"}),e>0&&s.jsx("span",{className:"bg-black text-white text-xs px-2 py-0.5 rounded-full font-bold",children:e})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[e>0&&s.jsx("button",{onClick:i,className:"text-xs text-primary hover:underline font-medium",children:"Mark all read"}),s.jsx("button",{onClick:c,className:"p-1 hover:bg-gray-100 rounded-full transition-colors","aria-label":"Close notifications",children:s.jsx(ut,{className:"w-5 h-5 text-gray-600"})})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto",children:t.length===0?s.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center px-4",children:[s.jsx(or,{className:"w-12 h-12 text-gray-300 mb-3"}),s.jsx("p",{className:"text-gray-600",children:"No notifications yet"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"We'll notify you about tasks, wishes, and messages"})]}):s.jsx("div",{children:t.map(f=>s.jsx("div",{className:`p-4 border-b border-gray-200 hover:bg-gray-50 transition-colors cursor-pointer ${h(f)}`,onClick:()=>l(f),children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"mt-0.5",children:u(f.type)}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsx("h4",{className:`font-medium text-sm ${f.is_read?"text-black":"text-white"}`,children:f.title}),!f.is_read&&s.jsx("div",{className:"w-2 h-2 bg-[#CDFF00] rounded-full shrink-0 mt-1"})]}),s.jsx("p",{className:`text-sm mt-0.5 ${f.is_read?"text-gray-600":"text-white"}`,children:f.message}),s.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[s.jsx("span",{className:`text-xs ${f.is_read?"text-gray-500":"text-gray-300"}`,children:Ii(new Date(f.created_at))}),s.jsxs("div",{className:"flex items-center gap-2",children:[!f.is_read&&s.jsx("button",{onClick:g=>{g.stopPropagation(),r(f.id)},className:"text-xs text-white hover:underline font-medium",children:"Mark read"}),s.jsx("button",{onClick:g=>{g.stopPropagation(),o(f.id)},className:`text-xs hover:underline font-medium ${f.is_read?"text-red-600":"text-red-400"}`,children:"Delete"})]})]})]})]})},f.id))})})]})]})}function M5({isOpen:t,onClose:e,isLoggedIn:r,isAdmin:i,userDisplayName:o,onNavigate:c,onLogout:l,onNotificationClick:u,notificationCount:h=0,onLocationClick:f,locationText:g,onLoginClick:p,onContactClick:y,appDownloadUrl:v,appDownloadEnabled:w=!0}){if(!t)return null;console.log(" [MobileMenuSheet] Props:",{appDownloadEnabled:w,appDownloadUrl:v});const k=C=>{c(C),e()},N=()=>{l(),e()};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 sm:hidden",onClick:e}),s.jsxs("div",{className:"fixed top-0 right-0 bottom-0 w-[280px] bg-white z-50 sm:hidden shadow-xl",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[s.jsx("h2",{className:"text-lg font-bold text-heading",children:"Menu"}),s.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-full transition-colors","aria-label":"Close menu",children:s.jsx(ut,{className:"w-5 h-5 text-heading"})})]}),s.jsxs("div",{className:"flex flex-col py-2",children:[r?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"px-4 py-3 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 bg-black rounded-full flex items-center justify-center",children:s.jsx(Js,{className:"w-6 h-6 text-[#CDFF00]"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-heading",children:o}),s.jsx("p",{className:"text-sm text-body",children:"Welcome back!"})]})]})}),f&&s.jsxs("button",{onClick:()=>{f(),e()},className:"flex items-center gap-3 px-4 py-3 hover:bg-gray-50 transition-colors",children:[s.jsx(ds,{className:"w-5 h-5 text-primary"}),s.jsxs("div",{className:"flex-1 text-left",children:[s.jsx("span",{className:"text-heading block",children:g||"Set Location"}),g&&s.jsx("span",{className:"text-xs text-body",children:"Tap to change"})]})]}),s.jsxs("button",{onClick:()=>{c("notifications"),e()},className:"flex items-center gap-3 px-4 py-3 hover:bg-gray-50 transition-colors",children:[s.jsxs("div",{className:"relative",children:[s.jsx(or,{className:"w-5 h-5 text-heading"}),h>0&&s.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-black text-white text-[10px] font-bold rounded-full flex items-center justify-center",children:h>9?"9+":h})]}),s.jsx("span",{className:"text-heading",children:"Notifications"})]}),s.jsxs("button",{onClick:()=>k("profile"),className:"flex items-center gap-3 px-4 py-3 hover:bg-gray-50 transition-colors",children:[s.jsx(Js,{className:"w-5 h-5 text-heading"}),s.jsx("span",{className:"text-heading",children:"My Profile"})]}),i&&s.jsxs("button",{onClick:()=>k("admin"),className:"flex items-center gap-3 px-4 py-3 hover:bg-gray-50 transition-colors",children:[s.jsx(Rn,{className:"w-5 h-5 text-heading"}),s.jsx("span",{className:"text-heading",children:"Admin Panel"})]}),s.jsxs("button",{onClick:N,className:"flex items-center gap-3 px-4 py-3 hover:bg-gray-50 transition-colors border-t border-gray-200 mt-2",children:[s.jsx(ny,{className:"w-5 h-5 text-red-500"}),s.jsx("span",{className:"text-red-500 font-medium",children:"Logout"})]})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"px-4 py-6 text-center",children:[s.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3",children:s.jsx(Js,{className:"w-8 h-8 text-gray-400"})}),s.jsx("p",{className:"text-heading font-medium mb-1",children:"Not logged in"}),s.jsx("p",{className:"text-sm text-body mb-4",children:"Login to access all features"})]}),s.jsx("div",{className:"px-4",children:s.jsxs("button",{onClick:()=>{p&&p(),e()},className:"w-full btn-primary flex items-center justify-center gap-2 py-3 rounded-xl",children:[s.jsx(i1,{className:"w-5 h-5"}),s.jsx("span",{children:"Login / Register"})]})})]}),s.jsxs("div",{className:"mt-4 border-t border-gray-200 pt-2",children:[s.jsx("p",{className:"px-4 py-2 text-xs font-semibold text-muted uppercase",children:"Legal & Safety"}),s.jsxs("button",{onClick:()=>k("safety"),className:"flex items-center gap-3 px-4 py-2.5 hover:bg-gray-50 transition-colors w-full",children:[s.jsx(Rn,{className:"w-4 h-4 text-body"}),s.jsx("span",{className:"text-sm text-body",children:"Safety & Community Guidelines"})]}),s.jsxs("button",{onClick:()=>k("terms"),className:"flex items-center gap-3 px-4 py-2.5 hover:bg-gray-50 transition-colors w-full",children:[s.jsx(An,{className:"w-4 h-4 text-body"}),s.jsx("span",{className:"text-sm text-body",children:"Terms & Conditions"})]}),s.jsxs("button",{onClick:()=>k("privacy"),className:"flex items-center gap-3 px-4 py-2.5 hover:bg-gray-50 transition-colors w-full",children:[s.jsx(Rn,{className:"w-4 h-4 text-body"}),s.jsx("span",{className:"text-sm text-body",children:"Privacy Policy"})]}),s.jsxs("button",{onClick:()=>k("prohibited"),className:"flex items-center gap-3 px-4 py-2.5 hover:bg-gray-50 transition-colors w-full",children:[s.jsx(Rl,{className:"w-4 h-4 text-body"}),s.jsx("span",{className:"text-sm text-body",children:"Prohibited Items"})]}),s.jsxs("button",{onClick:()=>{y&&y(),e()},className:"flex items-center gap-3 px-4 py-2.5 hover:bg-gray-50 transition-colors w-full",children:[s.jsx(Si,{className:"w-4 h-4 text-body"}),s.jsx("span",{className:"text-sm text-body",children:"Contact Us"})]})]}),w&&v&&s.jsxs("div",{className:"mt-4 border-t border-gray-200 pt-2",children:[s.jsx("p",{className:"px-4 py-2 text-xs font-semibold text-muted uppercase",children:"Download App"}),s.jsxs("a",{href:v,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 px-4 py-2.5 hover:bg-gray-50 transition-colors w-full",children:[s.jsx(d1,{className:"w-4 h-4 text-body"}),s.jsx("span",{className:"text-sm text-body",children:"Download LocalFelo App"})]})]})]}),s.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-4 border-t border-gray-200 bg-gray-50",children:s.jsx("p",{className:"text-xs text-center text-body",children:"LocalFelo v1.0"})})]})]})}function O5({isOpen:t,onClose:e}){if(!t)return null;const r="contact@localfelo.com",i="+91-9063205739",o="https://wa.me/919063205739",c=(l,u)=>{navigator.clipboard.writeText(l),J.success(`${u} copied to clipboard!`)};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed inset-0 bg-black/50 z-50",onClick:e}),s.jsxs("div",{className:"fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-md bg-white rounded-xl shadow-xl z-50 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-xl font-bold text-black",children:"Contact Us"}),s.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-full transition-colors","aria-label":"Close",children:s.jsx(ut,{className:"w-5 h-5 text-heading"})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-body text-sm",children:"We'd love to hear from you! Whether you're an investor, partner, or have general inquiries, reach out to us:"}),s.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Si,{className:"w-5 h-5 text-primary"}),s.jsx("span",{className:"text-xs font-semibold text-muted uppercase",children:"Email"})]}),s.jsxs("div",{className:"flex items-center justify-between gap-2",children:[s.jsx("a",{href:`mailto:${r}`,className:"text-black hover:text-primary transition-colors break-all",children:r}),s.jsx("button",{onClick:()=>c(r,"Email"),className:"p-2 hover:bg-white rounded-lg transition-colors shrink-0",title:"Copy email",children:s.jsx(Vp,{className:"w-4 h-4 text-body"})})]})]}),s.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(ct,{className:"w-5 h-5 text-green-600"}),s.jsx("span",{className:"text-xs font-semibold text-muted uppercase",children:"WhatsApp"})]}),s.jsxs("div",{className:"flex items-center justify-between gap-2",children:[s.jsx("a",{href:o,target:"_blank",rel:"noopener noreferrer",className:"text-black hover:text-green-600 transition-colors",children:i}),s.jsx("button",{onClick:()=>c(i,"WhatsApp number"),className:"p-2 hover:bg-white rounded-lg transition-colors shrink-0",title:"Copy number",children:s.jsx(Vp,{className:"w-4 h-4 text-body"})})]})]}),s.jsxs("div",{className:"flex gap-2 pt-2",children:[s.jsxs("a",{href:`mailto:${r}`,className:"flex-1 btn-primary py-3 rounded-xl flex items-center justify-center gap-2",children:[s.jsx(Si,{className:"w-4 h-4"}),s.jsx("span",{children:"Send Email"})]}),s.jsxs("a",{href:o,target:"_blank",rel:"noopener noreferrer",className:"flex-1 bg-green-600 text-white py-3 rounded-xl flex items-center justify-center gap-2 hover:bg-green-700 transition-colors",children:[s.jsx(ct,{className:"w-4 h-4"}),s.jsx("span",{children:"WhatsApp"})]})]})]})]})]})}function U5({type:t,message:e,onClose:r,duration:i=4e3}){const[o,c]=j.useState(!1),[l,u]=j.useState(!1);j.useEffect(()=>{setTimeout(()=>c(!0),10);const p=setTimeout(()=>{h()},i);return()=>clearTimeout(p)},[i]);const h=()=>{u(!0),setTimeout(r,300)},f=()=>{switch(t){case"success":return s.jsx(rn,{className:"w-5 h-5 text-white"});case"error":return s.jsx(ar,{className:"w-5 h-5 text-red-300"});case"warning":return s.jsx(cs,{className:"w-5 h-5 text-yellow-300"});case"info":default:return s.jsx(cs,{className:"w-5 h-5 text-blue-300"})}},g=()=>{switch(t){case"error":return"bg-red-600";default:return"bg-black"}};return s.jsx("div",{className:`fixed top-4 left-1/2 -translate-x-1/2 sm:left-auto sm:right-4 sm:translate-x-0 z-[9999] max-w-md w-[calc(100%-2rem)] sm:w-full transition-all duration-300 ${o&&!l?"translate-y-0 opacity-100":"-translate-y-full opacity-0"}`,style:{pointerEvents:"auto"},children:s.jsx("div",{className:`${g()} rounded-lg shadow-2xl overflow-hidden`,children:s.jsxs("div",{className:"flex items-center gap-3 p-4",children:[s.jsx("div",{className:"shrink-0",children:f()}),s.jsx("div",{className:"flex-1 min-w-0",children:s.jsx("p",{className:"text-sm text-white leading-relaxed",children:e})}),s.jsx("button",{onClick:h,className:"shrink-0 p-1 hover:bg-white/10 rounded transition-colors","aria-label":"Close",children:s.jsx(ut,{className:"w-4 h-4 text-white"})})]})})})}function $5(){const[t,e]=j.useState([]),r=(h,f)=>{const g=Math.random().toString(36).substr(2,9);console.log(" [SimpleNotification] Adding notification:",{id:g,type:h,message:f}),e(p=>{const y=[...p,{id:g,type:h,message:f}];return console.log(" [SimpleNotification] Updated notifications array:",y),y})},i=h=>{console.log(" [SimpleNotification] Removing notification:",h),e(f=>f.filter(g=>g.id!==h))},o=h=>r("success",h),c=h=>r("error",h),l=h=>r("info",h),u=h=>r("warning",h);return j.useEffect(()=>{console.log(" [SimpleNotification] Current notifications:",t)},[t]),{notifications:t,removeNotification:i,success:o,error:c,info:l,warning:u}}function B5({notifications:t,onRemove:e}){return s.jsx("div",{className:"fixed top-4 left-1/2 -translate-x-1/2 sm:left-auto sm:right-4 sm:translate-x-0 z-[9999] flex flex-col gap-2 pointer-events-none w-[calc(100%-2rem)] sm:w-auto max-w-md",children:t.map((r,i)=>s.jsx("div",{style:{marginTop:i>0?`${i*80}px`:"0"},children:s.jsx(U5,{type:r.type,message:r.message,onClose:()=>e(r.id)})},r.id))})}function rt({title:t="LocalFelo",currentScreen:e="home",showBack:r=!1,onBack:i,onNavigate:o,rightAction:c,onLocationClick:l,showGlobalLocation:u=!1,globalLocationArea:h,globalLocationCity:f,isLoggedIn:g=!1,isAdmin:p=!1,userDisplayName:y,showSearch:v=!1,searchQuery:w="",onSearchChange:k,onMenuClick:N,unreadCount:C,notificationCount:A,onNotificationClick:E,onGlobalSearchClick:_}){const R=["home","create","profile","admin","chat","tasks","wishes","marketplace"].includes(e),L=e==="home";return s.jsxs("header",{className:"sticky top-0 z-50 bg-white border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 h-14 px-3 sm:px-4 md:px-6 lg:px-8 xl:px-12 max-w-[1400px] mx-auto md:pb-2",children:[s.jsxs("div",{className:"flex items-center gap-3 shrink-0",children:[r&&s.jsx("button",{onClick:i,className:"p-2 -ml-2 hover:bg-gray-100 rounded active:scale-95 transition-all","aria-label":"Go back",children:s.jsx(Za,{className:"w-5 h-5 text-black"})}),s.jsx("button",{onClick:o?()=>o("home"):void 0,className:"hover:opacity-80 transition-opacity active:scale-95 ml-0.5 sm:ml-1","aria-label":"Go to home",children:s.jsx("img",{src:Kh,alt:"LocalFelo",className:"h-6 sm:h-7"})}),!R&&r&&s.jsx("h1",{className:"text-black m-0 font-bold text-[18px] tracking-tight",children:t})]}),u&&s.jsxs("button",{onClick:l,className:"flex items-center gap-1.5 px-2.5 py-1.5 hover:bg-gray-100 rounded transition-all min-w-0 max-w-[160px] sm:max-w-[220px]",children:[s.jsx(ds,{className:"w-4 h-4 text-primary flex-shrink-0"}),s.jsx("span",{className:"text-sm text-black truncate font-medium",children:(()=>{const P=h&&h!=="Unknown"&&h.trim()!==""?h.trim():"",D=f&&f!=="Unknown"&&f.trim()!==""?f.trim():"";return console.log(" Header Location Debug:",{rawArea:h,rawCity:f,processedArea:P,processedCity:D}),P&&D?`${P}, ${D}`:P||D||"Select location"})()}),s.jsx(Kx,{className:"w-3.5 h-3.5 text-gray-600 flex-shrink-0"})]}),_&&s.jsx("button",{onClick:_,className:"p-2 hover:bg-gray-100 rounded active:scale-95 transition-all","aria-label":"Search",title:"Search everything",children:s.jsx(Rs,{className:"w-5 h-5 text-gray-700"})}),s.jsx("div",{className:"flex-1"}),R&&o&&s.jsxs("nav",{className:"hidden sm:flex items-center gap-2",children:[!L&&g&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>o("create"),className:"flex items-center gap-1.5 px-2 sm:px-3 py-1.5 bg-black text-white rounded-lg hover:bg-gray-800 transition-all text-sm font-medium whitespace-nowrap",children:[s.jsx(Fn,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden md:inline",children:"Sell Item"}),s.jsx("span",{className:"md:hidden",children:"Sell"})]}),s.jsxs("button",{onClick:()=>o("create-wish"),className:"flex items-center gap-1.5 px-2 sm:px-3 py-1.5 border-2 border-black text-black rounded-lg hover:bg-gray-50 transition-all text-sm font-medium whitespace-nowrap",children:[s.jsx(bs,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden lg:inline",children:"Post a Wish"}),s.jsx("span",{className:"lg:hidden",children:"Wish"})]}),s.jsxs("button",{onClick:()=>o("create-task"),className:"flex items-center gap-1.5 px-2 sm:px-3 py-1.5 border-2 border-black text-black rounded-lg hover:bg-gray-50 transition-all text-sm font-medium whitespace-nowrap",children:[s.jsx(Ot,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden lg:inline",children:"Post a Task"}),s.jsx("span",{className:"lg:hidden",children:"Task"})]})]}),s.jsxs("button",{onClick:()=>o("profile"),className:`flex items-center gap-2 px-3 py-1.5 rounded-lg transition-all font-medium text-sm ${e==="profile"?"bg-black text-white":"text-gray-700 hover:bg-gray-100"}`,children:[s.jsx(Js,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden md:inline",children:"Profile"})]}),p&&e!=="admin"&&s.jsxs("button",{onClick:()=>o("admin"),className:"flex items-center gap-2 px-3 py-1.5 rounded-lg transition-all font-medium text-sm text-gray-700 hover:bg-gray-100",children:[s.jsx(Rn,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden md:inline",children:"Admin"})]}),g&&s.jsxs("button",{onClick:()=>o("chat"),className:`flex relative items-center gap-2 px-3 py-1.5 rounded-lg transition-all font-medium text-sm ${e==="chat"?"bg-black text-white":"text-gray-700 hover:bg-gray-100"}`,children:[s.jsxs("div",{className:"relative inline-flex",children:[s.jsx(ct,{className:"w-4 h-4"}),C!==void 0&&C>0&&s.jsx("span",{className:"absolute -top-1.5 -right-1.5 inline-flex items-center justify-center px-1.5 py-0.5 text-[10px] font-bold leading-none text-white bg-red-500 rounded-full min-w-[18px] h-[18px] border-2 border-white",children:C>9?"9+":C})]}),s.jsx("span",{className:"hidden md:inline",children:"Chat"})]}),g&&s.jsxs("button",{onClick:E,className:`flex relative items-center gap-2 px-3 py-1.5 rounded-lg transition-all font-medium text-sm ${e==="notifications"?"bg-black text-white":"text-gray-700 hover:bg-gray-100"}`,children:[s.jsxs("div",{className:"relative inline-flex",children:[s.jsx(or,{className:"w-4 h-4"}),A!==void 0&&A>0&&s.jsx("span",{className:"absolute -top-1.5 -right-1.5 inline-flex items-center justify-center px-1.5 py-0.5 text-[10px] font-bold leading-none text-white bg-red-500 rounded-full min-w-[18px] h-[18px] border-2 border-white",children:A>9?"9+":A})]}),s.jsx("span",{className:"hidden md:inline",children:"Notifications"})]})]}),!R&&c&&s.jsx("div",{children:c}),g&&E&&s.jsxs("button",{onClick:E,className:"sm:hidden p-2 hover:bg-gray-100 rounded active:scale-95 transition-all relative","aria-label":"Notifications",children:[s.jsx(or,{className:"w-5 h-5 text-black"}),A!==void 0&&A>0&&s.jsx("span",{className:"absolute top-0 right-0 inline-flex items-center justify-center px-1.5 py-0.5 text-[10px] font-bold leading-none text-white bg-red-500 rounded-full min-w-[18px] h-[18px]",children:A>9?"9+":A})]}),N&&s.jsx("button",{onClick:N,className:`p-2 hover:bg-gray-100 rounded active:scale-95 transition-all ${R?"sm:hidden":""}`,"aria-label":"Open menu",children:s.jsx(o1,{className:"w-5 h-5 text-black"})})]}),R&&o&&s.jsx("div",{className:"hidden md:block border-t border-gray-200 bg-white",children:s.jsx("div",{className:"max-w-[1400px] mx-auto px-6 lg:px-8 xl:px-12",children:s.jsxs("nav",{className:"flex items-center gap-1",children:[s.jsx("button",{onClick:()=>o("home"),className:`px-4 py-3 text-sm font-medium transition-colors border-b-2 ${e==="home"?"border-black text-black":"border-transparent text-gray-600 hover:text-black"}`,children:"Home"}),s.jsx("button",{onClick:()=>o("tasks"),className:`px-4 py-3 text-sm font-medium transition-colors border-b-2 ${e==="tasks"?"border-black text-black":"border-transparent text-gray-600 hover:text-black"}`,children:"Tasks Nearby"}),s.jsx("button",{onClick:()=>o("wishes"),className:`px-4 py-3 text-sm font-medium transition-colors border-b-2 ${e==="wishes"?"border-black text-black":"border-transparent text-gray-600 hover:text-black"}`,children:"Wishes Nearby"}),s.jsx("button",{onClick:()=>o("marketplace"),className:`px-4 py-3 text-sm font-medium transition-colors border-b-2 ${e==="marketplace"?"border-black text-black":"border-transparent text-gray-600 hover:text-black"}`,children:"Marketplace"})]})})})]})}const W5="oldcycle_wishlist_",V5="oldcycle_wishlist_guest";function Yh(){const t=localStorage.getItem("oldcycle_token");return t?`${W5}${t.substring(0,16)}`:V5}function Jh(){try{const t=Yh(),e=localStorage.getItem(t);return e?JSON.parse(e):[]}catch(t){return console.error("Error reading wishlist:",t),[]}}function z5(t){try{const e=Yh(),r=Jh();r.includes(t)||(r.push(t),localStorage.setItem(e,JSON.stringify(r)))}catch(e){console.error("Error adding to wishlist:",e)}}function q5(t){try{const e=Yh(),i=Jh().filter(o=>o!==t);localStorage.setItem(e,JSON.stringify(i))}catch(e){console.error("Error removing from wishlist:",e)}}function Pb(t){return Jh().includes(t)}function H5(t){return Pb(t)?(q5(t),!1):(z5(t),!0)}function G5({listing:t,onClick:e,onWishlistChange:r}){const[i,o]=j.useState(!1);console.log(`[ListingCard] "${t.title}" - distance:`,t.distance,"lat:",t.latitude,"lon:",t.longitude);const c=()=>{o(Pb(t.id))};j.useEffect(()=>{c()},[t.id]),j.useEffect(()=>{const u=f=>{(f.key?.startsWith("oldcycle_wishlist")||f.key==="oldcycle_token")&&c()},h=()=>{c()};return window.addEventListener("storage",u),window.addEventListener("wishlist-updated",h),()=>{window.removeEventListener("storage",u),window.removeEventListener("wishlist-updated",h)}},[t.id]);const l=u=>{u.stopPropagation();const h=H5(t.id);o(h),window.dispatchEvent(new Event("wishlist-updated")),r&&r()};return s.jsxs("div",{onClick:()=>e(t),className:"bg-white border border-gray-200 overflow-hidden hover:border-gray-300 transition-all cursor-pointer relative group",style:{borderRadius:"6px"},children:[s.jsxs("div",{className:"relative w-full aspect-square bg-gray-100 overflow-hidden",style:{borderRadius:"6px 6px 0 0"},children:[s.jsx("img",{src:t.images?.[0]||"/placeholder.png",alt:t.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}),s.jsx("button",{onClick:l,className:"absolute top-1.5 right-1.5 p-1.5 bg-white/90 backdrop-blur-sm rounded-full hover:scale-110 transition-all z-10 shadow-sm","aria-label":i?"Remove from wishlist":"Add to wishlist",children:s.jsx(bs,{className:`w-3.5 h-3.5 transition-all ${i?"fill-red-500 text-red-500":"text-gray-600"}`})})]}),s.jsxs("div",{className:"p-2.5 min-w-0",children:[s.jsx("h3",{className:"text-black m-0 mb-1 line-clamp-1 font-semibold text-[12px] sm:text-[13px] leading-tight w-full",children:t.title}),s.jsxs("p",{className:"m-0 mb-1.5 font-extrabold text-[13px] sm:text-[14px] leading-none text-black",children:["",(t.price||0).toLocaleString("en-IN")]}),s.jsx("div",{className:"mb-1",children:s.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 bg-gray-100 rounded text-[9px] sm:text-[10px] text-gray-700 font-medium",children:[s.jsx("span",{className:"text-[10px]",children:t.categoryEmoji}),s.jsx("span",{className:"truncate max-w-[70px] sm:max-w-[100px]",children:t.categoryName})]})}),s.jsxs("div",{className:"flex items-center gap-0.5 text-gray-500 min-w-0 mb-1",children:[s.jsx(ds,{className:"w-2.5 h-2.5 flex-shrink-0"}),s.jsx("span",{className:"text-[10px] sm:text-[11px] truncate font-medium",children:(()=>{const u=t.areaName&&t.areaName!=="Unknown"?t.areaName:"",h=t.cityName&&t.cityName!=="Unknown"?t.cityName:"",f=[u,h].filter(Boolean).join(" ");return f||(t.address?t.address.split(",").map(p=>p.trim()).filter(Boolean).slice(0,2).join(" ")||t.address:"Location not set")})()})]}),t.distance!==void 0&&t.distance!==null&&s.jsx("div",{children:s.jsxs("span",{className:"inline-block px-1.5 py-0.5 rounded text-[9px] sm:text-[10px] font-extrabold",style:{backgroundColor:"#CDFF00",color:"#000000"},children:[" ",t.distance.toFixed(1)," km away"]})})]})]})}function K5(){return s.jsxs("div",{className:"bg-card rounded-lg overflow-hidden shadow-card border border-border animate-pulse",children:[s.jsx("div",{className:"w-full pt-[75%] bg-input relative overflow-hidden",children:s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-input via-card to-input animate-shimmer"})}),s.jsxs("div",{className:"p-4 space-y-3",children:[s.jsx("div",{className:"h-5 bg-input rounded-lg w-3/4"}),s.jsx("div",{className:"h-6 bg-input rounded-lg w-1/2"}),s.jsx("div",{className:"h-4 bg-input rounded-full w-2/3"}),s.jsx("div",{className:"h-3 bg-input rounded-md w-1/2"})]})]})}function ln({count:t=6}){return s.jsx("div",{className:"listing-grid",children:Array.from({length:t}).map((e,r)=>s.jsx(K5,{},r))})}function Qs({type:t,message:e,icon:r,action:i,title:o,description:c,actionText:l,onAction:u}){if(o&&r)return s.jsxs("div",{className:"flex flex-col items-center justify-center py-20 px-4 text-center",children:[s.jsx("div",{className:"mb-6 p-6 bg-gradient-to-br from-primary/5 to-accent/10 rounded-2xl border border-primary/10",children:s.jsx(r,{className:"w-16 h-16 text-muted"})}),s.jsx("h3",{className:"text-heading mb-3 font-bold text-[20px]",children:o}),s.jsx("p",{className:"text-body mb-8 max-w-sm text-[15px] leading-relaxed",children:c}),l&&u&&s.jsx("button",{onClick:u,className:"btn-primary max-w-xs",children:l}),i&&s.jsx("div",{className:"mt-4",children:i})]});const f={"no-results":{icon:s.jsx(Rs,{className:"w-16 h-16 text-muted"}),title:"No Results Found",defaultMessage:"Try adjusting your filters or search query"},error:{icon:s.jsx(cs,{className:"w-16 h-16 text-destructive"}),title:"Something Went Wrong",defaultMessage:"Please try again later"},"no-listings":{icon:s.jsx(Fn,{className:"w-16 h-16 text-muted"}),title:"No Listings Yet",defaultMessage:"Be the first to post an ad!"}}[t||"no-listings"],{icon:g,title:p,defaultMessage:y}=f,v=r?s.jsx(r,{className:"w-16 h-16 text-muted"}):g;return s.jsxs("div",{className:"flex flex-col items-center justify-center py-20 px-4 text-center",children:[s.jsx("div",{className:"mb-6 p-6 bg-gradient-to-br from-primary/5 to-accent/10 rounded-2xl border border-primary/10",children:v}),s.jsx("h3",{className:"text-heading mb-3 font-bold text-[20px]",children:p}),s.jsx("p",{className:"text-body mb-8 max-w-sm text-[15px] leading-relaxed",children:e||y}),i&&s.jsx("div",{children:i}),l&&u&&s.jsx("button",{onClick:u,className:"btn-primary max-w-xs",children:l})]})}function lc({onNavigate:t,onContactClick:e,socialLinks:r}){return s.jsxs("footer",{className:"hidden md:block bg-white border-t-4 border-[#CDFF00] mt-12 w-full",children:[s.jsxs("div",{className:"relative bg-gradient-to-br from-[#CDFF00] via-[#CDFF00] to-[#b8e600] py-12 overflow-hidden",children:[s.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[s.jsx("div",{className:"absolute top-10 left-10 w-2 h-2 bg-white rounded-full animate-pulse",style:{animationDuration:"2s"}}),s.jsx("div",{className:"absolute top-20 right-20 w-1 h-1 bg-white rounded-full animate-ping",style:{animationDuration:"3s"}}),s.jsx("div",{className:"absolute bottom-10 left-1/4 w-1.5 h-1.5 bg-white rounded-full animate-pulse",style:{animationDuration:"2.5s"}}),s.jsx("div",{className:"absolute top-1/3 right-1/3 w-1 h-1 bg-white rounded-full animate-ping",style:{animationDuration:"4s"}}),s.jsx("div",{className:"absolute bottom-20 right-10 w-2 h-2 bg-white rounded-full animate-pulse",style:{animationDuration:"3.5s"}}),s.jsx(mt,{className:"absolute top-16 left-1/3 w-5 h-5 text-white opacity-60 animate-pulse",style:{animationDuration:"2s"}}),s.jsx(mt,{className:"absolute bottom-16 right-1/4 w-4 h-4 text-white opacity-50 animate-ping",style:{animationDuration:"3s"}}),s.jsx(mt,{className:"absolute top-1/2 left-20 w-3 h-3 text-white opacity-40 animate-pulse",style:{animationDuration:"2.8s"}})]}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:[s.jsxs("h2",{className:"text-2xl font-bold text-black mb-8 text-center flex items-center justify-center gap-3",children:[s.jsx(mt,{className:"w-6 h-6 text-black animate-pulse"}),"How It Works",s.jsx(mt,{className:"w-6 h-6 text-black animate-pulse"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"bg-black p-3 shadow-lg shadow-black/20",children:s.jsx(Ot,{className:"w-6 h-6 text-[#CDFF00]"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-black mb-2",children:"Tasks"}),s.jsx("p",{className:"text-sm text-black",children:"Post tasks at your convenient price. Local helpers can view and accept to help you. They earn, you get work done easily."})]})]}),s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"bg-black p-3 shadow-lg shadow-black/20",children:s.jsx(mt,{className:"w-6 h-6 text-[#CDFF00]"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-black mb-2",children:"Wishes"}),s.jsx("p",{className:"text-sm text-black",children:"Wish for anything you need. People nearby can view your wish and contact you directly to fulfill it."})]})]}),s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"bg-black p-3 shadow-lg shadow-black/20",children:s.jsx(Ua,{className:"w-6 h-6 text-[#CDFF00]"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-black mb-2",children:"Marketplace"}),s.jsx("p",{className:"text-sm text-black",children:"Sell unlimited things at no cost. Find local ads, buy anything, and connect with buyers or sellers near you."})]})]})]})]})]}),s.jsxs("div",{className:"relative bg-gradient-to-r from-black via-gray-900 to-black py-10 overflow-hidden",children:[s.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[s.jsx("div",{className:"absolute top-5 left-10 w-2 h-2 bg-[#CDFF00] rounded-full animate-ping",style:{animationDuration:"2.5s"}}),s.jsx("div",{className:"absolute top-10 right-16 w-1.5 h-1.5 bg-[#CDFF00] rounded-full animate-pulse",style:{animationDuration:"3s"}}),s.jsx("div",{className:"absolute bottom-8 left-1/4 w-1 h-1 bg-[#CDFF00] rounded-full animate-ping",style:{animationDuration:"3.5s"}}),s.jsx("div",{className:"absolute top-1/2 right-1/3 w-2 h-2 bg-[#CDFF00] rounded-full animate-pulse",style:{animationDuration:"2s"}}),s.jsx("div",{className:"absolute bottom-5 right-20 w-1.5 h-1.5 bg-[#CDFF00] rounded-full animate-ping",style:{animationDuration:"4s"}}),s.jsx(mt,{className:"absolute top-8 left-1/3 w-6 h-6 text-[#CDFF00] opacity-60 animate-pulse",style:{animationDuration:"2.2s"}}),s.jsx(mt,{className:"absolute bottom-8 right-1/4 w-5 h-5 text-[#CDFF00] opacity-50 animate-ping",style:{animationDuration:"3.2s"}}),s.jsx(mt,{className:"absolute top-1/2 left-16 w-4 h-4 text-[#CDFF00] opacity-40 animate-pulse",style:{animationDuration:"2.8s"}}),s.jsx(mt,{className:"absolute top-12 right-1/2 w-5 h-5 text-white opacity-30 animate-ping",style:{animationDuration:"3.8s"}})]}),s.jsx("div",{className:"absolute inset-x-0 top-0 h-1 bg-gradient-to-r from-transparent via-[#CDFF00] to-transparent animate-pulse"}),s.jsx("div",{className:"absolute inset-x-0 bottom-0 h-1 bg-gradient-to-r from-transparent via-[#CDFF00] to-transparent animate-pulse"}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10 text-center",children:[s.jsxs("div",{className:"flex items-center justify-center gap-3 mb-2",children:[s.jsx(mt,{className:"w-7 h-7 text-[#CDFF00] animate-pulse",style:{animationDuration:"2s"}}),s.jsx("p",{className:"text-[#CDFF00] font-bold text-2xl bg-gradient-to-r from-[#CDFF00] via-white to-[#CDFF00] bg-clip-text text-transparent",children:" India's First Wish-Based Hyperlocal Platform"}),s.jsx(mt,{className:"w-7 h-7 text-[#CDFF00] animate-pulse",style:{animationDuration:"2s"}})]}),s.jsxs("p",{className:"text-white text-base font-medium",children:["Connecting local communities for tasks, wishes, and marketplace  ",s.jsx("span",{className:"text-[#CDFF00] font-bold",children:"100% free"}),", ",s.jsx("span",{className:"text-[#CDFF00] font-bold",children:"zero commission"})]})]})]}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8 mb-12",children:[s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("img",{src:Kh,alt:"LocalFelo - India's Hyperlocal Marketplace Platform",className:"h-10 mb-4"}),s.jsx("h2",{className:"text-lg font-bold text-black mb-3",children:"India's #1 Hyperlocal Community Platform"}),s.jsxs("p",{className:"text-sm text-gray-700 leading-relaxed mb-4",children:["LocalFelo connects local communities across India for buying, selling, task posting, and wish fulfillment. Our hyperlocal marketplace platform enables peer-to-peer transactions with ",s.jsx("strong",{className:"text-black",children:"zero middleman fees"}),". We're 100% mediator-only  no payments, no delivery, no financial involvement. Just genuine connections with verified local buyers and sellers."]}),s.jsxs("div",{className:"flex gap-3 mb-4",children:[r?.instagram&&s.jsx("a",{href:r.instagram,target:"_blank",rel:"noopener noreferrer",className:"bg-black p-2 hover:bg-gray-800 transition-colors","aria-label":"Instagram",children:s.jsx(ty,{className:"w-4 h-4 text-[#CDFF00]"})}),r?.facebook&&s.jsx("a",{href:r.facebook,target:"_blank",rel:"noopener noreferrer",className:"bg-black p-2 hover:bg-gray-800 transition-colors","aria-label":"Facebook",children:s.jsx(Qx,{className:"w-4 h-4 text-[#CDFF00]"})}),r?.linkedin&&s.jsx("a",{href:r.linkedin,target:"_blank",rel:"noopener noreferrer",className:"bg-black p-2 hover:bg-gray-800 transition-colors","aria-label":"LinkedIn",children:s.jsx(sy,{className:"w-4 h-4 text-[#CDFF00]"})})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-sm mb-4 text-black border-b-2 border-[#CDFF00] pb-2 inline-block uppercase tracking-wide",children:"Our Services"}),s.jsxs("ul",{className:"space-y-2.5 mt-4",children:[s.jsx("li",{children:s.jsxs("button",{onClick:()=>t("tasks"),className:"text-sm text-gray-700 hover:text-black font-medium transition-colors flex items-center gap-2",children:[s.jsx(Ot,{className:"w-4 h-4"}),"Tasks & Gigs"]})}),s.jsx("li",{children:s.jsxs("button",{onClick:()=>t("wishes"),className:"text-sm text-gray-700 hover:text-black font-medium transition-colors flex items-center gap-2",children:[s.jsx(mt,{className:"w-4 h-4"}),"Wishes"]})}),s.jsx("li",{children:s.jsxs("button",{onClick:()=>t("marketplace"),className:"text-sm text-gray-700 hover:text-black font-medium transition-colors flex items-center gap-2",children:[s.jsx(Ua,{className:"w-4 h-4"}),"Marketplace"]})}),s.jsx("li",{children:s.jsx("button",{onClick:()=>t("about"),className:"text-sm text-gray-700 hover:text-black font-medium transition-colors",children:"How It Works"})})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-sm mb-4 text-black border-b-2 border-[#CDFF00] pb-2 inline-block uppercase tracking-wide",children:"Company & Legal"}),s.jsxs("ul",{className:"space-y-2.5 mt-4",children:[s.jsx("li",{children:s.jsx("button",{onClick:()=>t("about"),className:"text-sm text-gray-700 hover:text-black font-medium transition-colors",children:"About LocalFelo"})}),s.jsx("li",{children:s.jsxs("button",{onClick:e,className:"text-sm text-gray-700 hover:text-black font-medium transition-colors flex items-center gap-2",children:[s.jsx(Si,{className:"w-4 h-4"}),"Contact Us"]})}),s.jsx("li",{children:s.jsx("button",{onClick:()=>t("terms"),className:"text-sm text-gray-700 hover:text-black font-medium transition-colors",children:"Terms of Service"})}),s.jsx("li",{children:s.jsx("button",{onClick:()=>t("privacy"),className:"text-sm text-gray-700 hover:text-black font-medium transition-colors",children:"Privacy Policy"})}),s.jsx("li",{children:s.jsx("button",{onClick:()=>t("safety"),className:"text-sm text-gray-700 hover:text-black font-medium transition-colors",children:"Safety Guidelines"})}),s.jsx("li",{children:s.jsx("button",{onClick:()=>t("prohibited"),className:"text-sm text-gray-700 hover:text-black font-medium transition-colors",children:"Prohibited Items"})})]})]})]}),s.jsx("div",{className:"pt-6 border-t border-gray-300",children:s.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[s.jsxs("p",{className:"text-xs text-gray-600",children:[" ",new Date().getFullYear()," LocalFelo. All rights reserved. | India's Trusted Hyperlocal Community Platform"]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[s.jsx("span",{children:"Made with"}),s.jsx(bs,{className:"w-4 h-4 text-red-500 fill-red-500"}),s.jsx("span",{children:"for local communities"}),s.jsx("span",{className:"text-xl",children:""})]})]})})]})]})}function Y5({onListingClick:t,selectedCity:e,selectedArea:r,onCityChange:i,onAreaChange:o,onNavigate:c,isLoggedIn:l=!1,isAdmin:u=!1,userDisplayName:h,onMenuClick:f,unreadCount:g=0,cities:p,globalLocationArea:y,globalLocationCity:v,onGlobalLocationClick:w,notificationCount:k=0,onNotificationClick:N,userCoordinates:C,onGlobalSearchClick:A,onContactClick:E,socialLinks:_}){const[R,L]=j.useState([]),[P,D]=j.useState([]),[H,B]=j.useState([]),[ae,ue]=j.useState(!0),[le,fe]=j.useState(""),[we,oe]=j.useState(),[Y,I]=j.useState(),[$,W]=j.useState(""),[T,z]=j.useState(!1),[G,M]=j.useState(),[X,ie]=j.useState(!0);j.useEffect(()=>{(async()=>{try{const ce=await Ti();B(ce.map(Ue=>({id:String(Ue.id),name:Ue.name,emoji:Ue.emoji,slug:Ue.slug})))}catch(ce){console.error("Failed to load categories:",ce)}})()},[]),j.useEffect(()=>{(async()=>{try{ue(!0);const ce={limit:1e3,includeOwn:X};if(!e&&!r.length&&v&&(ce.city=v),le){const he=H.find(Le=>Le.id===le);he?.slug&&(ce.categorySlug=he.slug)}if(e){const he=p.find(Le=>Le.id===e);he&&(ce.city=he.name)}r.length>0&&(ce.areaSlug=r[0]),we!==void 0&&we>0&&(ce.minPrice=we),Y!==void 0&&Y>0&&(ce.maxPrice=Y),$.trim()&&(ce.searchQuery=$.trim()),C?(ce.userLat=C.latitude,ce.userLon=C.longitude,console.log("[MarketplaceScreen]  Passing user coordinates to listings:",{lat:C.latitude,lon:C.longitude})):console.log("[MarketplaceScreen]  No user location available for distance calculation"),console.log("[MarketplaceScreen] Loading listings with filters:",ce);const Ue=await ah(ce);L(Ue.data||[])}catch(ce){console.error("Failed to load listings:",ce)}finally{ue(!1)}})()},[le,e,r,we,Y,$,v,y,H,p,C,X]),j.useEffect(()=>{let ee=[...R];if(le&&(ee=ee.filter(ce=>ce.categoryId===Number(le))),e&&(ee=ee.filter(ce=>ce.cityId===e)),r.length>0&&(ee=ee.filter(ce=>r.includes(ce.areaId))),we!==void 0&&(ee=ee.filter(ce=>ce.price>=we)),Y!==void 0&&(ee=ee.filter(ce=>ce.price<=Y)),$.trim()){const ce=$.toLowerCase(),Ue=H.filter(he=>he.name.toLowerCase().includes(ce)||he.slug.toLowerCase().includes(ce)).map(he=>he.id);ee=ee.filter(he=>{const Le=he.title.toLowerCase().includes(ce)||he.description.toLowerCase().includes(ce),Ke=he.categoryName.toLowerCase().includes(ce),at=Ue.includes(String(he.categoryId));return Le||Ke||at})}G!==void 0&&C&&(ee=ee.filter(ce=>ce.distance===void 0?!1:ce.distance<=G)),C&&(ee.sort((ce,Ue)=>ce.distance!==void 0&&Ue.distance===void 0?-1:ce.distance===void 0&&Ue.distance!==void 0?1:ce.distance===void 0&&Ue.distance===void 0?0:ce.distance-Ue.distance),console.log("[MarketplaceScreen]  Sorted by distance:",ee.slice(0,3).map(ce=>({title:ce.title,distance:ce.distance})))),D(ee)},[R,le,e,r,we,Y,$,G,H,C]);const be=()=>{fe(""),i(""),o([]),oe(void 0),I(void 0),W("")},ve=le||e||r.length>0||we||Y||$;return s.jsxs("div",{className:"min-h-screen bg-background pb-20 md:pb-0",children:[s.jsx(rt,{title:"Marketplace",currentScreen:"marketplace",onNavigate:c,isLoggedIn:l,isAdmin:u,userDisplayName:h,onMenuClick:f,unreadCount:g,showGlobalLocation:!0,globalLocationArea:y,globalLocationCity:v,onLocationClick:w,notificationCount:k,onNotificationClick:N,onGlobalSearchClick:A}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:[s.jsx("div",{className:"sticky top-14 z-40 bg-white border-b border-gray-200 py-3 -mx-4 sm:-mx-6 lg:-mx-8 px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto scrollbar-hide",children:[s.jsx("button",{onClick:()=>fe(""),className:`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors shrink-0 ${le?"bg-gray-100 text-gray-700 hover:bg-gray-200":"bg-black text-white"}`,children:"All"}),H.map(ee=>s.jsxs("button",{onClick:()=>fe(ee.id),className:`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-colors shrink-0 ${le===ee.id?"bg-black text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[s.jsx("span",{className:"mr-1",children:ee.emoji}),ee.name]},ee.id))]})}),s.jsxs("div",{className:"flex gap-2 mb-4 mt-4",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(mt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-[#CDFF00]"}),s.jsx("input",{type:"text",placeholder:"Smart search (e.g., 'phone', 'laptop', 'bike')...",value:$,onChange:ee=>W(ee.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-[4px] focus:ring-2 focus:ring-[#CDFF00] focus:border-transparent"})]}),s.jsxs("button",{onClick:()=>z(!T),className:`px-4 py-2 rounded-[4px] font-medium transition-colors flex items-center gap-2 ${ve?"bg-[#CDFF00] text-black font-bold":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[s.jsx(Zx,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Filters"}),ve&&s.jsxs("span",{className:"hidden sm:inline",children:["(",[le,e,...r,we,Y,$].filter(Boolean).length,")"]})]}),s.jsx("button",{onClick:()=>c("create"),className:"px-4 py-2 rounded-[4px] bg-[#CDFF00] text-black font-bold hover:bg-[#b8e600] transition-colors flex items-center gap-2 whitespace-nowrap",children:s.jsx("span",{children:"Sell"})})]}),ve&&s.jsxs("div",{className:"mb-4 flex flex-wrap items-center gap-2",children:[le&&s.jsxs("span",{className:"px-3 py-1 bg-[#CDFF00]/20 text-black rounded-full text-sm flex items-center gap-2 font-medium",children:[H.find(ee=>ee.id===le)?.emoji," ",H.find(ee=>ee.id===le)?.name,s.jsx("button",{onClick:()=>fe(""),className:"hover:opacity-70",children:""})]}),e&&s.jsxs("span",{className:"px-3 py-1 bg-[#CDFF00]/20 text-black rounded-full text-sm flex items-center gap-2 font-medium",children:[" ",p.find(ee=>ee.id===e)?.name,s.jsx("button",{onClick:()=>i(""),className:"hover:opacity-70",children:""})]}),r.length>0&&s.jsxs("span",{className:"px-3 py-1 bg-[#CDFF00]/20 text-black rounded-full text-sm flex items-center gap-2 font-medium",children:[r.length," area",r.length!==1?"s":"",s.jsx("button",{onClick:()=>o([]),className:"hover:opacity-70",children:""})]}),(we!==void 0||Y!==void 0)&&s.jsxs("span",{className:"px-3 py-1 bg-[#CDFF00]/20 text-black rounded-full text-sm flex items-center gap-2 font-medium",children:["",we||0," - ",Y||"",s.jsx("button",{onClick:()=>{oe(void 0),I(void 0)},className:"hover:opacity-70",children:""})]}),s.jsx("button",{onClick:be,className:"px-3 py-1 text-sm text-gray-600 hover:text-black underline",children:"Clear all"})]}),ae?s.jsx("div",{className:"listing-grid",children:s.jsx(ln,{count:6})}):P.length===0?s.jsx(Qs,{type:ve?"no-results":"no-listings",message:ve?"No listings match your filters. Try adjusting your search.":void 0}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"mb-3 text-sm text-gray-600",children:["Showing ",P.length," of ",R.length," listings"]}),s.jsx("div",{className:"listing-grid",children:P.map(ee=>s.jsx(G5,{listing:ee,onClick:t},ee.id))})]})]}),s.jsx(lc,{onNavigate:c,onContactClick:E||(()=>{}),socialLinks:_})]})}function xs({label:t,placeholder:e,value:r,onChange:i,type:o="text",required:c=!1,error:l,disabled:u=!1}){return s.jsxs("div",{className:"space-y-1",children:[t&&s.jsxs("label",{className:"block text-heading",children:[t,c&&s.jsx("span",{className:"text-destructive ml-1",children:"*"})]}),s.jsx("input",{type:o,value:r,onChange:h=>i(h.target.value),placeholder:e,className:"input-field",disabled:u}),l&&s.jsx("p",{className:"text-xs text-destructive m-0",children:l})]})}function Ab({label:t,placeholder:e,value:r,onChange:i,required:o=!1,error:c,rows:l=4,maxLength:u,showCharCount:h=!1,disabled:f=!1}){return s.jsxs("div",{className:"space-y-1",children:[t&&s.jsxs("label",{className:"block text-heading",children:[t,o&&s.jsx("span",{className:"text-destructive ml-1",children:"*"})]}),s.jsx("textarea",{value:r,onChange:g=>i(g.target.value),placeholder:e,rows:l,maxLength:u,className:"textarea-field",disabled:f}),h&&u&&s.jsxs("p",{className:"text-xs text-muted m-0 text-right",children:[r.length," / ",u]}),c&&s.jsx("p",{className:"text-xs text-destructive m-0",children:c})]})}function cc({categories:t,selectedCategoryId:e,selectedId:r,onCategoryChange:i,error:o,label:c,value:l,onChange:u,required:h=!1}){const f=String(l||e||r||""),g=u||i||(()=>{});return s.jsxs("div",{className:"space-y-3",children:[c&&s.jsxs("label",{className:"block text-heading",children:[c,h&&s.jsx("span",{className:"text-destructive ml-1",children:"*"})]}),s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:t.map(p=>s.jsxs("button",{type:"button",onClick:()=>g(String(p.id)),className:`p-4 rounded-xl border-2 transition-all flex flex-col items-center gap-2 ${f===String(p.id)?"border-primary bg-primary/5":"border-border hover:border-primary/50"}`,children:[s.jsx("span",{className:"text-3xl",children:p.emoji}),s.jsx("span",{className:"text-sm text-center",children:p.name})]},p.id))}),o&&s.jsx("p",{className:"text-xs text-destructive m-0",children:o})]})}function Ib({images:t,onImagesChange:e,maxImages:r=4}){const i=j.useRef(null),o=u=>{const h=Array.from(u.target.files||[]);if(h.length===0)return;const f=r-t.length,p=h.slice(0,f).map(y=>new Promise(v=>{const w=new FileReader;w.onloadend=()=>{v(w.result)},w.readAsDataURL(y)}));Promise.all(p).then(y=>{e([...t,...y])}),i.current&&(i.current.value="")},c=u=>{const h=t.filter((f,g)=>g!==u);e(h)},l=()=>{i.current?.click()};return s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.map((u,h)=>s.jsxs("div",{className:"relative aspect-square bg-input rounded-lg overflow-hidden",children:[s.jsx("img",{src:u,alt:`Upload ${h+1}`,className:"w-full h-full object-cover"}),s.jsx("button",{onClick:()=>c(h),className:"absolute top-2 right-2 w-6 h-6 bg-destructive text-destructive-foreground rounded-full flex items-center justify-center hover:opacity-90 active:scale-95 transition-all","aria-label":"Remove image",children:s.jsx(ut,{className:"w-4 h-4"})})]},h)),t.length<r&&s.jsxs("button",{onClick:l,className:"aspect-square bg-input border-2 border-dashed border-border rounded-lg flex flex-col items-center justify-center gap-2 hover:bg-background transition-all active:scale-98",children:[s.jsx(h1,{className:"w-6 h-6 text-muted"}),s.jsx("span",{className:"text-xs text-muted",children:"Upload Photo"})]})]}),s.jsx("input",{ref:i,type:"file",accept:"image/*",multiple:!0,onChange:o,className:"hidden"}),s.jsxs("p",{className:"text-xs text-muted text-center m-0",children:[t.length," / ",r," photos uploaded"]})]})}function J5({isOpen:t,onClose:e,onSubmit:r,userName:i}){const[o,c]=j.useState(""),[l,u]=j.useState(""),[h,f]=j.useState(!0),[g,p]=j.useState(!1),y=k=>{const N=k.replace(/\D/g,"");return N.length===0?(u(""),!1):N.length!==10?(u("Phone number must be exactly 10 digits"),!1):(u(""),!0)},v=k=>{const N=k.replace(/\D/g,"");N.length<=10&&(c(N),y(N))},w=async()=>{if(y(o)){p(!0);try{await r(o,h),c(""),u(""),f(!0)}catch(k){u(k.message||"Failed to update phone number")}finally{p(!1)}}};return s.jsx(Ar,{isOpen:t,onClose:e,title:"",children:s.jsxs("div",{className:"space-y-5 py-2",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 rounded-xl bg-primary/10 flex items-center justify-center mx-auto mb-4",children:s.jsx("span",{className:"text-4xl",children:""})}),s.jsx("h3",{className:"text-heading mb-2",children:"Add Phone Number"}),s.jsx("p",{className:"text-muted text-sm",children:"Required for buyers to contact you"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx(xs,{label:"Phone Number",type:"tel",value:o,onChange:v,placeholder:"10-digit mobile number",required:!0}),l&&s.jsx("p",{className:"text-xs text-rose-500 mt-1.5 ml-1",children:l})]}),s.jsxs("label",{className:"flex items-start gap-3 cursor-pointer group",children:[s.jsx("div",{className:"relative flex items-center justify-center mt-0.5",children:s.jsx("input",{type:"checkbox",checked:h,onChange:k=>f(k.target.checked),className:"w-5 h-5 cursor-pointer accent-primary"})}),s.jsx("div",{className:"flex-1",children:s.jsx("span",{className:"text-body text-sm",children:"This is my WhatsApp number"})})]})]}),s.jsxs("div",{className:"space-y-3 pt-2",children:[s.jsx("button",{onClick:w,disabled:o.length!==10||!!l||g,className:"btn-primary w-full disabled:opacity-50 disabled:cursor-not-allowed",children:g?s.jsxs("span",{className:"flex items-center justify-center gap-2",children:[s.jsx(_r,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):"Continue to Create Listing"}),s.jsx("button",{onClick:e,disabled:g,className:"w-full text-center text-sm text-muted hover:text-foreground transition-colors py-2",children:"Cancel"})]})]})})}const Q5={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRyb2Zucm50cmJlZHRqdHBzZXZlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM3ODMzMjQsImV4cCI6MjA3OTM1OTMyNH0.HONRnz8phA-6j0hwf6XLhD8aRX4zwQR-2x6pQHcUBAo",VITE_SUPABASE_URL:"https://drofnrntrbedtjtpseve.supabase.co"},Lb=()=>{const t="2d400c06bcd844989e70bb38697a464b";try{if(typeof import.meta<"u"&&Q5?.VITE_GEOAPIFY_API_KEY)return}catch{}return t},Yu="https://api.geoapify.com/v1";let Ux=0;const $x=100;async function Rb(){const e=Date.now()-Ux;e<$x&&await new Promise(r=>setTimeout(r,$x-e)),Ux=Date.now()}async function Db(t,e){try{await Rb();const r=Lb(),i=await fetch(`${Yu}/geocode/reverse?lat=${t}&lon=${e}&apiKey=${r}&format=json`);if(!i.ok)throw new Error("Reverse geocoding failed");const o=await i.json();if(!o||!o.results||o.results.length===0)return null;const c=o.results[0],l=c.properties||{};return{latitude:t,longitude:e,address:c.formatted||l.formatted||"",locality:l.suburb||l.neighbourhood||l.district||l.street,city:l.city||l.town||l.village||l.county||"",state:l.state,pincode:l.postcode,country:l.country||"India"}}catch(r){return console.error("Reverse geocoding error:",r),null}}async function Z5(t,e=5){try{if(await Rb(),!t||t.trim().length<2)return[];console.log(" Searching for:",t);const r=Lb();let i=await fetch(`${Yu}/geocode/autocomplete?text=${encodeURIComponent(t)}&filter=countrycode:in&bias=proximity:77.5946,12.9716&limit=${e}&apiKey=${r}&lang=en&format=json`);if(!i.ok)throw console.log(" Primary search failed with status:",i.status),new Error("Search failed");const o=await i.json();if(console.log(" Found",o?.results?.length||0,"results"),(!o?.results||o.results.length===0)&&(t.toLowerCase().includes("btm")||t.toLowerCase().includes("bangalore")||t.toLowerCase().includes("bengaluru"))){console.log(" Trying broader search for BTM/Bangalore area...");let c=t;if(t.toLowerCase().includes("btm")){const l=t.match(/btm\s*(\d+(?:st|nd|rd|th)?)\s*stage/i);l?c=`BTM ${l[1]} Stage Bangalore`:c="BTM Layout Bangalore",console.log(" Simplified query to:",c);const u=await fetch(`${Yu}/geocode/autocomplete?text=${encodeURIComponent(c)}&filter=countrycode:in&limit=${e}&apiKey=${r}&lang=en&format=json`);if(u.ok){const h=await u.json();if(h?.results?.length>0)return console.log(" Fallback search found",h.results.length,"results"),h.results.map(f=>({lat:f.lat,lon:f.lon,display_name:f.formatted||f.properties?.formatted||"Unknown",address:f.properties||{},place_id:f.place_id,properties:f.properties}))}}}return!o||!o.results||o.results.length===0?(console.log(" No results found"),[]):o.results.map(c=>({lat:c.lat,lon:c.lon,display_name:c.formatted||c.properties?.formatted||"Unknown",address:c.properties||{},place_id:c.place_id,properties:c.properties}))}catch(r){return console.error(" Search error:",r),[]}}async function X5(){return new Promise((t,e)=>{if(!navigator.geolocation){e(new Error("Geolocation not supported by your browser"));return}navigator.geolocation.getCurrentPosition(t,r=>{let i="Unable to get your location";switch(r.code){case r.PERMISSION_DENIED:i="Location permission denied. Please allow location access or use search.";break;case r.POSITION_UNAVAILABLE:i="Location information unavailable. Please try search instead.";break;case r.TIMEOUT:i="Location request timed out. Please try again or use search.";break}const o=new Error(i);o.code=r.code,e(o)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:0})})}async function e4(){try{console.log(" Getting GPS coordinates from device...");const t=await X5(),e=t.coords.latitude,r=t.coords.longitude,i=t.coords.accuracy;console.log(" GPS coordinates obtained:",{latitude:e,longitude:r,accuracy:`${Math.round(i)}m`}),console.log(" Getting address for GPS coordinates...");const o=await Db(e,r);return o&&console.log(" Location detected successfully:",{coordinates:{lat:o.latitude,lng:o.longitude},address:o.address,city:o.city}),o}catch(t){throw console.log(" GPS not available:",t.message),t}}function t4({center:t,onLocationChange:e,allowPinDrag:r=!0,browseMode:i=!1}){const o=j.useRef(null),c=j.useRef(null),l=j.useRef(null),[u,h]=j.useState(!0),[f,g]=j.useState(!1);return j.useEffect(()=>{const p=async()=>{if(!document.getElementById("leaflet-css")){const w=document.createElement("link");w.id="leaflet-css",w.rel="stylesheet",w.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",w.integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=",w.crossOrigin="",document.head.appendChild(w)}if(!window.L){const w=document.createElement("script");w.src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",w.integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=",w.crossOrigin="",await new Promise((k,N)=>{w.onload=k,w.onerror=N,document.head.appendChild(w)})}return window.L},y=async()=>{try{const w=await p();if(!o.current){console.log("Map ref not ready");return}if(c.current){console.log("Map already initialized");return}console.log("Initializing map at:",t);const k=w.map(o.current,{zoomControl:!0,scrollWheelZoom:!0,doubleClickZoom:!1,touchZoom:!0,dragging:!0}).setView([t.lat,t.lng],15);w.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:" OpenStreetMap contributors",maxZoom:19}).addTo(k),c.current=k;const N=w.divIcon({className:"location-pin-marker",html:`
            <div class="relative flex flex-col items-center ${r?"cursor-move":"cursor-default"}" style="filter: drop-shadow(0 6px 12px rgba(0,0,0,0.3));">
              <div class="relative">
                <div class="w-14 h-14 rounded-full overflow-hidden border-3 border-white shadow-xl flex items-center justify-center" style="background: #CDFF00;">
                  <svg width="56" height="56" viewBox="0 0 180 180" preserveAspectRatio="xMidYMid meet" fill="none" xmlns="http://www.w3.org/2000/svg" style="display: block;">
                    <path d="M95.9365 94.7373L138.624 133.494L124.546 149L81.5703 109.982L45.2422 148.536L30 134.173L77.0928 84.1973H37.6211V63.2539H125.604L95.9365 94.7373ZM149.356 85.4785L134.937 100.667L114.133 80.916L128.553 65.7266L149.356 85.4785ZM135.265 32C142.924 32.0002 149.133 38.2092 149.133 45.8682C149.133 53.5272 142.924 59.7361 135.265 59.7363C127.605 59.7363 121.396 53.5273 121.396 45.8682C121.396 38.209 127.605 32 135.265 32Z" fill="black"/>
                  </svg>
                </div>
                <div class="absolute left-1/2 -translate-x-1/2 -bottom-2.5">
                  <div style="
                    width: 0;
                    height: 0;
                    border-left: 10px solid transparent;
                    border-right: 10px solid transparent;
                    border-top: 14px solid #CDFF00;
                    filter: drop-shadow(0 3px 4px rgba(0,0,0,0.2));
                  "></div>
                </div>
              </div>
            </div>
          `,iconSize:[56,80],iconAnchor:[28,70]});l.current=w.marker([t.lat,t.lng],{icon:N,draggable:r}).addTo(k),r&&l.current.on("dragend",async()=>{const C=l.current.getLatLng();await v(C.lat,C.lng)}),i&&k.on("click",async C=>{const{lat:A,lng:E}=C.latlng;l.current.setLatLng([A,E]),await v(A,E)}),h(!1)}catch(w){console.error("Failed to load map:",w),h(!1)}},v=async(w,k)=>{if(e){g(!0);try{const N=await Db(w,k);console.log(" LocationMap - Geocoded result:",N),e(w,k,N?.address||"",{city:N?.city,locality:N?.locality,state:N?.state,pincode:N?.pincode})}catch(N){console.error("Failed to get address:",N),e(w,k,"")}finally{g(!1)}}};return y(),()=>{c.current&&(c.current.remove(),c.current=null)}},[]),j.useEffect(()=>{l.current&&c.current&&(l.current.setLatLng([t.lat,t.lng]),c.current.setView([t.lat,t.lng],15))},[t.lat,t.lng]),s.jsxs("div",{className:"relative w-full h-full",children:[s.jsx("div",{ref:o,className:"w-full h-full"}),u&&s.jsx("div",{className:"absolute inset-0 bg-white/90 flex items-center justify-center z-50",children:s.jsxs("div",{className:"flex flex-col items-center gap-3",children:[s.jsx(_r,{className:"w-10 h-10 text-[#CDFF00] animate-spin"}),s.jsx("p",{className:"text-[14px] text-gray-600",style:{fontWeight:"600"},children:"Loading map..."})]})}),f&&s.jsxs("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 z-50 bg-white px-4 py-2 shadow-lg flex items-center gap-2",style:{borderRadius:"20px"},children:[s.jsx(_r,{className:"w-4 h-4 text-[#CDFF00] animate-spin"}),s.jsx("span",{className:"text-[13px] text-gray-700",style:{fontWeight:"600"},children:"Getting address..."})]})]})}function ao({onLocationSelect:t,onClose:e,currentLocation:r}){const[i,o]=j.useState(!1),[c,l]=j.useState(null),[u,h]=j.useState(""),[f,g]=j.useState([]),[p,y]=j.useState(!1),[v,w]=j.useState(!1),k=je.useRef();j.useEffect(()=>{l(r?{latitude:r.latitude,longitude:r.longitude,address:"",city:r.city,country:"India"}:{latitude:20.5937,longitude:78.9629,address:"India",city:"India",country:"India"})},[]);const N=async()=>{o(!0);try{const _=await e4();_&&(console.log(" LocationSelector - Auto-detect successful:",_),l(_),setTimeout(()=>{l(R=>R?{...R}:null)},0))}catch(_){console.log("GPS not available:",_.message)}finally{o(!1)}},C=(_,R,L,P)=>{console.log(" LocationSelector - handleMapChange called:",{lat:_,lng:R,address:L,locationData:P});let D=P?.city||c?.city;if(!D){const H=L.split(",").map(B=>B.trim()).filter(Boolean);H.length>=3?D=H[2]:H.length>=2&&(D=H[1]),console.log(" Extracted city from address:",D)}l({latitude:_,longitude:R,address:L||c?.address||"",city:D||"",locality:P?.locality,state:P?.state,pincode:P?.pincode,country:"India"})},A=()=>{c&&t({latitude:c.latitude,longitude:c.longitude,address:c.address,locality:c.locality,city:c.city,state:c.state,pincode:c.pincode})};j.useEffect(()=>{if(u.length<2){g([]),w(!1);return}return k.current&&clearTimeout(k.current),y(!0),k.current=setTimeout(async()=>{try{const _=await Z5(u,8);g(_),w(!0)}catch{g([])}finally{y(!1)}},300),()=>{k.current&&clearTimeout(k.current)}},[u]);const E=_=>{const R=_.address?.city||_.address?.town||_.address?.village||_.address?.county||"";l({latitude:_.lat,longitude:_.lon,address:_.display_name,locality:_.address?.suburb||_.address?.neighbourhood,city:R,state:_.address?.state,pincode:_.address?.postcode,country:"India"}),h(""),w(!1)};return s.jsxs("div",{className:"fixed inset-0 bg-white z-50 flex flex-col",children:[s.jsxs("div",{className:"flex-shrink-0 bg-white border-b border-gray-200",children:[s.jsxs("div",{className:"px-4 py-3 flex items-center gap-3",children:[s.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 transition-colors flex-shrink-0",style:{borderRadius:"50%"},children:s.jsx(ut,{className:"w-5 h-5 text-gray-700"})}),s.jsxs("div",{className:"flex-1 relative",children:[s.jsxs("div",{className:"relative",children:[s.jsx(Rs,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),s.jsx("input",{type:"text",value:u,onChange:_=>h(_.target.value),placeholder:"Search BTM, Koramangala, Indiranagar...",className:"w-full pl-11 pr-4 py-3 bg-gray-100 border-none text-black placeholder-gray-500 focus:outline-none focus:bg-white focus:ring-2 focus:ring-[#CDFF00]",style:{borderRadius:"12px",fontSize:"15px",fontWeight:"500"}}),p&&s.jsx(_r,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 animate-spin"})]}),v&&f.length>0&&s.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white border border-gray-200 shadow-lg z-50 max-h-80 overflow-y-auto",style:{borderRadius:"12px"},children:f.map((_,R)=>s.jsxs("button",{onClick:()=>E(_),className:"w-full px-4 py-3 text-left hover:bg-gray-50 border-b border-gray-100 last:border-b-0 transition-colors",children:[s.jsx("p",{className:"text-[14px] text-black",style:{fontWeight:"600"},children:_.address?.suburb||_.address?.neighbourhood||_.address?.road||"Location"}),s.jsx("p",{className:"text-[12px] text-gray-600 mt-0.5 line-clamp-1",style:{fontWeight:"500"},children:_.display_name})]},`${_.place_id}-${R}`))}),v&&!p&&u.length>=2&&f.length===0&&s.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white border border-gray-200 shadow-lg p-4 z-50",style:{borderRadius:"12px"},children:s.jsx("p",{className:"text-[13px] text-gray-600 text-center",style:{fontWeight:"600"},children:"No results found"})})]})]}),s.jsx("div",{className:"px-4 pb-3",children:s.jsxs("button",{onClick:N,disabled:i,className:"w-full py-3 px-4 bg-[#CDFF00] text-black hover:bg-[#b8e600] transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",style:{borderRadius:"12px",fontWeight:"700",fontSize:"15px"},children:[i?s.jsx(s.Fragment,{children:s.jsx(_r,{className:"w-5 h-5 animate-spin"})}):s.jsx(s.Fragment,{children:s.jsx(xi,{className:"w-5 h-5"})}),s.jsx("span",{children:"Current Location"})]})})]}),s.jsx("div",{className:"flex-1 relative",children:c&&s.jsx(t4,{center:{lat:c.latitude,lng:c.longitude},onLocationChange:C,allowPinDrag:!0,browseMode:!0})}),s.jsxs("div",{className:"flex-shrink-0 bg-white border-t border-gray-200 px-4 py-4",children:[c?.address&&s.jsxs("div",{className:"mb-3 p-3 bg-gray-50",style:{borderRadius:"10px"},children:[s.jsx("p",{className:"text-[13px] text-gray-600",style:{fontWeight:"600"},children:"Selected Location:"}),s.jsx("p",{className:"text-[14px] text-black mt-1 line-clamp-2",style:{fontWeight:"600"},children:c.address})]}),s.jsx("button",{onClick:A,disabled:!c,className:"w-full py-4 px-4 bg-[#CDFF00] text-black hover:bg-[#b8e600] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",style:{borderRadius:"12px",fontWeight:"800",fontSize:"16px"},children:"Confirm Location"})]})]})}function s4({onBack:t,onSuccess:e,onNavigate:r,isLoggedIn:i=!1,isAdmin:o=!1,userDisplayName:c,unreadCount:l=0,cities:u=[]}){const h=tt(),{location:f,updateLocation:g}=Fi(h?.id||null),[p,y]=j.useState(1),[v,w]=j.useState(!1),[k,N]=j.useState([]),[C,A]=j.useState(!1),[E,_]=j.useState([]),[R,L]=j.useState(""),[P,D]=j.useState(""),[H,B]=j.useState(""),[ae,ue]=j.useState(""),[le,fe]=j.useState(""),[we,oe]=j.useState(!1),[Y,I]=j.useState(""),[$,W]=j.useState(""),[T,z]=j.useState(!1),[G,M]=j.useState({});j.useEffect(()=>{(async()=>{try{const Le=await Ti();N(Le.map(Ke=>({id:Number(Ke.id),name:Ke.name,slug:Ke.slug,emoji:Ke.emoji})))}catch(Le){console.error("Failed to load categories:",Le)}})()},[]),j.useEffect(()=>{const he=tt();if(he&&he.phone){const Le=he.phone.replace(/^\+91/,"");if(fe(Le),oe(he.whatsappSame),he.whatsappSame&&he.whatsappNumber){const Ke=he.whatsappNumber.replace(/^\+91/,"");I(Ke)}}else he&&!he.phone&&w(!0)},[]);const X=async(he,Le)=>{console.log(" handlePhoneSubmit called with:",{phoneNum:he,whatsappSame:Le});try{await Ry({phone:he,whatsappSame:Le}),fe(he),oe(Le),J.success("Phone number saved! You can now create listings."),w(!1)}catch(Ke){throw console.error(" Error in handlePhoneSubmit:",Ke),J.error(Ke.message||"Failed to save phone number"),Ke}},ie=he=>{const Le={};return he===1&&E.length===0&&(Le.images="Please upload at least 1 image"),he===2&&(R.trim()||(Le.title="Title is required"),P.trim()||(Le.description="Description is required"),(!H||parseInt(H)<=0)&&(Le.price="Valid price is required")),he===3&&(ae||(Le.category="Please select a category")),he===4&&((!le.trim()||le.length!==10)&&(Le.phone="Valid 10-digit phone number is required"),we&&Y&&Y.length!==10&&(Le.whatsapp="Valid 10-digit WhatsApp number is required")),he===5&&((!f||!f.latitude||!f.longitude)&&(Le.location="Please set your location from the header first"),$.trim()||(Le.address="Please enter your full address")),M(Le),Object.keys(Le).length===0},be=()=>{ie(p)&&y(p+1)},ve=()=>{p===1?t():y(p-1)},ee=async()=>{if(ie(6)){if(C){console.log(" Submission already in progress, ignoring click");return}A(!0);try{const he=k.find(ne=>ne.id===Number(ae));if(!he){J.error("Invalid category"),A(!1);return}if(!f||!f.latitude||!f.longitude){J.error("Location not set. Please set your location first."),A(!1);return}const Le=f.latitude,Ke=f.longitude;console.log(" Using global location coordinates:",{listingLatitude:Le,listingLongitude:Ke});const at={title:R.trim(),description:P.trim(),price:parseInt(H),categorySlug:he.slug,city:f.city,areaSlug:f.area||f.city,phone:le.trim(),whatsappEnabled:we,whatsappNumber:we?(Y||le).trim():null,latitude:Le,longitude:Ke,address:$.trim()||null};console.log("Creating listing with payload:",at);const re=await L2(at);if(E.length>0){const ne=await Promise.all(E.map(async(Oe,He)=>{const Lt=await(await fetch(Oe)).blob();return new File([Lt],`image-${He}.jpg`,{type:"image/jpeg"})}));await Ky(ne,re.id)}J.success("Listing posted successfully!"),oc(),e()}catch(he){console.error("Failed to create listing:",he),J.error("Failed to create listing. Please try again."),A(!1)}}},ce=k.find(he=>he.id===Number(ae)),Ue=()=>{switch(p){case 1:return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-heading mb-2",children:"Upload Photos"}),s.jsx("p",{className:"text-muted text-sm mb-4",children:"Add 1-4 photos of your item"})]}),s.jsx(Ib,{images:E,onImagesChange:_,maxImages:4}),G.images&&s.jsx("p",{className:"text-xs text-destructive",children:G.images})]});case 2:return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-heading mb-2",children:"Item Details"}),s.jsx("p",{className:"text-muted text-sm mb-4",children:"Tell us about your item"})]}),s.jsxs("div",{className:"form-grid",children:[s.jsx(xs,{label:"Title",placeholder:"e.g., iPhone 13 Pro Max 256GB",value:R,onChange:L,required:!0,error:G.title}),s.jsx(Ab,{label:"Description",placeholder:"Describe your item, condition, reason for selling...",value:P,onChange:D,rows:5,required:!0,error:G.description}),s.jsx(xs,{label:"Price ()",type:"number",placeholder:"e.g., 50000",value:H,onChange:B,required:!0,error:G.price})]})]});case 3:return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-heading mb-2",children:"Select Category"}),s.jsx("p",{className:"text-muted text-sm mb-4",children:"Choose the best category for your item"})]}),s.jsx(cc,{categories:k,selectedCategoryId:ae,onCategoryChange:ue,error:G.category})]});case 4:return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-heading mb-2",children:"Contact Information"}),s.jsx("p",{className:"text-muted text-sm mb-4",children:"How should buyers contact you?"})]}),s.jsx(xs,{label:"Phone Number",type:"tel",placeholder:"10-digit mobile number",value:le,onChange:fe,required:!0,error:G.phone}),s.jsxs("div",{className:"flex items-center gap-3 p-3 bg-input rounded-lg",children:[s.jsx("input",{type:"checkbox",id:"hasWhatsapp",checked:we,onChange:he=>oe(he.target.checked),className:"w-5 h-5"}),s.jsx("label",{htmlFor:"hasWhatsapp",className:"flex-1 text-body cursor-pointer",children:"This number is on WhatsApp"})]}),we&&s.jsx(xs,{label:"Different WhatsApp Number (Optional)",type:"tel",placeholder:"10-digit WhatsApp number",value:Y,onChange:I,error:G.whatsapp})]});case 5:return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-heading mb-2",children:"Location"}),s.jsx("p",{className:"text-muted text-sm mb-4",children:"Where is the item located?"})]}),f&&f.latitude&&f.longitude?s.jsxs("div",{children:[s.jsx("label",{className:"block text-[14px] text-black mb-2",style:{fontWeight:"700"},children:"Your Location"}),s.jsxs("button",{type:"button",onClick:()=>z(!0),className:"w-full p-4 bg-white border-2 border-gray-200 hover:border-[#CDFF00] transition-colors text-left flex items-start justify-between gap-3",style:{borderRadius:"8px"},children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("svg",{className:"w-5 h-5 text-[#CDFF00] flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})}),s.jsxs("p",{className:"text-[15px] text-black",style:{fontWeight:"700"},children:[f.area,", ",f.city]})]}),f.address&&s.jsx("p",{className:"text-[13px] text-gray-600 truncate",style:{fontWeight:"500"},children:f.address})]}),s.jsx("svg",{className:"w-5 h-5 text-gray-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),s.jsx("p",{className:"text-[12px] text-gray-500 mt-1.5",style:{fontWeight:"600"},children:"Tap to change your location"})]}):s.jsxs("div",{children:[s.jsxs("div",{className:"p-4 bg-red-50 border-2 border-red-200",style:{borderRadius:"8px"},children:[s.jsx("p",{className:"text-[14px] text-red-600 mb-3",style:{fontWeight:"700"},children:" Location Not Set"}),s.jsx("p",{className:"text-[13px] text-red-600 mb-3",style:{fontWeight:"500"},children:"Please set your location from the header first."}),s.jsx("button",{type:"button",onClick:()=>z(!0),className:"w-full py-2.5 px-4 bg-[#CDFF00] text-black hover:bg-[#b8e600] transition-colors",style:{borderRadius:"6px",fontSize:"14px",fontWeight:"700"},children:"Set Location Now"})]}),G.location&&s.jsx("p",{className:"text-[12px] text-red-600 mt-1.5",style:{fontWeight:"600"},children:G.location})]}),f&&f.latitude&&s.jsxs("div",{children:[s.jsxs("label",{className:"block text-[14px] text-black mb-2",style:{fontWeight:"700"},children:["Full Address ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("textarea",{value:$,onChange:he=>W(he.target.value),placeholder:`Building name, floor, street details...

E.g., Shop #12, 2nd Floor, 8th Cross, 29th Main Road
Above Cafe Coffee Day`,className:"w-full px-4 py-3 bg-white border-2 border-gray-200 text-black placeholder-gray-400 focus:outline-none focus:border-[#CDFF00] transition-colors resize-none",style:{borderRadius:"8px",fontSize:"15px",fontWeight:"500",minHeight:"120px"},rows:5}),s.jsx("p",{className:"text-[12px] text-gray-500 mt-1.5",style:{fontWeight:"600"},children:"Add specific details like building name, floor, nearby landmarks"}),G.address&&s.jsx("p",{className:"text-[12px] text-red-600 mt-1.5",style:{fontWeight:"600"},children:G.address})]})]});case 6:return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-heading mb-2",children:"Review & Submit"}),s.jsx("p",{className:"text-muted text-sm mb-4",children:"Check your listing details"})]}),s.jsxs("div",{className:"card",children:[s.jsxs("h4",{className:"text-heading mb-2",children:["Photos (",E.length,")"]}),s.jsx("div",{className:"grid grid-cols-4 gap-2",children:E.map((he,Le)=>s.jsx("img",{src:he,alt:`Preview ${Le+1}`,className:"w-full aspect-square object-cover rounded-lg"},Le))})]}),s.jsxs("div",{className:"card space-y-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-muted m-0",children:"Title"}),s.jsx("p",{className:"text-body m-0",children:R})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-muted m-0",children:"Price"}),s.jsxs("p",{className:"text-primary m-0",children:["",parseInt(H).toLocaleString("en-IN")]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-muted m-0",children:"Category"}),s.jsxs("p",{className:"text-body m-0",children:[ce?.emoji," ",ce?.name]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-muted m-0",children:"Description"}),s.jsx("p",{className:"text-body text-sm m-0",children:P})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-muted m-0",children:"Phone"}),s.jsx("p",{className:"text-body m-0",children:le})]}),we&&s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-muted m-0",children:"WhatsApp"}),s.jsx("p",{className:"text-body m-0",children:Y||le})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-muted m-0",children:"Location"}),s.jsxs("p",{className:"text-body m-0",children:[f?.area,", ",f?.city]}),$&&s.jsxs(s.Fragment,{children:[s.jsx("p",{className:"text-xs text-muted mt-2 m-0",children:"Full Address"}),s.jsx("p",{className:"text-body text-sm m-0",children:$})]})]})]})]});default:return null}};return s.jsxs("div",{className:"min-h-screen bg-background pb-40 sm:pb-8",children:[s.jsx(rt,{title:`Post Ad (${p}/6)`,showBack:!0,onBack:ve,currentScreen:"create",onNavigate:r,isLoggedIn:i,isAdmin:o,userDisplayName:c,unreadCount:l}),s.jsx("div",{className:"bg-card border-b border-border",children:s.jsx("div",{className:"page-container py-3",children:s.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5,6].map(he=>s.jsx("div",{className:`h-1 flex-1 rounded-full ${he<=p?"bg-primary":"bg-input"}`},he))})})}),s.jsx("div",{className:"page-container py-6",children:Ue()}),s.jsx("div",{className:"fixed lg:static bottom-16 lg:bottom-0 left-0 right-0 bg-card border-t border-border p-4 z-40",children:s.jsx("div",{className:"max-w-lg mx-auto",children:p<6?s.jsx("button",{onClick:be,className:"btn-primary",children:"Continue"}):s.jsx("button",{onClick:ee,disabled:C,className:"btn-primary flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:C?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),s.jsx("span",{children:"Posting..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(Is,{className:"w-5 h-5"}),s.jsx("span",{children:"Post Listing"})]})})})}),s.jsx(J5,{isOpen:v,onClose:()=>{w(!1),t()},onSubmit:X,userName:c}),T&&s.jsx(ao,{onLocationSelect:async he=>{const Le={cityId:null,city:he.city,areaId:he.locality||he.city,area:he.locality||he.city,latitude:he.latitude,longitude:he.longitude,address:he.address,locality:he.locality,state:he.state,pincode:he.pincode};await g(Le),z(!1),J.success("Location updated! ")},onClose:()=>z(!1),currentLocation:f&&f.latitude?{latitude:f.latitude,longitude:f.longitude,city:f.city}:null,title:"Set Your Location",description:"Choose your location to post items"})]})}const r4=[{id:"1",title:"Looking for iPhone 13 Pro",description:"Need a used iPhone 13 Pro in good condition. Budget flexible for the right deal.",categoryId:"1",categoryName:"Electronics",categoryEmoji:"",cityId:"1",cityName:"Mumbai",areaId:"1",areaName:"Andheri",budgetMin:4e4,budgetMax:5e4,urgency:"flexible",status:"open",phone:"",whatsapp:"",hasWhatsapp:!1,userId:"mock-user-1",userName:"Rahul S.",createdAt:new Date().toISOString(),isHidden:!1,latitude:19.1136,longitude:72.8697},{id:"2",title:"Need a laptop for coding",description:"Looking for a laptop with at least 16GB RAM and SSD. Prefer ThinkPad or Dell.",categoryId:"1",categoryName:"Electronics",categoryEmoji:"",cityId:"1",cityName:"Mumbai",areaId:"2",areaName:"Bandra",budgetMin:3e4,budgetMax:45e3,urgency:"flexible",status:"open",phone:"",whatsapp:"",hasWhatsapp:!1,userId:"mock-user-2",userName:"Priya M.",createdAt:new Date(Date.now()-864e5).toISOString(),isHidden:!1,latitude:19.0596,longitude:72.8295}];function Fb(t,e,r,i){const c=(r-t)*Math.PI/180,l=(i-e)*Math.PI/180,u=Math.sin(c/2)*Math.sin(c/2)+Math.cos(t*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(l/2)*Math.sin(l/2);return 6371*(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)))}async function n4(t){try{const{data:e,error:r}=await V.from("wishes").select(`
        *,
        categories:category_id(name, emoji),
        cities:city_id(name),
        areas:area_id(name),
        profiles(name)
      `).eq("is_hidden",!1).or(`user_id.eq.${t},accepted_by.eq.${t}`).in("status",["accepted","in_progress","negotiating"]).order("created_at",{ascending:!1});return r?(console.error("Failed to fetch active wishes:",r),[]):(e||[]).map(i=>({id:i.id,title:i.title,description:i.description,categoryId:i.category_id,categoryName:i.categories?.name||"Unknown",categoryEmoji:i.categories?.emoji||"",cityId:i.city_id,cityName:i.cities?.name||"Unknown",areaId:i.area_id,areaName:i.areas?.name||"Unknown",budgetMin:i.budget_min,budgetMax:i.budget_max,urgency:i.urgency||"flexible",status:i.status||"open",phone:i.phone||"",whatsapp:i.whatsapp,hasWhatsapp:i.has_whatsapp,userId:i.user_id,userName:i.profiles?.name||"User",createdAt:i.created_at,isHidden:i.is_hidden,exactLocation:i.exact_location,latitude:i.latitude,longitude:i.longitude,acceptedBy:i.accepted_by,acceptedAt:i.accepted_at,acceptedPrice:i.accepted_price}))}catch(e){return console.error("Exception in getUserActiveWishes:",e),[]}}async function dc(t){try{const e=tt();let r=V.from("wishes").select(`
        *,
        categories:category_id(name, emoji),
        cities:city_id(name),
        areas:area_id(name, latitude, longitude),
        profiles(name)
      `).eq("is_hidden",!1);e?.id&&(r=r.neq("user_id",e.id)),t?.categoryId&&(r=r.eq("category_id",t.categoryId)),t?.searchQuery&&(r=r.or(`title.ilike.%${t.searchQuery}%,description.ilike.%${t.searchQuery}%`)),t?.status?r=r.eq("status",t.status):r=r.eq("status","open");const{data:i,error:o}=await r;if(o)return console.error("Failed to fetch wishes:",o),console.log(" Using mock wishes data as fallback"),r4;if(console.log(` [getWishes] Fetched ${i?.length||0} wishes from database`),!i||i.length===0)return console.log(" [getWishes] No wishes found in database - returning empty array"),e?.id&&console.log(' Note: Your own wishes are filtered out from this view. Check "My Wishes" to see wishes you created.'),[];let c=(i||[]).map(l=>{const u={id:l.id,title:l.title,description:l.description,categoryId:l.category_id,categoryName:l.categories?.name||"Unknown",categoryEmoji:l.categories?.emoji||"",cityId:l.city_id,cityName:l.cities?.name||"Unknown",areaId:l.area_id,areaName:l.areas?.name||"Unknown",budgetMin:l.budget_min,budgetMax:l.budget_max,urgency:l.urgency||"flexible",phone:l.phone||"",whatsapp:l.whatsapp,hasWhatsapp:l.has_whatsapp,userId:l.user_id,userName:"User",createdAt:l.created_at,isHidden:l.is_hidden,latitude:l.latitude,longitude:l.longitude,status:l.status||"open",exactLocation:l.exact_location,acceptedBy:l.accepted_by,acceptedAt:l.accepted_at,acceptedPrice:l.accepted_price};if(t?.userLat&&t?.userLon){let h=l.latitude,f=l.longitude;(!h||!f)&&(h=l.areas?.latitude,f=l.areas?.longitude,h&&f&&console.log(` Using area coordinates for wish "${l.title}"`)),h&&f?(u.distance=Fb(t.userLat,t.userLon,h,f),console.log(` DISTANCE CALCULATED for wish "${l.title}": ${u.distance?.toFixed(1)} km`)):console.log(` No distance for wish "${l.title}" - no GPS or area coordinates available`)}return u});return t?.helperPreferences&&t.helperPreferences.length>0&&!t.showAll&&(c=c.filter(l=>{const u=l.helper_category;return u?t.helperPreferences.includes(u):!1})),t?.userLat&&t?.userLon?c.sort((l,u)=>{const h=l.distance??1/0,f=u.distance??1/0;return h-f}):c.sort((l,u)=>new Date(u.createdAt).getTime()-new Date(l.createdAt).getTime()),c}catch(e){return console.error("Exception in getWishes:",e),[]}}async function i4(t,e,r){try{const{data:i,error:o}=await V.from("wishes").select(`
        *,
        categories(name, emoji),
        cities(name),
        areas(name, latitude, longitude),
        profiles(name)
      `).eq("id",t).single();if(o||!i)return console.error("Failed to fetch wish:",o),null;const c={id:i.id,title:i.title,description:i.description,categoryId:i.category_id,categoryName:i.categories?.name||"Unknown",categoryEmoji:i.categories?.emoji||"",cityId:i.city_id,cityName:i.cities?.name||"Unknown",areaId:i.area_id,areaName:i.areas?.name||"Unknown",budgetMin:i.budget_min,budgetMax:i.budget_max,urgency:i.urgency||"flexible",phone:i.phone||"",whatsapp:i.whatsapp,hasWhatsapp:i.has_whatsapp,userId:i.user_id,userName:i.profiles?.name||"User",userAvatar:void 0,createdAt:i.created_at,isHidden:i.is_hidden,latitude:i.latitude,longitude:i.longitude,status:i.status||"open",exactLocation:i.exact_location,acceptedBy:i.accepted_by,acceptedAt:i.accepted_at,acceptedPrice:i.accepted_price};return e&&r&&i.latitude&&i.longitude&&(c.distance=Fb(e,r,i.latitude,i.longitude),console.log(` [WishService] Wish distance: ${c.distance.toFixed(2)} km`)),c}catch(i){return console.error("Exception in getWishById:",i),null}}async function a4(t){try{const e=nn(),r=await to();if(!e||!r)return{success:!1,error:"Not authenticated"};const i=tt();if(!i)return{success:!1,error:"Not authenticated"};const{data:o,error:c}=await V.from("wishes").insert({title:t.title,description:t.description,category_id:t.categoryId,city_id:t.cityId,area_id:t.areaId||null,budget_min:t.budgetMin,budget_max:t.budgetMax,urgency:t.urgency,phone:t.phone||"",whatsapp:t.whatsapp||"",has_whatsapp:t.hasWhatsapp,user_id:i.id,exact_location:t.exactLocation,latitude:t.latitude,longitude:t.longitude,address:t.address||null,client_token:e,owner_token:r,is_hidden:!1,status:"open"}).select().single();return c?(console.error("Failed to create wish:",c),{success:!1,error:c.message}):{success:!0,wishId:o.id}}catch(e){return console.error("Exception in createWish:",e),{success:!1,error:"Failed to create wish"}}}async function o4(t,e){try{const r=tt(),i=await to();if(!r||!i)return{success:!1,error:"Not authenticated"};const{data:o,error:c}=await V.from("wishes").select("user_id, status").eq("id",t).single();if(c||!o)return{success:!1,error:"Wish not found"};if(o.user_id!==r.id)return{success:!1,error:"Only the wish creator can edit this wish"};if(o.status!=="open"&&o.status!=="negotiating")return{success:!1,error:"Cannot edit wish after it has been accepted"};const l={updated_at:new Date().toISOString()};e.title!==void 0&&(l.title=e.title),e.description!==void 0&&(l.description=e.description),e.categoryId!==void 0&&(l.category_id=e.categoryId),e.budgetMin!==void 0&&(l.budget_min=e.budgetMin),e.budgetMax!==void 0&&(l.budget_max=e.budgetMax),e.urgency!==void 0&&(l.urgency=e.urgency),e.cityId!==void 0&&(l.city_id=e.cityId),e.areaId!==void 0&&(l.area_id=e.areaId||null),e.phone!==void 0&&(l.phone=e.phone),e.whatsapp!==void 0&&(l.whatsapp=e.whatsapp),e.hasWhatsapp!==void 0&&(l.has_whatsapp=e.hasWhatsapp),e.exactLocation!==void 0&&(l.exact_location=e.exactLocation),e.latitude!==void 0&&(l.latitude=e.latitude),e.longitude!==void 0&&(l.longitude=e.longitude);const{error:u}=await V.from("wishes").update(l).eq("id",t).eq("owner_token",i);return u?(console.error("Failed to edit wish:",u),{success:!1,error:u.message}):{success:!0}}catch(r){return console.error("Exception in editWish:",r),{success:!1,error:"Failed to edit wish"}}}async function Mb(t){try{const{data:e,error:r}=await V.from("wishes").select(`
        *,
        categories:category_id(name, emoji),
        cities:city_id(name),
        areas:area_id(name),
        profiles(name)
      `).eq("user_id",t).order("created_at",{ascending:!1});return r?(console.error("Failed to fetch user wishes:",r),[]):(e||[]).map(i=>({id:i.id,title:i.title,description:i.description,categoryId:i.category_id,categoryName:i.categories?.name||"Unknown",categoryEmoji:i.categories?.emoji||"",cityId:i.city_id,cityName:i.cities?.name||"Unknown",areaId:i.area_id,areaName:i.areas?.name||"Unknown",budgetMin:i.budget_min,budgetMax:i.budget_max,urgency:i.urgency||"flexible",phone:i.phone||"",whatsapp:i.whatsapp,hasWhatsapp:i.has_whatsapp,userId:i.user_id,userName:i.profiles?.name||"User",createdAt:i.created_at,isHidden:i.is_hidden,latitude:i.latitude,longitude:i.longitude,status:i.status||"open",exactLocation:i.exact_location,acceptedBy:i.accepted_by,acceptedAt:i.accepted_at,acceptedPrice:i.accepted_price}))}catch(e){return console.error("Exception in getUserWishes:",e),[]}}async function Ob(t){try{const e=await to();if(!e)return{success:!1,error:"Not authenticated"};const{error:r}=await V.from("wishes").update({status:"deleted",is_hidden:!0,updated_at:new Date().toISOString()}).eq("id",t).eq("owner_token",e);return r?(console.error("Failed to delete wish:",r),{success:!1,error:r.message}):(console.log(" [WishService] Wish soft-deleted (hidden from public view)"),{success:!0})}catch(e){return console.error("Exception in deleteWish:",e),{success:!1,error:"An error occurred"}}}async function l4(t){try{const e=await to();if(!e)return{success:!1,error:"Not authenticated"};const{error:r}=await V.from("wishes").update({status:"closed",is_hidden:!0}).eq("id",t).eq("owner_token",e);return r?(console.error("Failed to cancel wish:",r),{success:!1,error:r.message}):{success:!0}}catch(e){return console.error("Exception in cancelWish:",e),{success:!1,error:"Failed to cancel wish"}}}function Ub(t,e,r,i){const c=(r-t)*(Math.PI/180),l=(i-e)*(Math.PI/180),u=Math.sin(c/2)*Math.sin(c/2)+Math.cos(t*(Math.PI/180))*Math.cos(r*(Math.PI/180))*Math.sin(l/2)*Math.sin(l/2);return 6371*(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)))}async function uc(t){try{console.log(" [TaskService] getTasks called with filters:",t);const e=tt();let r=V.from("tasks").select(`
        *,
        city:cities(id, name),
        area:areas(id, name, latitude, longitude)
      `).in("status",["open","negotiating"]);e?.id&&(r=r.neq("user_id",e.id),console.log(" [TaskService] Filtering out current user's own tasks:",e.id)),t?.categoryId&&(r=r.eq("category_id",t.categoryId)),t?.cityId&&(r=r.eq("city_id",t.cityId)),t?.areaId&&(r=r.eq("area_id",t.areaId)),t?.searchQuery&&(r=r.or(`title.ilike.%${t.searchQuery}%,description.ilike.%${t.searchQuery}%`)),t?.status&&(r=r.eq("status",t.status)),r=r.order("created_at",{ascending:!1});const{data:i,error:o}=await r;if(o)return[];if(!i)return console.log(" [TaskService] No tasks found"),[];console.log(` [TaskService] Found ${i.length} tasks`);const c=i.map(l=>{let u;if(t?.userLat&&t?.userLon){let h=l.latitude,f=l.longitude;(!h||!f)&&(h=l.area?.latitude,f=l.area?.longitude,h&&f&&console.log(` Using area coordinates for task "${l.title}"`)),h&&f?(u=Ub(t.userLat,t.userLon,h,f),console.log(` DISTANCE CALCULATED for task "${l.title}": ${u.toFixed(1)} km`)):console.log(` No distance for task "${l.title}" - no GPS or area coordinates available`)}return{id:l.id,title:l.title,description:l.description,categoryId:l.category_id,categoryName:"",cityId:l.city_id,cityName:l.city_name||l.city?.name||"",areaId:l.area_id,areaName:l.area_name||l.area?.name||"",latitude:l.latitude,longitude:l.longitude,address:l.address,price:l.price,isNegotiable:l.is_negotiable,timeWindow:l.time_window,exactLocation:l.exact_location,phone:l.phone,whatsapp:l.whatsapp,hasWhatsapp:l.has_whatsapp,status:l.status,userId:l.user_id,userName:"",helperId:l.helper_id,acceptedBy:l.accepted_by,acceptedAt:l.accepted_at,acceptedPrice:l.accepted_price,createdAt:l.created_at,completedAt:l.completed_at,distance:u}});return t?.userLat&&t?.userLon&&(c.sort((l,u)=>l.distance===void 0&&u.distance===void 0?0:l.distance===void 0?1:u.distance===void 0?-1:l.distance-u.distance),console.log(" [TaskService] Tasks sorted by distance")),c}catch{return[]}}async function Ta(t,e,r){try{console.log(" [TaskService] getTaskById:",t);const{data:i,error:o}=await V.from("tasks").select(`
        *,
        city:cities(id, name),
        area:areas(id, name, latitude, longitude)
      `).eq("id",t).single();if(o)throw console.error(" [TaskService] Error fetching task:",o),o;if(!i)return console.log(" [TaskService] Task not found"),null;console.log(" [TaskService] Task found:",i.title);let c="";if(i.sub_area_id){const{data:u}=await V.from("sub_areas").select("name").eq("id",i.sub_area_id).single();u&&(c=u.name)}let l;return e&&r&&i.latitude&&i.longitude&&(l=Ub(e,r,i.latitude,i.longitude),console.log(` [TaskService] Task distance: ${l.toFixed(2)} km`)),{id:i.id,title:i.title,description:i.description,categoryId:i.category_id,categoryName:"",cityId:i.city_id,cityName:i.city?.name||"",areaId:i.area_id,areaName:i.area?.name||"",subAreaId:i.sub_area_id,subAreaName:c,latitude:i.latitude,longitude:i.longitude,price:i.price,isNegotiable:i.is_negotiable,timeWindow:i.time_window,exactLocation:i.exact_location,address:i.address,phone:i.phone,whatsapp:i.whatsapp,hasWhatsapp:i.has_whatsapp,status:i.status,userId:i.user_id,userName:"",helperId:i.helper_id,acceptedBy:i.accepted_by,acceptedAt:i.accepted_at,acceptedPrice:i.accepted_price,createdAt:i.created_at,completedAt:i.completed_at,distance:l}}catch(i){throw console.error(" [TaskService] getTaskById failed:",i),i}}async function $b(t,e){try{console.log(" [TaskService] Creating task:",t.title);const{data:r,error:i}=await V.from("tasks").insert({title:t.title,description:t.description,category_id:t.categoryId,city_id:t.cityId,area_id:t.areaId,sub_area_id:t.subAreaId||null,latitude:t.latitude,longitude:t.longitude,address:t.address||null,price:t.price,is_negotiable:t.isNegotiable,time_window:t.timeWindow,exact_location:t.exactLocation,phone:t.phone,whatsapp:t.whatsapp,has_whatsapp:t.hasWhatsapp,user_id:e,status:"open"}).select().single();return i?(console.error(" [TaskService] Error creating task:",i),{success:!1,error:i.message}):(console.log(" [TaskService] Task created successfully"),{success:!0,taskId:r.id})}catch(r){return console.error(" [TaskService] createTask failed:",r),{success:!1,error:r.message}}}async function hc(t,e,r){try{console.log(` [TaskService] Updating task ${t} to status: ${e}`);const i={status:e};e==="accepted"&&r&&(i.helper_id=r,i.accepted_by=r,i.accepted_at=new Date().toISOString()),e==="completed"&&(i.completed_at=new Date().toISOString());const{data:o,error:c}=await V.from("tasks").update(i).eq("id",t).select(`
        *,
        city:cities(id, name),
        area:areas(id, name)
      `).single();if(c)throw console.error(" [TaskService] Error updating task status:",c),c;return console.log(" [TaskService] Task status updated successfully"),{id:o.id,title:o.title,description:o.description,categoryId:o.category_id,categoryName:"",cityId:o.city_id,cityName:o.city?.name||"",areaId:o.area_id,areaName:o.area?.name||"",latitude:o.latitude,longitude:o.longitude,status:o.status,userId:o.user_id,userName:"",helperId:o.helper_id,acceptedBy:o.accepted_by,acceptedAt:o.accepted_at,createdAt:o.created_at,completedAt:o.completed_at}}catch(i){throw console.error(" [TaskService] updateTaskStatus failed:",i),i}}async function Qh(t){try{console.log(" [TaskService] Deleting task:",t);const{error:e}=await V.from("tasks").update({status:"deleted",updated_at:new Date().toISOString()}).eq("id",t);if(e)throw console.error(" [TaskService] Error deleting task:",e),e;console.log(" [TaskService] Task soft-deleted (hidden from public view)")}catch(e){throw console.error(" [TaskService] deleteTask failed:",e),e}}async function c4(t,e){try{console.log(" [TaskService] Updating task:",t);const r={};e.title!==void 0&&(r.title=e.title),e.description!==void 0&&(r.description=e.description),e.categoryId!==void 0&&(r.category_id=e.categoryId),e.cityId!==void 0&&(r.city_id=e.cityId),e.areaId!==void 0&&(r.area_id=e.areaId),e.latitude!==void 0&&(r.latitude=e.latitude),e.longitude!==void 0&&(r.longitude=e.longitude),e.status!==void 0&&(r.status=e.status);const{data:i,error:o}=await V.from("tasks").update(r).eq("id",t).select(`
        *,
        city:cities(id, name),
        area:areas(id, name)
      `).single();if(o)throw console.error(" [TaskService] Error updating task:",o),o;return console.log(" [TaskService] Task updated successfully"),{id:i.id,title:i.title,description:i.description,categoryId:i.category_id,categoryName:"",cityId:i.city_id,cityName:i.city?.name||"",areaId:i.area_id,areaName:i.area?.name||"",latitude:i.latitude,longitude:i.longitude,status:i.status,userId:i.user_id,userName:"",helperId:i.helper_id,createdAt:i.created_at,completedAt:i.completed_at}}catch(r){throw console.error(" [TaskService] updateTask failed:",r),r}}async function Bb(t,e){try{const r={};e.title!==void 0&&(r.title=e.title),e.description!==void 0&&(r.description=e.description),e.categoryId!==void 0&&(r.category_id=e.categoryId),e.cityId!==void 0&&(r.city_id=e.cityId),e.areaId!==void 0&&(r.area_id=e.areaId),e.subAreaId!==void 0&&(r.sub_area_id=e.subAreaId||null),e.latitude!==void 0&&(r.latitude=e.latitude),e.longitude!==void 0&&(r.longitude=e.longitude),e.price!==void 0&&(r.price=e.price),e.isNegotiable!==void 0&&(r.is_negotiable=e.isNegotiable),e.timeWindow!==void 0&&(r.time_window=e.timeWindow),e.exactLocation!==void 0&&(r.exact_location=e.exactLocation),e.phone!==void 0&&(r.phone=e.phone),e.whatsapp!==void 0&&(r.whatsapp=e.whatsapp),e.hasWhatsapp!==void 0&&(r.has_whatsapp=e.hasWhatsapp);const{error:i}=await V.from("tasks").update(r).eq("id",t);return i?(console.error(" [TaskService] Error updating task:",i),{success:!1,error:i.message}):(console.log(" [TaskService] Task updated successfully"),{success:!0})}catch(r){return console.error(" [TaskService] editTask failed:",r),{success:!1,error:r.message}}}async function Wb(t){try{console.log(" [TaskService] Getting active tasks for user:",t);const{data:e,error:r}=await V.from("tasks").select("*").or(`user_id.eq.${t},helper_id.eq.${t}`).in("status",["accepted","in_progress"]).order("created_at",{ascending:!1});return r?[]:e?(console.log(` [TaskService] Found ${e.length} active tasks`),e.map(i=>({id:i.id,title:i.title,description:i.description,categoryId:i.category_id,categoryName:"",cityId:i.city_id,cityName:"",areaId:i.area_id,areaName:"",latitude:i.latitude,longitude:i.longitude,status:i.status,userId:i.user_id,userName:"",helperId:i.helper_id,createdAt:i.created_at,completedAt:i.completed_at}))):(console.log(" [TaskService] No active tasks found"),[])}catch{return[]}}async function Zh(t){try{console.log(" [TaskService] Getting tasks for user:",t);const{data:e,error:r}=await V.from("tasks").select("*").eq("user_id",t).order("created_at",{ascending:!1});if(r)throw console.error(" [TaskService] Error fetching user tasks:",r),r;return e?(console.log(` [TaskService] Found ${e.length} tasks for user`),e.map(i=>({id:i.id,title:i.title,description:i.description,categoryId:i.category_id,categoryName:"",cityId:i.city_id,cityName:"",areaId:i.area_id,areaName:"",latitude:i.latitude,longitude:i.longitude,status:i.status,userId:i.user_id,userName:"",helperId:i.helper_id,createdAt:i.created_at,completedAt:i.completed_at}))):(console.log(" [TaskService] No tasks found for user"),[])}catch(e){return console.error(" [TaskService] getUserTasks failed:",e),[]}}async function Vb(){try{console.log(" [TaskService] Getting all tasks (admin)");const{data:t,error:e}=await V.from("tasks").select(`
        *,
        city:cities(id, name),
        area:areas(id, name)
      `).order("created_at",{ascending:!1});if(e)throw console.error(" [TaskService] Error fetching all tasks:",e),e;return t?(console.log(` [TaskService] Found ${t.length} tasks (admin)`),t.map(r=>({id:r.id,title:r.title,description:r.description,categoryId:r.category_id,categoryName:"",cityId:r.city_id,cityName:r.city?.name||"",areaId:r.area_id,areaName:r.area?.name||"",latitude:r.latitude,longitude:r.longitude,status:r.status,userId:r.user_id,userName:"",helperId:r.helper_id,createdAt:r.created_at,completedAt:r.completed_at}))):(console.log(" [TaskService] No tasks found"),[])}catch(t){throw console.error(" [TaskService] getAllTasksAdmin failed:",t),t}}async function Xh(t){try{console.log(" [TaskService] Closing task (admin):",t);const{error:e}=await V.from("tasks").update({status:"completed",completed_at:new Date().toISOString()}).eq("id",t);return e?(console.error(" [TaskService] Error closing task:",e),{success:!1,error:e.message}):(console.log(" [TaskService] Task closed successfully (admin)"),{success:!0})}catch(e){return console.error(" [TaskService] closeTaskAdmin failed:",e),{success:!1,error:e.message}}}async function d4(t){return Xh(t)}async function zb(t){try{console.log(" [TaskService] Getting negotiations for task:",t);const{data:e,error:r}=await V.from("conversations").select(`
        *,
        messages(
          id,
          content,
          sender_id,
          created_at
        )
      `).eq("listing_id",t).order("created_at",{ascending:!1});if(r)throw console.error(" [TaskService] Error fetching negotiations:",r),r;return e?(console.log(` [TaskService] Found ${e.length} negotiations`),e):(console.log(" [TaskService] No negotiations found"),[])}catch(e){throw console.error(" [TaskService] getTaskNegotiations failed:",e),e}}async function qb(t,e){console.log(" [TaskService] acceptTask called:",{taskId:t,helperId:e});const r=await hc(t,"accepted",e);console.log(" [TaskService] Task updated, sending notification to creator:",r.userId);try{const{sendTaskAcceptedNotification:i}=await ys(async()=>{const{sendTaskAcceptedNotification:u}=await Promise.resolve().then(()=>ec);return{sendTaskAcceptedNotification:u}},void 0),{data:o}=await V.from("profiles").select("name").eq("id",e).single(),c=o?.name||"Someone";console.log(" [TaskService] Sending notification:",{recipientId:r.userId,taskId:t,taskTitle:r.title,helperName:c}),await i(r.userId,t,r.title,c)?console.log(" [TaskService] Acceptance notification sent successfully"):console.error(" [TaskService] Failed to send acceptance notification")}catch(i){console.error(" [TaskService] Failed to send notification:",i)}return r}async function Ju(t,e){try{console.log(" [TaskService] Cancelling task and resetting to open:",t);const{data:r}=await V.from("tasks").select("user_id, helper_id, accepted_by, title").eq("id",t).single(),{error:i}=await V.from("tasks").update({status:"open",helper_id:null,accepted_by:null,accepted_at:null,accepted_price:null}).eq("id",t);if(i)return console.error(" [TaskService] Error cancelling task:",i),{success:!1,error:i.message};if(console.log(" [TaskService] Task cancelled and reset to open"),r&&e)try{const{sendTaskCancelledNotification:o}=await ys(async()=>{const{sendTaskCancelledNotification:h}=await Promise.resolve().then(()=>ec);return{sendTaskCancelledNotification:h}},void 0),{data:c}=await V.from("profiles").select("name").eq("id",e).single(),l=c?.name||"Someone";let u=null;e===r.user_id&&r.accepted_by?u=r.accepted_by:e===r.accepted_by&&r.user_id&&(u=r.user_id),u&&(await o(u,t,r.title,l),console.log(" [TaskService] Cancellation notification sent"))}catch(o){console.error(" [TaskService] Failed to send cancellation notification:",o)}return{success:!0}}catch(r){return console.error(" [TaskService] cancelTask failed:",r),{success:!1,error:r.message}}}async function u4(t){try{return await hc(t,"completed"),{success:!0}}catch(e){return{success:!1,error:e.message}}}async function Hb(t,e,r){console.log(" [TaskService] confirmTaskCompletion called:",{taskId:t,userId:e,isCreator:r});try{const{data:i,error:o}=await V.from("tasks").select("*").eq("id",t).single();if(o)throw o;if(!i)throw new Error("Task not found");let c="Task creator",l="Helper";if(i.user_id){const{data:k}=await V.from("profiles").select("name").eq("id",i.user_id).single();k&&(c=k.name)}if(i.helper_id){const{data:k}=await V.from("profiles").select("name").eq("id",i.helper_id).single();k&&(l=k.name)}const u=r?"creator_completed":"helper_completed",h=r?"helper_completed":"creator_completed",f={[u]:!0},g=i[h]===!0;g&&(f.status="completed",f.completed_at=new Date().toISOString());const{data:p,error:y}=await V.from("tasks").update(f).eq("id",t).select(`
        *,
        city:cities(id, name),
        area:areas(id, name),
        category:categories(id, name, emoji)
      `).single();if(y)throw y;console.log(" [TaskService] Task completion confirmed:",p);const v=r?i.helper_id:i.user_id,w=r?c:l;if(v)try{const{createNotification:k}=await ys(async()=>{const{createNotification:N}=await Promise.resolve().then(()=>ec);return{createNotification:N}},void 0);g?(await k({userId:v,title:" Task Completed!",message:`Task "${i.title}" has been marked as complete by both parties.`,type:"task_completed",taskId:t}),console.log(" Sent task completed notification")):(await k({userId:v,title:" Confirm Task Completion",message:`${w} marked the task complete. Click to confirm: "${i.title}"`,type:"task_completion_pending",taskId:t,actionUrl:`/tasks/${t}`,actionLabel:"Confirm Completion"}),console.log(" Sent completion pending notification"))}catch(k){console.error("Failed to send completion notification:",k)}return{id:p.id,title:p.title,description:p.description,categoryId:p.category_id,categoryName:p.category?.name||"",categoryEmoji:p.category?.emoji||"",price:p.price,budgetMin:p.budget_min,budgetMax:p.budget_max,isNegotiable:p.is_negotiable,cityId:p.city_id,cityName:p.city?.name||"",areaId:p.area_id,areaName:p.area?.name||"",latitude:p.latitude,longitude:p.longitude,status:p.status,userId:p.user_id,userName:"",helperId:p.helper_id,acceptedBy:p.accepted_by,acceptedAt:p.accepted_at,createdAt:p.created_at,completedAt:p.completed_at,helperCompleted:p.helper_completed,creatorCompleted:p.creator_completed}}catch(i){throw console.error(" [TaskService] confirmTaskCompletion failed:",i),i}}async function Gb(t,e,r){console.log(" [TaskService] undoTaskCompletion called:",{taskId:t,userId:e,isCreator:r});try{const{data:i,error:o}=await V.from("tasks").select("status, creator_completed, helper_completed, user_id, helper_id").eq("id",t).single();if(o)throw o;if(!i)throw new Error("Task not found");if(i.status==="completed")return{success:!1,error:"Cannot undo - task is already completed by both parties"};if(r&&i.user_id!==e)return{success:!1,error:"You are not the creator of this task"};if(!r&&i.helper_id!==e)return{success:!1,error:"You are not the helper for this task"};const c=r?"creator_completed":"helper_completed",{error:l}=await V.from("tasks").update({[c]:!1}).eq("id",t);if(l)throw l;return console.log(" [TaskService] Task completion undone"),{success:!0}}catch(i){return console.error(" [TaskService] undoTaskCompletion failed:",i),{success:!1,error:i.message}}}async function Kb(t){console.log(" [TaskService] startTask called:",{taskId:t});try{const e=await hc(t,"in_progress");return console.log(" [TaskService] Task started successfully"),e}catch(e){throw console.error(" [TaskService] startTask failed:",e),e}}async function Yb(t){return uc(t)}const Jb=Object.freeze(Object.defineProperty({__proto__:null,acceptTask:qb,cancelTask:Ju,closeTask:d4,closeTaskAdmin:Xh,completeTask:u4,confirmTaskCompletion:Hb,createTask:$b,deleteTask:Qh,editTask:Bb,getAllTasks:Yb,getAllTasksAdmin:Vb,getTaskById:Ta,getTaskNegotiations:zb,getTasks:uc,getUserActiveTasks:Wb,getUserTasks:Zh,startTask:Kb,undoTaskCompletion:Gb,updateTask:c4,updateTaskStatus:hc},Symbol.toStringTag,{value:"Module"}));function h4({isOpen:t,onClose:e,onSuccess:r,currentName:i,currentAvatar:o}){const[c,l]=j.useState(i),[u,h]=j.useState(o||""),[f,g]=j.useState(!1),p=async y=>{if(y.preventDefault(),!c.trim()){J.error("Name is required");return}g(!0);try{const v=tt();if(!v)throw new Error("User not found");const{error:w}=await V.from("profiles").update({name:c.trim(),avatar:u||null,updated_at:new Date().toISOString()}).eq("id",v.id);if(w)throw w;const k={...v,name:c.trim(),avatar:u||void 0};localStorage.setItem("oldcycle_user",JSON.stringify(k)),J.success("Profile updated successfully! "),r(),e()}catch(v){console.error("Profile update error:",v),J.error(v.message||"Failed to update profile")}finally{g(!1)}};return s.jsx(Ar,{isOpen:t,onClose:e,title:"Edit Profile",children:s.jsxs("form",{onSubmit:p,className:"space-y-4",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("div",{className:"w-20 h-20 bg-[#CDFF00] rounded-full flex items-center justify-center mx-auto mb-4",children:u?s.jsx("img",{src:u,alt:"Profile",className:"w-full h-full rounded-full object-cover"}):s.jsx(Js,{className:"w-10 h-10 text-black"})}),s.jsx("p",{className:"text-sm text-gray-600",children:"Update your display name and photo"})]}),s.jsx(xs,{label:"Display Name",type:"text",value:c,onChange:l,placeholder:"Enter your name",required:!0,disabled:f}),s.jsx(xs,{label:"Avatar URL (optional)",type:"url",value:u,onChange:h,placeholder:"https://example.com/avatar.jpg",disabled:f}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{type:"button",onClick:e,className:"btn-outline flex-1",disabled:f,children:"Cancel"}),s.jsx("button",{type:"submit",className:"btn-primary flex-1",disabled:f,children:f?"Updating...":"Save Changes"})]})]})})}function m4({isOpen:t,onClose:e,onSuccess:r}){const[i,o]=j.useState(""),[c,l]=j.useState(""),[u,h]=j.useState(""),[f,g]=j.useState(!1),p=async y=>{if(y.preventDefault(),!c||c.length<6){J.error("New password must be at least 6 characters");return}if(c!==u){J.error("Passwords do not match");return}g(!0);try{const{error:v}=await V.auth.updateUser({password:c});if(v)throw v;J.success("Password changed successfully! "),o(""),l(""),h(""),r(),e()}catch(v){console.error("Password change error:",v),J.error(v.message||"Failed to change password")}finally{g(!1)}};return s.jsx(Ar,{isOpen:t,onClose:e,title:"Change Password",children:s.jsxs("form",{onSubmit:p,className:"space-y-4",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("div",{className:"w-16 h-16 bg-[#CDFF00] rounded-full flex items-center justify-center mx-auto mb-4",children:s.jsx(Rn,{className:"w-8 h-8 text-black"})}),s.jsx("h3",{className:"text-lg mb-2 text-black font-semibold",children:"Update Your Password"}),s.jsx("p",{className:"text-gray-600 text-sm",children:"Enter a new password to secure your account"})]}),s.jsx(xs,{label:"New Password",type:"password",value:c,onChange:l,placeholder:"At least 6 characters",required:!0,disabled:f}),s.jsx(xs,{label:"Confirm New Password",type:"password",value:u,onChange:h,placeholder:"Re-enter new password",required:!0,disabled:f}),s.jsx("div",{className:"bg-[#CDFF00]/20 border border-[#CDFF00]/40 rounded-lg p-3",children:s.jsxs("p",{className:"text-sm text-black",children:[" ",s.jsx("strong",{children:"Security Tip:"})," Use a strong password with letters, numbers, and symbols"]})}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{type:"button",onClick:e,className:"btn-outline flex-1",disabled:f,children:"Cancel"}),s.jsx("button",{type:"submit",className:"btn-primary flex-1",disabled:f,children:f?"Changing...":"Change Password"})]})]})})}function f4({user:t,onLogin:e,onLogout:r,onListingClick:i,onEditListing:o,onNavigate:c,isLoggedIn:l,isAdmin:u,userDisplayName:h,unreadCount:f=0}){const[g,p]=j.useState("listings"),[y,v]=j.useState([]),[w,k]=j.useState([]),[N,C]=j.useState([]),[A,E]=j.useState(!1),[_,R]=j.useState(t?.profilePic),[L,P]=j.useState(!1),[D,H]=j.useState(!1);j.useEffect(()=>{t&&B()},[t,g]);const B=async()=>{if(t){E(!0);try{let T=t.id;if(t.id&&t.id.startsWith("token_")){console.log(" [ProfileScreen] Token-based user detected, fetching real UUID...");try{const{data:z,error:G}=await V.from("profiles").select("id").eq("client_token",t.clientToken).single();if(G||!z){console.error(" [ProfileScreen] Failed to get user UUID:",G),J.error("Failed to load profile data"),E(!1);return}T=z.id,console.log(" [ProfileScreen] Got real UUID:",T)}catch(z){console.error(" [ProfileScreen] Error fetching UUID:",z),J.error("Failed to load profile data"),E(!1);return}}if(g==="listings"){const z=await R2(t.clientToken);v(z)}else if(g==="wishes"){const z=await Mb(T);k(z)}else if(g==="tasks"){const z=await Zh(T);C(z)}}catch(T){console.error("Error loading user data:",T),J.error("Failed to load data")}finally{E(!1)}}},ae=T=>{o(T)},ue=async T=>{if(t&&window.confirm("Are you sure you want to permanently delete this listing?"))try{await D2(T,t.clientToken),J.success("Listing deleted successfully"),B()}catch(z){console.error("Error deleting listing:",z),J.error("Failed to delete listing")}},le=async T=>{try{const{error:z}=await V.from("listings").update({is_active:!0,status:"active"}).eq("id",T);if(z)throw z;J.success("Listing reactivated"),B()}catch(z){console.error("Error reactivating listing:",z),J.error("Failed to reactivate listing")}},fe=T=>{c("create-wish",{editMode:!0,wish:T})},we=async T=>{if(window.confirm("Are you sure you want to permanently delete this wish?"))try{await Ob(T),J.success("Wish deleted successfully"),B()}catch(z){console.error("Error deleting wish:",z),J.error("Failed to delete wish")}},oe=async T=>{try{const{error:z}=await V.from("wishes").update({status:"active"}).eq("id",T);if(z)throw z;J.success("Wish restored"),B()}catch(z){console.error("Error restoring wish:",z),J.error("Failed to restore wish")}},Y=T=>{c("create-task",{editMode:!0,task:T})},I=async T=>{if(window.confirm("Are you sure you want to permanently delete this task?"))try{await Qh(T),J.success("Task deleted successfully"),B()}catch(z){console.error("Error deleting task:",z),J.error("Failed to delete task")}},$=async T=>{if(window.confirm("Cancel this task?"))try{const{error:z}=await V.from("tasks").update({status:"closed"}).eq("id",T);if(z)throw z;J.success("Task cancelled"),B()}catch(z){console.error("Error cancelling task:",z),J.error("Failed to cancel task")}},W=async T=>{try{const{error:z}=await V.from("tasks").update({status:"open"}).eq("id",T);if(z)throw z;J.success("Task restored to open"),B()}catch(z){console.error("Error restoring task:",z),J.error("Failed to restore task")}};return t?s.jsxs("div",{className:"min-h-screen bg-white pb-20 sm:pb-0",children:[s.jsx(rt,{title:"Profile",currentScreen:"profile",onNavigate:c,isLoggedIn:l,isAdmin:u,userDisplayName:h,unreadCount:f}),s.jsxs("div",{className:"max-w-4xl mx-auto px-3 py-4 sm:px-4 sm:py-6",children:[s.jsx("div",{className:"bg-white border border-gray-200 p-4 sm:p-5 mb-4",children:s.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[s.jsx("div",{className:"relative",children:_?s.jsx("img",{src:_,alt:t.name,className:"w-14 h-14 sm:w-16 sm:h-16 rounded-full object-cover border-2 border-primary"}):s.jsx("div",{className:"w-14 h-14 sm:w-16 sm:h-16 rounded-full bg-black flex items-center justify-center border-2 border-primary",children:s.jsx(Js,{className:"w-7 h-7 sm:w-8 sm:h-8 text-primary"})})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h2",{className:"text-base sm:text-lg font-semibold truncate text-gray-900",children:t.name}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-600 truncate",children:t.phone||t.email})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>P(!0),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:"Edit Profile",children:s.jsx(cy,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-600"})}),s.jsx("button",{onClick:()=>{J.success("Profile link copied!")},className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:"Share profile",children:s.jsx(dy,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-600"})}),s.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:"Logout",children:s.jsx(ny,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-600"})})]})]})}),s.jsxs("div",{className:"bg-white border border-gray-200 p-1 mb-4 flex gap-1",children:[s.jsxs("button",{onClick:()=>p("listings"),className:`flex-1 py-2.5 px-3 rounded-xl text-xs sm:text-sm font-medium transition-all flex items-center justify-center gap-2 ${g==="listings"?"bg-black text-white":"text-gray-600 hover:bg-gray-100"}`,children:[s.jsx(Fn,{className:"w-4 h-4"}),s.jsx("span",{children:"Listings"})]}),s.jsxs("button",{onClick:()=>p("wishes"),className:`flex-1 py-2.5 px-3 rounded-xl text-xs sm:text-sm font-medium transition-all flex items-center justify-center gap-2 ${g==="wishes"?"bg-black text-white":"text-gray-600 hover:bg-gray-100"}`,children:[s.jsx(bs,{className:"w-4 h-4"}),s.jsx("span",{children:"Wishes"})]}),s.jsxs("button",{onClick:()=>p("tasks"),className:`flex-1 py-2.5 px-3 rounded-xl text-xs sm:text-sm font-medium transition-all flex items-center justify-center gap-2 ${g==="tasks"?"bg-black text-white":"text-gray-600 hover:bg-gray-100"}`,children:[s.jsx(Ot,{className:"w-4 h-4"}),s.jsx("span",{children:"Tasks"})]})]}),s.jsx("div",{className:"space-y-3",children:A?s.jsxs("div",{className:"text-center py-12 bg-white rounded-2xl",children:[s.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-black"}),s.jsx("p",{className:"text-gray-600 mt-2 text-sm",children:"Loading..."})]}):s.jsxs(s.Fragment,{children:[g==="listings"&&s.jsx(s.Fragment,{children:y.length===0?s.jsx(Qs,{type:"no-listings",message:"You haven't posted any listings yet"}):s.jsx("div",{className:"space-y-3",children:y.map(T=>{const z=T.status==="cancelled";return s.jsxs("div",{className:`bg-white rounded-xl p-3 sm:p-4 shadow-sm hover:shadow-md transition-shadow ${z?"opacity-60":""}`,children:[s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"w-20 h-20 sm:w-24 sm:h-24 rounded-lg overflow-hidden bg-gray-100 flex-shrink-0 cursor-pointer",onClick:()=>i(T),children:T.images&&T.images.length>0?s.jsx("img",{src:T.images[0],alt:T.title,className:"w-full h-full object-cover"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center text-2xl",children:T.categoryEmoji||""})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[s.jsx("h3",{className:"font-semibold text-sm sm:text-base text-gray-900 line-clamp-1 cursor-pointer",onClick:()=>i(T),children:T.title}),z&&s.jsx("span",{className:"text-[10px] font-bold px-2 py-0.5 bg-red-100 text-red-700 rounded-full whitespace-nowrap",children:"CANCELLED"})]}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mb-1 line-clamp-1",children:T.description||"No description"}),s.jsxs("p",{className:"font-bold text-sm sm:text-base text-black mb-2",children:["",(T.price||0).toLocaleString("en-IN")]}),s.jsxs("p",{className:"text-[10px] sm:text-xs text-gray-500",children:[" ",[T.areaName,T.cityName].filter(Boolean).join(" ")||"Location not set"]})]})]}),s.jsx("div",{className:"flex gap-2 mt-3 pt-3 border-t border-gray-100",children:z?s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>le(T.id),className:"flex-1 flex items-center justify-center gap-1.5 py-2 px-3 bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors text-xs sm:text-sm font-medium",children:[s.jsx(Xd,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"Reactivate"})]}),s.jsxs("button",{onClick:()=>ue(T.id),className:"flex-1 flex items-center justify-center gap-1.5 py-2 px-3 bg-red-50 text-red-700 rounded-lg hover:bg-red-100 transition-colors text-xs sm:text-sm font-medium",children:[s.jsx(Ls,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"Delete Permanently"})]})]}):s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>ae(T),className:"flex-1 flex items-center justify-center gap-1.5 py-2 px-3 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors text-xs sm:text-sm font-medium",children:[s.jsx(Ea,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"Edit"})]}),s.jsxs("button",{onClick:()=>ue(T.id),className:"flex-1 flex items-center justify-center gap-1.5 py-2 px-3 bg-red-50 text-red-700 rounded-lg hover:bg-red-100 transition-colors text-xs sm:text-sm font-medium",children:[s.jsx(Ls,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"Delete"})]})]})})]},T.id)})})}),g==="wishes"&&s.jsx(s.Fragment,{children:w.length===0?s.jsxs("div",{className:"text-center py-12 bg-white rounded-2xl",children:[s.jsx(bs,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"No wishes yet"}),s.jsx("button",{onClick:()=>c("create-wish"),className:"bg-black text-white px-6 py-2.5 rounded-xl hover:bg-gray-800 transition-colors text-sm font-medium",children:"Create Your First Wish"})]}):s.jsx("div",{className:"space-y-3",children:w.map(T=>{const z=T.status==="cancelled";return s.jsxs("div",{className:`bg-white rounded-xl p-3 sm:p-4 shadow-sm hover:shadow-md transition-shadow ${z?"opacity-60":""}`,children:[s.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[s.jsxs("div",{className:"flex items-start gap-2 flex-1 min-w-0",children:[s.jsx(bs,{className:"w-4 h-4 text-primary fill-primary shrink-0 mt-1"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold text-sm sm:text-base text-gray-900 line-clamp-1",children:T.title}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mt-1 line-clamp-2",children:T.description||"No description"})]})]}),z&&s.jsx("span",{className:"text-[10px] font-bold px-2 py-0.5 bg-red-100 text-red-700 rounded-full whitespace-nowrap",children:"CANCELLED"})]}),(T.budgetMin||T.budgetMax)&&s.jsxs("p",{className:"text-xs sm:text-sm font-semibold text-gray-900 mb-2",children:["Budget: ",T.budgetMin?.toLocaleString("en-IN")||"0"," - ",T.budgetMax?.toLocaleString("en-IN")||"0"]}),s.jsxs("p",{className:"text-[10px] sm:text-xs text-gray-500 mb-3",children:[" ",T.areaName,", ",T.cityName]}),s.jsx("div",{className:"flex gap-2 pt-3 border-t border-gray-100",children:z?s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>oe(T.id),className:"flex-1 flex items-center justify-center gap-1.5 py-2 px-3 bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors text-xs sm:text-sm font-medium",children:[s.jsx(Xd,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"Restore"})]}),s.jsxs("button",{onClick:()=>we(T.id),className:"flex-1 flex items-center justify-center gap-1.5 py-2 px-3 bg-red-50 text-red-700 rounded-lg hover:bg-red-100 transition-colors text-xs sm:text-sm font-medium",children:[s.jsx(Ls,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"Delete Permanently"})]})]}):s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>fe(T),className:"flex-1 flex items-center justify-center gap-1.5 py-2 px-3 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors text-xs sm:text-sm font-medium",children:[s.jsx(Ea,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"Edit"})]}),s.jsxs("button",{onClick:()=>we(T.id),className:"flex-1 flex items-center justify-center gap-1.5 py-2 px-3 bg-red-50 text-red-700 rounded-lg hover:bg-red-100 transition-colors text-xs sm:text-sm font-medium",children:[s.jsx(Ls,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"Delete"})]})]})})]},T.id)})})}),g==="tasks"&&s.jsx(s.Fragment,{children:N.length===0?s.jsxs("div",{className:"text-center py-12 bg-white rounded-2xl",children:[s.jsx(Ot,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"No tasks yet"}),s.jsx("button",{onClick:()=>c("create-task"),className:"bg-black text-white px-6 py-2.5 rounded-xl hover:bg-gray-800 transition-colors text-sm font-medium",children:"Create Your First Task"})]}):s.jsx("div",{className:"space-y-3",children:N.map(T=>{const z=T.status==="closed",G=T.status==="open";return s.jsxs("div",{className:`bg-white rounded-xl p-3 sm:p-4 shadow-sm hover:shadow-md transition-shadow ${z?"opacity-60":""}`,children:[s.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[s.jsxs("div",{className:"flex items-start gap-2 flex-1 min-w-0",children:[s.jsx(Ot,{className:"w-4 h-4 text-primary shrink-0 mt-1"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold text-sm sm:text-base text-gray-900 line-clamp-1",children:T.title}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mt-1 line-clamp-2",children:T.description||"No description"})]})]}),s.jsx("span",{className:`text-[10px] font-bold px-2 py-0.5 rounded-full whitespace-nowrap ${T.status==="open"?"bg-[#CDFF00] text-black":T.status==="accepted"?"bg-blue-100 text-blue-700":T.status==="in_progress"?"bg-[#CDFF00]/60 text-black":T.status==="completed"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:T.status.toUpperCase()})]}),T.price&&s.jsx("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded",style:{backgroundColor:"#CDFF00"},children:s.jsxs("span",{className:"text-xs font-bold text-black",children:["Earn ",T.price.toLocaleString("en-IN")]})}),s.jsxs("p",{className:"text-[10px] sm:text-xs text-gray-500 mb-3",children:[" ",T.areaName,", ",T.cityName]}),s.jsxs("div",{className:"flex gap-2 pt-3 border-t border-gray-100",children:[!z&&G&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>Y(T),className:"flex-1 flex items-center justify-center gap-1.5 py-2 px-3 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors text-xs sm:text-sm font-medium",children:[s.jsx(Ea,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"Edit"})]}),s.jsxs("button",{onClick:()=>$(T.id),className:"flex-1 flex items-center justify-center gap-1.5 py-2 px-3 bg-gray-50 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors text-xs sm:text-sm font-medium",children:[s.jsx(ar,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"Cancel"})]}),s.jsxs("button",{onClick:()=>I(T.id),className:"flex-1 flex items-center justify-center gap-1.5 py-2 px-3 bg-red-50 text-red-700 rounded-lg hover:bg-red-100 transition-colors text-xs sm:text-sm font-medium",children:[s.jsx(Ls,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"Delete"})]})]}),z&&s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>W(T.id),className:"flex-1 flex items-center justify-center gap-1.5 py-2 px-3 bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors text-xs sm:text-sm font-medium",children:[s.jsx(Xd,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"Restore"})]}),s.jsxs("button",{onClick:()=>I(T.id),className:"flex-1 flex items-center justify-center gap-1.5 py-2 px-3 bg-red-50 text-red-700 rounded-lg hover:bg-red-100 transition-colors text-xs sm:text-sm font-medium",children:[s.jsx(Ls,{className:"w-3.5 h-3.5"}),s.jsx("span",{children:"Delete Permanently"})]})]}),!z&&!G&&s.jsx("div",{className:"flex-1 text-center py-2 text-xs text-gray-500",children:"Task in progress - cannot edit or cancel"})]})]},T.id)})})})]})})]}),L&&s.jsx(h4,{isOpen:L,onClose:()=>P(!1),currentName:t.name,currentAvatar:t.profilePic,onSuccess:()=>{P(!1),J.success("Profile updated successfully!"),B()}}),D&&s.jsx(m4,{isOpen:D,onClose:()=>H(!1),onSuccess:()=>{H(!1),J.success("Password changed successfully!")}})]}):null}function p4({listing:t,className:e=""}){const r=async()=>{const i=window.location.href,o=`Check out ${t.title} for ${t.price.toLocaleString("en-IN")} on LocalFelo`;if(navigator.share)try{await navigator.share({title:t.title,text:o,url:i})}catch{console.log("Share cancelled")}else try{await navigator.clipboard.writeText(i),J.success("Link copied to clipboard!")}catch{J.error("Failed to copy link")}};return s.jsx("button",{onClick:r,className:e,"aria-label":"Share listing",children:s.jsx(dy,{className:"w-5 h-5 text-primary"})})}function g4({images:t,categoryEmoji:e,title:r}){const[i,o]=j.useState(0),[c,l]=j.useState(0),[u,h]=j.useState(0),f=j.useRef(null),g=t||[],p=g.length>0,y=g.length>1,v=()=>{o(E=>E===0?g.length-1:E-1)},w=()=>{o(E=>E===g.length-1?0:E+1)},k=E=>{o(E)},N=E=>{l(E.targetTouches[0].clientX)},C=E=>{h(E.targetTouches[0].clientX)},A=()=>{if(!c||!u)return;const E=c-u,_=50;E>_?w():E<-_&&v(),l(0),h(0)};return j.useEffect(()=>{const E=_=>{y&&(_.key==="ArrowLeft"?v():_.key==="ArrowRight"&&w())};return window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)},[y,g.length]),s.jsx("div",{ref:f,className:"relative w-full bg-input overflow-hidden",style:{height:"400px",maxWidth:"100%"},onTouchStart:N,onTouchMove:C,onTouchEnd:A,children:p?s.jsxs(s.Fragment,{children:[s.jsx("img",{src:g[i],alt:`${r} - Image ${i+1}`,loading:"lazy",className:"w-full h-full object-contain bg-input",style:{maxWidth:"100%"}}),y&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:v,className:"absolute left-3 top-1/2 -translate-y-1/2 w-10 h-10 bg-card/95 backdrop-blur-sm rounded-full flex items-center justify-center hover:bg-card transition-all active:scale-95 shadow-lg z-10","aria-label":"Previous image",children:s.jsx(eh,{className:"w-5 h-5 text-heading"})}),s.jsx("button",{onClick:w,className:"absolute right-3 top-1/2 -translate-y-1/2 w-10 h-10 bg-card/95 backdrop-blur-sm rounded-full flex items-center justify-center hover:bg-card transition-all active:scale-95 shadow-lg z-10","aria-label":"Next image",children:s.jsx(th,{className:"w-5 h-5 text-heading"})})]}),y&&s.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-2 z-10",children:g.map((E,_)=>s.jsx("button",{onClick:()=>k(_),className:`transition-all rounded-full ${_===i?"w-7 h-2.5 bg-primary shadow-md":"w-2.5 h-2.5 bg-card/80 hover:bg-card"}`,"aria-label":`Go to image ${_+1}`},_))}),y&&s.jsx("div",{className:"hidden sm:block absolute top-4 right-4 px-3 py-1.5 bg-card/95 backdrop-blur-sm rounded-full shadow-md z-10",children:s.jsxs("span",{className:"text-xs text-heading font-semibold",children:[i+1," / ",g.length]})})]}):s.jsx("div",{className:"w-full h-full flex items-center justify-center",children:s.jsx("span",{className:"text-8xl opacity-30",children:e})})})}function x4({latitude:t,longitude:e,label:r="Open in Google Maps",className:i="",size:o="md"}){const c=()=>{const u=`https://www.google.com/maps/dir/?api=1&destination=${t},${e}`;window.open(u,"_blank")},l={sm:"px-3 py-1.5 text-xs",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"};return s.jsxs("button",{onClick:c,className:`flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 text-white rounded-[4px] font-medium transition-colors ${l[o]} ${i}`,children:[s.jsx(xi,{className:o==="sm"?"w-3 h-3":o==="lg"?"w-5 h-5":"w-4 h-4"}),s.jsx("span",{children:r})]})}function Ma(t){if(!t||t.trim()===""||t==="User")return"Local Resident";const e=t.trim().split(" ");if(e.length===1)return e[0];const r=e[0],i=e[e.length-1][0];return`${r} ${i}.`}async function em(t){try{const{data:e,error:r}=await V.from("profiles").select("id, name, email").eq("id",t).single();return r?null:e}catch(e){return console.error("Error fetching profile by id:",e),null}}function y4({listing:t,onBack:e,isLoggedIn:r,onLoginRequired:i,onChatClick:o,currentUserId:c}){const[l,u]=j.useState(!0),[h,f]=j.useState(!0);j.useEffect(()=>{(async()=>{const E=t.userId||t.owner_token;if(!E){u(!1),f(!1);return}try{const _=await em(E);u(!!_)}catch(_){console.error(" Error checking seller profile:",_),u(!1)}finally{f(!1)}})()},[t.id,t.userId,t.owner_token]);const g=()=>{if(!r){i();return}window.location.href=`tel:${t.phone}`},p=()=>{if(!r){i();return}const A=t.whatsapp||t.phone,E=encodeURIComponent(`Hi, I'm interested in your listing: ${t.title}`);window.open(`https://wa.me/91${A}?text=${E}`,"_blank")},y=()=>{if(console.log(" [ListingDetail] Chat button clicked!"),!r){console.log(" [ListingDetail] User not logged in - showing login modal"),i();return}console.log(" [ListingDetail] Calling onChatClick with listing:",t.id),o(t)},v=c&&t.userId===c,w=t.hasWhatsapp,k=!v,N=1+(w?1:0)+(k?1:0),C=N===3?"grid-cols-3":N===2?"grid-cols-2":"grid-cols-1";return console.log(" [ListingDetail] Chat button visibility check:",{isOwnListing:v,sellerProfileExists:l,profileCheckLoading:h,showChat:k,currentUserId:c,listingUserId:t.userId,listingOwnerToken:t.owner_token,buttonCount:N,gridCols:C}),s.jsxs("div",{className:"min-h-screen bg-background pb-24 lg:pb-0 overflow-x-hidden",children:[s.jsx("div",{className:"sticky top-0 z-40",children:s.jsx(rt,{title:"Listing Details",showBack:!0,onBack:e})}),s.jsxs("div",{className:"page-container pb-4 lg:pb-8",children:[s.jsx("div",{className:"relative",children:s.jsx(p4,{listing:t,className:"absolute right-0 top-2 z-10 bg-white shadow-lg rounded-full p-3 hover:bg-gray-50 transition-all active:scale-95 border border-border","aria-label":"Share listing"})}),s.jsxs("div",{className:"listing-detail-layout",children:[s.jsx("div",{className:"w-full overflow-hidden",children:s.jsx(g4,{images:t.images,categoryEmoji:t.categoryEmoji,title:t.title})}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"pb-6 border-b border-border",children:[s.jsx("h1",{className:"text-heading mb-3 font-bold text-[26px] leading-tight",children:t.title}),s.jsxs("p",{className:"text-primary m-0 font-bold text-[28px] leading-none",children:["",t.price?.toLocaleString("en-IN")||"0"]})]}),s.jsx("div",{children:s.jsxs("span",{className:"inline-flex items-center gap-2 px-4 py-2.5 bg-input rounded-xl",children:[s.jsx("span",{className:"text-xl",children:t.categoryEmoji}),s.jsx("span",{className:"text-sm text-body font-semibold",children:t.categoryName})]})}),s.jsxs("div",{className:"pb-6 border-b border-border",children:[s.jsx("h3",{className:"text-heading mb-3 font-semibold text-[17px]",children:"Description"}),s.jsx("p",{className:"text-body whitespace-pre-wrap leading-relaxed",children:t.description})]}),s.jsxs("div",{className:"pb-6 border-b border-border",children:[s.jsx("h3",{className:"text-heading mb-3 font-semibold text-[17px]",children:"Location"}),s.jsxs("div",{className:"flex items-center gap-2 text-body mb-3",children:[s.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:s.jsx(ds,{className:"w-5 h-5 text-primary"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("span",{className:"font-medium block",children:[t.areaName,", ",t.cityName]}),t.distance!==void 0&&t.distance!==null&&s.jsxs("span",{className:"font-extrabold mt-2 block",style:{backgroundColor:"#CDFF00",color:"#000000",fontSize:"14px",display:"inline-block",padding:"4px 8px",borderRadius:"6px"},children:["~",t.distance.toFixed(1)," km away"]})]})]}),t.address&&s.jsxs("div",{className:"mb-3 p-3 bg-gray-50 border border-gray-200",style:{borderRadius:"8px"},children:[s.jsx("p",{className:"text-[12px] text-gray-500 mb-1",style:{fontWeight:"600"},children:"Full Address"}),s.jsx("p",{className:"text-[14px] text-black whitespace-pre-wrap",style:{fontWeight:"500"},children:t.address})]}),t.latitude&&t.longitude&&s.jsx(x4,{latitude:t.latitude,longitude:t.longitude,label:"Get Directions",size:"sm"})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-heading mb-4 font-semibold text-[17px]",children:"Seller Information"}),s.jsxs("div",{className:"card flex items-center gap-4",children:[s.jsx("div",{className:"w-14 h-14 bg-primary text-primary-foreground rounded-full flex items-center justify-center shrink-0 font-bold text-[20px]",children:s.jsx("span",{children:Ma(t.userName).charAt(0).toUpperCase()})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-heading m-0 font-semibold text-[16px]",children:Ma(t.userName)}),s.jsx("p",{className:"text-xs text-muted m-0 mt-1 font-medium",children:"Posted by a local user near you"}),s.jsx("p",{className:"text-xs text-gray-500 m-0 mt-0.5",children:new Date(t.createdAt).toLocaleDateString("en-IN")})]})]})]})]})]})]}),s.jsx("div",{className:"fixed lg:static bottom-0 left-0 right-0 bg-card border-t border-border p-3 safe-bottom z-40 lg:hidden shadow-lg",children:s.jsxs("div",{className:`max-w-lg mx-auto grid ${C} gap-2`,children:[s.jsxs("button",{onClick:g,className:"flex items-center justify-center gap-2 bg-primary text-white rounded-xl py-2.5 px-4 font-medium text-sm hover:bg-primary/90 transition-all active:scale-95",children:[s.jsx(Ci,{className:"w-4 h-4"}),s.jsx("span",{children:"Call"})]}),t.hasWhatsapp&&s.jsxs("button",{onClick:p,className:"flex items-center justify-center gap-2 bg-white text-primary border-2 border-primary rounded-xl py-2.5 px-4 font-medium text-sm hover:bg-primary/5 transition-all active:scale-95",children:[s.jsx(ct,{className:"w-4 h-4"}),s.jsx("span",{children:"WhatsApp"})]}),!v&&s.jsxs("button",{onClick:y,className:"flex items-center justify-center gap-2 bg-white text-primary border-2 border-primary rounded-xl py-2.5 px-4 font-medium text-sm hover:bg-primary/5 transition-all active:scale-95",children:[s.jsx(Sr,{className:"w-4 h-4"}),s.jsx("span",{children:"Chat"})]})]})}),s.jsx("div",{className:"hidden lg:block page-container",children:s.jsxs("div",{className:`grid ${C} gap-4 max-w-2xl`,children:[s.jsxs("button",{onClick:g,className:"btn-primary flex items-center justify-center gap-2",children:[s.jsx(Ci,{className:"w-5 h-5"}),s.jsx("span",{children:"Call"})]}),t.hasWhatsapp&&s.jsxs("button",{onClick:p,className:"btn-secondary flex items-center justify-center gap-2",children:[s.jsx(ct,{className:"w-5 h-5"}),s.jsx("span",{children:"WhatsApp"})]}),!v&&s.jsxs("button",{onClick:y,className:"btn-secondary flex items-center justify-center gap-2",children:[s.jsx(Sr,{className:"w-5 h-5"}),s.jsx("span",{children:"Chat"})]})]})})]})}function b4({listing:t,onBack:e,onSuccess:r,onNavigate:i,isLoggedIn:o=!1,isAdmin:c=!1,userDisplayName:l}){const[u,h]=j.useState(1),[f,g]=j.useState([]),p=tt(),{location:y,updateLocation:v}=Fi(p?.id||null),[w,k]=j.useState(t.images||[]),[N,C]=j.useState([]),[A,E]=j.useState(t.title),[_,R]=j.useState(t.description),[L,P]=j.useState(t.price.toString()),[D,H]=j.useState(t.categoryId),[B,ae]=j.useState(t.phone||""),[ue,le]=j.useState(t.hasWhatsapp||!1),[fe,we]=j.useState(t.whatsapp||""),[oe,Y]=j.useState(t.address||""),[I,$]=j.useState(!1),[W,T]=j.useState({}),z=[...w,...N];j.useEffect(()=>{(async()=>{try{const ce=await Ti();g(ce.map(Ue=>({id:Number(Ue.id),name:Ue.name,slug:Ue.slug,emoji:Ue.emoji})))}catch(ce){console.error("Failed to load categories:",ce)}})()},[]),j.useEffect(()=>{if(t.latitude&&t.longitude&&(!y?.latitude||!y?.longitude)){const ee={cityId:null,city:t.cityName||"",areaId:t.areaName||t.cityName,area:t.areaName||t.cityName,latitude:t.latitude,longitude:t.longitude,address:t.address||"",locality:t.areaName,state:"",pincode:""};v(ee)}},[t]);const G=ee=>{const ce=ee.filter(he=>he.startsWith("http")),Ue=ee.filter(he=>!he.startsWith("http"));k(ce),C(Ue)},M=ee=>{k(w.filter(ce=>ce!==ee))},X=()=>{const ee={};return z.length===0&&(ee.images="Please add at least one image"),A.trim()||(ee.title="Title is required"),_.trim()||(ee.description="Description is required"),(!L||parseFloat(L)<=0)&&(ee.price="Please enter a valid price"),D||(ee.categoryId="Please select a category"),T(ee),Object.keys(ee).length===0},ie=()=>{const ee={};return(!B.trim()||B.length!==10)&&(ee.phone="Please enter a valid 10-digit phone number"),ue&&(!fe.trim()||fe.length!==10)&&(ee.whatsappNumber="Please enter a valid 10-digit WhatsApp number"),(!y?.latitude||!y?.longitude)&&(ee.location="Please set your location"),oe.trim()||(ee.address="Please enter your full address"),T(ee),Object.keys(ee).length===0},be=()=>{u===1&&X()&&h(2)},ve=async()=>{if(ie())try{J.loading("Updating listing...");const ee=t.images.filter(he=>!w.includes(he));if(ee.length>0&&await M2(t.id,ee),N.length>0){const he=await Promise.all(N.map(async(Le,Ke)=>{const re=await(await fetch(Le)).blob();return new File([re],`image-${Ke}.jpg`,{type:"image/jpeg"})}));await Ky(he,t.id)}const Ue=f.find(he=>he.id===Number(D))?.slug||t.categorySlug;await F2(t.id,{title:A.trim(),description:_.trim(),price:parseFloat(L),categorySlug:Ue,city:y?.city||t.cityName,areaSlug:y?.areaId||t.areaSlug,phone:B.trim(),whatsappEnabled:ue,whatsappNumber:ue?fe.trim():null}),J.dismiss(),J.success("Listing updated successfully!"),r()}catch(ee){J.dismiss(),console.error("Error updating listing:",ee),J.error(ee.message||"Failed to update listing")}};return s.jsxs("div",{className:"min-h-screen bg-white pb-40 sm:pb-8",children:[s.jsx(rt,{title:"Edit Listing",showBack:!0,onBack:e,currentScreen:"create",onNavigate:i,isLoggedIn:o,isAdmin:c,userDisplayName:l}),s.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-6 pb-24 lg:pb-6",children:[s.jsxs("div",{className:"mb-8 flex items-center justify-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center transition-all ${u===1?"bg-[#CDFF00] text-black":"bg-gray-200 text-gray-600"}`,children:u>1?s.jsx(Is,{className:"w-5 h-5"}):"1"}),s.jsx("span",{className:`text-sm hidden sm:inline ${u===1?"text-black font-semibold":"text-gray-600"}`,children:"Item Details"})]}),s.jsx("div",{className:"w-12 h-px bg-gray-300"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center transition-all ${u===2?"bg-[#CDFF00] text-black":"bg-gray-200 text-gray-600"}`,children:"2"}),s.jsx("span",{className:`text-sm hidden sm:inline ${u===2?"text-black font-semibold":"text-gray-600"}`,children:"Contact & Location"})]})]}),u===1&&s.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-black mb-1",children:"Update Item Details"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Make changes to your listing information"})]}),w.length>0&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold text-black mb-2",children:"Current Images"}),s.jsx("div",{className:"grid grid-cols-3 gap-3",children:w.map(ee=>s.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-gray-100",children:[s.jsx("img",{src:ee,alt:"Listing",className:"w-full h-full object-cover"}),s.jsx("button",{onClick:()=>M(ee),className:"absolute top-2 right-2 w-6 h-6 bg-red-600 text-white rounded-full flex items-center justify-center hover:bg-red-700 transition-colors","aria-label":"Remove image",children:s.jsx(ut,{className:"w-4 h-4"})})]},ee))})]}),s.jsx(Ib,{images:z,onImagesChange:G,maxImages:10}),W.images&&s.jsx("p",{className:"text-xs text-red-600 mt-1",children:W.images}),s.jsx(xs,{label:"Title",value:A,onChange:E,placeholder:"e.g., iPhone 12 Pro Max",required:!0,error:W.title}),s.jsx(Ab,{label:"Description",value:_,onChange:R,placeholder:"Describe your item in detail...",rows:5,required:!0,error:W.description}),s.jsx(xs,{label:"Price ()",type:"number",value:L,onChange:P,placeholder:"0",required:!0,error:W.price}),s.jsx(cc,{label:"Category",value:D,onChange:H,categories:f,required:!0,error:W.categoryId})]})}),u===2&&s.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-black mb-1",children:"Contact & Location"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Update contact and location details"})]}),s.jsx(xs,{label:"Phone Number",type:"tel",value:B,onChange:ee=>ae(ee.replace(/\D/g,"").slice(0,10)),placeholder:"9876543210",required:!0,error:W.phone}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:ue,onChange:ee=>le(ee.target.checked),className:"w-5 h-5 rounded border-gray-300 accent-[#CDFF00]"}),s.jsx("span",{className:"text-sm text-black",children:"I have WhatsApp on a different number"})]}),ue&&s.jsx(xs,{label:"WhatsApp Number",type:"tel",value:fe,onChange:ee=>we(ee.replace(/\D/g,"").slice(0,10)),placeholder:"9876543210",required:!0,error:W.whatsappNumber})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-black mb-2",children:["Your Location ",s.jsx("span",{className:"text-red-500",children:"*"})]}),y&&y.latitude&&y.longitude?s.jsxs("button",{type:"button",onClick:()=>$(!0),className:"w-full p-4 bg-white border-2 border-gray-200 hover:border-[#CDFF00] transition-colors text-left flex items-start justify-between gap-3 rounded-lg",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx(ds,{className:"w-5 h-5 text-[#CDFF00] flex-shrink-0"}),s.jsxs("p",{className:"text-sm font-semibold text-black",children:[y.area," ",y.city]})]}),y.address&&s.jsx("p",{className:"text-xs text-gray-600 truncate",children:y.address})]}),s.jsx("svg",{className:"w-5 h-5 text-gray-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}):s.jsxs("div",{className:"p-4 bg-red-50 border-2 border-red-200 rounded-lg",children:[s.jsx("p",{className:"text-sm font-semibold text-red-600 mb-2",children:" Location Not Set"}),s.jsx("p",{className:"text-xs text-red-600 mb-3",children:"Please set your location to continue"}),s.jsx("button",{type:"button",onClick:()=>$(!0),className:"w-full py-2.5 px-4 bg-[#CDFF00] text-black hover:bg-[#b8e600] transition-colors rounded-md text-sm font-semibold",children:"Set Location Now"})]}),W.location&&s.jsx("p",{className:"text-xs text-red-600 mt-1",children:W.location}),s.jsx("p",{className:"text-xs text-gray-500 mt-1.5",children:"Tap to change your location"})]}),y&&y.latitude&&s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-semibold text-black mb-2",children:["Full Address ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("textarea",{value:oe,onChange:ee=>Y(ee.target.value),placeholder:`Building name, floor, street details...

E.g., Shop #12, 2nd Floor, 8th Cross, 29th Main Road
Above Cafe Coffee Day`,className:"w-full px-4 py-3 bg-white border-2 border-gray-200 text-black placeholder-gray-400 focus:outline-none focus:border-[#CDFF00] transition-colors resize-none rounded-lg text-sm",style:{minHeight:"120px"},rows:5}),s.jsx("p",{className:"text-xs text-gray-500 mt-1.5",children:"Add specific details like building name, floor, nearby landmarks"}),W.address&&s.jsx("p",{className:"text-xs text-red-600 mt-1.5",children:W.address})]})]})})]}),s.jsx("div",{className:"fixed lg:static bottom-16 lg:bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-4 z-40",children:s.jsx("div",{className:"max-w-3xl mx-auto flex gap-3",children:u===1?s.jsxs(s.Fragment,{children:[s.jsx("button",{type:"button",onClick:e,className:"flex-1 py-3 px-4 border-2 border-gray-300 text-black font-semibold rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),s.jsx("button",{type:"button",onClick:be,className:"flex-1 py-3 px-4 bg-[#CDFF00] text-black font-semibold rounded-lg hover:bg-[#b8e600] transition-colors",children:"Next"})]}):s.jsxs(s.Fragment,{children:[s.jsx("button",{type:"button",onClick:()=>h(1),className:"flex-1 py-3 px-4 border-2 border-gray-300 text-black font-semibold rounded-lg hover:bg-gray-50 transition-colors",children:"Back"}),s.jsx("button",{type:"button",onClick:ve,className:"flex-1 py-3 px-4 bg-[#CDFF00] text-black font-semibold rounded-lg hover:bg-[#b8e600] transition-colors",children:"Update Listing"})]})})}),I&&s.jsx(ao,{onLocationSelect:async ee=>{const ce={cityId:null,city:ee.city,areaId:ee.locality||ee.city,area:ee.locality||ee.city,latitude:ee.latitude,longitude:ee.longitude,address:ee.address,locality:ee.locality,state:ee.state,pincode:ee.pincode};await v(ce),$(!1),J.success("Location updated! ")},onClose:()=>$(!1),currentLocation:y&&y.latitude?{latitude:y.latitude,longitude:y.longitude,city:y.city,address:y.address}:null})]})}function v4({conversations:t,selectedConversationId:e,onSelectConversation:r,onBack:i}){const o=tt(),c=o?.id||null;if(console.log(" [ChatList] Rendering with:",{conversationsCount:t.length,selectedConversationId:e,currentUserId:c,onSelectConversation:typeof r}),!o)return null;const l=h=>{const f=h.buyer_id===c;return{name:f?h.seller_name:h.buyer_name,avatar:f?h.seller_avatar:h.buyer_avatar}},u=h=>{if(!h)return"";try{const f=new Date(h),p=new Date().getTime()-f.getTime(),y=Math.floor(p/6e4),v=Math.floor(y/60),w=Math.floor(v/24);return y<1?"Just now":y<60?`${y}m ago`:v<24?`${v}h ago`:w<7?`${w}d ago`:f.toLocaleDateString("en-IN",{month:"short",day:"numeric"})}catch{return""}};return s.jsxs("div",{className:"flex flex-col h-full",children:[s.jsxs("div",{className:"p-4 border-b border-border flex items-center gap-3",children:[i&&s.jsx("button",{onClick:i,className:"p-2 -ml-2 hover:bg-input rounded-lg transition-colors","aria-label":"Back to home",children:s.jsx(Za,{className:"w-5 h-5"})}),s.jsx("h2",{className:"font-semibold text-heading",children:"Messages"})]}),t.length===0?s.jsx("div",{className:"flex-1 flex items-center justify-center p-8",children:s.jsxs("p",{className:"text-center text-muted",children:["No conversations yet.",s.jsx("br",{}),"Start chatting from a listing!"]})}):s.jsx("div",{className:"flex-1 overflow-y-auto divide-y divide-border",children:t.map(h=>{const f=l(h),g=e===h.id,p=h.unread_count&&h.unread_count>0;return s.jsx("button",{type:"button",onClick:()=>{console.log(" CLICK DETECTED on conversation:",h.id),r(h)},className:`w-full p-4 hover:bg-input/50 transition-colors text-left ${g?"bg-primary/5":""}`,children:s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"w-12 h-12 bg-primary/10 text-primary rounded-full flex items-center justify-center shrink-0 font-bold",children:f.name.charAt(0).toUpperCase()}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-heading font-semibold truncate",children:f.name}),s.jsx("p",{className:"text-xs text-muted truncate",children:h.listing_title})]}),h.last_message_at&&s.jsx("span",{className:"text-xs text-muted whitespace-nowrap",children:u(h.last_message_at)})]}),s.jsxs("div",{className:"flex items-center justify-between gap-2",children:[s.jsx("p",{className:"text-sm text-body truncate flex-1",children:h.last_message||"No messages yet"}),p&&s.jsx("span",{className:"bg-[#CDFF00] text-black text-xs font-bold px-2 py-1 rounded-full min-w-[24px] text-center",children:h.unread_count>9?"9+":h.unread_count})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[h.listing_image&&s.jsx("img",{src:h.listing_image,alt:h.listing_title,className:"w-10 h-10 rounded-lg object-cover"}),s.jsxs("span",{className:"text-primary font-semibold text-sm",children:["",h.listing_price.toLocaleString("en-IN")]})]})]})]})},h.id)})})]})}function w4({conversation:t,onBack:e,onConversationUpdate:r,onListingClick:i,isLoggedIn:o=!1,isAdmin:c=!1,userDisplayName:l,unreadCount:u=0,notificationCount:h=0,onNotificationClick:f,onMenuClick:g,globalLocationArea:p,globalLocationCity:y,onGlobalLocationClick:v,onNavigate:w}){const[k,N]=j.useState([]),[C,A]=j.useState(""),[E,_]=j.useState(!1),R=j.useRef(null),L=j.useRef(null),P=j.useRef(null),D=j.useRef(!1),H=j.useRef(!1),B=j.useMemo(()=>{const Y=tt(),I=Y?.id||null;return console.log(" [ChatWindow] Current User ID:",I),console.log(" [ChatWindow] Current User:",Y),I},[]);tt();const ae=t.buyer_id===B?{name:t.seller_name,avatar:t.seller_avatar}:{name:t.buyer_name,avatar:t.buyer_avatar},ue=()=>{R.current?.scrollIntoView({behavior:"smooth"})};j.useEffect(()=>{D.current=!1;const Y=async()=>{console.log(" [ChatWindow] Loading messages for conversation:",t.id);const{messages:$,error:W}=await Oy(t.id);console.log(" [ChatWindow] Messages loaded:",{count:$.length,error:W,messages:$}),W?console.error(" [ChatWindow] Error loading messages:",W):(N($),setTimeout(ue,100))};Y();const I=setInterval(()=>{Y()},3e3);return()=>{clearInterval(I)}},[t.id]);const le=j.useCallback(Y=>{N(I=>I.some($=>$.id===Y.id)?I:(setTimeout(ue,100),[...I,Y])),Y.sender_id!==B&&document.visibilityState==="visible"&&(P.current&&clearTimeout(P.current),P.current=setTimeout(()=>{Dl(t.id),D.current=!0},500))},[t.id,B]);j.useEffect(()=>{const Y=Vy(t.id,le);return()=>{Y()}},[t.id,le]),j.useEffect(()=>{if(!(D.current||k.filter(I=>!I.read&&I.sender_id!==B).length===0)&&document.visibilityState==="visible")return P.current=setTimeout(async()=>{await Dl(t.id),D.current=!0,N(I=>I.map($=>$.sender_id!==B&&!$.read?{...$,read:!0}:$))},500),()=>{P.current&&clearTimeout(P.current)}},[t.id,k,B]),j.useEffect(()=>{const Y=()=>{document.visibilityState==="visible"&&!D.current&&k.filter($=>!$.read&&$.sender_id!==B).length>0&&(P.current=setTimeout(async()=>{await Dl(t.id),D.current=!0,N($=>$.map(W=>W.sender_id!==B&&!W.read?{...W,read:!0}:W))},500))};return document.addEventListener("visibilitychange",Y),()=>{document.removeEventListener("visibilitychange",Y)}},[t.id,k,B]);const fe=async()=>{if(console.log(" [handleSend] START - newMessage:",C),console.log(" [handleSend] newMessage.trim():",C.trim()),console.log(" [handleSend] sending:",E),!C.trim()||E||H.current){console.log(" [handleSend] BLOCKED - empty, already sending, or rapid-fire");return}H.current=!0,_(!0);const Y=C.trim();console.log(" [handleSend] Content to send:",Y),console.log(" [handleSend] Clearing input NOW"),A(""),console.log(" Sending message to conversation:",t.id),console.log(" Current user ID:",B),console.log(" Message content:",Y);const{message:I,error:$}=await Uy(t.id,Y);if(console.log(" Send result:",{message:I,error:$}),console.log(" Error type:",typeof $),console.log(" Error stringified:",JSON.stringify($)),$){console.error(" Send message error:",$);const W=typeof $=="string"?$:JSON.stringify($,null,2);J.error(`Failed to send: ${W}`),A(Y)}else I&&(console.log(" Message sent successfully:",I),N(W=>W.some(T=>T.id===I.id)?W:[...W,I]),r?.());_(!1),H.current=!1,setTimeout(()=>{L.current?.focus()},50),console.log(" [handleSend] COMPLETE")},we=Y=>{console.log(" [handleKeyDown] Key pressed:",Y.key),console.log(" [handleKeyDown] Current input value:",C),console.log(" [handleKeyDown] ShiftKey:",Y.shiftKey),console.log(" [handleKeyDown] Sending:",E),Y.key==="Enter"&&!Y.shiftKey&&!E&&(console.log(" [handleKeyDown] ENTER DETECTED - preventing default and calling handleSend"),Y.preventDefault(),fe())},oe=Y=>{try{return new Date(Y).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"})}catch{return""}};return s.jsxs("div",{className:"flex flex-col h-full bg-white w-full overflow-hidden",children:[s.jsx(rt,{currentScreen:"chat",onNavigate:w,isLoggedIn:o,isAdmin:c,userDisplayName:l,unreadCount:u,notificationCount:h,onNotificationClick:f,onMenuClick:g,showGlobalLocation:!0,globalLocationArea:p,globalLocationCity:y,onLocationClick:v,onGlobalSearchClick:()=>{}}),s.jsxs("div",{className:"flex-none z-30 flex items-center gap-3 p-3 border-b border-gray-200 bg-white",children:[e&&s.jsx("button",{onClick:e,className:"p-2 -ml-2 hover:bg-gray-100 rounded-lg transition-colors shrink-0","aria-label":"Back to conversations",children:s.jsx(Za,{className:"w-5 h-5"})}),s.jsx("div",{className:"w-10 h-10 bg-[#CDFF00] text-black rounded-full flex items-center justify-center shrink-0 font-semibold",children:ae.name.charAt(0).toUpperCase()}),s.jsxs("button",{onClick:()=>{console.log(" [ChatWindow] HEADER CLICKED!"),i?.(t.listing_id,t.listingtype)},className:"flex-1 min-w-0 overflow-hidden text-left hover:bg-gray-100 -my-2 py-2 px-2 -mx-2 rounded-lg transition-colors",children:[s.jsx("h2",{className:"font-semibold text-sm text-black truncate",children:ae.name}),s.jsx("p",{className:"text-xs text-gray-600 truncate",children:t.listing_title})]}),s.jsx("div",{className:"text-right shrink-0",children:s.jsxs("p",{className:"text-black font-bold whitespace-nowrap text-sm",children:["",t.listing_price.toLocaleString("en-IN")]})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 overscroll-contain pb-32 md:pb-24 bg-white",children:[k.length===0?s.jsx("div",{className:"flex items-center justify-center h-full",children:s.jsx("p",{className:"text-muted text-center",children:"No messages yet. Start the conversation!"})}):k.map(Y=>{const I=Y.sender_id===B;return console.log(" [Message Render] Message ID:",Y.id,"Sender:",Y.sender_id,"Current User:",B,"isOwn:",I),s.jsx("div",{className:`flex ${I?"justify-end":"justify-start"}`,children:s.jsxs("div",{className:`max-w-[70%] rounded-2xl px-4 py-2 ${I?"bg-[#CDFF00] text-black rounded-br-sm":"bg-gray-200 text-gray-900 rounded-bl-sm"}`,children:[s.jsx("p",{className:"break-words",children:Y.content}),s.jsx("p",{className:`text-xs mt-1 ${I?"text-black/60":"text-gray-600"}`,children:oe(Y.created_at)})]})},Y.id)}),s.jsx("div",{ref:R})]}),s.jsx("div",{className:"fixed bottom-16 md:bottom-12 left-0 right-0 z-30 p-4 border-t border-border bg-white shadow-[0_-2px_8px_rgba(0,0,0,0.05)]",children:s.jsxs("div",{className:"flex gap-2 max-w-7xl mx-auto",children:[s.jsx("input",{type:"text",value:C,onChange:Y=>A(Y.target.value),onKeyDown:we,placeholder:"Type a message...",className:"flex-1 px-4 py-3 bg-input border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",disabled:E,ref:L}),s.jsx("button",{onClick:fe,disabled:!C.trim()||E,className:"px-6 py-3 bg-[#CDFF00] text-black font-semibold rounded-lg hover:bg-[#B8E600] disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:s.jsx(ly,{className:"w-5 h-5"})})]})})]})}function j4({onBack:t,initialConversationId:e,onNavigate:r,isLoggedIn:i=!1,isAdmin:o=!1,userDisplayName:c,unreadCount:l=0,onMenuClick:u,globalLocationArea:h,globalLocationCity:f,onGlobalLocationClick:g,notificationCount:p=0,onNotificationClick:y}){const[v,w]=j.useState([]),[k,N]=j.useState(null),[C,A]=j.useState(!0),[E,_]=j.useState("all"),[R,L]=j.useState(null),D=tt()?.id||null,H=j.useRef(!1);console.log(" [ChatScreen] Rendered"),console.log("  initialConversationId:",e),console.log("  selectedConversationId:",k),console.log("  conversations:",v.length);const B=k&&v.find(Y=>Y.id===k)||null,ae=async()=>{console.log(" Fetching conversations...");const{conversations:Y,error:I}=await My();return I?(console.error(" Failed to load conversations:",I),J.error("Failed to load conversations"),A(!1),[]):(console.log(` Loaded ${Y.length} conversations`),w(Y),A(!1),Y)};j.useEffect(()=>{H.current||(H.current=!0,ae())},[]),j.useEffect(()=>{if(!e||v.length===0)return;console.log(" Auto-selecting conversation:",e);const Y=v.find(I=>I.id===e);Y?(console.log(" Found target conversation, selecting it"),N(Y.id),L(null)):(console.warn(" Conversation not found in list:",e),setTimeout(async()=>{console.log(" Retrying conversation fetch...");const $=(await ae()).find(W=>W.id===e);$?(console.log(" Found conversation after retry!"),N($.id),L(null)):(console.error(" Conversation still not found after retry"),L(e),J.error("This conversation is no longer available"))},1e3))},[e,v]),j.useEffect(()=>{console.log(" Setting up real-time subscriptions...");const Y=ih(()=>{console.log(" Real-time change detected, refreshing..."),ae()});return()=>{console.log(" Cleaning up subscriptions..."),Y.unsubscribe()}},[]);const ue=v.filter(Y=>{if(!D)return!1;const I=Y.listingtype||"listing",$=Y.seller_id===D;switch(E){case"all":return!0;case"sell":return $;case"buy":return!$;case"wishes":return I==="wish";case"tasks":return I==="task";default:return!0}}),le=Y=>{console.log(" Conversation selected:",Y),N(Y),L(null)},fe=()=>{console.log(" Back from chat window"),N(null),L(null)},we=(Y,I)=>{console.log(" Listing clicked:",Y,"type:",I),r&&(I==="wish"?r("wishDetail",{wishId:Y}):I==="task"?r("taskDetail",{taskId:Y}):r("listingDetail",{listingId:Y}))},oe=[{id:"all",label:"All",icon:ct},{id:"sell",label:"Selling",icon:Fn},{id:"buy",label:"Buying",icon:Ua},{id:"wishes",label:"Wishes",icon:bs},{id:"tasks",label:"Tasks",icon:Ot}];return R?s.jsxs("div",{className:"flex flex-col h-screen bg-white",children:[s.jsx(rt,{currentScreen:"chat",onNavigate:r,isLoggedIn:i,isAdmin:o,userDisplayName:c,unreadCount:l,onMenuClick:u,showGlobalLocation:!0,globalLocationArea:h,globalLocationCity:f,onLocationClick:g,notificationCount:p,onNotificationClick:y,onGlobalSearchClick:()=>{}}),s.jsx("div",{className:"flex-1 flex items-center justify-center p-6",children:s.jsxs("div",{className:"text-center",children:[s.jsx(ct,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Conversation Not Found"}),s.jsx("p",{className:"text-gray-500 mb-6",children:"This conversation may have been deleted or is no longer available."}),s.jsx("button",{onClick:()=>{L(null),t&&t()},className:"px-6 py-2 bg-[#CDFF00] text-black font-medium hover:bg-[#b8e600] transition-colors",children:"Back to Chats"})]})})]}):B?s.jsx("div",{className:"h-screen bg-white",children:s.jsx(w4,{conversation:B,onBack:fe,onListingClick:we,onConversationUpdate:ae,isLoggedIn:i,isAdmin:o,userDisplayName:c,unreadCount:l,notificationCount:p,onNotificationClick:y,onMenuClick:u,globalLocationArea:h,globalLocationCity:f,onGlobalLocationClick:g,onNavigate:r})}):s.jsxs("div",{className:"flex flex-col h-screen bg-white",children:[s.jsx(rt,{currentScreen:"chat",onNavigate:r,isLoggedIn:i,isAdmin:o,userDisplayName:c,unreadCount:l,onMenuClick:u,showGlobalLocation:!0,globalLocationArea:h,globalLocationCity:f,onLocationClick:g,notificationCount:p,onNotificationClick:y,onGlobalSearchClick:()=>{}}),s.jsx("div",{className:"border-b border-gray-200 bg-white",children:s.jsx("div",{className:"flex overflow-x-auto scrollbar-hide",children:oe.map(Y=>{const I=Y.icon,$=v.filter(W=>{if(!D)return!1;const T=W.listingtype||"listing",z=W.seller_id===D;switch(Y.id){case"all":return!0;case"sell":return z;case"buy":return!z;case"wishes":return T==="wish";case"tasks":return T==="task";default:return!0}}).length;return s.jsxs("button",{onClick:()=>_(Y.id),className:`flex items-center gap-2 px-4 py-3 border-b-2 transition-colors whitespace-nowrap ${E===Y.id?"border-[#CDFF00] text-black font-medium":"border-transparent text-gray-500 hover:text-black"}`,children:[s.jsx(I,{className:"w-4 h-4"}),s.jsx("span",{children:Y.label}),$>0&&s.jsx("span",{className:"ml-1 px-2 py-0.5 text-xs bg-gray-100 text-black rounded-full font-medium",children:$})]},Y.id)})})}),s.jsx("div",{className:"flex-1 overflow-y-auto",children:C?s.jsx("div",{className:"flex items-center justify-center h-full",children:s.jsxs("div",{className:"text-center",children:[s.jsx(ct,{className:"w-12 h-12 text-gray-300 mx-auto mb-3 animate-pulse"}),s.jsx("p",{className:"text-gray-500",children:"Loading chats..."})]})}):ue.length===0?s.jsx("div",{className:"flex items-center justify-center h-full p-6",children:s.jsxs("div",{className:"text-center",children:[s.jsx(ct,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Conversations"}),s.jsx("p",{className:"text-gray-500",children:E==="all"?"Start chatting by clicking the chat button on any listing, wish, or task.":`You don't have any ${E} conversations yet.`})]})}):s.jsx(v4,{conversations:ue,selectedConversationId:k,onSelectConversation:Y=>le(Y.id)})})]})}function N4(){const[t,e]=j.useState(""),[r,i]=j.useState(""),[o,c]=j.useState("#CDFF00"),[l,u]=j.useState("#CDFF00"),[h,f]=j.useState("#000000"),[g,p]=j.useState(8),[y,v]=j.useState(!1),[w,k]=j.useState(""),[N,C]=j.useState("Download our app from Google Play Store"),[A,E]=j.useState("Active Tasks"),[_,R]=j.useState("Tap to view details"),[L,P]=j.useState(""),[D,H]=j.useState(""),[B,ae]=j.useState(""),[ue,le]=j.useState(""),[fe,we]=j.useState(!0),[oe,Y]=j.useState(!1);j.useEffect(()=>{I()},[]);const I=async()=>{we(!0);try{const{data:G}=await V.from("site_settings").select("message, emoji, gradient_color_1, gradient_color_2, text_color, opacity").eq("id","home_banner").single();G&&(e(G.message||""),i(G.emoji||""),c(G.gradient_color_1||"#CDFF00"),u(G.gradient_color_2||"#CDFF00"),f(G.text_color||"#000000"),p(G.opacity||8));const{data:M}=await V.from("site_settings").select("enabled, app_download_url, message").eq("id","app_download").single();M&&(v(M.enabled||!1),k(M.app_download_url||""),C(M.message||"Download our app from Google Play Store"));const{data:X}=await V.from("site_settings").select("title, message, image_url").eq("id","active_task_banner").single();X&&(E(X.title||"Active Tasks"),R(X.message||"Tap to view details"),P(X.image_url||""));const{data:ie}=await V.from("site_settings").select("instagram_url, facebook_url, linkedin_url").eq("id","social_links").single();ie&&(H(ie.instagram_url||""),ae(ie.facebook_url||""),le(ie.linkedin_url||""))}catch(G){console.error("Error loading settings:",G)}we(!1)},$=async()=>{Y(!0);try{const{error:G}=await V.from("site_settings").upsert({id:"home_banner",setting_type:"banner",enabled:!0,message:t,emoji:r,gradient_color_1:o,gradient_color_2:l,text_color:h,opacity:g,icon:"megaphone",style_type:"info",storage_key:"home-banner-v1",priority:1,updated_at:new Date().toISOString()});if(G)throw G;J.success("Banner saved successfully!")}catch(G){console.error("Error saving banner:",G),J.error(`Failed to save: ${G.message}`)}Y(!1)},W=async()=>{Y(!0);try{const{error:G}=await V.from("site_settings").upsert({id:"app_download",setting_type:"app_download",enabled:y,message:N,app_download_url:w,priority:1,updated_at:new Date().toISOString()});if(G)throw G;J.success("App download settings saved!")}catch(G){console.error("Error saving app download:",G),J.error(`Failed to save: ${G.message}`)}Y(!1)},T=async()=>{Y(!0);try{const{error:G}=await V.from("site_settings").upsert({id:"active_task_banner",setting_type:"active_task_banner",enabled:!0,title:A,message:_,image_url:L,icon:"briefcase",priority:1,updated_at:new Date().toISOString()});if(G)throw G;J.success("Active task banner settings saved!")}catch(G){console.error("Error saving task banner:",G),J.error(`Failed to save: ${G.message}`)}Y(!1)},z=async()=>{Y(!0);try{const{error:G}=await V.from("site_settings").upsert({id:"social_links",setting_type:"social_links",enabled:!0,instagram_url:D,facebook_url:B,linkedin_url:ue,priority:1,updated_at:new Date().toISOString()});if(G)throw G;J.success("Social links saved successfully!")}catch(G){console.error("Error saving social links:",G),J.error(`Failed to save: ${G.message}`)}Y(!1)};return fe?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-3"}),s.jsx("p",{className:"text-sm text-muted",children:"Loading..."})]})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-heading m-0",children:"Home Page Banner"}),s.jsx("p",{className:"text-sm text-muted m-0 mt-1",children:"Customize the banner message and styling that appears at the top of the home page"})]}),s.jsxs("div",{className:"bg-card border border-border rounded-xl p-6 space-y-5",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-body mb-2",children:"Banner Message"}),s.jsx("input",{type:"text",value:t,onChange:G=>e(G.target.value),className:"input w-full",placeholder:"Enter banner text (e.g., 'Welcome to LocalFelo!')",maxLength:200}),s.jsxs("p",{className:"text-xs text-muted mt-1.5",children:[t.length,"/200 characters"]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-body mb-2",children:"Icon/Emoji"}),s.jsx("input",{type:"text",value:r,onChange:G=>i(G.target.value),className:"input w-full",placeholder:"",maxLength:10}),s.jsx("p",{className:"text-xs text-muted mt-1.5",children:"Use any emoji or icon (e.g., , , , , )"})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-body mb-2",children:"Gradient Color 1"}),s.jsxs("div",{className:"flex gap-2 items-center",children:[s.jsx("input",{type:"color",value:o,onChange:G=>c(G.target.value),className:"h-10 w-16 rounded cursor-pointer border border-border"}),s.jsx("input",{type:"text",value:o,onChange:G=>c(G.target.value),className:"input flex-1",placeholder:"#CDFF00"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-body mb-2",children:"Gradient Color 2"}),s.jsxs("div",{className:"flex gap-2 items-center",children:[s.jsx("input",{type:"color",value:l,onChange:G=>u(G.target.value),className:"h-10 w-16 rounded cursor-pointer border border-border"}),s.jsx("input",{type:"text",value:l,onChange:G=>u(G.target.value),className:"input flex-1",placeholder:"#CDFF00"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-body mb-2",children:"Text Color"}),s.jsxs("div",{className:"flex gap-2 items-center",children:[s.jsx("input",{type:"color",value:h,onChange:G=>f(G.target.value),className:"h-10 w-16 rounded cursor-pointer border border-border"}),s.jsx("input",{type:"text",value:h,onChange:G=>f(G.target.value),className:"input flex-1",placeholder:"#000000"})]})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-body mb-2",children:["Background Opacity: ",g,"%"]}),s.jsx("input",{type:"range",min:"0",max:"30",step:"1",value:g,onChange:G=>p(parseInt(G.target.value)),className:"w-full h-2 bg-border rounded-lg appearance-none cursor-pointer",style:{background:`linear-gradient(to right, ${o} 0%, ${l} 100%)`}}),s.jsxs("div",{className:"flex justify-between text-xs text-muted mt-1",children:[s.jsx("span",{children:"Subtle (0%)"}),s.jsx("span",{children:"Strong (30%)"})]})]}),s.jsxs("button",{onClick:$,disabled:oe||!t.trim(),className:"btn-primary flex items-center gap-2",children:[s.jsx(sn,{className:"w-4 h-4"}),s.jsx("span",{children:oe?"Saving...":"Save Banner Settings"})]})]}),t&&s.jsxs("div",{className:"bg-card border border-border rounded-xl p-6",children:[s.jsx("p",{className:"text-sm font-medium text-body mb-3",children:"Live Preview:"}),s.jsxs("div",{className:"relative w-full overflow-hidden -mx-6",children:[s.jsx("div",{className:"absolute inset-0",style:{background:`linear-gradient(to right, ${o}, ${l})`,opacity:g/100}}),s.jsxs("div",{className:"relative px-4 py-3.5 flex items-center justify-center gap-3 border-y",style:{borderColor:`${h}15`},children:[s.jsx("span",{className:"text-xl animate-bounce",children:r}),s.jsx("p",{className:"m-0 font-medium",style:{color:h},children:t}),s.jsx("div",{className:"flex-shrink-0 w-1.5 h-1.5 rounded-full animate-ping",style:{backgroundColor:h}})]})]})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-heading m-0",children:"App Download Settings"}),s.jsx("p",{className:"text-sm text-muted m-0 mt-1",children:"Configure the app download link and message"})]}),s.jsxs("div",{className:"bg-card border border-border rounded-xl p-6 space-y-5",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-body mb-2",children:"Enable App Download"}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:y,onChange:G=>v(G.target.checked),className:"h-4 w-4 text-primary bg-gray-100 border-gray-300 rounded focus:ring-primary focus:ring-2"}),s.jsx("span",{className:"ml-2 text-sm text-body",children:"Enable"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-body mb-2",children:"App Download URL"}),s.jsx("input",{type:"text",value:w,onChange:G=>k(G.target.value),className:"input w-full",placeholder:"Enter app download URL (e.g., 'https://play.google.com/store/apps/details?id=com.localfelo')",maxLength:200}),s.jsxs("p",{className:"text-xs text-muted mt-1.5",children:[w.length,"/200 characters"]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-body mb-2",children:"App Download Message"}),s.jsx("input",{type:"text",value:N,onChange:G=>C(G.target.value),className:"input w-full",placeholder:"Enter app download message (e.g., 'Download our app from Google Play Store')",maxLength:200}),s.jsxs("p",{className:"text-xs text-muted mt-1.5",children:[N.length,"/200 characters"]})]}),s.jsxs("button",{onClick:W,disabled:oe||!w.trim(),className:"btn-primary flex items-center gap-2",children:[s.jsx(sn,{className:"w-4 h-4"}),s.jsx("span",{children:oe?"Saving...":"Save App Download Settings"})]})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-heading m-0",children:"Active Task Banner Settings"}),s.jsx("p",{className:"text-sm text-muted m-0 mt-1",children:"Configure the active task banner message and image"})]}),s.jsxs("div",{className:"bg-card border border-border rounded-xl p-6 space-y-5",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-body mb-2",children:"Title"}),s.jsx("input",{type:"text",value:A,onChange:G=>E(G.target.value),className:"input w-full",placeholder:"Enter title (e.g., 'Active Tasks')",maxLength:200}),s.jsxs("p",{className:"text-xs text-muted mt-1.5",children:[A.length,"/200 characters"]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-body mb-2",children:"Message"}),s.jsx("input",{type:"text",value:_,onChange:G=>R(G.target.value),className:"input w-full",placeholder:"Enter message (e.g., 'Tap to view details')",maxLength:200}),s.jsxs("p",{className:"text-xs text-muted mt-1.5",children:[_.length,"/200 characters"]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-body mb-2",children:"Image URL"}),s.jsx("input",{type:"text",value:L,onChange:G=>P(G.target.value),className:"input w-full",placeholder:"Enter image URL (e.g., 'https://example.com/image.png')",maxLength:200}),s.jsxs("p",{className:"text-xs text-muted mt-1.5",children:[L.length,"/200 characters"]})]}),s.jsxs("button",{onClick:T,disabled:oe||!A.trim(),className:"btn-primary flex items-center gap-2",children:[s.jsx(sn,{className:"w-4 h-4"}),s.jsx("span",{children:oe?"Saving...":"Save Active Task Banner Settings"})]})]}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-heading m-0",children:"Social Media Links Settings"}),s.jsx("p",{className:"text-sm text-muted m-0 mt-1",children:"Configure the social media links"})]}),s.jsxs("div",{className:"bg-card border border-border rounded-xl p-6 space-y-5",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-body mb-2",children:"Instagram URL"}),s.jsx("input",{type:"text",value:D,onChange:G=>H(G.target.value),className:"input w-full",placeholder:"Enter Instagram URL (e.g., 'https://www.instagram.com/localfelo/')",maxLength:200}),s.jsxs("p",{className:"text-xs text-muted mt-1.5",children:[D.length,"/200 characters"]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-body mb-2",children:"Facebook URL"}),s.jsx("input",{type:"text",value:B,onChange:G=>ae(G.target.value),className:"input w-full",placeholder:"Enter Facebook URL (e.g., 'https://www.facebook.com/localfelo/')",maxLength:200}),s.jsxs("p",{className:"text-xs text-muted mt-1.5",children:[B.length,"/200 characters"]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-body mb-2",children:"LinkedIn URL"}),s.jsx("input",{type:"text",value:ue,onChange:G=>le(G.target.value),className:"input w-full",placeholder:"Enter LinkedIn URL (e.g., 'https://www.linkedin.com/company/localfelo/')",maxLength:200}),s.jsxs("p",{className:"text-xs text-muted mt-1.5",children:[ue.length,"/200 characters"]})]}),s.jsxs("button",{onClick:z,disabled:oe||!D.trim(),className:"btn-primary flex items-center gap-2",children:[s.jsx(sn,{className:"w-4 h-4"}),s.jsx("span",{children:oe?"Saving...":"Save Social Links Settings"})]})]})]})}function Qu({wish:t,onClick:e,onChatClick:r}){console.log(`[WishCard] "${t.title}" - distance:`,t.distance,"lat:",t.latitude,"lon:",t.longitude);const i=c=>{switch(c){case"asap":return"bg-red-50 text-red-700";case"today":return"bg-[#CDFF00]/60 text-black";case"flexible":return"bg-[#CDFF00] text-black";default:return"bg-gray-50 text-gray-700"}},o=c=>{const u=new Date().getTime()-c.getTime(),h=Math.floor(u/6e4),f=Math.floor(h/60),g=Math.floor(f/24);return h<60?`${h}m`:f<24?`${f}h`:`${g}d`};return s.jsxs("div",{className:"bg-white border border-gray-200 p-4 cursor-pointer hover:border-black hover:shadow-sm transition-all flex flex-col",onClick:e,style:{minHeight:"160px",borderRadius:"8px"},children:[s.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[s.jsx("h3",{className:"font-bold text-gray-900 text-base leading-tight flex-1 line-clamp-2",children:t.title}),t.urgency&&s.jsx("span",{className:`px-2 py-0.5 rounded text-[9px] font-bold uppercase shrink-0 ${i(t.urgency)}`,children:t.urgency})]}),s.jsx("div",{className:"mb-3",children:t.budgetMin||t.budgetMax?s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(Xa,{className:"w-3.5 h-3.5 text-gray-500"}),s.jsx("span",{className:"font-bold text-black text-sm",children:t.budgetMin!==void 0&&t.budgetMin!==null&&t.budgetMax!==void 0&&t.budgetMax!==null?`${t.budgetMin.toLocaleString("en-IN")}-${t.budgetMax.toLocaleString("en-IN")}`:t.budgetMin!==void 0&&t.budgetMin!==null?`${t.budgetMin.toLocaleString("en-IN")}+`:t.budgetMax!==void 0&&t.budgetMax!==null?`Up to ${t.budgetMax.toLocaleString("en-IN")}`:""})]}):s.jsx("span",{className:"text-sm font-semibold text-gray-600",children:"Budget not specified"})}),s.jsxs("div",{className:"flex items-center gap-1.5 mb-3",children:[s.jsx(ds,{className:"w-3.5 h-3.5 text-gray-400 shrink-0"}),s.jsx("span",{className:"text-xs text-gray-600 truncate",children:(()=>{const c=t.areaName&&t.areaName!=="Unknown"?t.areaName:"",l=t.cityName&&t.cityName!=="Unknown"?t.cityName:"",u=[c,l].filter(Boolean).join(", ");return u||(t.address?t.address.split(",").map(f=>f.trim()).filter(Boolean).slice(0,2).join(", ")||t.address:"Location not set")})()})]}),s.jsxs("div",{className:"flex items-center justify-between gap-2 mt-auto pt-2 border-t border-gray-100",children:[s.jsx("div",{children:t.distance!==void 0&&t.distance!==null&&s.jsxs("span",{className:"text-xs font-bold text-black",children:[" ",t.distance.toFixed(1)," km"]})}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Ys,{className:"w-3 h-3 text-gray-400"}),s.jsx("span",{className:"text-xs text-gray-500",children:o(new Date(t.createdAt))})]})]})]})}function lr({label:t,value:e,onChange:r,options:i,children:o,placeholder:c="Select an option",required:l=!1,error:u,disabled:h=!1}){return s.jsxs("div",{className:"space-y-1",children:[t&&s.jsxs("label",{className:"block text-heading",children:[t,l&&s.jsx("span",{className:"text-destructive ml-1",children:"*"})]}),s.jsxs("select",{value:e,onChange:f=>r(f.target.value),className:"select-field",disabled:h,children:[s.jsx("option",{value:"",children:c}),o||i?.map(f=>s.jsx("option",{value:f.value,children:f.label},f.value))]}),u&&s.jsx("p",{className:"text-xs text-destructive m-0",children:u})]})}const k4=[{id:"buy-something",name:"Buy something",slug:"buy-something",emoji:""},{id:"rent-something",name:"Rent something",slug:"rent-something",emoji:""},{id:"find-used",name:"Find used item",slug:"find-used",emoji:""},{id:"find-service",name:"Find service",slug:"find-service",emoji:""},{id:"find-help",name:"Find help",slug:"find-help",emoji:""},{id:"find-deal",name:"Find deal",slug:"find-deal",emoji:""},{id:"other",name:"Other",slug:"other",emoji:""}];function _4({cities:t}){const[e,r]=j.useState([]),[i,o]=j.useState(!0),[c,l]=j.useState(null),[u,h]=j.useState(""),[f,g]=j.useState(""),[p,y]=j.useState(""),[v,w]=j.useState(""),k=t.find(_=>_.id===u),N=async()=>{o(!0);try{const _={};u&&(_.cityId=u),f&&(_.areaId=f),p&&(_.categoryId=p),v.trim()&&(_.searchQuery=v.trim());const R=await dc(_);r(R)}catch(_){console.error("Failed to load wishes:",_),J.error("Failed to load wishes")}finally{o(!1)}};j.useEffect(()=>{N()},[u,f,p,v]);const C=async _=>{if(confirm("Are you sure you want to delete this wish? This action cannot be undone.")){l(_);try{const R=await Ob(_);R.success?(J.success("Wish deleted successfully"),r(e.filter(L=>L.id!==_))):J.error(R.error||"Failed to delete wish")}catch(R){console.error("Failed to delete wish:",R),J.error("Failed to delete wish")}finally{l(null)}}},A=()=>{h(""),g(""),y(""),w("")},E=[u,f,p,v].filter(Boolean).length;return s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsxs("h2",{className:"text-lg font-medium flex items-center gap-2",children:[s.jsx(mt,{className:"w-5 h-5 text-primary"}),s.jsx("span",{children:"Wishes Management"})]}),s.jsx("p",{className:"text-sm text-muted",children:"View and manage all wishes"})]})}),s.jsxs("div",{className:"relative",children:[s.jsx(Rs,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted"}),s.jsx("input",{type:"text",placeholder:"Search wishes...",value:v,onChange:_=>w(_.target.value),className:"w-full pl-10 pr-4 py-2 bg-card border border-border rounded-[4px] text-sm focus:outline-none focus:border-primary"}),v&&s.jsx("button",{onClick:()=>w(""),className:"absolute right-3 top-1/2 -translate-y-1/2",children:s.jsx(ut,{className:"w-4 h-4 text-muted hover:text-foreground"})})]}),s.jsxs("div",{className:"bg-card border border-border rounded-[4px] p-3 space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-sm font-medium",children:"Filters"}),E>0&&s.jsxs("button",{onClick:A,className:"text-xs text-primary hover:underline",children:["Clear all (",E,")"]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[s.jsxs(lr,{label:"Category",value:p,onChange:_=>y(_),children:[s.jsx("option",{value:"",children:"All Categories"}),k4.map(_=>s.jsxs("option",{value:_.id,children:[_.emoji," ",_.name]},_.id))]}),s.jsxs(lr,{label:"City",value:u,onChange:_=>{h(_),g("")},children:[s.jsx("option",{value:"",children:"All Cities"}),t.map(_=>s.jsx("option",{value:_.id,children:_.name},_.id))]}),k&&s.jsxs(lr,{label:"Area",value:f,onChange:_=>g(_),children:[s.jsx("option",{value:"",children:"All Areas"}),k.areas?.map(_=>s.jsx("option",{value:_.id,children:_.name},_.id))]})]})]}),!i&&s.jsx("div",{className:"bg-card border border-border rounded-[4px] p-3",children:s.jsxs("p",{className:"text-sm text-muted",children:["Showing ",e.length," ",e.length===1?"wish":"wishes",E>0&&` with ${E} ${E===1?"filter":"filters"} applied`]})}),i?s.jsx("div",{className:"grid grid-cols-1 gap-3",children:s.jsx(ln,{count:6})}):e.length===0?s.jsx(Qs,{icon:mt,title:"No wishes found",description:E>0?"Try adjusting your filters to see more results":"No wishes have been posted yet"}):s.jsx("div",{className:"grid grid-cols-1 gap-3",children:e.map(_=>s.jsxs("div",{className:"relative",children:[s.jsx(Qu,{wish:_,onClick:()=>{}}),s.jsx("div",{className:"absolute top-2 right-2",children:s.jsx("button",{onClick:()=>C(_.id),disabled:c===_.id,className:"p-2 bg-red-500/10 text-red-600 rounded-[4px] hover:bg-red-500/20 transition-colors disabled:opacity-50",title:"Delete wish",children:c===_.id?s.jsx("div",{className:"w-4 h-4 border-2 border-red-600 border-t-transparent rounded-full animate-spin"}):s.jsx(Ls,{className:"w-4 h-4"})})})]},_.id))})]})}function S4(){const[t,e]=j.useState([]),[r,i]=j.useState(!0),[o,c]=j.useState(""),[l,u]=j.useState("all"),[h,f]=j.useState(null),[g,p]=j.useState([]),[y,v]=j.useState(!1);j.useEffect(()=>{w()},[]),j.useEffect(()=>{h&&k(h.id)},[h]);const w=async()=>{i(!0);try{const _=await Vb();e(_)}catch(_){console.error("Failed to load tasks:",_),J.error("Failed to load tasks")}finally{i(!1)}},k=async _=>{v(!0);try{const R=await zb(_);p(R)}catch(R){console.error("Failed to load negotiations:",R)}finally{v(!1)}},N=async _=>{if(confirm("Are you sure you want to close this task? This action cannot be undone."))try{const R=await Xh(_);R.success?(J.success("Task closed successfully"),w(),f(null)):J.error(R.error||"Failed to close task")}catch(R){console.error("Failed to close task:",R),J.error("Something went wrong")}},C=t.filter(_=>{const R=!o||_.title.toLowerCase().includes(o.toLowerCase())||_.description.toLowerCase().includes(o.toLowerCase()),L=l==="all"||_.status===l;return R&&L}),A={open:C.filter(_=>_.status==="open").length,accepted:C.filter(_=>_.status==="accepted").length,in_progress:C.filter(_=>_.status==="in_progress").length,completed:C.filter(_=>_.status==="completed").length,closed:C.filter(_=>_.status==="closed").length},E={open:"Open",accepted:"Accepted",in_progress:"In Progress",completed:"Completed",closed:"Closed"};return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:[s.jsxs("div",{className:"bg-green-500/10 border border-green-500/20 rounded-[4px] p-3",children:[s.jsx("p",{className:"text-sm text-green-600",children:"Open Tasks"}),s.jsx("p",{className:"text-2xl font-medium text-green-600",children:A.open})]}),s.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-[4px] p-3",children:[s.jsx("p",{className:"text-sm text-blue-600",children:"Accepted"}),s.jsx("p",{className:"text-2xl font-medium text-blue-600",children:A.accepted})]}),s.jsxs("div",{className:"bg-purple-500/10 border border-purple-500/20 rounded-[4px] p-3",children:[s.jsx("p",{className:"text-sm text-purple-600",children:"In Progress"}),s.jsx("p",{className:"text-2xl font-medium text-purple-600",children:A.in_progress})]}),s.jsxs("div",{className:"bg-gray-500/10 border border-gray-500/20 rounded-[4px] p-3",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Completed"}),s.jsx("p",{className:"text-2xl font-medium text-gray-600",children:A.completed})]}),s.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-[4px] p-3",children:[s.jsx("p",{className:"text-sm text-red-600",children:"Closed"}),s.jsx("p",{className:"text-2xl font-medium text-red-600",children:A.closed})]})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(Rs,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted"}),s.jsx("input",{type:"text",placeholder:"Search tasks...",value:o,onChange:_=>c(_.target.value),className:"w-full pl-10 pr-4 py-2 bg-card border border-border rounded-[4px] text-sm focus:outline-none focus:border-primary"})]}),s.jsxs("select",{value:l,onChange:_=>u(_.target.value),className:"px-4 py-2 bg-card border border-border rounded-[4px] text-sm focus:outline-none focus:border-primary",children:[s.jsx("option",{value:"all",children:"All Status"}),s.jsx("option",{value:"open",children:"Open"}),s.jsx("option",{value:"accepted",children:"Accepted"}),s.jsx("option",{value:"in_progress",children:"In Progress"}),s.jsx("option",{value:"completed",children:"Completed"}),s.jsx("option",{value:"closed",children:"Closed"})]}),s.jsxs("button",{onClick:w,className:"btn-primary px-4 py-2 rounded-[4px] flex items-center gap-2",children:[s.jsx(oy,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm",children:"Refresh"})]})]}),s.jsxs("p",{className:"text-sm text-muted",children:[C.length," ",C.length===1?"task":"tasks"," found"]}),r?s.jsx("div",{className:"text-center py-8 text-sm text-muted",children:"Loading tasks..."}):C.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ot,{className:"w-12 h-12 text-muted mx-auto mb-3"}),s.jsx("p",{className:"text-sm text-muted",children:"No tasks found"})]}):s.jsx("div",{className:"grid grid-cols-1 gap-3",children:C.map(_=>s.jsxs("div",{className:"bg-card border border-border rounded-[4px] p-4",children:[s.jsx("div",{className:"flex items-start justify-between gap-3 mb-3",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("span",{className:"text-2xl",children:_.categoryEmoji}),s.jsx("h3",{className:"font-medium",children:_.title})]}),s.jsx("p",{className:"text-sm text-muted mb-2",children:_.description}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-sm",children:[s.jsxs("span",{className:"px-2 py-1 bg-primary/10 text-primary rounded-[4px]",children:["",_.price?.toLocaleString()||"N/A"]}),s.jsx("span",{className:`px-2 py-1 rounded-[4px] ${_.status==="open"?"bg-green-500/10 text-green-600":_.status==="accepted"?"bg-blue-500/10 text-blue-600":_.status==="in_progress"?"bg-purple-500/10 text-purple-600":_.status==="completed"?"bg-gray-500/10 text-gray-600":"bg-red-500/10 text-red-600"}`,children:E[_.status]}),_.isNegotiable&&s.jsx("span",{className:"px-2 py-1 bg-[#CDFF00]/20 text-black rounded-[4px] font-medium",children:"Negotiable"}),_.timeWindow&&s.jsx("span",{className:"px-2 py-1 bg-blue-500/10 text-blue-600 rounded-[4px]",children:_.timeWindow})]})]})}),s.jsxs("div",{className:"flex items-center justify-between gap-3 text-sm text-muted mb-3",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("span",{children:_.userName}),s.jsx("span",{children:""}),s.jsxs("span",{children:[_.areaName,", ",_.cityName]}),s.jsx("span",{children:""}),s.jsx("span",{children:Ii(new Date(_.createdAt))})]}),_.userRatingCount&&_.userRatingCount>0&&s.jsxs("span",{children:[" ",_.userRating?.toFixed(1)," (",_.userRatingCount,")"]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>f(h?.id===_.id?null:_),className:"flex items-center gap-2 px-3 py-1.5 bg-primary/5 text-primary rounded-[4px] hover:bg-primary/10 transition-colors text-sm",children:[s.jsx(kr,{className:"w-4 h-4"}),h?.id===_.id?"Hide Details":"View Details"]}),_.status!=="closed"&&s.jsxs("button",{onClick:()=>N(_.id),className:"flex items-center gap-2 px-3 py-1.5 bg-red-500/5 text-red-600 rounded-[4px] hover:bg-red-500/10 transition-colors text-sm",children:[s.jsx(ar,{className:"w-4 h-4"}),"Close Task"]})]}),h?.id===_.id&&s.jsxs("div",{className:"mt-3 pt-3 border-t border-border",children:[s.jsx("h4",{className:"text-sm font-medium mb-2",children:"Negotiation History"}),y?s.jsx("p",{className:"text-sm text-muted",children:"Loading negotiations..."}):g.length===0?s.jsx("p",{className:"text-sm text-muted",children:"No negotiations yet"}):s.jsx("div",{className:"space-y-2",children:g.map(R=>s.jsxs("div",{className:"p-3 bg-background border border-border rounded-[4px]",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("p",{className:"text-sm font-medium",children:R.helperName||"Unknown User"}),R.offeredPrice&&s.jsxs("p",{className:"text-sm font-medium text-primary",children:["",R.offeredPrice.toLocaleString()]})]}),R.message&&s.jsx("p",{className:"text-xs text-muted mb-1",children:R.message}),s.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted",children:[R.round&&s.jsxs("span",{children:["Round ",R.round]}),R.round&&s.jsx("span",{children:""}),s.jsx("span",{children:Ii(R.createdAt)}),s.jsx("span",{children:""}),s.jsx("span",{className:R.status==="accepted"?"text-primary":R.status==="rejected"?"text-destructive":R.status==="countered"?"text-amber-600":"text-muted",children:R.status||"pending"})]})]},R.id))})]})]},_.id))})]})}async function Bx(t,e){console.log("[Service] updateReportStatusAdmin called with:",{reportId:t,status:e});try{const{data:r,error:i}=await V.from("reports").update({status:e}).eq("id",t).select().single();return{data:r,error:i}}catch(r){return console.error("[Service] updateReportStatusAdmin error:",r),{data:null,error:r}}}async function C4(t){console.log("[Service] submitTaskWishReport called with:",t);try{const{data:e,error:r}=await V.from("task_wish_reports").insert({item_type:t.itemType,item_id:t.itemId,reporter_id:t.reporterId,reported_user_id:t.reportedUserId,issue_type:t.issueType,details:t.details||null,conversation_id:t.conversationId||null}).select().single();if(r)throw console.error("[Service] Error submitting task/wish report:",r),r;return e}catch(e){throw console.error("[Service] submitTaskWishReport error:",e),e}}function T4(){const[t,e]=j.useState([]),[r,i]=j.useState([]),[o,c]=j.useState(!1),[l,u]=j.useState(""),[h,f]=j.useState("all");j.useEffect(()=>{g()},[]),j.useEffect(()=>{p()},[l,h,t]);const g=async()=>{c(!0);try{const{data:_,error:R}=await V.from("reports").select(`
          id,
          listing_id,
          reason,
          reported_by,
          created_at,
          status,
          listings (title, is_hidden),
          profiles (name, email)
        `);if(R)throw R;const L=(_||[]).map(P=>({id:P.id,listingId:P.listing_id,reason:P.reason,reportedBy:P.reported_by,createdAt:P.created_at,status:P.status||"pending",listing:P.listings,reporter:P.profiles}));e(L),i(L)}catch(_){console.error("Error loading reports:",_),J.error("Failed to load reports")}finally{c(!1)}},p=()=>{let _=[...t];if(h!=="all"&&(_=_.filter(R=>R.status===h)),l){const R=l.toLowerCase();_=_.filter(L=>L.reason.toLowerCase().includes(R)||L.listing?.title.toLowerCase().includes(R)||L.reporter?.email.toLowerCase().includes(R))}i(_)},y=async _=>{try{const{error:R}=await Bx(_,"reviewed");if(R)throw R;J.success("Report marked as reviewed"),g()}catch(R){console.error("Error updating report:",R),J.error("Failed to update report")}},v=async _=>{try{const{error:R}=await Bx(_,"resolved");if(R)throw R;J.success("Report marked as resolved"),g()}catch(R){console.error("Error updating report:",R),J.error("Failed to update report")}},w=async _=>{if(confirm("Are you sure you want to delete this report?"))try{const{error:R}=await V.from("reports").delete().eq("id",_);if(R)throw R;J.success("Report deleted"),e(t.filter(L=>L.id!==_))}catch(R){console.error("Error deleting report:",R),J.error("Failed to delete report")}},k=()=>{exportReportsToCSV(r),J.success("Reports exported to CSV")},N=_=>{switch(_){case"pending":return"bg-orange-100 text-orange-700";case"reviewed":return"bg-blue-100 text-blue-700";case"resolved":return"bg-green-100 text-green-700";default:return"bg-gray-100 text-gray-700"}},C=t.filter(_=>_.status==="pending").length,A=t.filter(_=>_.status==="reviewed").length,E=t.filter(_=>_.status==="resolved").length;return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"m-0 flex items-center gap-2",children:[s.jsx(ki,{className:"w-5 h-5 text-orange-600"}),"Reports Management"]}),s.jsxs("p",{className:"text-sm text-muted m-0",children:[r.length," total report(s)"]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:k,className:"px-4 py-2 border border-border rounded-[4px] hover:bg-input flex items-center gap-2",disabled:r.length===0,children:[s.jsx(Yx,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Export CSV"})]}),s.jsx("button",{onClick:g,disabled:o,className:"px-4 py-2 bg-primary text-black rounded-[4px] hover:opacity-90 disabled:opacity-50",children:o?"Loading...":"Refresh"})]})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(Rs,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted"}),s.jsx("input",{type:"text",placeholder:"Search reports...",value:l,onChange:_=>u(_.target.value),className:"w-full pl-10 pr-4 py-2 border border-border rounded-[4px] bg-input"})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>f("all"),className:`px-3 py-2 rounded-[4px] text-sm ${h==="all"?"bg-black text-white":"bg-input hover:bg-border"}`,children:["All (",t.length,")"]}),s.jsxs("button",{onClick:()=>f("pending"),className:`px-3 py-2 rounded-[4px] text-sm ${h==="pending"?"bg-orange-600 text-white":"bg-input hover:bg-border"}`,children:["Pending (",C,")"]}),s.jsxs("button",{onClick:()=>f("reviewed"),className:`px-3 py-2 rounded-[4px] text-sm ${h==="reviewed"?"bg-blue-600 text-white":"bg-input hover:bg-border"}`,children:["Reviewed (",A,")"]}),s.jsxs("button",{onClick:()=>f("resolved"),className:`px-3 py-2 rounded-[4px] text-sm ${h==="resolved"?"bg-green-600 text-white":"bg-input hover:bg-border"}`,children:["Resolved (",E,")"]})]})]}),o?s.jsx("div",{className:"text-center py-12",children:s.jsx("p",{className:"text-muted",children:"Loading reports..."})}):r.length===0?s.jsxs("div",{className:"text-center py-12 card",children:[s.jsx(ki,{className:"w-12 h-12 text-muted mx-auto mb-3"}),s.jsx("p",{className:"text-muted",children:"No reports found"})]}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-input",children:[s.jsx("th",{className:"text-left p-3 text-sm font-medium border-b border-border",children:"Status"}),s.jsx("th",{className:"text-left p-3 text-sm font-medium border-b border-border",children:"Listing"}),s.jsx("th",{className:"text-left p-3 text-sm font-medium border-b border-border",children:"Reason"}),s.jsx("th",{className:"text-left p-3 text-sm font-medium border-b border-border",children:"Reporter"}),s.jsx("th",{className:"text-left p-3 text-sm font-medium border-b border-border",children:"Date"}),s.jsx("th",{className:"text-left p-3 text-sm font-medium border-b border-border",children:"Actions"})]})}),s.jsx("tbody",{children:r.map(_=>s.jsxs("tr",{className:"border-b border-border hover:bg-input/50",children:[s.jsx("td",{className:"p-3",children:s.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${N(_.status)}`,children:_.status})}),s.jsx("td",{className:"p-3",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm",children:_.listing?.title||"N/A"}),_.listing?.isHidden&&s.jsx("span",{className:"text-xs text-orange-600",children:"Hidden"})]})}),s.jsx("td",{className:"p-3",children:s.jsx("p",{className:"text-sm m-0 line-clamp-2 max-w-xs",children:_.reason})}),s.jsx("td",{className:"p-3",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-sm",children:_.reporter?.name||"Anonymous"}),s.jsx("span",{className:"text-xs text-muted",children:_.reporter?.email||""})]})}),s.jsx("td",{className:"p-3 text-sm text-muted",children:Ii(new Date(_.createdAt))}),s.jsx("td",{className:"p-3",children:s.jsxs("div",{className:"flex gap-1",children:[_.status==="pending"&&s.jsx("button",{onClick:()=>y(_.id),className:"p-1 hover:bg-blue-100 rounded text-blue-600",title:"Mark as reviewed",children:s.jsx(kr,{className:"w-4 h-4"})}),_.status!=="resolved"&&s.jsx("button",{onClick:()=>v(_.id),className:"p-1 hover:bg-green-100 rounded text-green-600",title:"Mark as resolved",children:s.jsx(rn,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>w(_.id),className:"p-1 hover:bg-red-100 rounded text-red-600",title:"Delete report",children:s.jsx(Ls,{className:"w-4 h-4"})})]})})]},_.id))})]})})]})}function E4(){const[t,e]=j.useState(""),[r,i]=j.useState(""),[o,c]=j.useState("info"),[l,u]=j.useState(""),[h,f]=j.useState(!1),[g,p]=j.useState("all"),[y,v]=j.useState([]),[w,k]=j.useState([]),[N,C]=j.useState(!1),[A,E]=j.useState("");j.useEffect(()=>{g==="selected"&&_()},[g]);const _=async()=>{C(!0);try{const{data:D,error:H}=await V.from("profiles").select("id, name, email").order("name",{ascending:!0});if(H)throw H;v(D||[])}catch(D){console.error("Failed to load users:",D),J.error("Failed to load users")}finally{C(!1)}},R=D=>{w.includes(D)?k(w.filter(H=>H!==D)):k([...w,D])},L=y.filter(D=>D.name?.toLowerCase().includes(A.toLowerCase())||D.email?.toLowerCase().includes(A.toLowerCase())),P=async()=>{if(!t.trim()||!r.trim()){J.error("Please fill in title and message");return}if(g==="selected"&&w.length===0){J.error("Please select at least one user");return}g==="all"?y.length:w.length;const D=g==="all"?"ALL users":`${w.length} selected user(s)`;if(window.confirm(`Send notification to ${D}?

Title: ${t}
Message: ${r}`)){f(!0);try{const H=await Yy({recipients:g==="all"?"all":w,title:t.trim(),message:r.trim(),type:o,link:l.trim()||void 0});console.log(" [BroadcastTab] Result from sendBroadcastNotification:",H),H.success?(console.log(` [BroadcastTab] Broadcast sent successfully to ${H.count} users`),J.success(`Notification sent to ${H.count} users!`),e(""),i(""),u(""),c("info"),k([])):(console.error(" [BroadcastTab] Broadcast failed:",H.error),J.error(H.error||"Failed to send notification"))}catch(H){console.error("Failed to send broadcast:",H),J.error("Failed to send notification")}finally{f(!1)}}};return s.jsx("div",{className:"max-w-4xl",children:s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[s.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-lg flex items-center justify-center",children:s.jsx(or,{className:"w-5 h-5 text-primary"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"font-semibold text-gray-900",children:"Broadcast Notification"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Send notifications to users"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Send To"}),s.jsxs("div",{className:"flex gap-2 mb-3",children:[s.jsxs("button",{onClick:()=>p("all"),className:`flex-1 py-2 px-4 rounded-lg border-2 transition-colors flex items-center justify-center gap-2 ${g==="all"?"border-primary bg-primary/10 text-primary":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"}`,children:[s.jsx(Ul,{className:"w-4 h-4"}),s.jsx("span",{children:"All Users"})]}),s.jsxs("button",{onClick:()=>p("selected"),className:`flex-1 py-2 px-4 rounded-lg border-2 transition-colors flex items-center justify-center gap-2 ${g==="selected"?"border-primary bg-primary/10 text-primary":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"}`,children:[s.jsx(Ul,{className:"w-4 h-4"}),s.jsx("span",{children:"Selected Users"})]})]}),g==="selected"&&s.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 bg-gray-50",children:[s.jsx("div",{className:"mb-3",children:s.jsx("input",{type:"text",value:A,onChange:D=>E(D.target.value),placeholder:"Search users by name or email...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary/20"})}),N?s.jsx("div",{className:"text-center py-4 text-sm text-gray-500",children:"Loading users..."}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("span",{className:"text-xs text-gray-600",children:[w.length," of ",y.length," selected"]}),w.length>0&&s.jsx("button",{onClick:()=>k([]),className:"text-xs text-primary hover:underline",children:"Clear all"})]}),s.jsx("div",{className:"max-h-60 overflow-y-auto space-y-1",children:L.length===0?s.jsx("div",{className:"text-center py-4 text-sm text-gray-500",children:A?"No users found":"No users available"}):L.map(D=>s.jsxs("label",{className:"flex items-center gap-2 p-2 hover:bg-white rounded cursor-pointer transition-colors",children:[s.jsx("input",{type:"checkbox",checked:w.includes(D.id),onChange:()=>R(D.id),className:"w-4 h-4 text-primary focus:ring-primary"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"text-sm text-gray-900 truncate",children:D.name||"Unnamed User"}),s.jsx("div",{className:"text-xs text-gray-500 truncate",children:D.email})]})]},D.id))})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>c("info"),className:`flex-1 py-2 px-4 rounded-lg border-2 transition-colors ${o==="info"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"}`,children:" Info"}),s.jsx("button",{onClick:()=>c("promotion"),className:`flex-1 py-2 px-4 rounded-lg border-2 transition-colors ${o==="promotion"?"border-green-500 bg-green-50 text-green-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"}`,children:" Promo"}),s.jsx("button",{onClick:()=>c("alert"),className:`flex-1 py-2 px-4 rounded-lg border-2 transition-colors ${o==="alert"?"border-red-500 bg-red-50 text-red-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"}`,children:" Alert"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title *"}),s.jsx("input",{type:"text",value:t,onChange:D=>e(D.target.value),placeholder:"e.g., New Feature Launched!",className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",maxLength:100}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[t.length,"/100 characters"]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message *"}),s.jsx("textarea",{value:r,onChange:D=>i(D.target.value),placeholder:"Write your message here...",rows:4,className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary resize-none",maxLength:500}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[r.length,"/500 characters"]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Link (Optional)"}),s.jsx("input",{type:"url",value:l,onChange:D=>u(D.target.value),placeholder:"https://example.com/page",className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Optional: Add a link for users to visit"})]}),(t||r)&&s.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[s.jsx("p",{className:"text-xs font-medium text-gray-600 mb-2",children:"PREVIEW"}),s.jsx("div",{className:"bg-white rounded-lg p-4 shadow-sm border border-gray-100",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${o==="info"?"bg-blue-100":o==="promotion"?"bg-green-100":"bg-red-100"}`,children:o==="info"?"":o==="promotion"?"":""}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:t||"Your title here"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r||"Your message here"}),l&&s.jsx("a",{href:l,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-primary hover:underline mt-2 inline-block",children:l})]})]})})]}),s.jsxs("div",{className:"flex items-start gap-2 p-3 bg-orange-50 border border-orange-200 rounded-lg",children:[s.jsx(cs,{className:"w-4 h-4 text-orange-600 mt-0.5 flex-shrink-0"}),s.jsx("p",{className:"text-xs text-orange-800",children:g==="all"?s.jsxs(s.Fragment,{children:["This notification will be sent to ",s.jsx("strong",{children:"ALL users"}),". Please double-check before sending."]}):s.jsxs(s.Fragment,{children:["This notification will be sent to ",s.jsxs("strong",{children:[w.length," selected user(s)"]}),"."]})})]}),s.jsx("button",{onClick:P,disabled:h||!t.trim()||!r.trim()||g==="selected"&&w.length===0,className:"w-full bg-black text-white py-3 rounded-lg hover:bg-gray-800 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2 font-medium",children:h?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),s.jsx("span",{children:"Sending..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(ly,{className:"w-4 h-4"}),s.jsx("span",{children:g==="all"?"Send to All Users":`Send to ${w.length} User(s)`})]})})]})]})})}function P4(){const[t,e]=j.useState([]),[r,i]=j.useState([]),[o,c]=j.useState(null),[l,u]=j.useState([]),[h,f]=j.useState(!1),[g,p]=j.useState(!1),[y,v]=j.useState(""),[w,k]=j.useState("all");j.useEffect(()=>{N()},[]),j.useEffect(()=>{C()},[t,y,w]);const N=async()=>{f(!0);try{console.log(" Loading chat history...");const{data:L,error:P}=await V.from("conversations").select("*").order("last_message_at",{ascending:!1});if(P)throw console.error("Error fetching conversations:",P),P;console.log(` Found ${L?.length||0} conversations`);const D=await Promise.all((L||[]).map(async H=>{console.log(` Processing conversation ${H.id}:`,{listingType:H.listingtype,listingId:H.listing_id,buyerId:H.buyer_id,sellerId:H.seller_id});let B="";if(H.buyer_id){const{data:ue}=await V.from("profiles").select("email").eq("id",H.buyer_id).maybeSingle();B=ue?.email||""}let ae="";if(H.seller_id){const{data:ue}=await V.from("profiles").select("email").eq("id",H.seller_id).maybeSingle();ae=ue?.email||""}return{...H,buyer_email:B,seller_email:ae,listingtype:H.listingtype||"listing"}}));console.log(" Enriched conversations:",D.length),e(D)}catch(L){console.error("Failed to load conversations:",L),J.error("Failed to load chat history")}finally{f(!1)}},C=()=>{let L=[...t];if(w==="listings"?L=L.filter(P=>P.listingtype==="listing"):w==="wishes"?L=L.filter(P=>P.listingtype==="wish"):w==="tasks"&&(L=L.filter(P=>P.listingtype==="task")),y){const P=y.toLowerCase();L=L.filter(D=>D.buyer_name?.toLowerCase().includes(P)||D.buyer_email?.toLowerCase().includes(P)||D.seller_name?.toLowerCase().includes(P)||D.seller_email?.toLowerCase().includes(P)||D.listing_title?.toLowerCase().includes(P))}i(L)},A=async L=>{p(!0);try{console.log(" Loading messages for conversation:",L);const{data:P,error:D}=await V.from("messages").select("*").eq("conversation_id",L).order("created_at",{ascending:!0});if(D)throw D;console.log(` Found ${P?.length||0} messages`);const H=await Promise.all((P||[]).map(async B=>{const{data:ae}=await V.from("profiles").select("name, email").eq("id",B.sender_id).maybeSingle();return{id:B.id,conversation_id:B.conversation_id,sender_id:B.sender_id,content:B.content||B.message||"",created_at:B.created_at,sender_name:ae?.name||"Unknown User",sender_email:ae?.email||""}}));u(H)}catch(P){console.error("Failed to load messages:",P),J.error("Failed to load messages")}finally{p(!1)}},E=L=>{c(L),A(L.id)},_=L=>({type:L.listingtype==="listing"?"Listing":L.listingtype==="wish"?"Wish":L.listingtype==="task"?"Task":"Unknown",title:L.listing_title||"Unknown"}),R=L=>L?new Date(L).toLocaleString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"Unknown date";return s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 h-[calc(100vh-300px)]",children:[s.jsxs("div",{className:"border border-gray-200 overflow-hidden flex flex-col bg-white",children:[s.jsxs("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(Sr,{className:"w-5 h-5 text-primary"}),s.jsxs("h3",{className:"text-sm font-bold text-black m-0",children:["Chat History (",r.length,")"]})]}),s.jsxs("div",{className:"relative mb-3",children:[s.jsx(Rs,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted pointer-events-none"}),s.jsx("input",{type:"text",placeholder:"Search by user or item...",value:y,onChange:L=>v(L.target.value),className:"w-full pl-10 pr-10 py-2 bg-white border border-border focus:outline-none focus:ring-2 focus:ring-primary/20 text-sm"}),y&&s.jsx("button",{onClick:()=>v(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted hover:text-body",children:s.jsx(ut,{className:"w-4 h-4"})})]}),s.jsx("div",{className:"flex gap-1",children:["all","listings","wishes","tasks"].map(L=>s.jsx("button",{onClick:()=>k(L),className:`px-3 py-1.5 text-xs transition-colors capitalize ${w===L?"bg-black text-white font-medium":"bg-white border border-gray-200 text-body hover:border-primary"}`,children:L},L))})]}),s.jsx("div",{className:"flex-1 overflow-y-auto",children:h?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx("div",{className:"w-6 h-6 border-3 border-primary border-t-transparent rounded-full animate-spin"})}):r.length===0?s.jsx("div",{className:"p-4",children:s.jsx(Qs,{icon:ct,title:"No Conversations Found",description:"No chat conversations match your search criteria"})}):s.jsx("div",{className:"divide-y divide-gray-200",children:r.map(L=>{const{type:P,title:D}=_(L);return s.jsxs("button",{onClick:()=>E(L),className:`w-full p-3 text-left hover:bg-gray-50 transition-colors ${o?.id===L.id?"bg-[#CDFF00]/10 border-l-4 border-[#CDFF00]":""}`,children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"flex items-center gap-2 mb-1",children:s.jsx("span",{className:"text-xs font-medium px-2 py-0.5 bg-primary/10 text-black",children:P})}),s.jsx("p",{className:"text-sm font-medium text-body m-0 truncate",children:D})]}),s.jsx("div",{className:"text-right ml-2",children:s.jsxs("p",{className:"text-xs font-bold text-black",children:["",(L.listing_price||0).toLocaleString("en-IN")]})})]}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted mb-1",children:[s.jsx(Js,{className:"w-3 h-3"}),s.jsx("span",{className:"truncate",children:L.buyer_name||L.buyer_email||"Unknown"}),s.jsx("span",{children:""}),s.jsx("span",{className:"truncate",children:L.seller_name||L.seller_email||"Unknown"})]}),s.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted",children:[s.jsx(vu,{className:"w-3 h-3"}),s.jsx("span",{children:R(L.last_message_at||L.created_at)})]})]},L.id)})})})]}),s.jsx("div",{className:"border border-gray-200 overflow-hidden flex flex-col bg-white",children:o?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("h3",{className:"text-sm font-bold text-black m-0",children:["Messages (",l.length,")"]}),s.jsx("button",{onClick:()=>c(null),className:"p-1.5 hover:bg-gray-200 transition-colors",children:s.jsx(ut,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"text-xs text-body space-y-1",children:[s.jsxs("p",{className:"m-0",children:[s.jsx("strong",{children:"Between:"})," ",o.buyer_name||o.buyer_email||"Unknown"," "," ",o.seller_name||o.seller_email||"Unknown"]}),s.jsxs("p",{className:"m-0",children:[s.jsx("strong",{children:"About:"})," ",_(o).title]})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 bg-gray-50",children:g?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx("div",{className:"w-6 h-6 border-3 border-primary border-t-transparent rounded-full animate-spin"})}):l.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(cs,{className:"w-8 h-8 text-muted mx-auto mb-2"}),s.jsx("p",{className:"text-sm text-muted",children:"No messages in this conversation"})]}):l.map(L=>s.jsxs("div",{className:"bg-white p-3 shadow-sm border border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-6 h-6 bg-black rounded-full flex items-center justify-center",children:s.jsx(Js,{className:"w-3 h-3 text-[#CDFF00]"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium text-black m-0",children:L.sender_name}),L.sender_email&&s.jsx("p",{className:"text-xs text-muted m-0",children:L.sender_email})]})]}),s.jsx("span",{className:"text-xs text-muted",children:R(L.created_at)})]}),s.jsx("p",{className:"text-sm text-body m-0 whitespace-pre-wrap",children:L.content})]},L.id))})]}):s.jsx("div",{className:"flex items-center justify-center h-full text-center p-8",children:s.jsxs("div",{children:[s.jsx(Sr,{className:"w-12 h-12 text-muted mx-auto mb-3"}),s.jsx("p",{className:"text-sm text-muted m-0",children:"Select a conversation to view messages"}),s.jsx("p",{className:"text-xs text-muted mt-1",children:"Chat history is stored for legal and security purposes"})]})})})]})}function A4(){const[t,e]=j.useState([]),[r,i]=j.useState(!0),[o,c]=j.useState(""),[l,u]=j.useState("all");j.useEffect(()=>{h()},[]);const h=async()=>{i(!0);try{const{data:p,error:y}=await V.from("messages").select("id, sender_id, receiver_id, content, message, listing_id, wish_id, task_id, created_at").order("created_at",{ascending:!1}).limit(500);if(y)throw y;const v=new Set;(p||[]).forEach(B=>{B.sender_id&&v.add(B.sender_id),B.receiver_id&&v.add(B.receiver_id)});const{data:w}=await V.from("profiles").select("id, client_token, owner_token, auth_user_id, display_name, name").or(`id.in.(${Array.from(v).join(",")}),client_token.in.(${Array.from(v).join(",")}),owner_token.in.(${Array.from(v).join(",")}),auth_user_id.in.(${Array.from(v).join(",")})`),k=new Map;(w||[]).forEach(B=>{const ae=B.display_name||B.name||"Unknown User";B.id&&k.set(B.id,ae),B.client_token&&k.set(B.client_token,ae),B.owner_token&&k.set(B.owner_token,ae),B.auth_user_id&&k.set(B.auth_user_id,ae)});const N=[...new Set((p||[]).map(B=>B.listing_id).filter(Boolean))],C=[...new Set((p||[]).map(B=>B.wish_id).filter(Boolean))],A=[...new Set((p||[]).map(B=>B.task_id).filter(Boolean))],[E,_,R]=await Promise.all([N.length>0?V.from("listings").select("id, title").in("id",N):Promise.resolve({data:[]}),C.length>0?V.from("wishes").select("id, title").in("id",C):Promise.resolve({data:[]}),A.length>0?V.from("tasks").select("id, title").in("id",A):Promise.resolve({data:[]})]),L=new Map((E.data||[]).map(B=>[B.id,B.title])),P=new Map((_.data||[]).map(B=>[B.id,B.title])),D=new Map((R.data||[]).map(B=>[B.id,B.title])),H=(p||[]).map(B=>({id:B.id,sender_id:B.sender_id,receiver_id:B.receiver_id,message:B.message||B.content||"",listing_id:B.listing_id,wish_id:B.wish_id,task_id:B.task_id,created_at:B.created_at,sender_name:k.get(B.sender_id)||"Unknown",receiver_name:k.get(B.receiver_id)||"Unknown",listing_title:B.listing_id&&L.get(B.listing_id)||null,wish_title:B.wish_id&&P.get(B.wish_id)||null,task_title:B.task_id&&D.get(B.task_id)||null}));e(H)}catch(p){console.error("Error loading chats:",p),J.error("Failed to load chat history")}i(!1)},f=()=>{const p=[["Date","Time","Sender","Receiver","Message","Type","Item Title"].join(","),...g.map(k=>[new Date(k.created_at).toLocaleDateString(),new Date(k.created_at).toLocaleTimeString(),k.sender_name,k.receiver_name,`"${k.message.replace(/"/g,'""')}"`,k.listing_id?"Marketplace":k.wish_id?"Wish":k.task_id?"Task":"General",k.listing_title||k.wish_title||k.task_title||"N/A"].join(","))].join(`
`),y=new Blob([p],{type:"text/csv"}),v=URL.createObjectURL(y),w=document.createElement("a");w.href=v,w.download=`localfelo-chat-history-${new Date().toISOString().split("T")[0]}.csv`,w.click(),URL.revokeObjectURL(v),J.success("Chat history exported!")},g=t.filter(p=>{const y=p.message.toLowerCase().includes(o.toLowerCase())||p.sender_name.toLowerCase().includes(o.toLowerCase())||p.receiver_name.toLowerCase().includes(o.toLowerCase()),v=l==="all"||l==="marketplace"&&p.listing_id||l==="wish"&&p.wish_id||l==="task"&&p.task_id;return y&&v});return r?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-3"}),s.jsx("p",{className:"text-sm text-muted",children:"Loading chat history..."})]})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-heading m-0",children:"All Chat History"}),s.jsx("p",{className:"text-sm text-muted m-0 mt-1",children:"Complete chat history for legal and compliance purposes"})]}),s.jsxs("button",{onClick:f,className:"btn-primary flex items-center gap-2",children:[s.jsx(Yx,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Export to CSV"})]})]}),s.jsxs("div",{className:"bg-card border border-border rounded-xl p-4 space-y-4",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx(Rs,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted"}),s.jsx("input",{type:"text",value:o,onChange:p=>c(p.target.value),placeholder:"Search messages, users...",className:"input-field w-full pl-10"})]}),s.jsxs("select",{value:l,onChange:p=>u(p.target.value),className:"select-field",children:[s.jsx("option",{value:"all",children:"All Types"}),s.jsx("option",{value:"marketplace",children:"Marketplace"}),s.jsx("option",{value:"wish",children:"Wishes"}),s.jsx("option",{value:"task",children:"Tasks"})]})]}),s.jsxs("div",{className:"text-sm text-muted",children:["Showing ",g.length," of ",t.length," messages"]})]}),s.jsx("div",{className:"bg-card border border-border rounded-xl overflow-hidden",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 border-b border-border",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-heading uppercase",children:"Date/Time"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-heading uppercase",children:"From"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-heading uppercase",children:"To"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-heading uppercase",children:"Message"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-heading uppercase",children:"Type"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-semibold text-heading uppercase",children:"Item"})]})}),s.jsx("tbody",{className:"divide-y divide-border",children:g.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-muted",children:"No messages found"})}):g.map(p=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsxs("td",{className:"px-4 py-3 text-sm text-body whitespace-nowrap",children:[s.jsx("div",{children:new Date(p.created_at).toLocaleDateString()}),s.jsx("div",{className:"text-xs text-muted",children:new Date(p.created_at).toLocaleTimeString()})]}),s.jsx("td",{className:"px-4 py-3 text-sm text-heading font-medium",children:p.sender_name}),s.jsx("td",{className:"px-4 py-3 text-sm text-heading font-medium",children:p.receiver_name}),s.jsx("td",{className:"px-4 py-3 text-sm text-body max-w-md",children:s.jsx("div",{className:"line-clamp-2",children:p.message})}),s.jsx("td",{className:"px-4 py-3 text-sm",children:s.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${p.listing_id?"bg-blue-100 text-blue-800":p.wish_id?"bg-purple-100 text-purple-800":p.task_id?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:p.listing_id?"Marketplace":p.wish_id?"Wish":p.task_id?"Task":"General"})}),s.jsx("td",{className:"px-4 py-3 text-sm text-body",children:p.listing_title||p.wish_title||p.task_title||"-"})]},p.id))})]})})})]})}function I4(){const[t,e]=j.useState({footer_about:{id:"footer_about",title:"About LocalFelo",content:""},footer_terms:{id:"footer_terms",title:"Terms & Conditions",content:""},footer_privacy:{id:"footer_privacy",title:"Privacy Policy",content:""},footer_contact:{id:"footer_contact",title:"Contact Information",content:""}}),[r,i]=j.useState(!0),[o,c]=j.useState(null);j.useEffect(()=>{l()},[]);const l=async()=>{i(!0);try{const{data:f,error:g}=await V.from("site_settings").select("id, title, content").in("id",["footer_about","footer_terms","footer_privacy","footer_contact"]);if(g)throw g;if(f){const p={...t};f.forEach(y=>{p[y.id]={id:y.id,title:y.title||p[y.id].title,content:y.content||""}}),e(p)}}catch(f){console.error("Error loading pages:",f),J.error("Failed to load pages")}i(!1)},u=async f=>{c(f);try{const g=t[f],{error:p}=await V.from("site_settings").upsert({id:f,setting_type:"footer_page",enabled:!0,title:g.title,content:g.content,priority:1,updated_at:new Date().toISOString()});if(p)throw p;J.success(`${g.title} updated successfully!`)}catch(g){console.error("Error saving page:",g),J.error(`Failed to save: ${g.message}`)}c(null)},h=(f,g,p)=>{e(y=>({...y,[f]:{...y[f],[g]:p}}))};return r?s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-3"}),s.jsx("p",{className:"text-sm text-muted",children:"Loading..."})]})}):s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-heading m-0",children:"Footer Pages Content"}),s.jsx("p",{className:"text-sm text-muted m-0 mt-1",children:"Edit the content for About, Terms, Privacy, and Contact pages"})]}),s.jsxs("div",{className:"bg-card border border-border rounded-xl p-6 space-y-5",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(An,{className:"w-5 h-5 text-primary"}),s.jsx("h3",{className:"text-heading m-0",children:"About Page"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-body mb-2",children:"Page Title"}),s.jsx("input",{type:"text",value:t.footer_about.title,onChange:f=>h("footer_about","title",f.target.value),className:"input w-full",placeholder:"About LocalFelo"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-body mb-2",children:"Page Content (Markdown supported)"}),s.jsx("textarea",{value:t.footer_about.content,onChange:f=>h("footer_about","content",f.target.value),className:"textarea-field w-full",rows:8,placeholder:"Enter the about page content..."}),s.jsxs("p",{className:"text-xs text-muted mt-1.5",children:[t.footer_about.content.length," characters"]})]}),s.jsxs("button",{onClick:()=>u("footer_about"),disabled:o==="footer_about",className:"btn-primary flex items-center gap-2",children:[s.jsx(sn,{className:"w-4 h-4"}),s.jsx("span",{children:o==="footer_about"?"Saving...":"Save About Page"})]})]}),s.jsxs("div",{className:"bg-card border border-border rounded-xl p-6 space-y-5",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(An,{className:"w-5 h-5 text-primary"}),s.jsx("h3",{className:"text-heading m-0",children:"Terms & Conditions"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-body mb-2",children:"Page Title"}),s.jsx("input",{type:"text",value:t.footer_terms.title,onChange:f=>h("footer_terms","title",f.target.value),className:"input w-full",placeholder:"Terms & Conditions"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-body mb-2",children:"Page Content (Markdown supported)"}),s.jsx("textarea",{value:t.footer_terms.content,onChange:f=>h("footer_terms","content",f.target.value),className:"textarea-field w-full",rows:12,placeholder:"Enter the terms and conditions..."}),s.jsxs("p",{className:"text-xs text-muted mt-1.5",children:[t.footer_terms.content.length," characters"]})]}),s.jsxs("button",{onClick:()=>u("footer_terms"),disabled:o==="footer_terms",className:"btn-primary flex items-center gap-2",children:[s.jsx(sn,{className:"w-4 h-4"}),s.jsx("span",{children:o==="footer_terms"?"Saving...":"Save Terms & Conditions"})]})]}),s.jsxs("div",{className:"bg-card border border-border rounded-xl p-6 space-y-5",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(An,{className:"w-5 h-5 text-primary"}),s.jsx("h3",{className:"text-heading m-0",children:"Privacy Policy"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-body mb-2",children:"Page Title"}),s.jsx("input",{type:"text",value:t.footer_privacy.title,onChange:f=>h("footer_privacy","title",f.target.value),className:"input w-full",placeholder:"Privacy Policy"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-body mb-2",children:"Page Content (Markdown supported)"}),s.jsx("textarea",{value:t.footer_privacy.content,onChange:f=>h("footer_privacy","content",f.target.value),className:"textarea-field w-full",rows:12,placeholder:"Enter the privacy policy..."}),s.jsxs("p",{className:"text-xs text-muted mt-1.5",children:[t.footer_privacy.content.length," characters"]})]}),s.jsxs("button",{onClick:()=>u("footer_privacy"),disabled:o==="footer_privacy",className:"btn-primary flex items-center gap-2",children:[s.jsx(sn,{className:"w-4 h-4"}),s.jsx("span",{children:o==="footer_privacy"?"Saving...":"Save Privacy Policy"})]})]}),s.jsxs("div",{className:"bg-card border border-border rounded-xl p-6 space-y-5",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(An,{className:"w-5 h-5 text-primary"}),s.jsx("h3",{className:"text-heading m-0",children:"Contact Information"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-body mb-2",children:"Page Title"}),s.jsx("input",{type:"text",value:t.footer_contact.title,onChange:f=>h("footer_contact","title",f.target.value),className:"input w-full",placeholder:"Contact Information"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-body mb-2",children:"Page Content (Markdown supported)"}),s.jsx("textarea",{value:t.footer_contact.content,onChange:f=>h("footer_contact","content",f.target.value),className:"textarea-field w-full",rows:10,placeholder:"Enter contact information..."}),s.jsxs("p",{className:"text-xs text-muted mt-1.5",children:[t.footer_contact.content.length," characters"]})]}),s.jsxs("button",{onClick:()=>u("footer_contact"),disabled:o==="footer_contact",className:"btn-primary flex items-center gap-2",children:[s.jsx(sn,{className:"w-4 h-4"}),s.jsx("span",{children:o==="footer_contact"?"Saving...":"Save Contact Information"})]})]})]})}function L4({onNavigate:t,isLoggedIn:e=!1,isAdmin:r=!1,userDisplayName:i}){const[o,c]=j.useState("listings"),[l,u]=j.useState([]),[h,f]=j.useState([]),[g,p]=j.useState(!1),[y,v]=j.useState([]),[w,k]=j.useState([]),[N,C]=j.useState(!1),[A,E]=j.useState([]),[_,R]=j.useState(""),[L,P]=j.useState("all"),[D,H]=j.useState("all"),[B,ae]=j.useState(!1),[ue,le]=j.useState(null),[fe,we]=j.useState(null);j.useEffect(()=>{o==="listings"&&oe()},[o]),j.useEffect(()=>{o==="users"&&Y()},[o]),j.useEffect(()=>{async function M(){try{const X=await nh();E(X)}catch(X){console.error("Failed to load cities:",X)}}M()},[]),j.useEffect(()=>{let M=[...l];if(_){const X=_.toLowerCase();M=M.filter(ie=>ie.title.toLowerCase().includes(X)||ie.description.toLowerCase().includes(X)||ie.profiles?.email.toLowerCase().includes(X))}L==="hidden"?M=M.filter(X=>X.is_hidden):L==="active"?M=M.filter(X=>!X.is_hidden):L==="reported"&&(M=M.filter(X=>X.reports&&X.reports.length>0)),f(M)},[l,_,L]),j.useEffect(()=>{let M=[...y];if(_){const X=_.toLowerCase();M=M.filter(ie=>ie.email.toLowerCase().includes(X)||ie.name?.toLowerCase().includes(X)||ie.phone?.includes(X))}D==="active"?M=M.filter(X=>X.is_active):D==="inactive"?M=M.filter(X=>!X.is_active):D==="admin"&&(M=M.filter(X=>X.is_admin)),k(M)},[y,_,D]);const oe=async()=>{p(!0);try{const{data:M,error:X}=await V.from("listings").select("*").order("created_at",{ascending:!1});if(X)throw X;const ie=await Promise.all((M||[]).map(async be=>{const{data:ve}=await V.from("profiles").select("name, email").eq("id",be.owner_token).single(),{data:ee}=await V.from("categories").select("name, emoji").eq("id",be.category_id).single(),{data:ce}=await V.from("areas").select("name").eq("id",be.area_id).single(),{data:Ue}=await V.from("listing_images").select("image_url").eq("listing_id",be.id),{data:he}=await V.from("reports").select("id, reason, created_at").eq("listing_id",be.id).order("created_at",{ascending:!1});return{...be,is_hidden:be.is_hidden!==void 0?be.is_hidden:!1,profiles:ve,categories:ee,areas:ce,listing_images:Ue||[],reports:he||[]}}));u(ie),console.log(" Loaded",ie.length,"listings")}catch(M){console.error(" Failed to load listings:",M),J.error("Failed to load listings")}finally{p(!1)}},Y=async()=>{C(!0);try{const{data:M,error:X}=await V.from("profiles").select("*").order("created_at",{ascending:!1});if(X)throw X;const ie=await Promise.all((M||[]).map(async be=>{const{count:ve}=await V.from("listings").select("*",{count:"exact",head:!0}).eq("owner_token",be.id),{count:ee}=await V.from("reports").select("*",{count:"exact",head:!0}).eq("reported_by",be.id);return{...be,is_active:be.is_active!==void 0?be.is_active:!0,listingsCount:ve||0,reportsCount:ee||0}}));v(ie),console.log(" Loaded",ie.length,"users")}catch(M){console.error(" Failed to load users:",M),J.error("Failed to load users")}finally{C(!1)}},I=async(M,X)=>{try{const{error:ie}=await V.from("listings").update({is_hidden:!X}).eq("id",M);if(ie){if(ie.message?.includes("column")||ie.message?.includes("does not exist")){J.error("Please add is_hidden column to listings table first. Check console for SQL."),console.error(" is_hidden column missing. Run this SQL in Supabase:"),console.error("ALTER TABLE listings ADD COLUMN IF NOT EXISTS is_hidden BOOLEAN DEFAULT false;");return}throw ie}u(l.map(be=>be.id===M?{...be,is_hidden:!X}:be)),J.success(X?"Listing unhidden":"Listing hidden")}catch(ie){console.error("Failed to toggle visibility:",ie),J.error("Failed to update listing")}},$=async M=>{if(confirm("Are you sure you want to permanently delete this listing?"))try{const{error:X}=await V.from("listings").delete().eq("id",M);if(X)throw X;u(l.filter(ie=>ie.id!==M)),J.success("Listing deleted permanently")}catch(X){console.error("Failed to delete listing:",X),J.error("Failed to delete listing")}},W=async(M,X,ie)=>{try{const{error:be}=await V.from("reports").insert({listing_id:M,reason:`[ADMIN ACTION: ${ie.toUpperCase()}] ${X}`,reported_by:"admin"});if(be)throw be;ie==="hide"?await I(M,!1):ie==="delete"&&await $(M),le(null),J.success(`Listing ${ie}d with comment`)}catch(be){console.error("Failed to add comment:",be),J.error("Failed to add comment")}},T=async(M,X)=>{try{const{error:ie}=await V.from("profiles").update({is_active:!X}).eq("id",M);if(ie){if(ie.message?.includes("column")||ie.message?.includes("does not exist")){J.error("Please add is_active column to profiles table first. Check console for SQL."),console.error(" is_active column missing. Run this SQL in Supabase:"),console.error("ALTER TABLE profiles ADD COLUMN IF NOT EXISTS is_active BOOLEAN DEFAULT true;");return}throw ie}v(y.map(be=>be.id===M?{...be,is_active:!X}:be)),J.success(X?"User deactivated":"User activated")}catch(ie){console.error("Failed to toggle user status:",ie),J.error("Failed to update user")}},z=async(M,X)=>{if(confirm(`Are you sure you want to ${X?"remove":"grant"} admin access?`))try{const{error:ie}=await V.from("profiles").update({is_admin:!X}).eq("id",M);if(ie)throw ie;v(y.map(be=>be.id===M?{...be,is_admin:!X}:be)),J.success(X?"Admin access revoked":"Admin access granted")}catch(ie){console.error("Failed to toggle admin status:",ie),J.error("Failed to update user")}},G=async()=>{if(fe)try{const{error:M}=await V.from("listings").update({title:fe.title,description:fe.description,price:fe.price}).eq("id",fe.listing.id);if(M)throw M;u(l.map(X=>X.id===fe.listing.id?{...X,title:fe.title,description:fe.description,price:fe.price}:X)),J.success("Listing updated successfully"),we(null)}catch(M){console.error("Failed to update listing:",M),J.error("Failed to update listing")}};return s.jsxs("div",{className:"min-h-screen bg-white pb-20",children:[s.jsx(rt,{title:"Admin Dashboard",currentScreen:"admin",onNavigate:M=>t&&t(M),isLoggedIn:e,isAdmin:r,userDisplayName:i}),s.jsxs("div",{className:"page-container py-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h1",{className:"text-2xl font-bold text-black",children:"Admin Dashboard"}),s.jsx("div",{className:"px-3 py-1.5 bg-[#CDFF00] text-black rounded text-xs font-bold uppercase tracking-wide",children:"Super Admin"})]}),s.jsx("p",{className:"text-gray-600 text-sm",children:"Manage all aspects of LocalFelo platform"})]}),s.jsx("div",{className:"mb-6 overflow-x-auto",children:s.jsxs("div",{className:"flex gap-1 min-w-max bg-white p-1",style:{borderRadius:"8px"},children:[s.jsxs("button",{onClick:()=>{c("listings"),R("")},className:`flex items-center gap-2 px-4 py-2.5 text-sm font-medium transition-all ${o==="listings"?"bg-black text-white font-bold":"text-gray-600 hover:text-black"}`,style:{borderRadius:"6px"},children:[s.jsx(Fn,{className:"w-4 h-4"}),s.jsx("span",{children:"Listings"})]}),s.jsxs("button",{onClick:()=>{c("wishes"),R("")},className:`flex items-center gap-2 px-4 py-2.5 text-sm font-medium transition-all ${o==="wishes"?"bg-black text-white font-bold":"text-gray-600 hover:text-black"}`,style:{borderRadius:"6px"},children:[s.jsx(bs,{className:"w-4 h-4"}),s.jsx("span",{children:"Wishes"})]}),s.jsxs("button",{onClick:()=>{c("tasks"),R("")},className:`flex items-center gap-2 px-4 py-2.5 text-sm font-medium transition-all ${o==="tasks"?"bg-black text-white font-bold":"text-gray-600 hover:text-black"}`,style:{borderRadius:"6px"},children:[s.jsx(Ot,{className:"w-4 h-4"}),s.jsx("span",{children:"Tasks"})]}),s.jsxs("button",{onClick:()=>{c("users"),R("")},className:`flex items-center gap-2 px-4 py-2.5 text-sm font-medium transition-all ${o==="users"?"bg-black text-white font-bold":"text-gray-600 hover:text-black"}`,style:{borderRadius:"6px"},children:[s.jsx(Ul,{className:"w-4 h-4"}),s.jsx("span",{children:"Users"})]}),s.jsxs("button",{onClick:()=>{c("reports"),R("")},className:`flex items-center gap-2 px-4 py-2.5 text-sm font-medium transition-all ${o==="reports"?"bg-black text-white font-bold":"text-gray-600 hover:text-black"}`,style:{borderRadius:"6px"},children:[s.jsx(Xx,{className:"w-4 h-4"}),s.jsx("span",{children:"Reports"})]}),s.jsxs("button",{onClick:()=>{c("broadcast"),R("")},className:`flex items-center gap-2 px-4 py-2.5 text-sm font-medium transition-all ${o==="broadcast"?"bg-black text-white font-bold":"text-gray-600 hover:text-black"}`,style:{borderRadius:"6px"},children:[s.jsx(or,{className:"w-4 h-4"}),s.jsx("span",{children:"Broadcast"})]}),s.jsxs("button",{onClick:()=>{c("site-settings"),R("")},className:`flex items-center gap-2 px-4 py-2.5 text-sm font-medium transition-all ${o==="site-settings"?"bg-black text-white font-bold":"text-gray-600 hover:text-black"}`,style:{borderRadius:"6px"},children:[s.jsx(cy,{className:"w-4 h-4"}),s.jsx("span",{children:"Settings"})]}),s.jsxs("button",{onClick:()=>{c("chat-history"),R("")},className:`flex items-center gap-2 px-4 py-2.5 text-sm font-medium transition-all ${o==="chat-history"?"bg-black text-white font-bold":"text-gray-600 hover:text-black"}`,style:{borderRadius:"6px"},children:[s.jsx(Sr,{className:"w-4 h-4"}),s.jsx("span",{children:"Chat History"})]}),s.jsxs("button",{onClick:()=>{c("all-chats"),R("")},className:`flex items-center gap-2 px-4 py-2.5 text-sm font-medium transition-all ${o==="all-chats"?"bg-black text-white font-bold":"text-gray-600 hover:text-black"}`,style:{borderRadius:"6px"},children:[s.jsx(Sr,{className:"w-4 h-4"}),s.jsx("span",{children:"All Chats"})]}),s.jsxs("button",{onClick:()=>{c("footer-pages"),R("")},className:`flex items-center gap-2 px-4 py-2.5 text-sm font-medium transition-all ${o==="footer-pages"?"bg-black text-white font-bold":"text-gray-600 hover:text-black"}`,style:{borderRadius:"6px"},children:[s.jsx(Sr,{className:"w-4 h-4"}),s.jsx("span",{children:"Footer Pages"})]})]})}),o!=="site-settings"&&o!=="wishes"&&o!=="tasks"&&o!=="reports"&&o!=="broadcast"&&o!=="chat-history"&&o!=="all-chats"&&o!=="footer-pages"&&s.jsxs("div",{className:"mb-4 space-y-3",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(Rs,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted pointer-events-none"}),s.jsx("input",{type:"text",placeholder:o==="listings"?"Search listings...":o==="users"?"Search users...":"Search...",value:_,onChange:M=>R(M.target.value),className:"w-full pl-10 pr-10 py-2.5 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20"}),_&&s.jsx("button",{onClick:()=>R(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted hover:text-body",children:s.jsx(ut,{className:"w-4 h-4"})})]}),s.jsxs("button",{onClick:()=>ae(!B),className:`px-4 py-2.5 rounded-lg border transition-colors flex items-center gap-2 ${B?"bg-black text-white border-black":"bg-background border-border hover:border-primary"}`,children:[s.jsx(Zx,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden sm:inline",children:"Filters"}),s.jsx(Kx,{className:`w-4 h-4 transition-transform ${B?"rotate-180":""}`})]})]}),B&&s.jsx("div",{className:"p-4 bg-card rounded-lg border border-border",children:o==="listings"?s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs("button",{onClick:()=>P("all"),className:`px-3 py-1.5 rounded-full text-xs transition-colors ${L==="all"?"bg-black text-white font-medium":"bg-input hover:bg-input/80"}`,children:["All (",l.length,")"]}),s.jsxs("button",{onClick:()=>P("active"),className:`px-3 py-1.5 rounded-full text-xs transition-colors ${L==="active"?"bg-black text-white font-medium":"bg-input hover:bg-input/80"}`,children:["Active (",l.filter(M=>!M.is_hidden).length,")"]}),s.jsxs("button",{onClick:()=>P("hidden"),className:`px-3 py-1.5 rounded-full text-xs transition-colors ${L==="hidden"?"bg-black text-white font-medium":"bg-input hover:bg-input/80"}`,children:["Hidden (",l.filter(M=>M.is_hidden).length,")"]}),s.jsxs("button",{onClick:()=>P("reported"),className:`px-3 py-1.5 rounded-full text-xs transition-colors ${L==="reported"?"bg-black text-white font-medium":"bg-input hover:bg-input/80"}`,children:["Reported (",l.filter(M=>M.reports&&M.reports.length>0).length,")"]})]}):s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs("button",{onClick:()=>H("all"),className:`px-3 py-1.5 rounded-full text-xs transition-colors ${D==="all"?"bg-black text-white font-medium":"bg-input hover:bg-input/80"}`,children:["All (",y.length,")"]}),s.jsxs("button",{onClick:()=>H("active"),className:`px-3 py-1.5 rounded-full text-xs transition-colors ${D==="active"?"bg-black text-white font-medium":"bg-input hover:bg-input/80"}`,children:["Active (",y.filter(M=>M.is_active).length,")"]}),s.jsxs("button",{onClick:()=>H("inactive"),className:`px-3 py-1.5 rounded-full text-xs transition-colors ${D==="inactive"?"bg-black text-white font-medium":"bg-input hover:bg-input/80"}`,children:["Inactive (",y.filter(M=>!M.is_active).length,")"]}),s.jsxs("button",{onClick:()=>H("admin"),className:`px-3 py-1.5 rounded-full text-xs transition-colors ${D==="admin"?"bg-black text-white font-medium":"bg-input hover:bg-input/80"}`,children:["Admins (",y.filter(M=>M.is_admin).length,")"]})]})})]}),o==="listings"?s.jsx("div",{children:g?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"inline-block w-8 h-8 border-3 border-primary border-t-transparent rounded-full animate-spin"}),s.jsx("p",{className:"text-muted mt-4",children:"Loading listings..."})]}):h.length===0?s.jsx(Qs,{type:"no-listings",message:_?"No listings found":"No listings yet"}):s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:h.map(M=>s.jsxs("div",{className:`card p-3 ${M.is_hidden?"opacity-60":""}`,children:[s.jsxs("div",{className:"flex gap-2 mb-2",children:[M.listing_images&&M.listing_images.length>0?s.jsx("img",{src:M.listing_images[0].image_url,alt:M.title,className:"w-16 h-16 object-cover rounded-lg shrink-0"}):s.jsx("div",{className:"w-16 h-16 bg-input rounded-lg flex items-center justify-center shrink-0",children:s.jsx("span",{className:"text-2xl",children:M.categories?.emoji||""})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"text-sm m-0 mb-1 line-clamp-2",children:M.title}),s.jsxs("p",{className:"text-primary text-xs m-0",children:["",M.price.toLocaleString("en-IN")]})]})]}),s.jsxs("div",{className:"space-y-1 mb-2 text-xs text-muted",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"truncate",children:M.categories?.name||"Unknown"}),s.jsx("span",{children:""}),s.jsx("span",{className:"truncate",children:M.areas?.name||"Unknown"})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Si,{className:"w-3 h-3 shrink-0"}),s.jsx("span",{className:"truncate",children:M.profiles?.email||"Unknown"})]}),M.phone&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Ci,{className:"w-3 h-3 shrink-0"}),s.jsx("span",{children:M.phone})]})]}),M.reports&&M.reports.length>0&&s.jsxs("div",{className:"mb-2 p-2 bg-orange-50 border border-orange-200 rounded text-xs",children:[s.jsxs("div",{className:"flex items-center gap-1 text-orange-700 mb-1",children:[s.jsx(ki,{className:"w-3 h-3"}),s.jsxs("span",{children:[M.reports.length," Report(s)"]})]}),s.jsx("p",{className:"text-orange-600 m-0 line-clamp-2",children:M.reports[0].reason})]}),M.is_hidden&&s.jsx("div",{className:"mb-2 px-2 py-1 bg-rose-50 border border-rose-200 rounded text-center",children:s.jsx("span",{className:"text-xs text-rose-700",children:"Hidden"})}),s.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[s.jsx("button",{onClick:()=>I(M.id,M.is_hidden),className:`text-xs py-1.5 rounded flex items-center justify-center gap-1 transition-colors ${M.is_hidden?"bg-green-50 text-green-700 hover:bg-green-100":"bg-orange-50 text-orange-700 hover:bg-orange-100"}`,children:M.is_hidden?s.jsxs(s.Fragment,{children:[s.jsx(kr,{className:"w-3 h-3"}),s.jsx("span",{children:"Show"})]}):s.jsxs(s.Fragment,{children:[s.jsx(mi,{className:"w-3 h-3"}),s.jsx("span",{children:"Hide"})]})}),s.jsxs("button",{onClick:()=>le({listingId:M.id,comment:"",action:"hide"}),className:"text-xs py-1.5 rounded flex items-center justify-center gap-1 bg-orange-50 text-orange-700 hover:bg-orange-100 transition-colors",children:[s.jsx(Sr,{className:"w-3 h-3"}),s.jsx("span",{children:"Note"})]}),s.jsxs("button",{onClick:()=>$(M.id),className:"text-xs py-1.5 rounded flex items-center justify-center gap-1 bg-rose-50 text-rose-700 hover:bg-rose-100 transition-colors",children:[s.jsx(Ls,{className:"w-3 h-3"}),s.jsx("span",{children:"Delete"})]}),s.jsxs("button",{onClick:()=>we({listing:M,title:M.title,description:M.description,price:M.price}),className:"text-xs py-1.5 rounded flex items-center justify-center gap-1 bg-input hover:bg-input/80 transition-colors",children:[s.jsx(c1,{className:"w-3 h-3"}),s.jsx("span",{children:"Edit"})]})]})]},M.id))})}):o==="users"?s.jsx("div",{children:N?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"inline-block w-8 h-8 border-3 border-primary border-t-transparent rounded-full animate-spin"}),s.jsx("p",{className:"text-muted mt-4",children:"Loading users..."})]}):w.length===0?s.jsx(Qs,{type:"no-listings",message:_?"No users found":"No users yet"}):s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:w.map(M=>s.jsxs("div",{className:`card p-4 ${M.is_active?"":"opacity-60"}`,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h3",{className:"text-sm m-0 mb-1 font-semibold truncate",children:M.name||"Unnamed User"}),s.jsx("p",{className:"text-xs text-muted m-0 truncate",children:M.email}),M.phone&&s.jsx("p",{className:"text-xs text-muted m-0 mt-1",children:M.phone})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3 text-xs",children:[s.jsxs("div",{className:"bg-input p-2 rounded",children:[s.jsx("div",{className:"text-muted",children:"Listings"}),s.jsx("div",{className:"font-semibold",children:M.listingsCount||0})]}),s.jsxs("div",{className:"bg-input p-2 rounded",children:[s.jsx("div",{className:"text-muted",children:"Reports"}),s.jsx("div",{className:"font-semibold",children:M.reportsCount||0})]})]}),s.jsxs("div",{className:"flex gap-1 mb-3",children:[M.is_admin&&s.jsx("span",{className:"text-[10px] px-2 py-0.5 bg-primary/20 text-primary rounded-full font-bold",children:"ADMIN"}),s.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-full font-bold ${M.is_active?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:M.is_active?"ACTIVE":"INACTIVE"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[s.jsx("button",{onClick:()=>T(M.id,M.is_active),className:`text-xs py-1.5 rounded flex items-center justify-center gap-1 transition-colors ${M.is_active?"bg-orange-50 text-orange-700 hover:bg-orange-100":"bg-green-50 text-green-700 hover:bg-green-100"}`,children:s.jsx("span",{children:M.is_active?"Deactivate":"Activate"})}),s.jsx("button",{onClick:()=>z(M.id,M.is_admin),className:`text-xs py-1.5 rounded flex items-center justify-center gap-1 transition-colors ${M.is_admin?"bg-red-50 text-red-700 hover:bg-red-100":"bg-blue-50 text-blue-700 hover:bg-blue-100"}`,children:s.jsx("span",{children:M.is_admin?"Remove Admin":"Make Admin"})})]})]},M.id))})}):o==="site-settings"?s.jsx(N4,{}):o==="wishes"?s.jsx(_4,{cities:A}):o==="tasks"?s.jsx(S4,{}):o==="reports"?s.jsx(T4,{}):o==="broadcast"?s.jsx(E4,{}):o==="chat-history"?s.jsx(P4,{}):o==="all-chats"?s.jsx(A4,{}):o==="footer-pages"?s.jsx(I4,{}):null]}),ue&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[s.jsx("h3",{className:"text-lg m-0 mb-4",children:"Add Admin Note"}),s.jsx("textarea",{value:ue.comment,onChange:M=>le(ue?{...ue,comment:M.target.value}:null),placeholder:"Enter reason (e.g., Suspicious pricing, Fake listing, etc.)",className:"w-full p-3 border border-border rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-primary/20 mb-4",rows:4}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>ue&&W(ue.listingId,ue.comment,"hide"),className:"btn-primary flex-1 py-2",disabled:!ue.comment.trim(),children:"Hide with Note"}),s.jsx("button",{onClick:()=>ue&&W(ue.listingId,ue.comment,"delete"),className:"btn-outline flex-1 py-2 border-red-500 text-red-500 hover:bg-red-50",disabled:!ue.comment.trim(),children:"Delete with Note"})]}),s.jsx("button",{onClick:()=>le(null),className:"w-full mt-2 py-2 text-muted hover:text-body",children:"Cancel"})]})}),fe&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[s.jsx("h3",{className:"text-lg m-0 mb-4",children:"Edit Listing"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm mb-1.5 text-muted",children:"Title"}),s.jsx("input",{type:"text",value:fe.title,onChange:M=>we(fe?{...fe,title:M.target.value}:null),className:"w-full p-3 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20",placeholder:"Listing title"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm mb-1.5 text-muted",children:"Description"}),s.jsx("textarea",{value:fe.description,onChange:M=>we(fe?{...fe,description:M.target.value}:null),placeholder:"Listing description",className:"w-full p-3 border border-border rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-primary/20",rows:4})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm mb-1.5 text-muted",children:"Price ()"}),s.jsx("input",{type:"number",value:fe.price,onChange:M=>we(fe?{...fe,price:parseFloat(M.target.value)||0}:null),className:"w-full p-3 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20",placeholder:"0",min:"0"})]})]}),s.jsxs("div",{className:"flex gap-2 mt-6",children:[s.jsx("button",{onClick:G,className:"btn-primary flex-1 py-2",disabled:!fe.title.trim()||!fe.description.trim(),children:"Save Changes"}),s.jsx("button",{onClick:()=>we(null),className:"btn-outline flex-1 py-2",children:"Cancel"})]})]})})]})}const R4="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODgiIGhlaWdodD0iODgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBvcGFjaXR5PSIuMyIgZmlsbD0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIzLjciPjxyZWN0IHg9IjE2IiB5PSIxNiIgd2lkdGg9IjU2IiBoZWlnaHQ9IjU2IiByeD0iNiIvPjxwYXRoIGQ9Im0xNiA1OCAxNi0xOCAzMiAzMiIvPjxjaXJjbGUgY3g9IjUzIiBjeT0iMzUiIHI9IjciLz48L3N2Zz4KCg==";function Ui(t){const[e,r]=j.useState(!1),i=()=>{r(!0)},{src:o,alt:c,style:l,className:u,...h}=t;return e?s.jsx("div",{className:`inline-block bg-gray-100 text-center align-middle ${u??""}`,style:l,children:s.jsx("div",{className:"flex items-center justify-center w-full h-full",children:s.jsx("img",{src:R4,alt:"Error loading image",...h,"data-original-url":o})})}):s.jsx("img",{src:o,alt:c,className:u,style:l,...h,onError:i})}function D4({onBack:t,onNavigate:e,isLoggedIn:r=!1,isAdmin:i=!1,userDisplayName:o}){return s.jsxs("div",{className:"min-h-screen bg-background pb-20",children:[s.jsx(rt,{title:"About LocalFelo",showBack:!0,onBack:t,currentScreen:"about",onNavigate:e,isLoggedIn:r,isAdmin:i,userDisplayName:o}),s.jsxs("div",{className:"relative h-[120px] lg:h-[160px] w-full overflow-hidden",children:[s.jsx(Ui,{src:"https://images.unsplash.com/photo-1758873268663-5a362616b5a7?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHx0ZWFtJTIwY29sbGFib3JhdGlvbiUyMG1vZGVybiUyMG9mZmljZXxlbnwxfHx8fDE3NjQ0MDc3MzJ8MA&ixlib=rb-4.1.0&q=80&w=1080",alt:"About LocalFelo",className:"w-full h-full object-cover"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/90 to-primary/60"}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsxs("div",{className:"text-center px-4",children:[s.jsx("h1",{className:"text-white text-2xl lg:text-3xl mb-2",children:"About LocalFelo"}),s.jsx("p",{className:"text-white/90 text-sm lg:text-base",children:"Everything you need, nearby"})]})})]}),s.jsx("div",{className:"legal-container py-6",children:s.jsxs("div",{className:"card space-y-4",children:[s.jsx("h2",{className:"text-heading",children:"Welcome to LocalFelo"}),s.jsx("p",{className:"text-body",children:"LocalFelo is India's fastest hyperlocal platform connecting people for buying, selling, expressing wishes, and getting tasks done - all within your local community."}),s.jsx("h3",{className:"text-heading",children:"Our Mission"}),s.jsx("p",{className:"text-body",children:"To empower local communities by making it simple to buy, sell, wish for items, and complete tasks nearby. We believe in sustainable living, reducing waste, and helping neighbors support each other."}),s.jsx("h3",{className:"text-heading",children:"What We Offer"}),s.jsxs("ul",{className:"space-y-2 text-body",children:[s.jsxs("li",{children:[" ",s.jsx("strong",{children:"Marketplace:"})," Buy and sell items locally with zero commission"]}),s.jsxs("li",{children:[" ",s.jsx("strong",{children:"Wishes:"})," Express what you're looking for and let sellers come to you"]}),s.jsxs("li",{children:[" ",s.jsx("strong",{children:"Tasks:"})," Post real-world work or find tasks to earn money nearby"]}),s.jsx("li",{children:" Hyperlocal listings in your city and area"}),s.jsx("li",{children:" Direct contact between buyers and sellers via chat"}),s.jsx("li",{children:" Simple, fast, and free platform"}),s.jsx("li",{children:" Mobile-first experience designed for India"})]}),s.jsx("h3",{className:"text-heading",children:"Important Note"}),s.jsxs("p",{className:"text-body",children:["LocalFelo is a ",s.jsx("strong",{children:"mediator-only platform"}),". We do not handle payments, delivery, or any financial transactions. All deals are directly between users via chat. Please exercise caution and follow our safety guidelines."]})]})})]})}function F4({onBack:t,onNavigate:e,isLoggedIn:r=!1,isAdmin:i=!1,userDisplayName:o}){return s.jsxs("div",{className:"min-h-screen bg-background pb-20",children:[s.jsx(rt,{title:"Terms & Conditions",showBack:!0,onBack:t,currentScreen:"terms",onNavigate:e,isLoggedIn:r,isAdmin:i,userDisplayName:o}),s.jsxs("div",{className:"relative h-[120px] lg:h-[160px] w-full overflow-hidden",children:[s.jsx(Ui,{src:"https://images.unsplash.com/photo-1763729805496-b5dbf7f00c79?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxsZWdhbCUyMGRvY3VtZW50JTIwY29udHJhY3R8ZW58MXx8fHwxNzY0NDU4OTc4fDA&ixlib=rb-4.1.0&q=80&w=1080",alt:"Terms and Conditions",className:"w-full h-full object-cover"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/90 to-primary/60"}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsxs("div",{className:"text-center px-4",children:[s.jsx("h1",{className:"text-white text-2xl lg:text-3xl mb-2",children:"Terms & Conditions"}),s.jsx("p",{className:"text-white/90 text-sm lg:text-base",children:"Our service agreement and guidelines"})]})})]}),s.jsx("div",{className:"legal-container py-6",children:s.jsxs("div",{className:"card space-y-4",children:[s.jsx("h2",{className:"text-heading",children:"Terms & Conditions"}),s.jsx("p",{className:"text-muted text-sm",children:"Last updated: November 2024"}),s.jsx("h3",{className:"text-heading",children:"1. Acceptance of Terms"}),s.jsx("p",{className:"text-body",children:"By accessing and using LocalFelo, you accept and agree to be bound by these Terms of Service. If you do not agree to these terms, please do not use our platform."}),s.jsx("h3",{className:"text-heading",children:"2. About LocalFelo"}),s.jsxs("p",{className:"text-body",children:["LocalFelo is a ",s.jsx("strong",{children:"hyperlocal marketplace platform"})," that connects people in India for buying/selling items, posting wishes, and getting help with tasks. We are a ",s.jsx("strong",{children:"connector platform only"})," that:"]}),s.jsxs("ul",{className:"space-y-2 text-body",children:[s.jsx("li",{children:"  Provides a platform to post listings, wishes, and tasks"}),s.jsx("li",{children:"  Enables direct communication between users via chat"}),s.jsx("li",{children:"  Does NOT process payments or handle money"}),s.jsx("li",{children:"  Does NOT provide delivery or shipping services"}),s.jsx("li",{children:"  Does NOT verify users or guarantee transactions"}),s.jsx("li",{children:"  Does NOT guarantee work completion or payment for tasks"})]}),s.jsx("h3",{className:"text-heading",children:"3. User Accounts"}),s.jsxs("ul",{className:"space-y-2 text-body",children:[s.jsx("li",{children:" You must verify your phone number with OTP to create listings, wishes, or tasks"}),s.jsx("li",{children:" You must provide a valid phone number for contact purposes"}),s.jsx("li",{children:" You are responsible for maintaining the security of your account"}),s.jsx("li",{children:" You must be at least 13 years old to use LocalFelo"})]}),s.jsx("h3",{className:"text-heading",children:"4. Platform Guidelines"}),s.jsx("p",{className:"text-body mb-2",children:s.jsx("strong",{children:"Prohibited Items & Activities:"})}),s.jsxs("ul",{className:"space-y-2 text-body",children:[s.jsx("li",{children:" Illegal items or services"}),s.jsx("li",{children:" Stolen goods"}),s.jsx("li",{children:" Weapons, explosives, or hazardous materials"}),s.jsx("li",{children:" Drugs, alcohol, or tobacco (if restricted by law)"}),s.jsx("li",{children:" Counterfeit or pirated goods"}),s.jsx("li",{children:" Adult content or services"}),s.jsx("li",{children:" Harassment, hate speech, or abusive behavior"})]}),s.jsx("h3",{className:"text-heading",children:"5. User Responsibilities"}),s.jsx("p",{className:"text-body",children:s.jsx("strong",{children:"All Users Must:"})}),s.jsxs("ul",{className:"space-y-2 text-body mb-3",children:[s.jsx("li",{children:" Provide accurate information in posts"}),s.jsx("li",{children:" Respond to inquiries respectfully and promptly"}),s.jsx("li",{children:" Meet others in safe, public places"}),s.jsx("li",{children:" Complete agreed transactions honestly"}),s.jsx("li",{children:" Behave respectfully in all interactions"})]}),s.jsx("p",{className:"text-body",children:s.jsx("strong",{children:"For Tasks & Wishes:"})}),s.jsxs("ul",{className:"space-y-2 text-body",children:[s.jsx("li",{children:" All payments and work are handled directly between users"}),s.jsx("li",{children:" LocalFelo is NOT involved in task completion or payment disputes"}),s.jsx("li",{children:" Users must discuss and agree on terms before starting work"}),s.jsx("li",{children:" Report any issues or disputes through the platform"})]}),s.jsx("h3",{className:"text-heading",children:"6. Safety & Security"}),s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[s.jsx("p",{className:"text-body mb-2",children:s.jsx("strong",{children:" Important Safety Guidelines:"})}),s.jsxs("ul",{className:"space-y-2 text-body",children:[s.jsx("li",{children:" Meet in public, well-lit places during daytime"}),s.jsx("li",{children:" Bring a friend or family member if possible"}),s.jsx("li",{children:" Never share sensitive financial information"}),s.jsx("li",{children:" Report suspicious activity or scams immediately"}),s.jsx("li",{children:" Trust your instincts - if something feels wrong, walk away"}),s.jsx("li",{children:" For tasks: Confirm payment terms before starting work"})]})]}),s.jsx("h3",{className:"text-heading",children:"7. Limitation of Liability"}),s.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:[s.jsxs("p",{className:"text-body",children:[s.jsx("strong",{children:"IMPORTANT:"})," LocalFelo is a connector platform only. We do NOT:"]}),s.jsxs("ul",{className:"space-y-2 text-body mt-2",children:[s.jsx("li",{children:" Verify the identity of users"}),s.jsx("li",{children:" Verify the accuracy of listings, wishes, or tasks"}),s.jsx("li",{children:" Guarantee task completion or payment"}),s.jsx("li",{children:" Guarantee item quality or authenticity"}),s.jsx("li",{children:" Act as a party to any transaction"}),s.jsx("li",{children:" Provide any warranties of any kind"})]}),s.jsxs("p",{className:"text-body mt-3",children:[s.jsx("strong",{children:"You use LocalFelo at your own risk."})," We are not responsible for disputes, fraud, non-payment, incomplete work, damaged items, failed transactions, or any loss or injury arising from your use of the platform. ",s.jsx("strong",{children:"Payments and work are handled directly between users."})]})]}),s.jsx("h3",{className:"text-heading",children:"8. Reporting & Moderation"}),s.jsx("p",{className:"text-body",children:"Users can report inappropriate content or behavior. We reserve the right to:"}),s.jsxs("ul",{className:"space-y-2 text-body",children:[s.jsx("li",{children:" Remove content that violates our terms"}),s.jsx("li",{children:" Suspend or terminate accounts for violations or abusive behavior"}),s.jsx("li",{children:" Cooperate with law enforcement"}),s.jsx("li",{children:" Modify or discontinue services at any time"})]}),s.jsx("h3",{className:"text-heading",children:"9. Privacy"}),s.jsxs("p",{className:"text-body",children:["Your privacy is important to us. Please review our Privacy Policy to understand how we collect and use your information. ",s.jsx("strong",{children:"LocalFelo is not meant for collecting personally identifiable information (PII) or securing sensitive data."})]}),s.jsx("h3",{className:"text-heading",children:"10. Contact Us"}),s.jsxs("p",{className:"text-body",children:["For questions about these Terms, contact us at: ",s.jsx("strong",{className:"text-primary",children:"contact@localfelo.com"})]}),s.jsx("div",{className:"border-t border-gray-200 pt-4 mt-6",children:s.jsx("p",{className:"text-muted text-sm",children:"By using LocalFelo, you acknowledge that you have read, understood, and agree to be bound by these Terms of Service. Use the platform responsibly and safely."})})]})})]})}function M4({onBack:t,onNavigate:e,isLoggedIn:r=!1,isAdmin:i=!1,userDisplayName:o}){return s.jsxs("div",{className:"min-h-screen bg-background pb-20",children:[s.jsx(rt,{title:"Privacy Policy",showBack:!0,onBack:t,currentScreen:"privacy",onNavigate:e,isLoggedIn:r,isAdmin:i,userDisplayName:o}),s.jsxs("div",{className:"relative h-[120px] lg:h-[160px] w-full overflow-hidden",children:[s.jsx(Ui,{src:"https://images.unsplash.com/photo-1603985529862-9e12198c9a60?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxwcml2YWN5JTIwZGF0YSUyMHByb3RlY3Rpb258ZW58MXx8fHwxNzY0NDU4OTc2fDA&ixlib=rb-4.1.0&q=80&w=1080",alt:"Privacy Policy",className:"w-full h-full object-cover"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/90 to-primary/60"}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsxs("div",{className:"text-center px-4",children:[s.jsx("h1",{className:"text-white text-2xl lg:text-3xl mb-2",children:"Privacy Policy"}),s.jsx("p",{className:"text-white/90 text-sm lg:text-base",children:"How we protect your data"})]})})]}),s.jsx("div",{className:"legal-container py-6",children:s.jsxs("div",{className:"card space-y-4",children:[s.jsx("h2",{className:"text-heading",children:"Privacy Policy"}),s.jsx("p",{className:"text-muted text-sm",children:"Last updated: November 2024"}),s.jsx("h3",{className:"text-heading",children:"1. Information We Collect"}),s.jsx("p",{className:"text-body",children:"We collect the following information:"}),s.jsxs("ul",{className:"space-y-2 text-body",children:[s.jsxs("li",{children:[" ",s.jsx("strong",{children:"Account Information:"})," Name and phone number (verified via OTP)"]}),s.jsxs("li",{children:[" ",s.jsx("strong",{children:"Listing Information:"})," Product details, images, pricing, and location you provide"]}),s.jsxs("li",{children:[" ",s.jsx("strong",{children:"Contact Information:"})," Phone numbers and WhatsApp numbers for buyer-seller communication"]}),s.jsxs("li",{children:[" ",s.jsx("strong",{children:"Usage Data:"})," How you interact with our platform"]})]}),s.jsx("h3",{className:"text-heading",children:"2. How We Use Your Information"}),s.jsx("p",{className:"text-body",children:"Your information is used to:"}),s.jsxs("ul",{className:"space-y-2 text-body",children:[s.jsx("li",{children:" Create and manage your account"}),s.jsx("li",{children:" Display your listings to potential buyers"}),s.jsx("li",{children:" Enable communication between buyers and sellers"}),s.jsx("li",{children:" Improve our platform and user experience"}),s.jsx("li",{children:" Prevent fraud and enforce our terms"})]}),s.jsx("h3",{className:"text-heading",children:"3. Information Sharing"}),s.jsxs("p",{className:"text-body",children:[s.jsx("strong",{children:"Public Information:"})," When you create a listing, your name, phone number, and listing details are visible to all users browsing LocalFelo."]}),s.jsx("p",{className:"text-body mt-2",children:s.jsx("strong",{children:"We do NOT:"})}),s.jsxs("ul",{className:"space-y-2 text-body",children:[s.jsx("li",{children:" Sell your personal information to third parties"}),s.jsx("li",{children:" Process payments or store financial information (we're a mediator-only platform)"})]}),s.jsx("h3",{className:"text-heading",children:"4. Data Security"}),s.jsx("p",{className:"text-body",children:"We use industry-standard security measures to protect your information. However, no method of transmission over the internet is 100% secure. Please use caution when sharing personal information."}),s.jsx("h3",{className:"text-heading",children:"5. Your Rights"}),s.jsx("p",{className:"text-body",children:"You have the right to:"}),s.jsxs("ul",{className:"space-y-2 text-body",children:[s.jsx("li",{children:" Access and update your profile information"}),s.jsx("li",{children:" Delete your listings at any time"}),s.jsx("li",{children:" Request account deletion by contacting us"})]}),s.jsx("h3",{className:"text-heading",children:"6. Third-Party Services"}),s.jsx("p",{className:"text-body",children:"LocalFelo uses:"}),s.jsx("ul",{className:"space-y-2 text-body",children:s.jsxs("li",{children:[" ",s.jsx("strong",{children:"Supabase:"})," For database and authentication services"]})}),s.jsx("h3",{className:"text-heading",children:"7. Children's Privacy"}),s.jsx("p",{className:"text-body",children:"LocalFelo is not intended for users under 13 years of age. We do not knowingly collect information from children."}),s.jsx("h3",{className:"text-heading",children:"8. Changes to This Policy"}),s.jsx("p",{className:"text-body",children:"We may update this Privacy Policy from time to time. We will notify users of any significant changes."}),s.jsx("h3",{className:"text-heading",children:"9. Contact Us"}),s.jsxs("p",{className:"text-body",children:["If you have questions about this Privacy Policy, please contact us at: ",s.jsx("strong",{className:"text-primary",children:"contact@localfelo.com"})]}),s.jsx("div",{className:"border-t border-gray-200 pt-4 mt-6",children:s.jsxs("p",{className:"text-muted text-sm",children:[s.jsx("strong",{children:"Note:"})," LocalFelo is a mediator-only platform. We do NOT handle payments, delivery, or financial transactions. All transactions occur directly between buyers and sellers. We are not responsible for the quality, safety, or legality of items listed, or the accuracy of listings."]})})]})})]})}function O4({onBack:t,onNavigate:e,isLoggedIn:r=!1,isAdmin:i=!1,userDisplayName:o}){return s.jsxs("div",{className:"min-h-screen bg-background pb-20",children:[s.jsx(rt,{title:"Safety Guidelines",showBack:!0,onBack:t,currentScreen:"safety",onNavigate:e,isLoggedIn:r,isAdmin:i,userDisplayName:o}),s.jsxs("div",{className:"relative h-[120px] lg:h-[160px] w-full overflow-hidden",children:[s.jsx(Ui,{src:"https://images.unsplash.com/photo-1761805364358-1a4446ffb0ca?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxzYWZldHklMjBzZWN1cml0eSUyMHNoaWVsZHxlbnwxfHx8fDE3NjQzMzQ4ODB8MA&ixlib=rb-4.1.0&q=80&w=1080",alt:"Safety Guidelines",className:"w-full h-full object-cover"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/90 to-primary/60"}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsxs("div",{className:"text-center px-4",children:[s.jsx("h1",{className:"text-white text-2xl lg:text-3xl mb-2",children:"Stay Safe on LocalFelo"}),s.jsx("p",{className:"text-white/90 text-sm lg:text-base",children:"Your safety is our priority"})]})})]}),s.jsx("div",{className:"legal-container py-6",children:s.jsxs("div",{className:"card space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-heading mb-2",children:"Safety First"}),s.jsx("p",{className:"text-body",children:"Follow these important safety tips to protect yourself when buying or selling."})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(ey,{className:"w-5 h-5 text-primary"}),s.jsx("h3",{className:"text-heading m-0",children:"Meet in Public Places"})]}),s.jsxs("ul",{className:"space-y-1 text-body text-sm",children:[s.jsx("li",{children:" Always meet in well-lit, public locations"}),s.jsx("li",{children:" Prefer busy areas like malls, cafes, or metro stations"}),s.jsx("li",{children:" Avoid meeting at your home or the seller's home"}),s.jsx("li",{children:" Meet during daytime hours when possible"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Ul,{className:"w-5 h-5 text-primary"}),s.jsx("h3",{className:"text-heading m-0",children:"Bring a Friend"})]}),s.jsxs("ul",{className:"space-y-1 text-body text-sm",children:[s.jsx("li",{children:" Take someone with you when meeting buyers/sellers"}),s.jsx("li",{children:" Inform family or friends about your meeting location"}),s.jsx("li",{children:" Share meeting details with someone you trust"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(kr,{className:"w-5 h-5 text-primary"}),s.jsx("h3",{className:"text-heading m-0",children:"Inspect Before Paying"})]}),s.jsxs("ul",{className:"space-y-1 text-body text-sm",children:[s.jsx("li",{children:" Carefully examine the item before making payment"}),s.jsx("li",{children:" Test electronics and check for damages"}),s.jsx("li",{children:" Verify authenticity of branded items"}),s.jsx("li",{children:" Don't hesitate to walk away if something feels wrong"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(s1,{className:"w-5 h-5 text-primary"}),s.jsx("h3",{className:"text-heading m-0",children:"Safe Payment Practices"})]}),s.jsxs("ul",{className:"space-y-1 text-body text-sm",children:[s.jsx("li",{children:" Never pay in advance without seeing the item"}),s.jsx("li",{children:" Prefer cash for in-person transactions"}),s.jsx("li",{children:" If using digital payment, verify the item first"}),s.jsx("li",{children:" Get a receipt or written confirmation"}),s.jsx("li",{children:" Avoid wire transfers to unknown parties"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Ci,{className:"w-5 h-5 text-primary"}),s.jsx("h3",{className:"text-heading m-0",children:"Smart Communication"})]}),s.jsxs("ul",{className:"space-y-1 text-body text-sm",children:[s.jsx("li",{children:" Keep conversations within the platform when possible"}),s.jsx("li",{children:" Be cautious of deals that seem too good to be true"}),s.jsx("li",{children:" Watch out for urgency tactics or pressure to decide quickly"}),s.jsx("li",{children:" Never share sensitive personal information"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Rn,{className:"w-5 h-5 text-destructive"}),s.jsx("h3",{className:"text-heading m-0",children:"Red Flags to Watch For"})]}),s.jsxs("ul",{className:"space-y-1 text-body text-sm",children:[s.jsx("li",{children:" Prices significantly below market value"}),s.jsx("li",{children:" Sellers unwilling to meet in person"}),s.jsx("li",{children:" Requests for payment before viewing the item"}),s.jsx("li",{children:" Poor quality photos or vague descriptions"}),s.jsx("li",{children:" Pressure to complete the deal quickly"}),s.jsx("li",{children:" Requests to move conversation off-platform immediately"})]})]}),s.jsxs("div",{className:"p-4 bg-primary/10 border border-primary/20 rounded-lg",children:[s.jsx("h4",{className:"text-heading mb-2",children:"Report Suspicious Activity"}),s.jsx("p",{className:"text-body text-sm m-0",children:"If you encounter fraud, scams, or suspicious behavior, please report it immediately. Your safety is our priority."})]})]})})]})}function U4({onBack:t,onNavigate:e,isLoggedIn:r=!1,isAdmin:i=!1,userDisplayName:o}){return s.jsxs("div",{className:"min-h-screen bg-background pb-20",children:[s.jsx(rt,{title:"Contact Us",showBack:!0,onBack:t,currentScreen:"contact",onNavigate:e,isLoggedIn:r,isAdmin:i,userDisplayName:o}),s.jsxs("div",{className:"relative h-[120px] lg:h-[160px] w-full overflow-hidden",children:[s.jsx(Ui,{src:"https://images.unsplash.com/photo-1553775282-20af80779df7?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxjdXN0b21lciUyMHN1cHBvcnQlMjBjb250YWN0fGVufDF8fHx8MTc2NDQ1ODk3N3ww&ixlib=rb-4.1.0&q=80&w=1080",alt:"Contact Us",className:"w-full h-full object-cover"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/90 to-primary/60"}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsxs("div",{className:"text-center px-4",children:[s.jsx("h1",{className:"text-white text-2xl lg:text-3xl mb-2",children:"Contact Us"}),s.jsx("p",{className:"text-white/90 text-sm lg:text-base",children:"We're here to help"})]})})]}),s.jsx("div",{className:"legal-container py-6",children:s.jsxs("div",{className:"card space-y-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-heading mb-2",children:"Get in Touch"}),s.jsx("p",{className:"text-body",children:"Have questions, feedback, or need help? We'd love to hear from you!"})]}),s.jsxs("a",{href:"mailto:contact@localfelo.com",className:"card flex items-center gap-4 hover:bg-background transition-all no-underline",children:[s.jsx("div",{className:"w-12 h-12 rounded-full bg-primary flex items-center justify-center flex-shrink-0",children:s.jsx(Si,{className:"w-6 h-6 text-black"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-heading m-0 mb-1",children:"Email"}),s.jsx("p",{className:"text-body text-sm m-0",children:"contact@localfelo.com"})]})]}),s.jsxs("a",{href:"https://instagram.com/localfelo",target:"_blank",rel:"noopener noreferrer",className:"card flex items-center gap-4 hover:bg-background transition-all no-underline",children:[s.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center shrink-0",children:s.jsx(ty,{className:"w-6 h-6 text-primary"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-heading m-0 mb-1",children:"Instagram"}),s.jsx("p",{className:"text-body text-sm m-0",children:"@localfelo"})]})]}),s.jsxs("a",{href:"https://facebook.com/localfelo",target:"_blank",rel:"noopener noreferrer",className:"card flex items-center gap-4 hover:bg-background transition-all no-underline",children:[s.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center shrink-0",children:s.jsx(Qx,{className:"w-6 h-6 text-primary"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-heading m-0 mb-1",children:"Facebook"}),s.jsx("p",{className:"text-body text-sm m-0",children:"@localfelo"})]})]}),s.jsxs("a",{href:"https://linkedin.com/company/localfelo",target:"_blank",rel:"noopener noreferrer",className:"card flex items-center gap-4 hover:bg-background transition-all no-underline",children:[s.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center shrink-0",children:s.jsx(sy,{className:"w-6 h-6 text-primary"})}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-heading m-0 mb-1",children:"LinkedIn"}),s.jsx("p",{className:"text-body text-sm m-0",children:"LocalFelo"})]})]}),s.jsxs("div",{className:"p-4 bg-input rounded-lg",children:[s.jsx("h4",{className:"text-heading mb-2",children:"Support Hours"}),s.jsxs("p",{className:"text-body text-sm m-0",children:["Monday - Saturday: 9:00 AM - 6:00 PM IST",s.jsx("br",{}),"Sunday: Closed"]})]}),s.jsx("div",{className:"p-4 bg-primary/10 border border-primary/20 rounded-lg",children:s.jsx("p",{className:"text-body text-sm m-0",children:'We typically respond within 24-48 hours. For urgent issues, please reach out via email with "URGENT" in the subject line.'})})]})})]})}function $4({onClose:t}){const[e,r]=j.useState(null),[i,o]=j.useState([]),[c,l]=j.useState(!1),[u,h]=j.useState(""),f=async()=>{l(!0);const{data:p}=await V.auth.getSession();r(p.session);const{data:y}=await V.auth.getUser();console.log("Current user:",y),l(!1)};j.useEffect(()=>{f()},[]);const g=async()=>{l(!0),h("");try{console.log(" Testing Supabase email service...");const{data:{session:p},error:y}=await V.auth.getSession();console.log("Current session:",{session:p,sessionError:y});const v=`test-${Date.now()}@example.com`;console.log(" Attempting signup with:",v);const{data:w,error:k}=await V.auth.signUp({email:v,password:"TestPassword123!",options:{emailRedirectTo:window.location.origin,data:{name:"Test User"}}});console.log(" Signup response:",{data:w,error:k}),w?.user&&!w?.user?.email_confirmed_at?h(` User created but email NOT confirmed

Email Status: Pending verification
User ID: `+w.user.id+`
Email: `+w.user.email+`

 EMAIL NOT SENT or FAILED

Possible Issues:
1. Email confirmation is disabled in Supabase
2. Supabase email service not configured
3. Rate limit reached
4. Email domain blocked`):w?.user?.email_confirmed_at?h(` Email was auto-confirmed (email confirmation is OFF in Supabase)

User ID: `+w.user.id+`
Email: `+w.user.email+`

 This means "Confirm email" setting is OFF in your Supabase Dashboard`):k&&h(` Signup Failed:

Error: `+k.message+`
Code: `+k.code+`

`+JSON.stringify(k,null,2))}catch(p){console.error("Test failed:",p),h(` Test Failed:

`+p.message)}l(!1)};return s.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-start justify-center p-4 overflow-y-auto",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full my-8",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[s.jsx("h2",{className:"text-lg",children:" Auth Debug Panel"}),s.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded",children:s.jsx(ut,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{className:"border rounded p-3",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h3",{className:"font-medium",children:"Current Session"}),s.jsx("button",{onClick:f,className:"p-1 hover:bg-gray-100 rounded",children:s.jsx(oy,{className:`w-4 h-4 ${c?"animate-spin":""}`})})]}),s.jsx("pre",{className:"text-xs bg-gray-50 p-2 rounded overflow-auto max-h-40",children:e?JSON.stringify(e.user,null,2):"No session"})]}),s.jsxs("div",{className:"border rounded p-3",children:[s.jsx("h3",{className:"font-medium mb-3",children:"Test Functions"}),s.jsx("div",{className:"space-y-2",children:s.jsx("button",{onClick:g,className:"w-full btn-secondary text-sm",children:" Test Supabase Email Service"})})]}),s.jsxs("div",{className:"border rounded p-3 bg-orange-50",children:[s.jsx("h3",{className:"font-medium mb-2",children:"Instructions"}),s.jsxs("ul",{className:"text-sm space-y-1 text-orange-900",children:[s.jsx("li",{children:" Open browser console (F12) to see detailed logs"}),s.jsx("li",{children:" Test signup will create a user with temp password"}),s.jsx("li",{children:" Test resend will attempt to resend verification"}),s.jsx("li",{children:" Check Supabase Dashboard  Auth  Users after each test"})]})]}),s.jsxs("div",{className:"border rounded p-3 bg-amber-50",children:[s.jsx("h3",{className:"font-medium mb-2",children:" Supabase Settings Checklist"}),s.jsxs("ul",{className:"text-sm space-y-1 text-amber-900",children:[s.jsx("li",{children:" Email provider enabled?"}),s.jsx("li",{children:' "Confirm email" turned ON? (CRITICAL!)'}),s.jsx("li",{children:" Site URL = http://localhost:5173"}),s.jsx("li",{children:" Redirect URLs include http://localhost:5173/**"})]})]}),s.jsxs("div",{className:"border rounded p-3 bg-rose-50",children:[s.jsx("h3",{className:"font-medium mb-2",children:" Common Issues"}),s.jsxs("ul",{className:"text-sm space-y-1 text-rose-900",children:[s.jsxs("li",{children:[s.jsx("strong",{children:"No email sent:"}),' Check "Confirm email" is ON']}),s.jsxs("li",{children:[s.jsx("strong",{children:"Resend fails:"})," User might be already confirmed"]}),s.jsxs("li",{children:[s.jsx("strong",{children:"Rate limited:"})," Wait 60 seconds between attempts"]}),s.jsxs("li",{children:[s.jsx("strong",{children:"Email in spam:"})," Check spam folder!"]})]})]}),s.jsxs("div",{className:"border rounded p-3 bg-gray-50",children:[s.jsx("h3",{className:"font-medium mb-2",children:"Test Results"}),s.jsx("pre",{className:"text-sm bg-gray-100 p-2 rounded overflow-auto max-h-40",children:u})]})]})]})})}function B4({onNavigate:t}){const[e,r]=j.useState(null),[i,o]=j.useState(!1),[c,l]=j.useState(!1),u=async()=>{o(!0);try{const f=localStorage.getItem("oldcycle_token"),g=localStorage.getItem("oldcycle-auth-token"),p=localStorage.getItem("oldcycle_user"),{data:{session:y},error:v}=await V.auth.getSession(),{data:w}=await V.from("profiles").select("*").eq("client_token",f).single(),{data:k}=await V.from("listings").select("id, title, owner_token, owner_name, owner_phone, created_at");r({clientToken:f,authToken:g?"Present (Supabase)":"Not found",userJson:p?JSON.parse(p):null,supabaseSession:y?{user_email:y.user?.email,user_id:y.user?.id,expires_at:new Date(y.expires_at*1e3).toLocaleString()}:"No session",sessionError:v?.message||"None",profile:w,allListings:k,currentUrl:window.location.href,origin:window.location.origin})}catch(f){console.error("Diagnostic error:",f)}o(!1)},h=async()=>{if(!e?.profile)return;const{owner_token:f}=e.profile,g=e.allListings.filter(y=>y.owner_phone===e.profile.phone);if(console.log("Found listings by phone:",g),g.length===0){alert("No listings found matching your phone number");return}const p=g.map(y=>V.from("listings").update({owner_token:f}).eq("id",y.id));await Promise.all(p),alert(`Fixed ${g.length} listing(s)!`),u()};return s.jsxs("div",{className:"min-h-screen bg-white pb-20",children:[s.jsx("div",{className:"bg-white border-b sticky top-0 z-10",children:s.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-4 flex items-center gap-4",children:[s.jsx("button",{onClick:()=>t("profile"),className:"p-2 hover:bg-gray-100 rounded-lg",children:s.jsx(Za,{className:"w-5 h-5"})}),s.jsx("h1",{className:"text-xl",children:" Diagnostic Tool"})]})}),s.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-6 space-y-4",children:[s.jsx("button",{onClick:u,disabled:i,className:"w-full bg-[#FF6B35] text-white px-4 py-3 rounded-lg hover:bg-[#E85A28] disabled:opacity-50 transition-colors",children:i?"Running...":"Run Diagnostic"}),s.jsx("button",{onClick:()=>l(!0),className:"w-full bg-[#FFC107] text-[#1A1410] px-4 py-3 rounded-lg hover:bg-[#FFB300] transition-colors",children:" Open Auth Debug Panel"}),e&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[s.jsx("h3",{className:"font-medium mb-2",children:"Client Token (localStorage)"}),s.jsx("code",{className:"text-xs bg-gray-100 p-2 rounded block break-all",children:e.clientToken})]}),s.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[s.jsx("h3",{className:"font-medium mb-2",children:"Profile Data"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Name:"})," ",e.profile?.name]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Phone:"})," ",e.profile?.phone]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Client Token:"}),s.jsx("code",{className:"text-xs bg-gray-100 p-1 rounded block break-all mt-1",children:e.profile?.client_token})]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Owner Token:"}),s.jsx("code",{className:"text-xs bg-orange-100 p-1 rounded block break-all mt-1",children:e.profile?.owner_token})]})]})]}),s.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[s.jsxs("h3",{className:"font-medium mb-2",children:["All Listings in Database (",e.allListings?.length||0,")"]}),s.jsx("div",{className:"space-y-4",children:e.allListings?.map(f=>s.jsxs("div",{className:"border-l-4 border-orange-500 pl-3 py-2 bg-gray-50",children:[s.jsx("div",{className:"font-medium",children:f.title}),s.jsxs("div",{className:"text-xs space-y-1 mt-2",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Owner Token:"}),s.jsx("code",{className:"bg-white p-1 rounded block break-all mt-1",children:f.owner_token})]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Phone:"})," ",f.owner_phone]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Name:"})," ",f.owner_name]}),s.jsx("div",{className:"text-gray-500",children:new Date(f.created_at).toLocaleString()}),f.owner_token===e.profile?.owner_token&&s.jsx("div",{className:"text-[#52B788] font-medium",children:" Matches Profile Owner Token"}),f.owner_token===e.profile?.client_token&&s.jsx("div",{className:"text-amber-600 font-medium",children:" Using Client Token (WRONG)"}),f.owner_phone===e.profile?.phone&&s.jsx("div",{className:"text-[#FF6B35] font-medium",children:" Phone Matches"})]})]},f.id))})]}),s.jsx("button",{onClick:h,className:"w-full bg-[#52B788] text-white px-4 py-3 rounded-lg hover:bg-[#40916C] transition-colors",children:" Fix My Listings by Phone Number"})]})]}),c&&s.jsx($4,{onClose:()=>l(!1)})]})}function W4({onBack:t,onNavigate:e,isLoggedIn:r=!1,isAdmin:i=!1,userDisplayName:o,unreadCount:c=0,notificationCount:l=0,onNotificationCountChange:u}){const[h,f]=j.useState([]),[g,p]=j.useState(!0),[y,v]=j.useState("all"),w=tt();j.useEffect(()=>{if(k(),w){const P=mh(w.id,()=>{k()});return()=>{P.unsubscribe()}}},[w?.id]);const k=async()=>{if(!w?.id)return;p(!0);const P=await ch(w.id);f(P),p(!1)},N=async P=>{await dh(P),f(D=>D.map(H=>H.id===P?{...H,is_read:!0}:H)),l>0&&u?.(l-1)},C=async()=>{w?.id&&(await uh(w.id),f(P=>P.map(D=>({...D,is_read:!0}))),u?.(0),J.success("All notifications marked as read"))},A=async P=>{await hh(P),f(D=>D.filter(H=>H.id!==P)),J.success("Notification deleted")},E=P=>{P.is_read||N(P.id),P.related_type==="task"&&P.related_id?e?.("task-detail",{taskId:P.related_id}):P.related_type==="listing"&&P.related_id?e?.("listing",{id:P.related_id}):P.related_type==="wish"&&P.related_id?e?.("wish-detail",{wishId:P.related_id}):P.related_type==="chat"&&P.related_id&&e?.("chat",{conversationId:P.related_id})},_=P=>{switch(P){case"task_accepted":case"task_completed":return s.jsx(rn,{className:"w-5 h-5 text-green-600"});case"task_cancelled":return s.jsx(ar,{className:"w-5 h-5 text-red-600"});case"task_completion_request":return s.jsx(cs,{className:"w-5 h-5 text-orange-600"});case"chat_message":return s.jsx(ct,{className:"w-5 h-5 text-primary"});case"info":case"broadcast":return s.jsx(or,{className:"w-5 h-5 text-blue-600"});case"promotion":return s.jsx(or,{className:"w-5 h-5 text-purple-600"});case"alert":return s.jsx(cs,{className:"w-5 h-5 text-red-600"});default:return s.jsx(or,{className:"w-5 h-5 text-primary"})}},R=P=>{const D=new Date(P),B=new Date().getTime()-D.getTime(),ae=Math.floor(B/6e4),ue=Math.floor(B/36e5),le=Math.floor(B/864e5);return ae<1?"Just now":ae<60?`${ae}m ago`:ue<24?`${ue}h ago`:le<7?`${le}d ago`:D.toLocaleDateString("en-IN",{day:"numeric",month:"short"})},L=h.filter(P=>y==="all"?!0:!P.is_read);return g?s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4"}),s.jsx("p",{className:"text-muted",children:"Loading notifications..."})]})}):s.jsxs("div",{className:"min-h-screen bg-background pb-20 sm:pb-6",children:[s.jsx(rt,{title:"Notifications",showBack:!0,onBack:()=>e?.("home"),currentScreen:"notifications",onNavigate:e,isLoggedIn:r,isAdmin:i,userDisplayName:o,unreadCount:c,notificationCount:l}),s.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>v("all"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${y==="all"?"bg-black text-white":"bg-white text-body border border-border hover:bg-gray-50"}`,children:["All",h.length>0&&s.jsxs("span",{className:"ml-2 text-xs opacity-75",children:["(",h.length,")"]})]}),s.jsxs("button",{onClick:()=>v("unread"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${y==="unread"?"bg-black text-white":"bg-white text-body border border-border hover:bg-gray-50"}`,children:["Unread (",c,")"]})]}),h.filter(P=>!P.is_read).length>0&&s.jsxs("button",{onClick:C,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-primary hover:bg-primary/10 rounded-lg transition-colors",children:[s.jsx(t1,{className:"w-4 h-4"}),"Mark all read"]})]}),L.length===0?s.jsxs("div",{className:"text-center py-16",children:[s.jsx(or,{className:"w-16 h-16 text-muted mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No notifications"}),s.jsx("p",{className:"text-body",children:y==="unread"?"You're all caught up!":"Notifications will appear here"})]}):s.jsx("div",{className:"space-y-2",children:L.map(P=>s.jsx("div",{className:`bg-white rounded-lg border transition-all cursor-pointer hover:shadow-md ${P.is_read?"border-gray-200":"border-primary/30 bg-primary/5"}`,onClick:()=>E(P),children:s.jsxs("div",{className:"p-4 flex items-start gap-3",children:[s.jsx("div",{className:"shrink-0 mt-0.5",children:_(P.type)}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"font-semibold text-heading text-sm mb-1",children:P.title}),s.jsx("p",{className:"text-sm text-body leading-relaxed mb-2",children:P.message}),P.metadata?.taskTitle&&s.jsxs("div",{className:"mt-2 p-2 bg-gray-50 rounded border border-gray-200",children:[s.jsxs("p",{className:"text-xs text-muted",children:[P.related_type==="task"?"Task":"Item",":"]}),s.jsx("p",{className:"text-sm font-medium text-heading truncate",children:P.metadata.taskTitle}),P.metadata.taskPrice&&s.jsxs("p",{className:"text-xs text-primary font-semibold mt-1",children:["",P.metadata.taskPrice.toLocaleString("en-IN")]})]}),s.jsx("p",{className:"text-xs text-muted mt-2",children:R(P.created_at||P.createdAt||"")})]}),s.jsxs("div",{className:"shrink-0 flex items-center gap-2",children:[!P.is_read&&s.jsx("div",{className:"w-2 h-2 bg-primary rounded-full"}),s.jsx("button",{onClick:D=>{D.stopPropagation(),A(P.id)},className:"p-2 hover:bg-red-50 rounded transition-colors","aria-label":"Delete notification",children:s.jsx(Ls,{className:"w-4 h-4 text-red-600"})})]})]})},P.id))})]})]})}function V4({onBack:t,onNavigate:e,isLoggedIn:r=!1,isAdmin:i=!1,userDisplayName:o}){return s.jsxs("div",{className:"min-h-screen bg-background pb-20",children:[s.jsx(rt,{title:"Prohibited Items",showBack:!0,onBack:t,currentScreen:"prohibited",onNavigate:e,isLoggedIn:r,isAdmin:i,userDisplayName:o}),s.jsxs("div",{className:"relative h-[120px] lg:h-[160px] w-full overflow-hidden",children:[s.jsx(Ui,{src:"https://images.unsplash.com/photo-1506606401543-2e73709cebb4?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&q=80&w=1080",alt:"Prohibited Items",className:"w-full h-full object-cover"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-red-600/90 to-red-500/60"}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.jsxs("div",{className:"text-center px-4",children:[s.jsx("h1",{className:"text-white text-2xl lg:text-3xl mb-2",children:"Prohibited Items & Activities"}),s.jsx("p",{className:"text-white/90 text-sm lg:text-base",children:"What you cannot post on LocalFelo"})]})})]}),s.jsx("div",{className:"legal-container py-6",children:s.jsxs("div",{className:"card space-y-6",children:[s.jsx("div",{className:"bg-red-50 border-2 border-red-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(ki,{className:"w-6 h-6 text-red-600 shrink-0 mt-0.5"}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-red-900 font-semibold mb-1",children:"Important Notice"}),s.jsx("p",{className:"text-red-800 text-sm",children:"Posting prohibited items or engaging in prohibited activities will result in immediate removal of your listing and may lead to account suspension."})]})]})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-heading mb-2",children:"What You Cannot Post"}),s.jsx("p",{className:"text-body mb-4",children:"To keep LocalFelo safe and legal, the following items and activities are strictly prohibited:"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(zp,{className:"w-5 h-5 text-red-600"}),s.jsx("h3",{className:"text-heading m-0",children:"Illegal Items & Services"})]}),s.jsxs("ul",{className:"space-y-1 text-body text-sm",children:[s.jsx("li",{children:" Stolen or illegally obtained goods"}),s.jsx("li",{children:" Counterfeit, replica, or pirated items (fake branded goods, pirated software, etc.)"}),s.jsx("li",{children:" Illegal drugs, narcotics, or prescription medications without proper authorization"}),s.jsx("li",{children:" Items that violate intellectual property rights"}),s.jsx("li",{children:" Illegal wildlife products or endangered species"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Rl,{className:"w-5 h-5 text-red-600"}),s.jsx("h3",{className:"text-heading m-0",children:"Dangerous & Restricted Items"})]}),s.jsxs("ul",{className:"space-y-1 text-body text-sm",children:[s.jsx("li",{children:" Weapons (guns, knives, explosives, ammunition)"}),s.jsx("li",{children:" Hazardous materials (chemicals, toxic substances)"}),s.jsx("li",{children:" Fireworks or explosives"}),s.jsx("li",{children:" Lock picking tools or burglary equipment"}),s.jsx("li",{children:" Recalled or unsafe products"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(ki,{className:"w-5 h-5 text-red-600"}),s.jsx("h3",{className:"text-heading m-0",children:"Adult & Restricted Content"})]}),s.jsxs("ul",{className:"space-y-1 text-body text-sm",children:[s.jsx("li",{children:" Adult content, pornography, or sexual services"}),s.jsx("li",{children:" Tobacco, alcohol (if prohibited by local laws)"}),s.jsx("li",{children:" Items promoting hate speech or discrimination"}),s.jsx("li",{children:" Gambling services or lottery tickets"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Rl,{className:"w-5 h-5 text-red-600"}),s.jsx("h3",{className:"text-heading m-0",children:"Animals & Living Things"})]}),s.jsxs("ul",{className:"space-y-1 text-body text-sm",children:[s.jsx("li",{children:" Live animals (except approved pet adoption services)"}),s.jsx("li",{children:" Animal parts or products from endangered species"}),s.jsx("li",{children:" Illegal wildlife trade"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(zp,{className:"w-5 h-5 text-red-600"}),s.jsx("h3",{className:"text-heading m-0",children:"Financial Instruments & Personal Data"})]}),s.jsxs("ul",{className:"space-y-1 text-body text-sm",children:[s.jsx("li",{children:" Stolen credit cards, bank accounts, or financial credentials"}),s.jsx("li",{children:" Personal information (IDs, passports, Aadhaar cards)"}),s.jsx("li",{children:" Get-rich-quick schemes or pyramid schemes"}),s.jsx("li",{children:" Cryptocurrency scams or unregulated financial services"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(ki,{className:"w-5 h-5 text-red-600"}),s.jsx("h3",{className:"text-heading m-0",children:"Prohibited Services"})]}),s.jsxs("ul",{className:"space-y-1 text-body text-sm",children:[s.jsx("li",{children:" Illegal services or activities"}),s.jsx("li",{children:" Services requiring professional licenses without proper credentials"}),s.jsx("li",{children:" Medical procedures or unlicensed healthcare services"}),s.jsx("li",{children:" Hacking, data theft, or privacy invasion services"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Rl,{className:"w-5 h-5 text-red-600"}),s.jsx("h3",{className:"text-heading m-0",children:"Spam & Fraudulent Activities"})]}),s.jsxs("ul",{className:"space-y-1 text-body text-sm",children:[s.jsx("li",{children:" Spam or repetitive duplicate listings"}),s.jsx("li",{children:" Misleading or fraudulent listings"}),s.jsx("li",{children:" Phishing attempts or scams"}),s.jsx("li",{children:" MLM (Multi-Level Marketing) recruitment"}),s.jsx("li",{children:" Bait-and-switch tactics"})]})]}),s.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:[s.jsx("h3",{className:"text-heading mb-2",children:"Consequences of Violation"}),s.jsx("p",{className:"text-body text-sm mb-2",children:"If you post prohibited items or engage in prohibited activities:"}),s.jsxs("ul",{className:"space-y-1 text-body text-sm",children:[s.jsx("li",{children:" Your listing will be immediately removed"}),s.jsx("li",{children:" Your account may be suspended or permanently banned"}),s.jsx("li",{children:" We will cooperate with law enforcement if illegal activity is detected"}),s.jsx("li",{children:" You may be held legally responsible for violations"})]})]}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsx("h3",{className:"text-heading mb-2",children:"Report Prohibited Content"}),s.jsx("p",{className:"text-body text-sm",children:'If you see a listing that violates these rules, please report it immediately using the "Report" button on the listing page. Your report will be reviewed by our team.'})]}),s.jsx("div",{className:"border-t border-gray-200 pt-4",children:s.jsx("p",{className:"text-muted text-sm",children:"LocalFelo reserves the right to remove any content that violates these guidelines or is deemed inappropriate. These guidelines may be updated from time to time."})})]})})]})}function z4({wish:t,onClick:e}){const i=(c=>{switch(c){case"negotiating":return{label:"Negotiating",color:"bg-yellow-50 border-yellow-200 text-yellow-800",icon:ct,description:"Discussing terms with wisher"};case"accepted":return{label:"Accepted",color:"bg-blue-50 border-blue-200 text-blue-800",icon:Gx,description:"Ready to fulfill wish"};case"in_progress":return{label:"In Progress",color:"bg-purple-50 border-purple-200 text-purple-800",icon:mt,description:"Working on fulfilling wish"};default:return{label:"Open",color:"bg-green-50 border-green-200 text-green-800",icon:Ys,description:"Available for acceptance"}}})(t.status||"open"),o=i.icon;return s.jsxs("div",{onClick:e,className:"bg-white border-2 border-[#CDFF00] p-3 sm:p-4 cursor-pointer hover:border-black transition-all",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-3",children:[s.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-[#CDFF00] animate-pulse"}),s.jsx("span",{className:"text-[10px] sm:text-xs font-semibold text-black uppercase tracking-wider",children:"Active Wish"})]}),s.jsxs("div",{className:`flex items-center gap-1 px-1.5 sm:px-2 py-0.5 sm:py-1 rounded-[4px] text-[10px] sm:text-xs font-medium border ${i.color}`,children:[s.jsx(o,{className:"w-3 h-3"}),s.jsx("span",{children:i.label})]})]}),s.jsxs("div",{className:"flex items-start gap-2 sm:gap-3",children:[s.jsx("div",{className:"text-2xl sm:text-3xl",children:t.categoryEmoji}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold text-gray-900 truncate mb-0.5 sm:mb-1 text-sm sm:text-base",children:t.title}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mb-1.5 sm:mb-2 line-clamp-2",children:t.description}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3 text-xs sm:text-sm",children:[(t.budgetMin||t.budgetMax)&&s.jsxs("div",{className:"flex items-center gap-1 text-black font-bold",children:[s.jsx(Xa,{className:"w-3 h-3 sm:w-4 sm:h-4"}),s.jsx("span",{children:t.acceptedPrice?`${t.acceptedPrice}`:t.budgetMin&&t.budgetMax?`${t.budgetMin}-${t.budgetMax}`:t.budgetMin?`${t.budgetMin}+`:`${t.budgetMax}`})]}),s.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[s.jsx(ds,{className:"w-3 h-3 sm:w-4 sm:h-4"}),s.jsx("span",{className:"text-[11px] sm:text-sm",children:t.areaName})]}),s.jsxs("div",{className:"flex items-center gap-1 text-gray-500",children:[s.jsx(Ys,{className:"w-3 h-3 sm:w-4 sm:h-4"}),s.jsx("span",{className:"text-[10px] sm:text-xs",children:Ii(new Date(t.acceptedAt||t.createdAt))})]})]})]})]}),s.jsx("div",{className:"mt-2 sm:mt-3 pt-2 sm:pt-3 border-t border-gray-100",children:s.jsxs("p",{className:"text-[10px] sm:text-xs text-gray-500",children:[i.description,"  Tap to open chat"]})})]})}function mc({markers:t,onMarkerClick:e,onClose:r,centerLat:i,centerLng:o,showClose:c=!1,userLocation:l,allowPinDrag:u=!1,onPinDragEnd:h}){const f=j.useRef(null),g=j.useRef(null),p=j.useRef(null),y=j.useRef(null),[v,w]=j.useState(!0),[k,N]=j.useState(!1);j.useEffect(()=>{const A=async()=>{if(!document.getElementById("leaflet-css")){const _=document.createElement("link");_.id="leaflet-css",_.rel="stylesheet",_.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",_.integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=",_.crossOrigin="",document.head.appendChild(_)}if(!window.L){const _=document.createElement("script");_.src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",_.integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=",_.crossOrigin="",await new Promise((R,L)=>{_.onload=R,_.onerror=L,document.head.appendChild(_)})}return window.L};return(async()=>{try{const _=await A();if(!f.current||g.current)return;const R=l?.latitude||i||28.6139,L=l?.longitude||o||77.209,P=_.map(f.current).setView([R,L],l?13:6);if(_.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:" OpenStreetMap contributors",maxZoom:19}).addTo(P),g.current=P,p.current=_.layerGroup().addTo(P),u&&l&&h){const D=_.divIcon({className:"draggable-pin-marker",html:`
              <div class="relative flex flex-col items-center cursor-move" style="filter: drop-shadow(0 6px 12px rgba(0,0,0,0.3));">
                <div class="relative">
                  <div class="w-14 h-14 rounded-full overflow-hidden border-3 border-white shadow-xl flex items-center justify-center" style="background: #CDFF00;">
                    <svg width="56" height="56" viewBox="0 0 180 180" preserveAspectRatio="xMidYMid meet" fill="none" xmlns="http://www.w3.org/2000/svg" style="display: block;">
                      <path d="M95.9365 94.7373L138.624 133.494L124.546 149L81.5703 109.982L45.2422 148.536L30 134.173L77.0928 84.1973H37.6211V63.2539H125.604L95.9365 94.7373ZM149.356 85.4785L134.937 100.667L114.133 80.916L128.553 65.7266L149.356 85.4785ZM135.265 32C142.924 32.0002 149.133 38.2092 149.133 45.8682C149.133 53.5272 142.924 59.7361 135.265 59.7363C127.605 59.7363 121.396 53.5273 121.396 45.8682C121.396 38.209 127.605 32 135.265 32Z" fill="black"/>
                    </svg>
                  </div>
                  <div class="absolute left-1/2 -translate-x-1/2 -bottom-2.5">
                    <div style="
                      width: 0;
                      height: 0;
                      border-left: 10px solid transparent;
                      border-right: 10px solid transparent;
                      border-top: 14px solid #CDFF00;
                      filter: drop-shadow(0 3px 4px rgba(0,0,0,0.2));
                    "></div>
                  </div>
                </div>
                <div class="mt-2 px-2 py-1 bg-black text-white text-xs font-bold rounded" style="white-space: nowrap;">
                  Drag to adjust
                </div>
              </div>
            `,iconSize:[56,90],iconAnchor:[28,70]});y.current=_.marker([l.latitude,l.longitude],{icon:D,draggable:!0}).addTo(P),y.current.on("dragend",()=>{const H=y.current.getLatLng();h(H.lat,H.lng)})}else if(l){const D=_.divIcon({className:"user-location-marker",html:`
              <div class="relative flex items-center justify-center">
                <div class="absolute w-16 h-16 bg-blue-500/20 rounded-full animate-pulse"></div>
                <div class="relative z-10 w-8 h-8 bg-blue-500 rounded-full border-4 border-white shadow-lg flex items-center justify-center">
                  <div class="w-3 h-3 bg-white rounded-full"></div>
                </div>
              </div>
            `,iconSize:[32,32],iconAnchor:[16,16]});_.marker([l.latitude,l.longitude],{icon:D}).addTo(p.current)}w(!1),u||C(_)}catch(_){console.error("Failed to load map:",_),w(!1)}})(),()=>{g.current&&(g.current.remove(),g.current=null)}},[]),j.useEffect(()=>{const A=window.L;A&&g.current&&C(A)},[t,l]);const C=A=>{if(p.current){if(p.current.clearLayers(),l){const E=A.divIcon({className:"user-location-marker",html:`
          <div class="relative flex items-center justify-center">
            <div class="absolute w-16 h-16 bg-blue-500/20 rounded-full animate-pulse"></div>
            <div class="relative z-10 w-8 h-8 bg-blue-500 rounded-full border-4 border-white shadow-lg flex items-center justify-center">
              <div class="w-3 h-3 bg-white rounded-full"></div>
            </div>
          </div>
        `,iconSize:[32,32],iconAnchor:[16,16]});A.marker([l.latitude,l.longitude],{icon:E}).addTo(p.current)}if(t.forEach(E=>{const _=A.divIcon({className:"custom-marker",html:`
          <div class="relative flex flex-col items-center cursor-pointer transform transition-transform hover:scale-110" style="filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));">
            <!-- Location Pin Shape with LocalFelo Branding -->
            <div class="relative">
              <!-- Pin Head (Circle with Logo) -->
              <div class="w-12 h-12 rounded-full overflow-hidden border-2 border-white shadow-lg flex items-center justify-center" style="background: #CDFF00;">
                <svg width="48" height="48" viewBox="0 0 180 180" preserveAspectRatio="xMidYMid meet" fill="none" xmlns="http://www.w3.org/2000/svg" style="display: block;">
                  <path d="M95.9365 94.7373L138.624 133.494L124.546 149L81.5703 109.982L45.2422 148.536L30 134.173L77.0928 84.1973H37.6211V63.2539H125.604L95.9365 94.7373ZM149.356 85.4785L134.937 100.667L114.133 80.916L128.553 65.7266L149.356 85.4785ZM135.265 32C142.924 32.0002 149.133 38.2092 149.133 45.8682C149.133 53.5272 142.924 59.7361 135.265 59.7363C127.605 59.7363 121.396 53.5273 121.396 45.8682C121.396 38.209 127.605 32 135.265 32Z" fill="black"/>
                </svg>
              </div>
              <!-- Pin Tip (Triangle) -->
              <div class="absolute left-1/2 -translate-x-1/2 -bottom-2">
                <div style="
                  width: 0;
                  height: 0;
                  border-left: 8px solid transparent;
                  border-right: 8px solid transparent;
                  border-top: 12px solid #CDFF00;
                  filter: drop-shadow(0 2px 3px rgba(0,0,0,0.15));
                "></div>
              </div>
              <!-- Ping Effect -->
              <div class="absolute inset-0 bg-[#CDFF00]/30 rounded-full animate-ping"></div>
            </div>
          </div>
        `,iconSize:[48,60],iconAnchor:[24,60],popupAnchor:[0,-60]});A.marker([E.latitude,E.longitude],{icon:_}).addTo(p.current).on("click",()=>{e(E.id)})}),t.length>0&&l){const E=[...t.map(R=>[R.latitude,R.longitude]),[l.latitude,l.longitude]],_=A.latLngBounds(E);g.current?.fitBounds(_,{padding:[50,50],maxZoom:14})}else if(t.length>0){const E=A.latLngBounds(t.map(_=>[_.latitude,_.longitude]));g.current?.fitBounds(E,{padding:[50,50],maxZoom:14})}else l&&g.current?.setView([l.latitude,l.longitude],13)}};return s.jsxs("div",{className:`${k?"fixed inset-0 z-[9999] bg-white":"relative w-full h-full"} transition-all duration-300`,children:[s.jsx("div",{ref:f,className:"w-full h-full rounded-lg overflow-hidden"}),v&&s.jsx("div",{className:"absolute inset-0 bg-white/80 flex items-center justify-center z-50",children:s.jsxs("div",{className:"flex flex-col items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 border-4 border-primary border-t-transparent rounded-full animate-spin"}),s.jsx("p",{className:"text-muted text-sm",children:"Loading map..."})]})}),s.jsxs("div",{className:"absolute top-4 left-4 right-4 z-50 flex items-center justify-between",children:[s.jsx("button",{onClick:()=>{N(!k),setTimeout(()=>{g.current&&g.current.invalidateSize()},300)},className:"p-2 bg-white rounded-lg shadow-lg hover:bg-gray-50 transition-colors","aria-label":k?"Minimize map":"Maximize map",children:k?s.jsx(l1,{className:"w-5 h-5"}):s.jsx(a1,{className:"w-5 h-5"})}),(c||k)&&r&&s.jsx("button",{onClick:r,className:"p-2 bg-white rounded-lg shadow-lg hover:bg-gray-50 transition-colors","aria-label":"Close map",children:s.jsx(ut,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"absolute bottom-2 left-2 z-30 bg-white/90 px-2 py-1 rounded text-xs text-muted",children:[s.jsx(ds,{className:"w-3 h-3 inline mr-1"}),t.length," location",t.length!==1?"s":""]})]})}function q4({onNavigate:t,isLoggedIn:e,isAdmin:r,userDisplayName:i,unreadCount:o,cities:c,onMenuClick:l,showGlobalLocation:u,globalLocationArea:h,globalLocationCity:f,onLocationClick:g,notificationCount:p,onNotificationClick:y,userCoordinates:v,onLoginRequired:w,onContactClick:k,socialLinks:N}){const C=tt(),[A,E]=j.useState([]),[_,R]=j.useState([]),[L,P]=j.useState([]),[D,H]=j.useState(!0),[B,ae]=j.useState(!1),[ue,le]=j.useState(""),[fe,we]=j.useState(""),[oe,Y]=j.useState(""),[I,$]=j.useState(""),[W,T]=j.useState(!1),[z,G]=j.useState(!1),[M,X]=j.useState(!1),[ie,be]=j.useState([]),[ve,ee]=j.useState("list"),[ce,Ue]=j.useState(""),he=c.find(ne=>ne.id===fe),Le=async()=>{H(!0);try{let ne=fe,Oe=oe;const He={};ue&&(He.categoryId=ue),ne&&(He.cityId=ne),Oe&&(He.areaId=Oe),I.trim()&&(He.searchQuery=I.trim()),ce&&(He.distance=ce),console.log(" [WishesScreen] Loading wishes from ALL cities with filters:",{...He,note:"Showing all wishes everywhere, sorted by distance (nearest first)"}),v?(He.userLat=v.latitude,He.userLon=v.longitude,console.log(" [WishesScreen] User coordinates AVAILABLE:",v)):console.log(" [WishesScreen] User coordinates NOT SET - distance will not show. Set location to see distances.");const wt=await dc(He);E(wt)}catch(ne){console.error("Failed to load wishes:",ne),J.error("Failed to load wishes")}finally{H(!1)}};j.useEffect(()=>{Le()},[ue,fe,oe,I,v,f,h,ce]);const Ke=async ne=>{if(!e){J.error("Please login to chat"),w&&w();return}try{console.log(" Opening chat with wish:",ne.id);const{conversation:Oe,error:He}=await Di(ne.id,ne.title,void 0,ne.budgetMax||ne.budgetMin||0,ne.userId,ne.userName,ne.userAvatar,"wish");if(He||!Oe){console.error(" Failed to create conversation:",He),J.error(He||"Failed to open chat. Please try again.");return}console.log(" Conversation ready:",Oe.id),t("chat",{conversationId:Oe.id})}catch(Oe){console.error(" Exception opening chat:",Oe),J.error("Failed to open chat. Please try again.")}},at=()=>{le(""),we(""),Y(""),$(""),Ue("")},re=[ue,fe,oe,I,ce].filter(Boolean).length;return j.useEffect(()=>{(async()=>{try{const Oe=await oh();be(Oe)}catch(Oe){console.error("Failed to fetch categories:",Oe),J.error("Failed to fetch categories")}})()},[]),j.useEffect(()=>{(async()=>{if(!(!e||!C?.id))try{const Oe=await n4(C.id);R(Oe)}catch(Oe){console.error("Failed to fetch active wishes:",Oe)}})()},[e,C?.id]),j.useEffect(()=>{(async()=>{if(!(!e||!C?.id)){ae(!0);try{const Oe=await Mb(C.id);P(Oe)}catch(Oe){console.error("Failed to fetch my wishes:",Oe)}finally{ae(!1)}}})()},[e,C?.id]),s.jsxs("div",{className:"min-h-screen bg-background pb-20 md:pb-0",children:[s.jsx(rt,{currentScreen:"wishes",onNavigate:t,isLoggedIn:e,isAdmin:r,userDisplayName:i,onMenuClick:l,unreadCount:o,showGlobalLocation:u,globalLocationArea:h,globalLocationCity:f,onLocationClick:g,notificationCount:p,onNotificationClick:y}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:[s.jsx("div",{className:"bg-white border border-gray-200 p-4 sm:p-6 mb-4",children:s.jsxs("div",{className:"flex items-center justify-between gap-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-lg flex items-center justify-center shrink-0",style:{backgroundColor:"#CDFF00"},children:s.jsx(bs,{className:"w-4 h-4 sm:w-5 sm:h-5 text-black"})}),s.jsx("h1",{className:"text-lg sm:text-xl m-0",style:{fontWeight:"700"},children:"Wishes Near You"})]}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-600 m-0",children:"Post a wish and connect with people in your area"})]}),s.jsxs("button",{onClick:()=>{if(!e){J.error("Please login to post a wish"),w&&w();return}t("create-wish")},className:"btn-primary flex items-center gap-1.5 px-3 py-2 sm:px-4 sm:py-2.5 shrink-0",style:{borderRadius:"6px",width:"auto",minWidth:"fit-content"},children:[s.jsx(Pa,{className:"w-4 h-4"}),s.jsx("span",{className:"whitespace-nowrap text-sm sm:text-base",children:"Post Wish"})]})]})}),s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(mt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Smart search wishes...",value:I,onChange:ne=>$(ne.target.value),className:"w-full pl-10 pr-10 py-2.5 bg-white border border-gray-200 rounded-[6px] text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"}),I&&s.jsx("button",{onClick:()=>$(""),className:"absolute right-3 top-1/2 -translate-y-1/2 hover:bg-gray-100 rounded-full p-1 transition-colors",children:s.jsx(ut,{className:"w-4 h-4 text-gray-400 hover:text-black"})})]}),e&&C&&s.jsxs("button",{onClick:()=>X(!0),className:"flex items-center gap-1.5 px-3 py-2.5 bg-white border border-gray-200 rounded-[6px] shrink-0 hover:bg-gray-50 transition-colors text-sm",children:[s.jsx(Js,{className:"w-4 h-4 text-black"}),s.jsx("span",{className:"text-black whitespace-nowrap",children:"My Wishes"})]}),s.jsxs("button",{onClick:()=>T(!W),className:"flex items-center gap-1.5 px-3 py-2.5 bg-white border border-gray-200 rounded-[6px] shrink-0 hover:bg-gray-50 transition-colors text-sm",children:[s.jsx(uy,{className:"w-4 h-4 text-black"}),s.jsx("span",{className:"hidden sm:inline text-black whitespace-nowrap",children:"Filters"}),re>0&&s.jsx("span",{className:"bg-primary text-black text-xs px-1.5 py-0.5 rounded-full font-bold",children:re})]})]}),s.jsx("div",{className:"mb-3",children:s.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2 hide-scrollbar",children:[s.jsx("button",{onClick:()=>le(""),className:`px-3 py-2 rounded-full text-sm whitespace-nowrap transition-colors ${ue?"bg-white text-gray-600 hover:text-black hover:bg-gray-50 border border-gray-200":"bg-black text-white font-medium"}`,children:"All"}),ie.map(ne=>s.jsxs("button",{onClick:()=>le(ne.id),className:`px-3 py-2 rounded-full text-sm whitespace-nowrap transition-colors ${ue===ne.id?"bg-black text-white font-medium":"bg-white text-gray-600 hover:text-black hover:bg-gray-50 border border-gray-200"}`,children:[ne.emoji," ",ne.name]},ne.id))]})}),W&&s.jsxs("div",{className:"bg-white border border-gray-200 rounded-[6px] p-4 mb-3 space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h4",{className:"text-sm font-medium",children:"Filters"}),re>0&&s.jsx("button",{onClick:at,className:"text-xs text-primary hover:underline",children:"Clear all"})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[s.jsxs(lr,{label:"Distance",value:ce,onChange:ne=>Ue(ne),children:[s.jsx("option",{value:"",children:"Any Distance"}),s.jsx("option",{value:"1",children:"Within 1 km"}),s.jsx("option",{value:"5",children:"Within 5 km"}),s.jsx("option",{value:"10",children:"Within 10 km"}),s.jsx("option",{value:"25",children:"Within 25 km"})]}),s.jsxs(lr,{label:"City",value:fe,onChange:ne=>{we(ne),Y("")},children:[s.jsx("option",{value:"",children:"All Cities"}),c.map(ne=>s.jsx("option",{value:ne.id,children:ne.name},ne.id))]}),he&&s.jsxs(lr,{label:"Area",value:oe,onChange:ne=>Y(ne),children:[s.jsx("option",{value:"",children:"All Areas"}),he.areas?.map(ne=>s.jsx("option",{value:ne.id,children:ne.name},ne.id))]})]})]}),e&&_.length>0&&s.jsxs("div",{className:"mb-3",children:[s.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[s.jsx("span",{children:""}),s.jsx("span",{children:"Your Active Wishes"}),s.jsx("span",{className:"bg-[#CDFF00] text-black text-xs px-1.5 py-0.5 rounded-full font-bold",children:_.length})]}),s.jsx("div",{className:"space-y-2",children:_.map(ne=>s.jsx(z4,{wish:ne,onClick:()=>{t("wish-detail",{wishId:ne.id})}},ne.id))})]}),!D&&s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("p",{className:"text-xs text-muted",children:[A.length," ",A.length===1?"wish":"wishes"," found"]}),re>0&&s.jsxs("button",{onClick:at,className:"text-xs text-primary hover:underline flex items-center gap-1",children:[s.jsx(ut,{className:"w-3 h-3"}),"Clear filters"]})]}),D?s.jsx("div",{className:"grid grid-cols-1 gap-3",children:s.jsx(ln,{count:6})}):A.length===0?s.jsx(Qs,{icon:mt,title:"No wishes found",description:re>0?"Try adjusting your filters to see more results":e?"No other users have posted wishes yet. Your own wishes appear in 'My Wishes' section above.":"No one is looking for anything in this area yet. Post your wish to get started!",action:s.jsxs("button",{onClick:()=>{if(!e){J.error("Please login to post a wish"),w&&w();return}t("create-wish")},className:"btn-primary px-4 py-2 rounded-[4px] flex items-center gap-2",children:[s.jsx(Pa,{className:"w-4 h-4"}),s.jsx("span",{children:"Post Your Wish"})]})}):s.jsxs(s.Fragment,{children:[ve==="list"&&s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:A.map(ne=>s.jsx(Qu,{wish:ne,onClick:()=>{t("wish-detail",{wishId:ne.id})},onChatClick:Ke},ne.id))}),ve==="map"&&s.jsx("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden relative z-0",style:{height:"500px"},children:s.jsx(mc,{markers:A.filter(ne=>ne.latitude&&ne.longitude).map(ne=>({id:ne.id,latitude:ne.latitude,longitude:ne.longitude,title:ne.title,price:ne.budgetMax||ne.budgetMin,type:"wish",categoryEmoji:ie.find(Oe=>String(Oe.id)===String(ne.categoryId))?.emoji,status:ne.status})),onMarkerClick:ne=>{t("wish-detail",{wishId:ne})},userLocation:v})})]})]}),A.length>0&&s.jsxs("div",{className:"fixed right-4 bottom-24 sm:bottom-6 z-40 flex flex-col gap-2 shadow-2xl rounded-[4px] overflow-hidden",children:[s.jsx("button",{onClick:()=>ee("list"),className:`w-12 h-12 flex items-center justify-center transition-all ${ve==="list"?"bg-black text-white":"bg-white text-foreground border-b border-border"}`,title:"List View",children:s.jsx(ry,{className:"w-5 h-5"})}),s.jsx("button",{onClick:()=>ee("map"),className:`w-12 h-12 flex items-center justify-center transition-all ${ve==="map"?"bg-black text-white":"bg-white text-foreground"}`,title:"Map View",children:s.jsx(iy,{className:"w-5 h-5"})})]}),s.jsx(Ar,{isOpen:M,onClose:()=>X(!1),title:"My Wishes",children:s.jsx("div",{className:"max-h-[70vh] overflow-y-auto",children:B?s.jsx("div",{className:"space-y-3 p-4",children:s.jsx(ln,{count:3})}):L.length===0?s.jsx(Qs,{icon:bs,title:"No wishes yet",description:"Start posting your wishes to find what you're looking for",action:s.jsxs("button",{onClick:()=>{X(!1),t("create-wish")},className:"btn-primary px-4 py-2 rounded-[4px] flex items-center gap-2",children:[s.jsx(Pa,{className:"w-4 h-4"}),s.jsx("span",{children:"Post Your First Wish"})]})}):s.jsx("div",{className:"space-y-2 p-4",children:L.map(ne=>s.jsx(Qu,{wish:ne,onClick:()=>{X(!1),t("wish-detail",{wishId:ne.id})},onChatClick:()=>{X(!1),Ke(ne)}},ne.id))})})}),s.jsx(lc,{onNavigate:t,onContactClick:k||(()=>{}),socialLinks:N})]})}function H4({isOpen:t,onClose:e,onSelect:r,selectedDate:i,minDate:o}){const[c,l]=j.useState(new Date);if(j.useEffect(()=>{i&&l(new Date(i))},[i]),!t)return null;const u=new Date,h=new Date(u);h.setDate(h.getDate()+1);const f=new Date(u);f.setDate(f.getDate()+2);const g=new Date(u);g.setDate(g.getDate()+7);const p=D=>D.toISOString().split("T")[0],y=D=>`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][D.getMonth()]} ${D.getDate()}, ${D.getFullYear()}`,v=[{label:"Today",date:p(u),display:y(u)},{label:"Tomorrow",date:p(h),display:y(h)},{label:"Day After",date:p(f),display:y(f)},{label:"Next Week",date:p(g),display:y(g)}],w=D=>{r(D),e()},k=D=>{const H=D.getFullYear(),B=D.getMonth(),ae=new Date(H,B,1),le=new Date(H,B+1,0).getDate(),fe=ae.getDay();return{daysInMonth:le,startingDayOfWeek:fe}},{daysInMonth:N,startingDayOfWeek:C}=k(c),A=c.getFullYear(),E=c.getMonth(),_=()=>{l(new Date(A,E-1,1))},R=()=>{l(new Date(A,E+1,1))},L=D=>{const H=new Date(A,E,D),B=p(H);o&&B<o||(r(B),e())},P=["January","February","March","April","May","June","July","August","September","October","November","December"];return s.jsxs("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center sm:justify-center",children:[s.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:e}),s.jsxs("div",{className:"relative w-full sm:max-w-md bg-white sm:rounded-lg max-h-[85vh] overflow-y-auto",children:[s.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-4 flex items-center justify-between",children:[s.jsx("h3",{className:"text-lg font-medium",children:"Select Date"}),s.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:s.jsx(ut,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"p-4 space-y-2 border-b border-gray-200",children:[s.jsx("p",{className:"text-sm text-muted mb-3",children:"Quick Select"}),s.jsx("div",{className:"grid grid-cols-2 gap-2",children:v.map(D=>s.jsxs("button",{onClick:()=>w(D.date),className:`p-3 border rounded-[6px] text-left transition-colors ${i===D.date?"bg-[#CDFF00] border-[#CDFF00] text-black":"border-gray-200 hover:border-primary hover:bg-gray-50"}`,children:[s.jsx("div",{className:"font-medium text-sm",children:D.label}),s.jsx("div",{className:"text-xs text-gray-600 mt-1",children:D.display})]},D.label))})]}),s.jsxs("div",{className:"p-4",children:[s.jsx("p",{className:"text-sm text-muted mb-3",children:"Or Pick a Date"}),s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("button",{onClick:_,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:s.jsx(eh,{className:"w-5 h-5"})}),s.jsxs("div",{className:"font-medium",children:[P[E]," ",A]}),s.jsx("button",{onClick:R,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:s.jsx(th,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Su","Mo","Tu","We","Th","Fr","Sa"].map(D=>s.jsx("div",{className:"text-center text-xs text-gray-500 py-2",children:D},D))}),s.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[Array.from({length:C}).map((D,H)=>s.jsx("div",{},`empty-${H}`)),Array.from({length:N}).map((D,H)=>{const B=H+1,ae=new Date(A,E,B),ue=p(ae),le=i===ue,fe=p(u)===ue,we=o?ue<o:!1;return s.jsx("button",{onClick:()=>L(B),disabled:we,className:`
                    aspect-square p-2 text-sm rounded-[6px] transition-colors
                    ${le?"bg-black text-white font-medium":""}
                    ${fe&&!le?"border border-primary text-primary font-medium":""}
                    ${we?"text-gray-300 cursor-not-allowed":"hover:bg-gray-100"}
                    ${!le&&!fe&&!we?"text-gray-700":""}
                  `,children:B},B)})]})]})]})]})}function Qb({label:t="When do you need this?",value:e,onChange:r,disabled:i=!1}){const[o,c]=j.useState(!1),l=y=>{y==="custom"&&c(!0),r({option:y,customDate:y==="custom"?e.customDate:void 0,time:y==="anytime"?void 0:e.time,timeOption:y==="anytime"?void 0:e.timeOption||"anytime"})},u=y=>{r({...e,option:"custom",customDate:y})},h=y=>{r({...e,timeOption:y,time:y==="anytime"?void 0:e.time||"09:00"})},f=y=>{r({...e,time:y,timeOption:"specific"})},g=e.option==="today"||e.option==="custom",p=y=>{if(!y)return"";const v=new Date(y);return`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][v.getMonth()]} ${v.getDate()}, ${v.getFullYear()}`};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"bg-white border border-gray-200 p-4",children:[s.jsxs("label",{className:"block text-sm mb-2 text-muted",children:[s.jsx(vu,{className:"w-4 h-4 inline mr-1 text-primary"}),t,s.jsx("span",{className:"text-gray-400 ml-1",children:"(optional)"})]}),s.jsx("div",{className:"flex gap-2 mb-3",children:["anytime","today","custom"].map(y=>s.jsx("button",{type:"button",onClick:()=>l(y),className:`flex-1 px-4 py-3 text-sm transition-colors ${e.option===y?"bg-black text-white font-medium":"bg-white text-gray-600 hover:text-black hover:bg-gray-100 border border-gray-200"}`,disabled:i,children:y==="anytime"?"Anytime":y==="today"?"Today":"Choose a date"},y))}),e.option==="custom"&&e.customDate&&s.jsxs("div",{className:"mb-3 p-3 bg-gray-50 border border-gray-200 rounded-[6px] flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(vu,{className:"w-4 h-4 text-primary"}),s.jsx("span",{className:"text-sm font-medium",children:p(e.customDate)})]}),s.jsx("button",{type:"button",onClick:()=>c(!0),className:"text-xs text-primary hover:text-primary/80",disabled:i,children:"Change"})]}),g&&s.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-200",children:[s.jsxs("label",{className:"block text-sm text-muted mt-3",children:[s.jsx(Ys,{className:"w-4 h-4 inline mr-1 text-primary"}),"What time? (IST)"]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{type:"button",onClick:()=>h("anytime"),className:`flex-1 px-4 py-3 text-sm transition-colors ${!e.timeOption||e.timeOption==="anytime"?"bg-black text-white font-medium":"bg-white text-gray-600 hover:text-black hover:bg-gray-100 border border-gray-200"}`,disabled:i,children:"Anytime"}),s.jsx("button",{type:"button",onClick:()=>h("specific"),className:`flex-1 px-4 py-3 text-sm transition-colors ${e.timeOption==="specific"?"bg-black text-white font-medium":"bg-white text-gray-600 hover:text-black hover:bg-gray-100 border border-gray-200"}`,disabled:i,children:"Specific time"})]}),e.timeOption==="specific"&&s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-xs text-muted",children:"Select time (IST)"}),s.jsx("input",{type:"time",value:e.time||"",onChange:y=>f(y.target.value),className:"w-full p-4 text-base border border-gray-200 rounded-[6px] cursor-pointer hover:border-gray-300 focus:outline-none focus:ring-2 focus:ring-primary/20 transition-colors",disabled:i,style:{minHeight:"48px"}})]}),s.jsx("p",{className:"text-xs text-gray-500",children:"You can discuss exact timing later in chat"})]}),e.option==="anytime"&&s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"You can discuss exact timing later in chat"})]}),s.jsx(H4,{isOpen:o,onClose:()=>c(!1),onSelect:u,selectedDate:e.customDate,minDate:new Date().toISOString().split("T")[0]})]})}function Wx(t){if(t.option==="anytime")return"asap";if(t.option==="today")return"today";if(t.option==="custom"&&t.customDate){const e=new Date;e.setDate(e.getDate()+1);const r=e.toISOString().split("T")[0];if(t.customDate===r)return"tomorrow";const i=new Date(t.customDate),o=new Date;if(o.setHours(0,0,0,0),i>o)return"tomorrow"}return"asap"}function G4(t){if(!t||t==="asap"||t==="anytime")return{option:"anytime"};if(t==="today")return{option:"today",timeOption:"anytime"};if(t==="tomorrow"){const r=new Date;return r.setDate(r.getDate()+1),{option:"custom",customDate:r.toISOString().split("T")[0],timeOption:"anytime"}}if(t.startsWith("today-")){const i=t.split("-")[1]||void 0;return{option:"today",time:i,timeOption:i?"specific":"anytime"}}const e=t.split("-");if(e.length>=3){const r=`${e[0]}-${e[1]}-${e[2]}`,i=e.length===5?`${e[3]}:${e[4]}`:void 0;return{option:"custom",customDate:r,time:i,timeOption:i?"specific":"anytime"}}return{option:"anytime"}}const Ll=t=>!t||t==="auto-detected"||t==="undefined"||t==="null"||!/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t)?null:t;function K4({onBack:t,onSuccess:e,onNavigate:r,isLoggedIn:i,isAdmin:o,userDisplayName:c,unreadCount:l,cities:u,editMode:h,wishId:f,wish:g}){const p=tt(),{location:y,updateLocation:v}=Fi(p?.id||null),[w,k]=j.useState(!1),[N,C]=j.useState(g?.description||""),[A,E]=j.useState(!1),[_,R]=j.useState([]),[L,P]=j.useState(g?.budgetMax?String(g.budgetMax):g?.budgetMin?String(g.budgetMin):""),[D,H]=j.useState({option:"anytime"}),[B,ae]=j.useState(g?.categoryId||""),[ue,le]=j.useState(g?.address||"");j.useEffect(()=>{(async()=>{const $=await oh();R($)})()},[]),j.useEffect(()=>{if(h&&g&&g.latitude&&g.longitude&&(!y?.latitude||!y?.longitude)){const I={cityId:null,city:g.city||"",areaId:g.area||g.city,area:g.area||g.city,latitude:g.latitude,longitude:g.longitude,address:g.address||"",locality:g.area,state:"",pincode:""};v(I),console.log(" [CreateWishScreen] Initialized location from wish data:",I)}},[h,g]);const fe=()=>{const I=N.toLowerCase();return I.includes("buy")||I.includes("purchase")?"buy-something":I.includes("rent")||I.includes("lease")?"rent-something":I.includes("used")||I.includes("second hand")?"find-used":I.includes("service")||I.includes("professional")?"find-service":I.includes("help")||I.includes("need someone")?"find-help":I.includes("deal")||I.includes("cheap")?"find-deal":null},we=()=>{const I=N.toLowerCase();return I.includes("bike")||I.includes("scooter")?"50000":I.includes("car")?"300000":I.includes("phone")||I.includes("mobile")?"20000":I.includes("laptop")?"40000":I.includes("furniture")?"15000":""},oe=()=>{const I=fe(),$=we();I&&!B&&(ae(String(I)),J.success(" Category suggested!")),$&&!L&&(P($),J.success(" Budget suggested!"))},Y=async I=>{if(I.preventDefault(),!N.trim()){J.error("Please tell us what you are looking for");return}if(!y||!y.latitude||!y.longitude){J.error("Please set your location first");return}if(!ue.trim()){J.error("Please enter your full address");return}if(!p){J.error("Please login to post a wish");return}k(!0);try{const $=N.trim().split(`
`),W=$[0].slice(0,50),T=$.length>1?$.slice(1).join(`
`).trim():N.trim(),z=y.latitude,G=y.longitude;if(h&&f){const M=await o4(f,{title:W,description:T,categoryId:B?typeof B=="number"?B:parseInt(B):void 0,budgetMin:L?parseFloat(L):void 0,budgetMax:L?parseFloat(L):void 0,urgency:"flexible",latitude:z,longitude:G,address:ue.trim(),phone:"",whatsapp:"",hasWhatsapp:!1});if(!M.success)throw new Error(M.error||"Failed to update wish");J.success(" Wish updated successfully!"),r("wish-detail",{wishId:f})}else{const M=await a4({title:W,description:T,categoryId:B?typeof B=="number"?B:parseInt(B):_[0]?.id||1,cityId:Ll(y.cityId),areaId:Ll(y.areaId),cityName:y.city,areaName:y.area||y.city,budgetMin:L?parseFloat(L):void 0,budgetMax:L?parseFloat(L):void 0,urgency:"flexible",latitude:z,longitude:G,address:ue.trim(),phone:"",whatsapp:"",hasWhatsapp:!1});if(!M.success||!M.wishId)throw new Error(M.error||"Failed to create wish");const X=await zy(M.wishId,W,p.id,p.name||"User");X.error&&console.warn("Failed to create chat thread:",X.error),J.success(" Wish posted! Chat is ready for responses."),oc(),e()}}catch($){console.error("Failed to create wish:",$),J.error($.message||"Failed to create wish")}finally{k(!1)}};return s.jsxs("div",{className:"min-h-screen bg-white pb-20 sm:pb-0",children:[s.jsx(rt,{title:h?"Edit Wish":"Wish Anything",currentScreen:"create",showBack:!0,onBack:t,onNavigate:r,isLoggedIn:i,isAdmin:o,userDisplayName:c,unreadCount:l,showGlobalLocation:!0,globalLocationArea:y?.area,globalLocationCity:y?.city,onLocationClick:()=>E(!0)}),s.jsx("div",{className:"page-container max-w-2xl",children:s.jsxs("form",{onSubmit:Y,className:"space-y-4",children:[s.jsxs("div",{className:"bg-white border border-gray-200 p-4",children:[s.jsxs("label",{className:"block text-sm mb-2 text-muted",children:[s.jsx(mt,{className:"w-4 h-4 inline mr-1 text-primary"}),"What are you looking for?"]}),s.jsx("textarea",{value:N,onChange:I=>C(I.target.value),placeholder:"looking for a laptop under 10k",className:"w-full p-3 border border-border rounded-[6px] focus:outline-none focus:ring-2 focus:ring-primary/20",rows:5,disabled:w}),N.length>20&&!B&&s.jsxs("button",{type:"button",onClick:oe,className:"mt-2 text-sm text-primary hover:text-primary/80 flex items-center gap-1",children:[s.jsx(mt,{className:"w-3 h-3"}),"Get AI suggestions"]})]}),s.jsx(Qb,{value:D,onChange:H,disabled:w}),s.jsxs("div",{className:"bg-white border border-gray-200 p-4",children:[s.jsx("label",{className:"block text-sm mb-2 text-muted",children:"Budget (Optional)"}),s.jsx("input",{type:"number",value:L,onChange:I=>P(I.target.value),placeholder:"10000",className:"w-full p-3 border border-border rounded-[6px] focus:outline-none focus:ring-2 focus:ring-primary/20",disabled:w}),s.jsx("p",{className:"text-xs text-gray-500 mt-2 m-0",children:" Leave blank for flexible budget"})]}),s.jsxs("div",{className:"bg-white border border-gray-200 p-4",children:[s.jsx("label",{className:"block text-sm mb-3 text-muted",children:"Category (Optional)"}),s.jsx(cc,{categories:_,selectedCategoryId:B,onCategoryChange:I=>ae(I)})]}),s.jsxs("div",{className:"bg-white border border-gray-200 p-4",children:[s.jsxs("label",{className:"block text-sm mb-2 text-muted",children:[s.jsx(ds,{className:"w-4 h-4 inline mr-1 text-primary"}),"Location ",s.jsx("span",{className:"text-red-500",children:"*"})]}),y&&y.latitude&&y.longitude?s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{type:"button",onClick:()=>E(!0),className:"w-full p-4 bg-white border-2 border-gray-200 hover:border-[#CDFF00] transition-colors text-left flex items-start justify-between gap-3",style:{borderRadius:"8px"},children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("svg",{className:"w-5 h-5 text-[#CDFF00] flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})}),s.jsxs("p",{className:"text-[15px] text-black",style:{fontWeight:"700"},children:[y.area,", ",y.city]})]}),y.address&&s.jsx("p",{className:"text-[13px] text-gray-600 truncate",style:{fontWeight:"500"},children:y.address})]}),s.jsx("svg",{className:"w-5 h-5 text-gray-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),s.jsx("p",{className:"text-[12px] text-gray-500 mt-1.5",style:{fontWeight:"600"},children:"Tap to change your location"}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-[14px] text-black mb-2",style:{fontWeight:"700"},children:["Full Address ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("textarea",{value:ue,onChange:I=>le(I.target.value),placeholder:`Building name, floor, street details...

E.g., Shop #12, 2nd Floor, 8th Cross, 29th Main Road
Above Cafe Coffee Day`,className:"w-full px-4 py-3 bg-white border-2 border-gray-200 text-black placeholder-gray-400 focus:outline-none focus:border-[#CDFF00] transition-colors resize-none",style:{borderRadius:"8px",fontSize:"15px",fontWeight:"500",minHeight:"120px"},rows:5,disabled:w}),s.jsx("p",{className:"text-[12px] text-gray-500 mt-1.5",style:{fontWeight:"600"},children:"Add specific details like building name, floor, nearby landmarks"})]})]}):s.jsxs("div",{className:"p-4 bg-red-50 border-2 border-red-200",style:{borderRadius:"8px"},children:[s.jsx("p",{className:"text-[14px] text-red-600 mb-3",style:{fontWeight:"700"},children:" Location Not Set"}),s.jsx("p",{className:"text-[13px] text-red-600 mb-3",style:{fontWeight:"500"},children:"Please set your location from the header first."}),s.jsx("button",{type:"button",onClick:()=>E(!0),className:"w-full py-2.5 px-4 bg-[#CDFF00] text-black hover:bg-[#b8e600] transition-colors",style:{borderRadius:"6px",fontSize:"14px",fontWeight:"700"},children:"Set Location Now"})]})]}),s.jsx("button",{type:"submit",disabled:w||!N.trim(),className:"btn-primary w-full py-3 disabled:opacity-50",style:{color:"#000000"},children:w?h?"Updating...":"Posting...":h?"Update Wish":"Post Wish & Start Chat"}),s.jsx("button",{type:"button",onClick:t,disabled:w,className:"btn-outline w-full py-3",children:"Cancel"})]})}),A&&s.jsx(ao,{onLocationSelect:async I=>{const $={cityId:Ll(I.cityId),city:I.city,areaId:Ll(I.locality||I.city),area:I.locality||I.city,latitude:I.latitude,longitude:I.longitude,address:I.address,locality:I.locality,state:I.state,pincode:I.pincode};await v($),E(!1),J.success("Location updated! ")},onClose:()=>E(!1),currentLocation:y&&y.latitude?{latitude:y.latitude,longitude:y.longitude,city:y.city}:null,title:"Set Your Location",description:"Choose your location to post your wish"})]})}function Y4({wishId:t,onBack:e,onNavigate:r,isLoggedIn:i,onLoginRequired:o,currentUserId:c,showGlobalLocation:l,globalLocationArea:u,globalLocationCity:h,onLocationClick:f,onMenuClick:g,notificationCount:p,onNotificationClick:y,userCoordinates:v}){const[w,k]=j.useState(null),[N,C]=j.useState(!0),[A,E]=j.useState(!1),[_,R]=j.useState([]),[L,P]=j.useState(!0),[D,H]=j.useState(!0);j.useEffect(()=>{(async()=>{try{C(!0);const[Y,I]=await Promise.all([i4(t,v?.latitude,v?.longitude),oh()]);if(k(Y),R(I),Y){const $=Y.userId||Y.owner_token;if(!$)P(!1);else try{const W=await em($);P(!!W)}catch(W){console.error(" Error checking wish owner profile:",W),P(!1)}}}catch(Y){console.error("Failed to load wish:",Y),J.error("Failed to load wish details")}finally{C(!1),H(!1)}})()},[t,v]);const B=async()=>{if(!i){o();return}if(w)try{const{conversation:oe,error:Y}=await Di(w.id,w.title,void 0,w.budgetMax||w.budgetMin||0,w.userId,w.userName,w.userAvatar,"wish");if(Y){J.error(Y);return}oe&&r("chat",{conversationId:oe.id})}catch(oe){console.error("Error opening chat:",oe),J.error("Failed to open chat")}},ae=()=>{if(!w?.latitude||!w?.longitude){J.error("Location not available");return}const oe=`https://www.google.com/maps/dir/?api=1&destination=${w.latitude},${w.longitude}`;window.open(oe,"_blank")},ue=oe=>{switch(oe){case"asap":return"ASAP";case"today":return"Today";case"flexible":return"Flexible";default:return oe}},le=oe=>{switch(oe){case"asap":return"bg-red-100 text-red-700";case"today":return"bg-[#CDFF00] text-black";case"flexible":return"bg-green-100 text-green-700";default:return"bg-gray-100 text-gray-700"}};if(N)return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(rt,{title:"Wish Details",showBack:!0,onBack:e,currentScreen:"wish-detail",onNavigate:r,isLoggedIn:i,showGlobalLocation:l,globalLocationArea:u,globalLocationCity:h,onLocationClick:f,onMenuClick:g,notificationCount:p,onNotificationClick:y}),s.jsx("div",{className:"page-container py-4",children:s.jsx(ln,{count:1})})]});if(!w)return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(rt,{title:"Wish Details",showBack:!0,onBack:e,currentScreen:"wish-detail",onNavigate:r,isLoggedIn:i,showGlobalLocation:l,globalLocationArea:u,globalLocationCity:h,onLocationClick:f,onMenuClick:g,notificationCount:p,onNotificationClick:y}),s.jsx("div",{className:"page-container py-8 text-center",children:s.jsx("p",{className:"text-muted",children:"Wish not found"})})]});const fe=_.find(oe=>String(oe.id)===String(w.categoryId))||_[0],we=c===w.userId;return w.acceptedBy,w.status==="accepted"||w.status==="in_progress"||w.status,s.jsxs("div",{className:"min-h-screen bg-background pb-28",children:[s.jsx("div",{className:"sticky top-0 z-40",children:s.jsx(rt,{title:"Wish Details",showBack:!0,onBack:e,currentScreen:"wish-detail",onNavigate:r,isLoggedIn:i,showGlobalLocation:l,globalLocationArea:u,globalLocationCity:h,onLocationClick:f,onMenuClick:g,notificationCount:p,onNotificationClick:y})}),s.jsxs("div",{className:"page-container py-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between gap-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl",children:fe?.emoji}),s.jsx("span",{className:"text-sm text-muted",children:fe?.name})]}),s.jsxs("span",{className:"px-3 py-1.5 bg-green-100 text-green-700 rounded-full text-xs font-medium flex items-center gap-1",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Open"]})]}),s.jsx("h1",{className:"text-heading text-2xl",children:w.title}),s.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[w.budgetMin||w.budgetMax?s.jsxs("div",{className:"flex items-center gap-1.5 px-4 py-2 bg-primary/10 text-primary rounded-lg",children:[s.jsx(Xa,{className:"w-5 h-5"}),s.jsx("span",{className:"font-bold",children:w.budgetMin&&w.budgetMax?`${w.budgetMin.toLocaleString("en-IN")} - ${w.budgetMax.toLocaleString("en-IN")}`:w.budgetMin?`From ${w.budgetMin.toLocaleString("en-IN")}`:`Up to ${w.budgetMax?.toLocaleString("en-IN")}`})]}):null,s.jsxs("div",{className:`flex items-center gap-1.5 px-3 py-2 rounded-lg ${le(w.urgency)}`,children:[s.jsx(Ys,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:ue(w.urgency)})]})]}),s.jsxs("div",{className:"bg-white rounded border border-border p-4",children:[s.jsx("h3",{className:"text-sm font-semibold mb-2 text-muted",children:"What they're looking for"}),s.jsx("p",{className:"text-body whitespace-pre-wrap",children:w.description})]}),w.latitude&&w.longitude&&s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>E(!1),className:`px-4 py-2 rounded-[4px] transition-colors ${A?"bg-white border border-border text-foreground hover:border-primary":"bg-black text-white"}`,children:"Details"}),s.jsx("button",{onClick:()=>E(!0),className:`px-4 py-2 rounded-[4px] transition-colors ${A?"bg-black text-white":"bg-white border border-border text-foreground hover:border-primary"}`,children:"Map View"})]}),A?s.jsx("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",style:{height:"400px"},children:s.jsx(mc,{markers:[{id:w.id,latitude:w.latitude,longitude:w.longitude,title:w.title,price:w.budgetMax||w.budgetMin,type:"wish",categoryEmoji:fe?.emoji,status:w.status}],onMarkerClick:()=>{},centerLat:w.latitude,centerLng:w.longitude})}):s.jsxs("div",{className:"bg-white rounded border border-border p-4",children:[s.jsx("h3",{className:"text-sm font-semibold mb-2 text-muted",children:"Location"}),s.jsxs("div",{className:"flex items-start gap-2 text-body",children:[s.jsx(ds,{className:"w-5 h-5 text-primary shrink-0 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-medium",children:w.areaName}),s.jsx("p",{className:"text-sm text-muted",children:w.cityName}),w.distance!==void 0&&w.distance!==null&&s.jsxs("p",{className:"font-extrabold mt-2",style:{backgroundColor:"#CDFF00",color:"#000000",fontSize:"14px",display:"inline-block",padding:"4px 8px",borderRadius:"6px"},children:["~",w.distance.toFixed(1)," km away"]}),w.address&&s.jsxs("div",{className:"mt-3 p-3 bg-gray-50 border border-gray-200",style:{borderRadius:"8px"},children:[s.jsx("p",{className:"text-[12px] text-gray-500 mb-1",style:{fontWeight:"600"},children:"Full Address"}),s.jsx("p",{className:"text-[14px] text-black whitespace-pre-wrap",style:{fontWeight:"500"},children:w.address})]}),w.latitude&&w.longitude&&s.jsxs("button",{onClick:ae,className:"mt-2 flex items-center gap-1 text-primary hover:underline text-sm font-medium",children:[s.jsx(Jx,{className:"w-3 h-3"}),"Open in Google Maps"]})]})]})]}),s.jsxs("div",{className:"bg-white rounded border border-border p-4",children:[s.jsx("h3",{className:"text-sm font-semibold mb-2 text-muted",children:"Posted by"}),s.jsxs("div",{className:"flex items-center gap-3",children:[w.userAvatar?s.jsx("img",{src:w.userAvatar,alt:w.userName,className:"w-10 h-10 rounded-full object-cover"}):s.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center",children:s.jsx("span",{className:"text-primary font-semibold",children:w.userName?.charAt(0).toUpperCase()})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-medium text-heading",children:w.userName}),s.jsx("p",{className:"text-sm text-muted",children:new Date(w.createdAt).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"})})]})]})]}),!we&&i&&L&&s.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:s.jsxs("p",{className:"text-xs text-gray-700",children:[" ",s.jsx("strong",{children:"LocalFelo is a connector platform."})," Chat safely. Share personal details only if you're comfortable. Payments and details are handled directly between users."]})}),!we&&!L&&!D&&s.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3",children:s.jsx("p",{className:"text-xs text-orange-700",children:" This wish was posted by a user whose account is no longer active. You cannot chat with them."})})]}),!we&&L&&!D&&s.jsx("div",{className:"fixed bottom-16 md:bottom-12 left-0 right-0 bg-white border-t border-border p-4 sm:p-6 z-40 safe-bottom",children:s.jsx("div",{className:"max-w-4xl mx-auto",children:s.jsxs("button",{onClick:B,className:"w-full px-6 py-3.5 bg-primary text-white rounded-lg font-semibold hover:bg-primary-dark transition-colors flex items-center justify-center gap-2",children:[s.jsx(ct,{className:"w-5 h-5"}),"Chat with Wisher"]})})}),we&&w.status!=="completed"&&w.status!=="fulfilled"&&s.jsx("div",{className:"fixed bottom-16 md:bottom-12 left-0 right-0 bg-white border-t border-border p-4 sm:p-6 z-40 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto flex items-center gap-3",children:[s.jsxs("button",{onClick:()=>r("create-wish",{editMode:!0,wishId:w.id,wish:w}),className:"flex-1 px-6 py-3.5 bg-primary text-white rounded-lg font-semibold hover:bg-primary-dark transition-colors flex items-center justify-center gap-2",children:[s.jsx(ay,{className:"w-5 h-5"}),"Edit Wish"]}),s.jsxs("button",{onClick:async()=>{if(!confirm("Are you sure you want to delete this wish?"))return;const oe=await l4(w.id);oe.success?(J.success("Wish deleted successfully"),e()):J.error(oe.error||"Failed to delete wish")},className:"px-6 py-3.5 bg-red-500 text-white rounded-lg font-semibold hover:bg-red-600 transition-colors flex items-center justify-center gap-2",children:[s.jsx(Ls,{className:"w-5 h-5"}),"Delete"]})]})})]})}function Zu({task:t,onClick:e,onChatClick:r}){console.log(`[TaskCard] "${t.title}":`,{price:t.price,isNegotiable:t.isNegotiable,distance:t.distance,lat:t.latitude,lon:t.longitude});const i=c=>{switch(c){case"negotiating":return"bg-blue-50 text-blue-700";case"open":return"bg-[#CDFF00] text-black";case"accepted":return"bg-blue-50 text-blue-700";case"in_progress":return"bg-[#CDFF00]/60 text-black";case"completed":return"bg-gray-50 text-gray-700";case"closed":return"bg-red-50 text-red-700";default:return"bg-gray-50 text-gray-700"}},o=c=>{const u=new Date().getTime()-c.getTime(),h=Math.floor(u/6e4),f=Math.floor(h/60),g=Math.floor(f/24);return h<60?`${h}m`:f<24?`${f}h`:`${g}d`};return s.jsxs("div",{className:"bg-white border border-gray-200 p-4 cursor-pointer hover:border-black hover:shadow-sm transition-all flex flex-col",onClick:e,style:{minHeight:"160px",borderRadius:"8px"},children:[s.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[s.jsx("h3",{className:"font-bold text-gray-900 text-base leading-tight flex-1 line-clamp-2",children:t.title}),s.jsx("span",{className:`px-2 py-0.5 rounded text-[9px] font-bold uppercase shrink-0 ${i(t.status)}`,children:"OPEN"})]}),s.jsx("div",{className:"mb-3",children:t.price!==void 0&&t.price!==null&&t.price>0?s.jsxs("div",{className:"inline-flex items-center gap-1.5",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Earn"}),s.jsxs("span",{className:"text-base font-black px-2.5 py-1 rounded",style:{backgroundColor:"#CDFF00",color:"#000000"},children:["",t.price.toLocaleString("en-IN")]})]}):s.jsx("span",{className:"text-sm font-semibold text-gray-600",children:t.isNegotiable?"Negotiable":"Price not specified"})}),s.jsxs("div",{className:"flex items-center gap-1.5 mb-3",children:[s.jsx(ds,{className:"w-3.5 h-3.5 text-gray-400 shrink-0"}),s.jsx("span",{className:"text-xs text-gray-600 truncate",children:(()=>{const c=t.areaName&&t.areaName!=="Unknown"?t.areaName:"",l=t.cityName&&t.cityName!=="Unknown"?t.cityName:"",u=[c,l].filter(Boolean).join(", ");return u||(t.address?t.address.split(",").map(f=>f.trim()).filter(Boolean).slice(0,2).join(", ")||t.address:"Location not set")})()})]}),s.jsxs("div",{className:"flex items-center justify-between gap-2 mt-auto pt-2 border-t border-gray-100",children:[s.jsx("div",{children:t.distance!==void 0&&t.distance!==null&&s.jsxs("span",{className:"text-xs font-bold text-black",children:[" ",t.distance.toFixed(1)," km"]})}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Ys,{className:"w-3 h-3 text-gray-400"}),s.jsx("span",{className:"text-xs text-gray-500",children:o(new Date(t.createdAt))})]})]})]})}function J4({task:t,onClick:e}){const i=(c=>{switch(c){case"negotiating":return{label:"Negotiating",color:"bg-yellow-50 border-yellow-200 text-yellow-800",icon:ct,description:"Discussing terms with poster"};case"accepted":return{label:"Accepted",color:"bg-blue-50 border-blue-200 text-blue-800",icon:Gx,description:"Ready to start work"};case"in_progress":return{label:"In Progress",color:"bg-blue-50 border-blue-200 text-blue-800",icon:Ys,description:"Work in progress"};default:return{label:"Open",color:"bg-green-50 border-green-200 text-green-800",icon:Ys,description:"Available for acceptance"}}})(t.status),o=i.icon;return s.jsxs("div",{onClick:e,className:"bg-white border-2 border-[#CDFF00] p-3 sm:p-4 cursor-pointer hover:border-black transition-all",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-3",children:[s.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-[#CDFF00] animate-pulse"}),s.jsx("span",{className:"text-[10px] sm:text-xs font-semibold text-black uppercase tracking-wider",children:"Active Task"})]}),s.jsxs("div",{className:`flex items-center gap-1 px-1.5 sm:px-2 py-0.5 sm:py-1 rounded-[4px] text-[10px] sm:text-xs font-medium border ${i.color}`,children:[s.jsx(o,{className:"w-3 h-3"}),s.jsx("span",{children:i.label})]})]}),s.jsxs("div",{className:"flex items-start gap-2 sm:gap-3",children:[s.jsx("div",{className:"text-2xl sm:text-3xl",children:t.categoryEmoji}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-semibold text-gray-900 truncate mb-0.5 sm:mb-1 text-sm sm:text-base",children:t.title}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mb-1.5 sm:mb-2 line-clamp-2",children:t.description}),s.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3 text-xs sm:text-sm",children:[s.jsxs("div",{className:"flex items-center gap-1 text-black font-bold",children:[s.jsx(Xa,{className:"w-3 h-3 sm:w-4 sm:h-4"}),s.jsxs("span",{children:["",t.acceptedPrice||t.price]})]}),s.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[s.jsx(ds,{className:"w-3 h-3 sm:w-4 sm:h-4"}),s.jsx("span",{className:"text-[11px] sm:text-sm",children:t.areaName})]}),s.jsxs("div",{className:"flex items-center gap-1 text-gray-500",children:[s.jsx(Ys,{className:"w-3 h-3 sm:w-4 sm:h-4"}),s.jsx("span",{className:"text-[10px] sm:text-xs",children:Ii(new Date(t.acceptedAt||t.createdAt))})]})]})]})]}),s.jsx("div",{className:"mt-2 sm:mt-3 pt-2 sm:pt-3 border-t border-gray-100",children:s.jsxs("p",{className:"text-[10px] sm:text-xs text-gray-500",children:[i.description,"  Tap to open chat"]})})]})}function Q4({user:t,onNavigate:e,isLoggedIn:r,isAdmin:i,userDisplayName:o,unreadCount:c,cities:l,showGlobalLocation:u,globalLocationArea:h,globalLocationCity:f,onLocationClick:g,onMenuClick:p,notificationCount:y,onNotificationClick:v,userCoordinates:w,onLoginRequired:k,onContactClick:N,socialLinks:C}){const[A,E]=j.useState([]),[_,R]=j.useState([]),[L,P]=j.useState([]),[D,H]=j.useState(!1),[B,ae]=j.useState(!1),[ue,le]=j.useState(!0),[fe,we]=j.useState(!1),[oe,Y]=j.useState([]),[I,$]=j.useState("list"),[W,T]=j.useState(""),[z,G]=j.useState(""),[M,X]=j.useState(""),[ie,be]=j.useState(""),[ve,ee]=j.useState(""),[ce,Ue]=j.useState("");Fi(t?.id||null),j.useEffect(()=>{(async()=>{const ne=await lh();Y(ne)})()},[]),j.useEffect(()=>{he(),r&&t?.id&&Le()},[w,z,M,ie,ve,r,t?.id,f,h,ce]);const he=async()=>{try{le(!0);let re=M,ne=ie;const Oe={categoryId:z?.toString()||void 0,cityId:re||void 0,areaId:ne||void 0,status:ve||void 0};console.log(" [TasksScreen] Loading tasks from ALL cities with filters:",{...Oe,note:"Showing all tasks everywhere, sorted by distance (nearest first)"}),w?(Oe.userLat=w.latitude,Oe.userLon=w.longitude,console.log(" [TasksScreen] User coordinates AVAILABLE:",w)):console.log(" [TasksScreen] User coordinates NOT SET - distance will not show. Set location to see distances.");const He=await Yb(Oe);E(He)}catch(re){console.error("Failed to load tasks:",re)}finally{le(!1)}},Le=async()=>{try{const re=await Wb(t?.id||"");R(re)}catch(re){console.error("Failed to load active tasks:",re)}},Ke=async()=>{try{ae(!0);const re=await Zh(t?.id||"");P(re)}catch(re){console.error("Failed to load my tasks:",re)}finally{ae(!1)}},at=l.find(re=>re.id===M);return s.jsxs("div",{className:"min-h-screen bg-background pb-20 md:pb-0",children:[s.jsx(rt,{title:"Tasks",currentScreen:"tasks",onNavigate:e,isLoggedIn:r||!1,isAdmin:i||!1,userDisplayName:o,unreadCount:c,showGlobalLocation:u,globalLocationArea:h,globalLocationCity:f,onLocationClick:g,onMenuClick:p,notificationCount:y,onNotificationClick:v}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:[s.jsx("div",{className:"bg-white border border-gray-200 p-4 sm:p-6 mb-4",children:s.jsxs("div",{className:"flex items-center justify-between gap-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-lg flex items-center justify-center shrink-0",style:{backgroundColor:"#CDFF00"},children:s.jsx(Ot,{className:"w-4 h-4 sm:w-5 sm:h-5 text-black"})}),s.jsx("h1",{className:"text-lg sm:text-xl m-0",style:{fontWeight:"700"},children:"Available Tasks Near You"})]}),s.jsx("p",{className:"text-xs sm:text-sm text-gray-600 m-0",children:"Accept tasks from people nearby and earn by helping them"})]}),s.jsxs("button",{onClick:()=>{if(!r&&k){k();return}e("create-task")},className:"btn-primary flex items-center gap-1.5 px-3 py-2 sm:px-4 sm:py-2.5 shrink-0",style:{borderRadius:"6px",width:"auto",minWidth:"fit-content"},children:[s.jsx(Pa,{className:"w-4 h-4"}),s.jsx("span",{className:"whitespace-nowrap text-sm sm:text-base",children:"Post Task"})]})]})}),s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(mt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Smart search tasks...",value:W,onChange:re=>T(re.target.value),className:"w-full pl-10 pr-10 py-2.5 bg-white border border-gray-200 rounded-[6px] text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"}),W&&s.jsx("button",{onClick:()=>T(""),className:"absolute right-3 top-1/2 -translate-y-1/2 hover:bg-gray-100 rounded-full p-1 transition-colors",children:s.jsx(ut,{className:"w-4 h-4 text-gray-400 hover:text-black"})})]}),r&&t&&s.jsxs("button",{onClick:()=>{H(!0),Ke()},className:"flex items-center gap-1.5 px-3 py-2.5 bg-white border border-gray-200 rounded-[6px] shrink-0 hover:bg-gray-50 transition-colors text-sm",children:[s.jsx(Js,{className:"w-4 h-4 text-black"}),s.jsx("span",{className:"text-black whitespace-nowrap",children:"My Tasks"})]}),s.jsxs("button",{onClick:()=>we(!fe),className:"flex items-center gap-1.5 px-3 py-2.5 bg-white border border-gray-200 rounded-[6px] shrink-0 hover:bg-gray-50 transition-colors text-sm",children:[s.jsx(uy,{className:"w-4 h-4 text-black"}),s.jsx("span",{className:"hidden sm:inline text-black whitespace-nowrap",children:"Filters"}),(z||M||ie||ve||ce)&&s.jsx("span",{className:"bg-primary text-black text-xs px-1.5 py-0.5 rounded-full font-bold",children:[z,M,ie,ve,ce].filter(Boolean).length})]})]}),s.jsx("div",{className:"mb-3",children:s.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2 hide-scrollbar",children:[s.jsx("button",{onClick:()=>G(""),className:`px-3 py-2 rounded-full text-sm whitespace-nowrap transition-colors ${z?"bg-white text-gray-600 hover:text-black hover:bg-gray-50 border border-gray-200":"bg-black text-white font-medium"}`,children:"All"}),oe.map(re=>s.jsxs("button",{onClick:()=>G(re.id),className:`px-3 py-2 rounded-full text-sm whitespace-nowrap transition-colors ${z===re.id?"bg-black text-white font-medium":"bg-white text-gray-600 hover:text-black hover:bg-gray-50 border border-gray-200"}`,children:[re.emoji," ",re.name]},re.id))]})}),fe&&s.jsxs("div",{className:"bg-white border border-gray-200 rounded-[6px] p-4 mb-3 space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h4",{className:"text-sm font-medium",children:"Filters"}),(z||M||ie||ve||ce)&&s.jsx("button",{onClick:()=>{G(""),X(""),be(""),ee(""),Ue("")},className:"text-xs text-primary hover:underline",children:"Clear all"})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[s.jsxs(lr,{label:"Distance",value:ce,onChange:Ue,children:[s.jsx("option",{value:"",children:"Any Distance"}),s.jsx("option",{value:"1",children:"Within 1 km"}),s.jsx("option",{value:"5",children:"Within 5 km"}),s.jsx("option",{value:"10",children:"Within 10 km"}),s.jsx("option",{value:"25",children:"Within 25 km"})]}),s.jsxs(lr,{label:"City",value:M,onChange:re=>{X(re),be("")},children:[s.jsx("option",{value:"",children:"All Cities"}),l.map(re=>s.jsx("option",{value:re.id,children:re.name},re.id))]}),at&&s.jsxs(lr,{label:"Area",value:ie,onChange:be,children:[s.jsx("option",{value:"",children:"All Areas"}),at.areas?.map(re=>s.jsx("option",{value:re.id,children:re.name},re.id))]}),s.jsxs(lr,{label:"Status",value:ve,onChange:ee,children:[s.jsx("option",{value:"",children:"All Status"}),s.jsx("option",{value:"open",children:"Open"}),s.jsx("option",{value:"accepted",children:"Accepted"}),s.jsx("option",{value:"in_progress",children:"In Progress"}),s.jsx("option",{value:"completed",children:"Completed"})]})]})]}),r&&_.length>0&&s.jsxs("div",{className:"mb-3",children:[s.jsxs("h3",{className:"text-sm font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[s.jsx("span",{children:""}),s.jsx("span",{children:"Your Active Tasks"}),s.jsx("span",{className:"bg-[#CDFF00] text-black text-xs px-1.5 py-0.5 rounded-full font-bold",children:_.length})]}),s.jsx("div",{className:"space-y-1",children:_.map(re=>s.jsx(J4,{task:re,onClick:()=>{e("task-detail",{taskId:re.id})}},re.id))})]}),I==="list"&&s.jsx(s.Fragment,{children:ue?s.jsxs("div",{className:"bg-white rounded-xl p-8 text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#CDFF00] mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Loading tasks..."})]}):A.length===0?s.jsxs("div",{className:"bg-white rounded-xl p-8",children:[s.jsx(Qs,{type:"no-results",message:z||M||ie?"No tasks found with current filters. Try adjusting your search.":t?"No tasks from other users yet. Tasks you create won't appear here.":"No tasks available yet. Be the first to post one!",action:r?s.jsx("button",{onClick:()=>e("create-task"),className:"px-6 py-3 bg-[#CDFF00] text-black font-bold rounded-[4px] hover:bg-[#b8e600] transition-colors",children:"Post a Task"}):void 0}),t&&A.length===0&&!z&&!M&&s.jsxs("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-[4px] text-sm text-blue-900",children:[s.jsx("p",{className:"font-medium mb-1",children:" Tip:"}),s.jsx("p",{children:"This view only shows tasks from other users. To see your own tasks, go to Profile  My Tasks."})]})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:A.map(re=>s.jsx(Zu,{task:re,onClick:()=>e("task-detail",{taskId:re.id}),currentUserId:t?.id,onChatClick:r&&t?.id!==re.userId?async()=>{const{conversation:ne,error:Oe}=await Di(re.id,re.title,void 0,re.price||re.budgetMax||re.budgetMin,re.userId,re.userName,re.userAvatar,"task");if(Oe){J.error(Oe);return}ne&&e("chat",{conversationId:ne.id})}:void 0},re.id))})}),I==="map"&&s.jsx("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden relative z-0",style:{height:"500px"},children:ue?s.jsx("div",{className:"flex items-center justify-center h-full",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#CDFF00]"})}):A.length===0?s.jsx("div",{className:"flex items-center justify-center h-full p-8",children:s.jsx(Qs,{type:"no-results",message:"No tasks to show on map"})}):s.jsx(mc,{markers:A.filter(re=>re.latitude&&re.longitude).map(re=>({id:re.id,latitude:re.latitude,longitude:re.longitude,title:re.title,price:re.price,type:"task",categoryEmoji:oe.find(ne=>String(ne.id)===String(re.categoryId))?.emoji,status:re.status})),onMarkerClick:re=>{e("task-detail",{taskId:re})},userLocation:w})})]}),A.length>0&&s.jsxs("div",{className:"fixed right-4 bottom-24 sm:bottom-6 z-40 flex flex-col gap-2 shadow-2xl rounded-[4px] overflow-hidden",children:[s.jsx("button",{onClick:()=>$("list"),className:`w-12 h-12 flex items-center justify-center transition-all ${I==="list"?"bg-black text-white":"bg-white text-foreground border-b border-border"}`,title:"List View",children:s.jsx(ry,{className:"w-5 h-5"})}),s.jsx("button",{onClick:()=>$("map"),className:`w-12 h-12 flex items-center justify-center transition-all ${I==="map"?"bg-black text-white":"bg-white text-foreground"}`,title:"Map View",children:s.jsx(iy,{className:"w-5 h-5"})})]}),s.jsx(Ar,{isOpen:D,onClose:()=>H(!1),title:"My Tasks",children:s.jsx("div",{className:"max-h-[70vh] overflow-y-auto",children:B?s.jsx("div",{className:"space-y-3 p-4",children:s.jsx(ln,{count:3})}):L.length===0?s.jsx("div",{className:"p-8",children:s.jsx(Qs,{icon:Ot,title:"No tasks yet",description:"You haven't created any tasks yet. Post a task to get help from your local community!",action:s.jsxs("button",{onClick:()=>{H(!1),e("create-task")},className:"btn-primary px-6 py-3 rounded-xl",children:[s.jsx(Pa,{className:"w-4 h-4 inline mr-2"}),"Post a Task"]})})}):s.jsxs(s.Fragment,{children:[L.filter(re=>["accepted","in_progress"].includes(re.status||"")).length>0&&s.jsxs("div",{className:"mb-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-gray-900 px-4 py-2 bg-gray-50 sticky top-0 z-10",children:["Active Tasks (",L.filter(re=>["accepted","in_progress"].includes(re.status||"")).length,")"]}),s.jsx("div",{className:"space-y-2 p-2",children:L.filter(re=>["accepted","in_progress"].includes(re.status||"")).map(re=>s.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-4 hover:shadow-md transition-shadow",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>{H(!1),e("task-detail",{taskId:re.id})},children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("h3",{className:"font-semibold",children:re.title}),s.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${re.status==="accepted"?"bg-blue-50 text-blue-700":re.status==="in_progress"?"bg-[#CDFF00] text-black":"bg-gray-50 text-gray-700"}`,children:re.status==="in_progress"?"In Progress":re.status})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-2 line-clamp-2",children:re.description}),re.price&&s.jsx("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded",style:{backgroundColor:"#CDFF00"},children:s.jsxs("span",{className:"text-xs font-bold text-black",children:["Earn ",re.price.toLocaleString("en-IN")]})})]}),s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsxs("button",{onClick:()=>{H(!1),e("create-task",{editMode:!0,taskId:re.id,task:re})},className:"px-3 py-1.5 text-xs border border-primary text-primary rounded-lg hover:bg-primary/10 transition-colors flex items-center gap-1",children:[s.jsx(Ea,{className:"w-3 h-3"}),"Edit"]}),s.jsx("button",{onClick:()=>{H(!1),e("task-detail",{taskId:re.id})},className:"px-3 py-1.5 text-xs bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:"View"})]})]})},re.id))})]}),L.filter(re=>re.status==="open").length>0&&s.jsxs("div",{className:"mb-4",children:[s.jsxs("h3",{className:"text-sm font-semibold text-gray-900 px-4 py-2 bg-gray-50 sticky top-0 z-10",children:["Open Tasks (",L.filter(re=>re.status==="open").length,")"]}),s.jsx("div",{className:"space-y-2 p-2",children:L.filter(re=>re.status==="open").map(re=>s.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-4 hover:shadow-md transition-shadow",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>{H(!1),e("task-detail",{taskId:re.id})},children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("h3",{className:"font-semibold",children:re.title}),s.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-[#CDFF00] text-black",children:"Open"})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-2 line-clamp-2",children:re.description}),re.price&&s.jsx("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded",style:{backgroundColor:"#CDFF00"},children:s.jsxs("span",{className:"text-xs font-bold text-black",children:["Earn ",re.price.toLocaleString("en-IN")]})})]}),s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsxs("button",{onClick:()=>{H(!1),e("create-task",{editMode:!0,taskId:re.id,task:re})},className:"px-3 py-1.5 text-xs border border-primary text-primary rounded-lg hover:bg-primary/10 transition-colors flex items-center gap-1",children:[s.jsx(Ea,{className:"w-3 h-3"}),"Edit"]}),s.jsx("button",{onClick:()=>{H(!1),e("task-detail",{taskId:re.id})},className:"px-3 py-1.5 text-xs bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:"View"})]})]})},re.id))})]}),L.filter(re=>re.status==="completed").length>0&&s.jsxs("div",{children:[s.jsxs("h3",{className:"text-sm font-semibold text-gray-900 px-4 py-2 bg-gray-50 sticky top-0 z-10",children:["Completed Tasks (",L.filter(re=>re.status==="completed").length,")"]}),s.jsx("div",{className:"space-y-2 p-2",children:L.filter(re=>re.status==="completed").map(re=>s.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-4 hover:shadow-md transition-shadow",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>{H(!1),e("task-detail",{taskId:re.id})},children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("h3",{className:"font-semibold",children:re.title}),s.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium bg-gray-50 text-black",children:"Completed"})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-2 line-clamp-2",children:re.description}),re.price&&s.jsxs("p",{className:"text-sm font-medium text-primary",children:["Earn ",re.price.toLocaleString("en-IN")]})]}),s.jsx("div",{className:"flex flex-col gap-2",children:s.jsx("button",{onClick:()=>{H(!1),e("task-detail",{taskId:re.id})},className:"px-3 py-1.5 text-xs bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:"View"})})]})},re.id))})]})]})})}),s.jsx(lc,{onNavigate:e,onContactClick:N||(()=>{}),socialLinks:C})]})}const Vx=t=>!t||t==="auto-detected"||t==="undefined"||t==="null"||!/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t)?null:t;function Z4({onBack:t,onSuccess:e,onNavigate:r,isLoggedIn:i,isAdmin:o,userDisplayName:c,unreadCount:l,cities:u,editMode:h,taskId:f,task:g}){const p=tt(),{location:y,updateLocation:v}=Fi(p?.id||null),[w,k]=j.useState(!1),[N,C]=j.useState(""),[A,E]=j.useState(""),[_,R]=j.useState(!1),[L,P]=j.useState({option:"anytime"}),[D,H]=j.useState(!1),[B,ae]=j.useState(""),[ue,le]=j.useState([]),[fe,we]=j.useState("");j.useEffect(()=>{if(h&&g&&(C(g.description||""),E(g.price?.toString()||""),R(g.isNegotiable||!1),ae(g.address||""),P(G4(g.timeWindow)),we(g.categoryId?.toString()||""),g.latitude&&g.longitude&&(!y?.latitude||!y?.longitude))){const $={cityId:null,city:g.city||"",areaId:g.area||g.city,area:g.area||g.city,latitude:g.latitude,longitude:g.longitude,address:g.address||"",locality:g.area,state:"",pincode:""};v($),console.log(" [CreateTaskScreen] Initialized location from task data:",$)}},[h,g]),j.useEffect(()=>{(async()=>{const W=await lh();le(W),!fe&&W.length>0&&we(W[0].id)})()},[]);const oe=()=>{const $=N.toLowerCase();return $.includes("plumber")||$.includes("electrician")?"500":$.includes("carpenter")||$.includes("painting")?"1000":$.includes("cleaning")||$.includes("maid")?"300":$.includes("tutor")||$.includes("teaching")?"400":$.includes("repair")?"600":$.includes("delivery")?"200":""},Y=()=>{const $=oe();$?(E($),J.success(" Price suggested based on service type!")):J.info("No price suggestion available for this service")},I=async $=>{if($.preventDefault(),!N.trim()){J.error("Please describe your task");return}if(!y||!y.latitude||!y.longitude){J.error("Please set your location first");return}if(!B.trim()){J.error("Please enter your full address");return}if(!p){J.error("Please login to post a task");return}k(!0);try{const W=N.trim().split(`
`),T=W[0].slice(0,50),z=W.length>1?W.slice(1).join(`
`).trim():N.trim(),G=y.latitude,M=y.longitude;if(h&&f){const X=await Bb(f,{title:T,description:z,price:parseFloat(A),isNegotiable:_,timeWindow:Wx(L),latitude:G,longitude:M,address:B.trim()});if(!X.success)throw new Error(X.error||"Failed to update task");J.success(" Task updated successfully!"),e()}else{const X=await $b({title:T,description:z,categoryId:parseInt(fe,10)||309,cityId:Vx(y.cityId),areaId:Vx(y.areaId),cityName:y.city,areaName:y.area||y.city,price:parseFloat(A),isNegotiable:_,timeWindow:Wx(L),latitude:G,longitude:M,address:B.trim(),phone:"",whatsapp:"",hasWhatsapp:!1},p.id);if(!X.success||!X.taskId)throw new Error(X.error||"Failed to create task");const ie=await qy(X.taskId,T,p.id,p.name||"User");ie.error&&console.warn("Failed to create chat thread:",ie.error),J.success(" Task posted! Chat is ready for offers."),oc(),e()}}catch(W){console.error("Failed to create task:",W),J.error(W.message||"Failed to create task")}finally{k(!1)}};return s.jsxs("div",{className:"min-h-screen bg-white pb-20 sm:pb-0",children:[s.jsx(rt,{title:h?"Edit Task":"Post a Task",currentScreen:"create",showBack:!0,onBack:t,onNavigate:r,isLoggedIn:i,isAdmin:o,userDisplayName:c,unreadCount:l,showGlobalLocation:!0,globalLocationArea:y?.area,globalLocationCity:y?.city,onLocationClick:()=>H(!0)}),D&&s.jsx(ao,{onLocationSelect:async $=>{const W={cityId:null,city:$.city,areaId:$.locality||$.city,area:$.locality||$.city,latitude:$.latitude,longitude:$.longitude,address:$.address,locality:$.locality,state:$.state,pincode:$.pincode};await v(W),H(!1),J.success("Location updated! ")},onClose:()=>H(!1),currentLocation:y&&y.latitude?{latitude:y.latitude,longitude:y.longitude,city:y.city}:null}),s.jsx("div",{className:"page-container max-w-2xl",children:s.jsxs("form",{onSubmit:I,className:"space-y-4",children:[s.jsxs("div",{className:"bg-white border border-gray-200 p-4",children:[s.jsxs("label",{className:"block text-sm mb-2 text-muted",children:[s.jsx(Ot,{className:"w-4 h-4 inline mr-1 text-primary"}),"What service do you need?"]}),s.jsx("textarea",{value:N,onChange:$=>C($.target.value),placeholder:"E.g., Need a plumber to fix leaking tap in kitchen...",className:"w-full p-3 border border-border rounded-[6px] resize-none focus:outline-none focus:ring-2 focus:ring-primary/20",rows:5,disabled:w})]}),s.jsx(Qb,{value:L,onChange:P,disabled:w}),s.jsxs("div",{className:"bg-white border border-gray-200 p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("label",{className:"block text-sm text-muted",children:"Budget ()"}),N.length>10&&!A&&s.jsx("button",{type:"button",onClick:Y,className:"text-xs text-primary hover:text-primary/80",children:" Suggest budget"})]}),s.jsx("input",{type:"number",value:A,onChange:$=>E($.target.value),placeholder:"Enter amount",className:"w-full p-3 border border-border rounded-[6px] focus:outline-none focus:ring-2 focus:ring-primary/20",min:"0",step:"10",disabled:w}),s.jsxs("label",{className:"flex items-center gap-2 mt-3 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:_,onChange:$=>R($.target.checked),className:"w-4 h-4 border-border text-primary focus:ring-2 focus:ring-primary/20",disabled:w}),s.jsx("span",{className:"text-sm text-muted",children:"Budget is negotiable"})]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 p-4",children:[s.jsxs("label",{className:"block text-sm mb-2 text-muted",children:[s.jsx(ds,{className:"w-4 h-4 inline mr-1 text-primary"}),"Location ",s.jsx("span",{className:"text-red-500",children:"*"})]}),y&&y.latitude&&y.longitude?s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{type:"button",onClick:()=>H(!0),className:"w-full p-4 bg-white border-2 border-gray-200 hover:border-[#CDFF00] transition-colors text-left flex items-start justify-between gap-3",style:{borderRadius:"8px"},children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("svg",{className:"w-5 h-5 text-[#CDFF00] flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})}),s.jsxs("p",{className:"text-[15px] text-black",style:{fontWeight:"700"},children:[y.area,", ",y.city]})]}),y.address&&s.jsx("p",{className:"text-[13px] text-gray-600 truncate",style:{fontWeight:"500"},children:y.address})]}),s.jsx("svg",{className:"w-5 h-5 text-gray-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]}),s.jsx("p",{className:"text-[12px] text-gray-500 mt-1.5",style:{fontWeight:"600"},children:"Tap to change your location"}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-[14px] text-black mb-2",style:{fontWeight:"700"},children:["Full Address ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("textarea",{value:B,onChange:$=>ae($.target.value),placeholder:`Building name, floor, street details...

E.g., Flat #101, Green Apartment, Main Road
Near City Hospital`,className:"w-full px-4 py-3 bg-white border-2 border-gray-200 text-black placeholder-gray-400 focus:outline-none focus:border-[#CDFF00] transition-colors resize-none",style:{borderRadius:"8px",fontSize:"15px",fontWeight:"500",minHeight:"120px"},rows:5,disabled:w}),s.jsx("p",{className:"text-[12px] text-gray-500 mt-1.5",style:{fontWeight:"600"},children:"Add specific details to help service providers find you"})]})]}):s.jsxs("div",{className:"p-4 bg-red-50 border-2 border-red-200",style:{borderRadius:"8px"},children:[s.jsx("p",{className:"text-[14px] text-red-600 mb-3",style:{fontWeight:"700"},children:" Location Not Set"}),s.jsx("p",{className:"text-[13px] text-red-600 mb-3",style:{fontWeight:"500"},children:"Please set your location from the header first."}),s.jsx("button",{type:"button",onClick:()=>H(!0),className:"w-full py-2.5 px-4 bg-[#CDFF00] text-black hover:bg-[#b8e600] transition-colors",style:{borderRadius:"6px",fontSize:"14px",fontWeight:"700"},children:"Set Location Now"})]})]}),s.jsxs("div",{className:"bg-white border border-gray-200 p-4",children:[s.jsxs("label",{className:"block text-sm mb-3 text-muted",children:["Category ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(cc,{categories:ue,selectedCategoryId:fe,onCategoryChange:we})]}),s.jsx("button",{type:"submit",disabled:w||!N.trim()||!A,className:"btn-primary w-full py-3 disabled:opacity-50",children:w?h?"Updating...":"Posting...":h?"Update Task":"Post Task & Start Chat"}),s.jsx("button",{type:"button",onClick:t,disabled:w,className:"btn-outline w-full py-3",children:"Cancel"})]})})]})}function X4({isOpen:t,onClose:e,onConfirm:r,taskTitle:i,taskPrice:o}){return s.jsx(Ar,{isOpen:t,onClose:e,title:"Confirm Task Commitment",children:s.jsxs("div",{className:"space-y-4 p-4",children:[s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(cs,{className:"w-5 h-5 text-blue-600 shrink-0 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm text-blue-900 font-medium mb-2",children:"You're agreeing to:"}),s.jsxs("ul",{className:"text-sm text-blue-800 space-y-1.5 list-disc list-inside",children:[s.jsxs("li",{children:["Complete the task: ",s.jsx("strong",{children:i})]}),o&&s.jsxs("li",{children:["Agreed price: ",s.jsxs("strong",{children:["",o.toLocaleString("en-IN")]})]}),s.jsx("li",{children:"Payment will be handled directly between you and the task creator"})]})]})]})}),s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 text-sm text-yellow-900",children:[s.jsx("p",{className:"font-medium mb-1",children:" Important"}),s.jsx("p",{children:"LocalFelo does not handle payments. Make sure you've discussed all terms in chat before proceeding."})]}),s.jsxs("div",{className:"flex gap-2 pt-2",children:[s.jsx("button",{onClick:e,className:"flex-1 px-4 py-2.5 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 transition-colors",children:"Cancel"}),s.jsxs("button",{onClick:r,className:"flex-1 px-4 py-2.5 rounded-lg font-medium transition-colors flex items-center justify-center gap-2",style:{backgroundColor:"#CDFF00",color:"#000000"},children:[s.jsx(Is,{className:"w-4 h-4"}),"Agree & Continue"]})]})]})})}function e3({isOpen:t,onClose:e,itemType:r,itemId:i,reportedUserId:o,reportedUserName:c,onSubmit:l}){const[u,h]=j.useState(""),[f,g]=j.useState(""),[p,y]=j.useState(!1),v=[{id:"payment",label:"Payment issue",icon:r1,description:"Payment not received or dispute"},{id:"harassment",label:"Harassment / Threat",icon:cs,description:"Inappropriate behavior or threats"},{id:"no_response",label:"User not responding",icon:m1,description:"No response after acceptance"}],w=async()=>{if(!u){J.error("Please select an issue type");return}try{y(!0),await l(u,f),J.success("Report submitted successfully. Our team will review it."),h(""),g(""),e()}catch(k){console.error("Failed to submit report:",k),J.error("Failed to submit report")}finally{y(!1)}};return s.jsx(Ar,{isOpen:t,onClose:e,title:"Report Issue",children:s.jsxs("div",{className:"space-y-4 p-4",children:[s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 text-sm text-yellow-900",children:[s.jsxs("p",{className:"font-medium mb-1",children:["Reporting ",c]}),s.jsx("p",{className:"text-xs",children:"False reports may result in action against your account."})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-semibold text-gray-900",children:"What's the issue?"}),s.jsx("div",{className:"space-y-2",children:v.map(k=>{const N=k.icon;return s.jsx("button",{onClick:()=>h(k.id),className:`w-full text-left p-3 rounded-lg border-2 transition-all ${u===k.id?"border-[#CDFF00] bg-[#CDFF00]/10":"border-gray-200 hover:border-gray-300"}`,children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(N,{className:`w-5 h-5 mt-0.5 ${u===k.id?"text-black":"text-gray-600"}`}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:`font-medium text-sm ${u===k.id?"text-black":"text-gray-900"}`,children:k.label}),s.jsx("p",{className:"text-xs text-gray-600 mt-0.5",children:k.description})]})]})},k.id)})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-semibold text-gray-900",children:"Additional details (optional)"}),s.jsx("textarea",{value:f,onChange:k=>g(k.target.value),placeholder:"Provide any additional information...",className:"w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-[#CDFF00]/20 focus:border-[#CDFF00] min-h-[80px]"})]}),s.jsxs("div",{className:"flex gap-2 pt-2",children:[s.jsx("button",{onClick:e,disabled:p,className:"flex-1 px-4 py-2.5 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 transition-colors disabled:opacity-50",children:"Cancel"}),s.jsx("button",{onClick:w,disabled:p||!u,className:"flex-1 px-4 py-2.5 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:p?"Submitting...":"Submit Report"})]})]})})}function t3({isOpen:t,onClose:e,onConfirm:r,taskTitle:i,isCreator:o,otherPartyName:c,otherPartyCompleted:l,currentUserCompleted:u,loading:h=!1}){return t?u?s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",children:s.jsxs("div",{className:"bg-white w-full max-w-md shadow-lg",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[s.jsx("h2",{className:"text-lg font-semibold",children:"Task Completion Status"}),s.jsx("button",{onClick:e,className:"p-1 hover:bg-gray-100 transition-colors",disabled:h,children:s.jsx(ut,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"p-6 space-y-4",children:[s.jsxs("div",{className:"flex items-start gap-3 p-4 bg-[#CDFF00]/10 border border-[#CDFF00]",children:[s.jsx(rn,{className:"w-5 h-5 text-[#CDFF00] flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-medium text-sm",children:"You marked this task as complete"}),s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Task: ",i]})]})]}),l?s.jsxs("div",{className:"flex items-start gap-3 p-4 bg-green-50 border border-green-200",children:[s.jsx(rn,{className:"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("p",{className:"font-medium text-sm text-green-800",children:[c," also confirmed completion"]}),s.jsx("p",{className:"text-sm text-green-700 mt-1",children:"Task is now marked as complete!"})]})]}):s.jsxs("div",{className:"flex items-start gap-3 p-4 bg-amber-50 border border-amber-200",children:[s.jsx(cs,{className:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("p",{className:"font-medium text-sm text-amber-800",children:["Waiting for ",c]}),s.jsxs("p",{className:"text-sm text-amber-700 mt-1",children:[c," needs to confirm completion to complete this task."]})]})]})]}),s.jsxs("div",{className:"flex gap-3 p-4 border-t border-gray-200",children:[s.jsx("button",{onClick:r,disabled:h,className:"flex-1 py-2.5 px-4 bg-gray-100 text-black hover:bg-gray-200 transition-colors font-medium disabled:opacity-50",children:h?"Undoing...":"Undo My Completion"}),s.jsx("button",{onClick:e,disabled:h,className:"flex-1 py-2.5 px-4 bg-black text-white hover:bg-gray-800 transition-colors font-medium disabled:opacity-50",children:"Close"})]})]})}):s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",children:s.jsxs("div",{className:"bg-white w-full max-w-md shadow-lg",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[s.jsx("h2",{className:"text-lg font-semibold",children:"Mark Task as Complete?"}),s.jsx("button",{onClick:e,className:"p-1 hover:bg-gray-100 transition-colors",disabled:h,children:s.jsx(ut,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"p-6 space-y-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Task:"}),s.jsx("p",{className:"font-medium",children:i})]}),l?s.jsxs("div",{className:"flex items-start gap-3 p-4 bg-green-50 border border-green-200",children:[s.jsx(rn,{className:"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("p",{className:"font-medium text-sm text-green-800",children:[c," already marked this complete"]}),s.jsx("p",{className:"text-sm text-green-700 mt-1",children:"Confirm to complete this task"})]})]}):s.jsxs("div",{className:"flex items-start gap-3 p-4 bg-blue-50 border border-blue-200",children:[s.jsx(cs,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-medium text-sm text-blue-800",children:"Both parties must confirm"}),s.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:[c," will be notified to confirm completion"]})]})]}),s.jsxs("p",{className:"text-sm text-gray-600",children:["You can undo your confirmation before ",c," confirms."]})]}),s.jsxs("div",{className:"flex gap-3 p-4 border-t border-gray-200",children:[s.jsx("button",{onClick:e,disabled:h,className:"flex-1 py-2.5 px-4 bg-gray-100 text-black hover:bg-gray-200 transition-colors font-medium disabled:opacity-50",children:"Cancel"}),s.jsx("button",{onClick:r,disabled:h,className:"flex-1 py-2.5 px-4 bg-[#CDFF00] text-black hover:bg-[#b8e600] transition-colors font-medium disabled:opacity-50",children:h?"Confirming...":"Yes, Mark Complete"})]})]})}):null}function s3({taskId:t,onNavigate:e,onBack:r,isLoggedIn:i,onLoginRequired:o,isAdmin:c,userDisplayName:l,showGlobalLocation:u,globalLocationArea:h,globalLocationCity:f,onLocationClick:g,onMenuClick:p,unreadCount:y,notificationCount:v,onNotificationClick:w,userCoordinates:k}){const[N,C]=j.useState(null),[A,E]=j.useState(!0),[_,R]=j.useState(!1),[L,P]=j.useState([]),[D,H]=j.useState(!1),[B,ae]=j.useState(!1),[ue,le]=j.useState(!1),[fe,we]=j.useState(!1),[oe,Y]=j.useState(!0),[I,$]=j.useState(!0),W=tt();j.useEffect(()=>{(async()=>{try{E(!0);const[Je,jt]=await Promise.all([Ta(t,k?.latitude,k?.longitude),lh()]);if(C(Je),P(jt),Je){const St=Je.userId||Je.owner_token;if(!St)Y(!1);else try{const xe=await em(St);Y(!!xe)}catch(xe){console.error(" Error checking task owner profile:",xe),Y(!1)}}}catch(Je){console.error("Failed to load task:",Je),J.error("Failed to load task details")}finally{E(!1),$(!1)}})()},[t,k]);const T=async()=>{if(!i){o&&o();return}if(N)try{const{conversation:Ae,error:Je}=await Di(N.id,N.title,void 0,N.price||N.budgetMax||N.budgetMin,N.userId,N.userName,N.userAvatar,"task");if(Je||!Ae){Je&&Je.includes("cannot chat with yourself")?J.error("You cannot chat about your own task."):Je&&Je.includes("profile could not be found")?J.error("This task is no longer available for chat. The user may have deleted their account."):J.error(Je||"Failed to open chat");return}console.log(" [TaskDetail] Conversation ready:",Ae.id),await new Promise(jt=>setTimeout(jt,100)),console.log(" [TaskDetail] Navigating to chat with conversationId:",Ae.id),e("chat",{conversationId:Ae.id})}catch(Ae){console.error("Failed to create conversation:",Ae),J.error("Failed to open chat")}},z=async()=>{if(!i){o&&o();return}if(N)try{const Ae=await qb(N.id,W?.id||"");C(Ae),J.success("Task accepted!"),sessionStorage.removeItem("activeTaskBannerDismissed"),T()}catch{J.error("Failed to accept task")}},G=async()=>{if(!i){o&&o();return}await T(),J.info("Start negotiating in the chat!")},M=async()=>{if(N&&confirm("Are you sure you want to cancel? The task will become available for others again."))try{await Ju(N.id,W?.id);const Ae=await Ta(N.id);Ae&&C(Ae),J.success("You have cancelled this task. It is now available for others.")}catch(Ae){console.error("Cancel error:",Ae),J.error("Failed to cancel")}},X=async()=>{if(N&&confirm("Are you sure you want to cancel the accepted deal? The task will go back to open status."))try{await Ju(N.id,W?.id);const Ae=await Ta(N.id);Ae&&C(Ae),J.success("Task cancelled. It is now open for others to accept.")}catch(Ae){console.error("Cancel error:",Ae),J.error("Failed to cancel")}},ie=async()=>{if(N&&confirm("Are you sure you want to permanently delete this task? This cannot be undone."))try{await Qh(N.id),J.success("Task deleted successfully"),r()}catch(Ae){console.error("Delete error:",Ae),J.error("Failed to delete task")}},be=()=>{!N||!W?.id||le(!0)},ve=async()=>{if(!N||!W?.id)return;const Ae=ne?N.creatorCompleted:N.helperCompleted;we(!0);try{if(Ae){const Je=await Gb(N.id,W.id,ne);if(Je.success){const jt=await Ta(N.id);jt&&C(jt),J.success("Completion undone")}else J.error(Je.error||"Failed to undo completion")}else{const Je=await Hb(N.id,W.id,ne);C(Je),Je.status==="completed"?J.success(" Task completed! Both parties confirmed."):J.success(" Completion confirmed! Waiting for other party.")}le(!1)}catch(Je){console.error("Complete error:",Je),J.error("Failed to process completion")}finally{we(!1)}},ee=()=>{H(!0)},ce=async()=>{if(N)try{const Ae=await Kb(N.id);C(Ae),H(!1),J.success("Task started! Navigate to location.")}catch(Ae){console.error("Start task error:",Ae),J.error("Failed to start task")}},Ue=async(Ae,Je)=>{if(!N||!W?.id)return;const jt=ne?N.acceptedBy:N.userId;ne?N.helperName:N.userName,jt&&await C4({itemType:"task",itemId:N.id,reporterId:W.id,reportedUserId:jt,issueType:Ae,details:Je})},he=async()=>{if(N){if(console.log("Navigate clicked. Task location:",{latitude:N.latitude,longitude:N.longitude,exactLocation:N.exactLocation,cityName:N.cityName,areaName:N.areaName}),N.latitude&&N.longitude){const Ae=`https://www.google.com/maps/dir/?api=1&destination=${N.latitude},${N.longitude}`;window.open(Ae,"_blank"),J.success("Opening navigation to exact task location!")}else{const Je=`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(`${N.areaName}, ${N.cityName}`)}`;window.open(Je,"_blank"),J.info("GPS not available - Navigating to area location")}try{const{updateTaskStatus:Ae}=await ys(async()=>{const{updateTaskStatus:jt}=await Promise.resolve().then(()=>Jb);return{updateTaskStatus:jt}},void 0),Je=await Ae(N.id,"in_progress");C(Je)}catch(Ae){console.error("Status update error:",Ae)}}},Le=()=>{if(!N?.latitude||!N?.longitude){J.error("Location not available");return}const Ae=`https://www.google.com/maps/dir/?api=1&destination=${N.latitude},${N.longitude}`;window.open(Ae,"_blank")},Ke=Ae=>{switch(Ae){case"open":return s.jsxs("span",{className:"px-3 py-1.5 bg-green-100 text-black rounded-full text-xs font-medium flex items-center gap-1",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Open"]});case"negotiating":return s.jsxs("span",{className:"px-3 py-1.5 bg-blue-100 text-black rounded-full text-xs font-medium flex items-center gap-1",children:[s.jsx(Sr,{className:"w-3 h-3"}),"Negotiating"]});case"accepted":return s.jsxs("span",{className:"px-3 py-1.5 bg-purple-100 text-black rounded-full text-xs font-medium flex items-center gap-1",children:[s.jsx(qp,{className:"w-3 h-3"}),"Accepted"]});case"in_progress":return s.jsxs("span",{className:"px-3 py-1.5 bg-[#CDFF00] text-black rounded-full text-xs font-medium flex items-center gap-1",children:[s.jsx(Ys,{className:"w-3 h-3 animate-pulse"}),"In Progress"]});case"completed":return s.jsxs("span",{className:"px-3 py-1.5 bg-green-100 text-black rounded-full text-xs font-medium flex items-center gap-1",children:[s.jsx(Is,{className:"w-3 h-3"}),"Completed"]});case"closed":return s.jsx("span",{className:"px-3 py-1.5 bg-gray-100 text-black rounded-full text-xs font-medium",children:"Closed"});default:return s.jsxs("span",{className:"px-3 py-1.5 bg-green-100 text-black rounded-full text-xs font-medium flex items-center gap-1",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"Open"]})}},at=Ae=>{if(!Ae)return"Not specified";switch(Ae){case"asap":return"ASAP";case"today":return"Today";case"tomorrow":return"Tomorrow";default:return Ae}},re=Ae=>{if(!Ae)return"bg-gray-100 text-gray-700";switch(Ae){case"asap":return"bg-red-100 text-red-700";case"today":return"bg-[#CDFF00] text-black";case"tomorrow":return"bg-blue-100 text-blue-700";default:return"bg-gray-100 text-gray-700"}},ne=W?.id===N?.userId,Oe=W?.id===N?.acceptedBy,He=ne||Oe,wt=N?.status==="open";N?.status;const Lt=N?.status==="accepted",st=N?.status==="in_progress";if(N?.status,console.log(" TaskDetailScreen Debug:",{currentUserId:W?.id,taskUserId:N?.userId,taskAcceptedBy:N?.acceptedBy,isCreator:ne,isAcceptor:Oe,isOpen:wt,taskStatus:N?.status,isLoggedIn:i,shouldShowButtons:i&&!ne&&wt&&!Oe}),A)return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(rt,{title:"Task Details",showBack:!0,onBack:r,onNavigate:e,isLoggedIn:i,isAdmin:c,userDisplayName:l,showGlobalLocation:u,globalLocationArea:h,globalLocationCity:f,onLocationClick:g,onMenuClick:p,unreadCount:y,notificationCount:v,onNotificationClick:w}),s.jsx("div",{className:"page-container py-4",children:s.jsx(ln,{count:1})})]});if(!N)return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(rt,{title:"Task Details",showBack:!0,onBack:r,onNavigate:e,isLoggedIn:i,isAdmin:c,userDisplayName:l,showGlobalLocation:u,globalLocationArea:h,globalLocationCity:f,onLocationClick:g,onMenuClick:p,unreadCount:y,notificationCount:v,onNotificationClick:w}),s.jsx("div",{className:"page-container py-8 text-center",children:s.jsx("p",{className:"text-muted",children:"Task not found"})})]});const Qt=L.find(Ae=>Ae.slug===N.categoryName?.toLowerCase())||L[6];return s.jsxs("div",{className:"min-h-screen bg-background pb-28",children:[s.jsx("div",{className:"sticky top-0 z-40",children:s.jsx(rt,{title:"Task Details",showBack:!0,onBack:r,onNavigate:e,isLoggedIn:i,isAdmin:c,userDisplayName:l,showGlobalLocation:u,globalLocationArea:h,globalLocationCity:f,onLocationClick:g,onMenuClick:p,unreadCount:y,notificationCount:v,onNotificationClick:w})}),s.jsxs("div",{className:"page-container py-4 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between gap-3",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-2xl",children:Qt.emoji}),s.jsx("span",{className:"text-sm text-muted",children:Qt.name})]}),Ke(He&&i?N.status:"open")]}),s.jsx("h1",{className:"text-heading text-2xl",children:N.title}),s.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[N.price!==void 0&&s.jsxs("div",{className:"flex items-center gap-2 px-4 py-2.5 rounded-lg",style:{backgroundColor:"#CDFF00"},children:[s.jsx(Xa,{className:"w-6 h-6 text-black"}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-xs text-black font-medium",children:"You'll Earn"}),s.jsxs("span",{className:"text-xl font-extrabold text-black",children:["",N.price.toLocaleString("en-IN")]})]})]}),s.jsxs("div",{className:`flex items-center gap-1.5 px-3 py-2 rounded-lg ${re(N.timeWindow)}`,children:[s.jsx(Ys,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:at(N.timeWindow)})]})]}),s.jsxs("div",{className:"bg-white rounded border border-border p-4",children:[s.jsx("h3",{className:"text-sm font-semibold mb-2 text-muted",children:"Task details"}),s.jsx("p",{className:"text-body whitespace-pre-wrap",children:N.description})]}),N.latitude&&N.longitude&&s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>R(!1),className:`px-4 py-2 rounded-[4px] transition-colors ${_?"bg-white border border-border text-foreground hover:border-primary":"bg-black text-white"}`,children:"Details"}),s.jsx("button",{onClick:()=>R(!0),className:`px-4 py-2 rounded-[4px] transition-colors ${_?"bg-black text-white":"bg-white border border-border text-foreground hover:border-primary"}`,children:"Map View"})]}),_?s.jsx("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",style:{height:"400px"},children:s.jsx(mc,{markers:[{id:N.id,latitude:N.latitude,longitude:N.longitude,title:N.title,price:N.price,type:"task",categoryEmoji:Qt?.emoji,status:N.status}],onMarkerClick:()=>{},centerLat:N.latitude,centerLng:N.longitude})}):s.jsxs("div",{className:"bg-white rounded border border-border p-4",children:[s.jsx("h3",{className:"text-sm font-semibold mb-2 text-muted",children:"Location"}),s.jsxs("div",{className:"flex items-start gap-2 text-body",children:[s.jsx(ds,{className:"w-5 h-5 text-primary shrink-0 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-medium",children:N.areaName}),s.jsx("p",{className:"text-sm text-muted",children:N.cityName}),N.distance!==void 0&&N.distance!==null&&s.jsxs("p",{className:"font-extrabold mt-2",style:{backgroundColor:"#CDFF00",color:"#000000",fontSize:"14px",display:"inline-block",padding:"4px 8px",borderRadius:"6px"},children:["~",N.distance.toFixed(1)," km away"]}),N.address&&s.jsxs("div",{className:"mt-3 p-3 bg-gray-50 border border-gray-200",style:{borderRadius:"8px"},children:[s.jsx("p",{className:"text-[12px] text-gray-500 mb-1",style:{fontWeight:"600"},children:"Full Address"}),s.jsx("p",{className:"text-[14px] text-black whitespace-pre-wrap",style:{fontWeight:"500"},children:N.address})]}),N.latitude&&N.longitude&&s.jsxs("button",{onClick:Le,className:"mt-2 flex items-center gap-1 text-primary hover:underline text-sm font-medium",children:[s.jsx(Jx,{className:"w-3 h-3"}),"Open in Google Maps"]})]})]})]}),Lt&&He&&s.jsxs("div",{className:"bg-gradient-to-br from-primary/10 to-primary/5 rounded-lg border-2 border-primary/20 p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(Is,{className:"w-5 h-5 text-primary"}),s.jsx("h3",{className:"font-semibold text-primary",children:"Deal Accepted"})]}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-muted",children:"Final price:"}),s.jsxs("span",{className:"font-semibold text-primary",children:["",(N.price||0).toLocaleString("en-IN")]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-muted",children:"Status:"}),s.jsx("span",{className:"font-medium text-green-700",children:N.status==="completed"?"Completed":N.status==="in_progress"?"In Progress":"Accepted"})]})]})]}),Lt&&Oe&&!ne&&s.jsx("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(cs,{className:"w-5 h-5 text-blue-600 shrink-0 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-semibold text-blue-900 mb-1",children:"Task accepted. Please confirm before starting."}),s.jsx("p",{className:"text-sm text-blue-800",children:"Make sure you've discussed all terms in chat before proceeding."}),s.jsx("p",{className:"text-xs text-blue-700 mt-2 italic",children:"LocalFelo connects users. Payments and work are handled directly between users."})]})]})}),wt&&!ne&&i&&s.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-3",children:s.jsxs("p",{className:"text-xs text-gray-700",children:[" ",s.jsx("strong",{children:"LocalFelo is a connector platform."})," Payments and work are handled directly between users. Discuss all terms before accepting."]})}),st&&Oe&&!ne&&s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:s.jsxs("p",{className:"text-sm text-yellow-900",children:[" ",s.jsx("strong",{children:"Payment is handled directly between users."})," Confirm payment before leaving the location."]})}),st&&He&&(N.helperCompleted||N.creatorCompleted)&&s.jsx("div",{className:"bg-green-50 border-2 border-green-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Is,{className:"w-5 h-5 text-green-600 shrink-0 mt-0.5"}),s.jsx("div",{className:"flex-1",children:ne?N.creatorCompleted?s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-green-900 mb-1",children:" Confirmed by you"}),s.jsx("p",{className:"text-sm text-green-800",children:N.helperCompleted?"Task completed! Both parties confirmed.":"Waiting for helper confirmation..."})]}):s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-green-900 mb-1",children:" Helper has confirmed completion"}),s.jsx("p",{className:"text-sm text-green-800",children:"Please confirm to complete the task"})]}):N.helperCompleted?s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-green-900 mb-1",children:" Confirmed by you"}),s.jsx("p",{className:"text-sm text-green-800",children:N.creatorCompleted?"Task completed! Both parties confirmed.":"Waiting for creator confirmation..."})]}):s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-green-900 mb-1",children:" Creator has confirmed completion"}),s.jsx("p",{className:"text-sm text-green-800",children:"Please confirm to complete the task"})]})})]})}),He&&i&&(Lt||st)&&s.jsxs("button",{onClick:()=>ae(!0),className:"w-full px-4 py-2.5 bg-white border border-red-200 text-red-600 rounded-lg text-sm font-medium hover:bg-red-50 transition-colors flex items-center justify-center gap-2",children:[s.jsx(Xx,{className:"w-4 h-4"}),"Report Issue"]}),s.jsxs("div",{className:"bg-white rounded border border-border p-4",children:[s.jsx("h3",{className:"text-sm font-semibold mb-2 text-muted",children:"Posted by"}),s.jsxs("div",{className:"flex items-center gap-3",children:[N.userAvatar?s.jsx("img",{src:N.userAvatar,alt:Ma(N.userName),className:"w-10 h-10 rounded-full object-cover"}):s.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center",children:s.jsx("span",{className:"text-primary font-semibold",children:Ma(N.userName).charAt(0).toUpperCase()})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-medium text-heading",children:Ma(N.userName)}),s.jsx("p",{className:"text-sm text-muted",children:"Posted by a local user near you"}),s.jsx("p",{className:"text-xs text-gray-500",children:new Date(N.createdAt).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"})})]})]})]})]}),!ne&&wt&&oe&&!I&&s.jsx("div",{className:"fixed bottom-16 md:bottom-12 left-0 right-0 bg-white border-t border-border p-3 sm:p-6 z-40 safe-bottom",children:s.jsx("div",{className:"max-w-4xl mx-auto flex items-center gap-2 sm:gap-3",children:i?s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:G,className:"flex-1 px-3 sm:px-6 py-2.5 sm:py-3.5 bg-white border-2 border-black text-black rounded-lg text-sm sm:text-base font-semibold hover:bg-gray-50 transition-colors flex items-center justify-center gap-1 sm:gap-2",children:[s.jsx(ct,{className:"w-4 h-4 sm:w-5 sm:h-5"}),s.jsx("span",{className:"hidden xs:inline",children:"Negotiate"}),s.jsx("span",{className:"xs:hidden",children:"Chat"})]}),s.jsxs("button",{onClick:z,className:"flex-1 px-3 sm:px-6 py-2.5 sm:py-3.5 bg-black text-white rounded-lg text-sm sm:text-base font-semibold hover:bg-gray-800 transition-colors flex items-center justify-center gap-1 sm:gap-2",children:[s.jsx(qp,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"}),"Accept"]})]}):s.jsx("button",{onClick:()=>o?.(),className:"w-full px-4 sm:px-6 py-2.5 sm:py-3.5 bg-black text-white rounded-lg text-sm sm:text-base font-semibold hover:bg-gray-800 transition-colors flex items-center justify-center gap-2",children:"Login to Accept"})})}),Oe&&!ne&&Lt&&s.jsx("div",{className:"fixed bottom-16 md:bottom-12 left-0 right-0 bg-white border-t border-border p-3 sm:p-6 z-40 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsxs("div",{className:"flex sm:hidden gap-2",children:[s.jsxs("button",{onClick:ee,className:"flex-1 px-3 py-2.5 rounded-lg text-sm font-semibold transition-colors flex items-center justify-center gap-1",style:{backgroundColor:"#CDFF00",color:"#000000"},children:[s.jsx(Is,{className:"w-4 h-4"}),s.jsx("span",{className:"hidden xs:inline",children:"Confirm & Start"}),s.jsx("span",{className:"xs:inline sm:hidden",children:"Start"})]}),s.jsx("button",{onClick:T,className:"px-3 py-2.5 bg-white border-2 border-primary text-primary rounded-lg text-sm font-semibold hover:bg-primary/5 transition-colors flex items-center justify-center gap-1",children:s.jsx(ct,{className:"w-4 h-4"})}),s.jsx("button",{onClick:M,className:"px-3 py-2.5 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors flex items-center justify-center gap-1",children:s.jsx(ar,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"hidden sm:flex items-center gap-3",children:[s.jsxs("button",{onClick:ee,className:"flex-1 px-6 py-3.5 rounded-lg font-semibold transition-colors flex items-center justify-center gap-2",style:{backgroundColor:"#CDFF00",color:"#000000"},children:[s.jsx(Is,{className:"w-5 h-5"}),"Confirm & Start"]}),s.jsxs("button",{onClick:T,className:"flex-1 px-6 py-3.5 bg-white border-2 border-primary text-primary rounded-lg font-semibold hover:bg-primary/5 transition-colors flex items-center justify-center gap-2",children:[s.jsx(ct,{className:"w-5 h-5"}),"Chat"]}),s.jsxs("button",{onClick:M,className:"px-4 py-3.5 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 transition-colors flex items-center justify-center gap-2",children:[s.jsx(ar,{className:"w-5 h-5"}),"Cancel"]})]})]})}),Oe&&!ne&&st&&s.jsx("div",{className:"fixed bottom-16 md:bottom-12 left-0 right-0 bg-white border-t border-border p-3 sm:p-6 z-40 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsxs("div",{className:"flex sm:hidden flex-col gap-2",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:T,className:"flex-1 px-3 py-2.5 bg-black text-white rounded-lg text-sm font-semibold hover:bg-gray-800 transition-colors flex items-center justify-center gap-1",children:[s.jsx(ct,{className:"w-4 h-4 text-white"}),"Chat"]}),s.jsxs("button",{onClick:he,className:"flex-1 px-3 py-2.5 bg-blue-600 text-white rounded-lg text-sm font-semibold hover:bg-blue-700 transition-colors flex items-center justify-center gap-1",children:[s.jsx(xi,{className:"w-4 h-4 text-white"}),"Navigate"]})]}),s.jsxs("div",{className:"flex gap-2",children:[st&&s.jsxs("button",{onClick:be,className:"flex-1 px-3 py-2.5 bg-green-600 text-white rounded-lg text-sm font-semibold hover:bg-green-700 transition-colors flex items-center justify-center gap-1",children:[s.jsx(Is,{className:"w-4 h-4 text-white"}),"Complete"]}),s.jsxs("button",{onClick:M,className:"flex-1 px-3 py-2.5 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors flex items-center justify-center gap-1",children:[s.jsx(ar,{className:"w-4 h-4"}),"Cancel"]})]})]}),s.jsxs("div",{className:"hidden sm:flex items-center gap-3",children:[s.jsxs("button",{onClick:T,className:"flex-1 px-6 py-3.5 bg-black text-white rounded-lg font-semibold hover:bg-gray-800 transition-colors flex items-center justify-center gap-2",children:[s.jsx(ct,{className:"w-5 h-5 text-white"}),"Chat"]}),s.jsxs("button",{onClick:he,className:"px-6 py-3.5 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors flex items-center justify-center gap-2",children:[s.jsx(xi,{className:"w-5 h-5 text-white"}),"Navigate"]}),st&&s.jsxs("button",{onClick:be,className:"px-6 py-3.5 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 transition-colors flex items-center justify-center gap-2",children:[s.jsx(Is,{className:"w-5 h-5 text-white"}),"Complete"]}),s.jsxs("button",{onClick:M,className:"px-4 py-3.5 bg-gray-100 text-gray-700 rounded-lg font-medium hover:bg-gray-200 transition-colors flex items-center justify-center gap-2",children:[s.jsx(ar,{className:"w-5 h-5"}),"Cancel"]})]})]})}),ne&&wt&&s.jsx("div",{className:"fixed bottom-16 md:bottom-12 left-0 right-0 bg-white border-t border-border p-3 sm:p-6 z-40 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto flex items-center gap-2 sm:gap-3",children:[s.jsxs("button",{onClick:()=>e("create-task",{editMode:!0,taskId:N.id,task:N}),className:"flex-1 px-3 sm:px-6 py-2.5 sm:py-3.5 bg-primary text-white rounded-lg text-sm sm:text-base font-semibold hover:bg-primary-dark transition-colors flex items-center justify-center gap-1 sm:gap-2",children:[s.jsx(ay,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"Edit"]}),s.jsxs("button",{onClick:ie,className:"px-3 sm:px-6 py-2.5 sm:py-3.5 bg-red-500 text-white rounded-lg text-sm sm:text-base font-semibold hover:bg-red-600 transition-colors flex items-center justify-center gap-1 sm:gap-2",children:[s.jsx(Ls,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"Delete"]})]})}),ne&&Lt&&s.jsx("div",{className:"fixed bottom-16 md:bottom-12 left-0 right-0 bg-white border-t border-border p-3 sm:p-6 z-40 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto flex items-center gap-2 sm:gap-3",children:[s.jsxs("button",{onClick:T,className:"flex-1 px-3 sm:px-6 py-2.5 sm:py-3.5 bg-black text-white rounded-lg text-sm sm:text-base font-semibold hover:bg-gray-800 transition-colors flex items-center justify-center gap-1 sm:gap-2",children:[s.jsx(ct,{className:"w-4 h-4 sm:w-5 sm:h-5 text-white"}),"Chat"]}),s.jsxs("button",{onClick:X,className:"px-3 sm:px-6 py-2.5 sm:py-3.5 bg-gray-100 text-gray-700 rounded-lg text-sm sm:text-base font-medium hover:bg-gray-200 transition-colors flex items-center justify-center gap-1 sm:gap-2",children:[s.jsx(ar,{className:"w-4 h-4 sm:w-5 sm:h-5"}),"Cancel"]})]})}),ne&&st&&s.jsx("div",{className:"fixed bottom-16 md:bottom-12 left-0 right-0 bg-white border-t border-border p-3 sm:p-6 z-40 safe-bottom",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsxs("div",{className:"flex sm:hidden flex-col gap-2",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:T,className:"flex-1 px-3 py-2.5 bg-black text-white rounded-lg text-sm font-semibold hover:bg-gray-800 transition-colors flex items-center justify-center gap-1",children:[s.jsx(ct,{className:"w-4 h-4 text-white"}),"Chat"]}),s.jsxs("button",{onClick:he,className:"flex-1 px-3 py-2.5 bg-blue-600 text-white rounded-lg text-sm font-semibold hover:bg-blue-700 transition-colors flex items-center justify-center gap-1",children:[s.jsx(xi,{className:"w-4 h-4 text-white"}),"Navigate"]})]}),s.jsxs("button",{onClick:be,className:"w-full px-3 py-2.5 bg-green-600 text-white rounded-lg text-sm font-semibold hover:bg-green-700 transition-colors flex items-center justify-center gap-1",children:[s.jsx(Is,{className:"w-4 h-4 text-white"}),"Complete"]})]}),s.jsxs("div",{className:"hidden sm:flex items-center gap-3",children:[s.jsxs("button",{onClick:T,className:"flex-1 px-6 py-3.5 bg-black text-white rounded-lg font-semibold hover:bg-gray-800 transition-colors flex items-center justify-center gap-2",children:[s.jsx(ct,{className:"w-5 h-5 text-white"}),"Chat"]}),s.jsxs("button",{onClick:he,className:"px-6 py-3.5 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors flex items-center justify-center gap-2",children:[s.jsx(xi,{className:"w-5 h-5 text-white"}),"Navigate"]}),s.jsxs("button",{onClick:be,className:"px-6 py-3.5 bg-green-600 text-white rounded-lg font-semibold hover:bg-green-700 transition-colors flex items-center justify-center gap-2",children:[s.jsx(Is,{className:"w-5 h-5 text-white"}),"Complete"]})]})]})}),s.jsx(X4,{isOpen:D,onClose:()=>H(!1),onConfirm:ce,taskTitle:N.title,taskPrice:N.price}),s.jsx(e3,{isOpen:B,onClose:()=>ae(!1),itemType:"task",itemId:N.id,reportedUserId:ne?N.acceptedBy||"":N.userId,reportedUserName:ne?N.helperName||"Helper":N.userName,onSubmit:Ue}),s.jsx(t3,{isOpen:ue,onClose:()=>le(!1),onConfirm:ve,taskTitle:N.title,isCreator:ne,otherPartyName:ne?N.helperName||"Helper":N.userName,otherPartyCompleted:ne?N.helperCompleted||!1:N.creatorCompleted||!1,currentUserCompleted:ne?N.creatorCompleted||!1:N.helperCompleted||!1,loading:fe})]})}function r3({title:t,children:e,onViewAll:r,showViewAll:i=!0}){const o=j.useRef(null),c=l=>{if(!o.current)return;const u=300,h=o.current.scrollLeft+(l==="right"?u:-u);o.current.scrollTo({left:h,behavior:"smooth"})};return s.jsxs("div",{className:"mb-5 sm:mb-7",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[s.jsx("h2",{className:"text-[15px] sm:text-xl font-bold text-heading pr-2",children:t}),s.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[s.jsxs("div",{className:"hidden sm:flex items-center gap-1",children:[s.jsx("button",{onClick:()=>c("left"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Scroll left",children:s.jsx(eh,{className:"w-5 h-5 text-muted"})}),s.jsx("button",{onClick:()=>c("right"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Scroll right",children:s.jsx(th,{className:"w-5 h-5 text-muted"})})]}),i&&r&&s.jsx("button",{onClick:r,className:"text-sm font-semibold text-black hover:text-gray-700 transition-colors",children:"View All"})]})]}),s.jsx("div",{ref:o,className:"flex overflow-x-auto scrollbar-hide pb-2",style:{scrollSnapType:"x mandatory",gap:"16px"},children:e})]})}function Oa({texts:t,typingSpeed:e=50,deletingSpeed:r=30,pauseDuration:i=2e3,className:o=""}){const[c,l]=j.useState(0),[u,h]=j.useState(""),[f,g]=j.useState(!1),[p,y]=j.useState(!1);return j.useEffect(()=>{if(t.length===0)return;const v=t[c];if(p){const k=setTimeout(()=>{y(!1),g(!0)},i);return()=>clearTimeout(k)}if(!f&&u===v){y(!0);return}if(f&&u===""){g(!1),l(k=>(k+1)%t.length);return}const w=setTimeout(()=>{h(f?v.substring(0,u.length-1):v.substring(0,u.length+1))},f?r:e);return()=>clearTimeout(w)},[u,f,p,c,t,e,r,i]),s.jsxs("span",{className:o,children:[u,s.jsx("span",{className:"animate-pulse ml-0.5",children:"|"})]})}function n3({onNavigate:t,isLoggedIn:e,isAdmin:r,userDisplayName:i,unreadCount:o=0,notificationCount:c=0,userLocation:l,onNotificationClick:u,onLocationClick:h,onMenuClick:f,onGlobalSearchClick:g,onContactClick:p,socialLinks:y}){const[v,w]=j.useState([]),[k,N]=j.useState([]),[C,A]=j.useState([]),[E,_]=j.useState(!0),R=tt();j.useEffect(()=>{L()},[l]);const L=async()=>{_(!0);try{console.log("[NewHomeScreen] Loading nearby content with user location:",{lat:l?.latitude,lon:l?.longitude,city:l?.city,area:l?.area,note:"Filtering by city if location set, otherwise showing all content"});const P=await nh(),D={status:"open"};l?(D.userLat=l.latitude,D.userLon=l.longitude,console.log("[NewHomeScreen]  Passing user coordinates to wishes:",{lat:l.latitude,lon:l.longitude})):console.log("[NewHomeScreen]  No user location available for distance calculation");const H=await dc(D);console.log("[NewHomeScreen] Loaded wishes from ALL cities (sorted by distance):",H.length),w(H.slice(0,10));const B={status:"open"};l&&(B.userLat=l.latitude,B.userLon=l.longitude);const ae=await uc(B);console.log("[NewHomeScreen] Loaded tasks from ALL cities (sorted by distance):",ae.length),N(ae.slice(0,10));const ue={limit:10};l&&(ue.userLat=l.latitude,ue.userLon=l.longitude);const le=await ah(ue);console.log("[NewHomeScreen] Loaded deals:",le.data?.length),A(le.data||[])}catch{}finally{_(!1)}};return s.jsxs("div",{className:"min-h-screen bg-background pb-20 md:pb-0",children:[s.jsx(rt,{title:"LocalFelo",currentScreen:"home",onNavigate:t,isLoggedIn:e,isAdmin:r,userDisplayName:i,unreadCount:o,notificationCount:c,onNotificationClick:u,onLocationClick:h,onMenuClick:f,onGlobalSearchClick:g,showGlobalLocation:!0,globalLocationArea:l?.area,globalLocationCity:l?.city}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-5",children:[s.jsxs("div",{className:"relative bg-[#CDFF00] rounded-lg overflow-hidden p-4 md:p-6 mb-6",children:[s.jsxs("div",{className:"relative z-10 max-w-[70%] md:max-w-[60%]",children:[s.jsxs("h1",{className:"text-black font-bold text-[18px] md:text-[22px] leading-tight mb-3 md:mb-4",children:[s.jsx("span",{className:"block md:hidden",children:"Get help nearby. Or"}),s.jsx("span",{className:"block md:hidden",children:"help someone and earn locally."}),s.jsx("span",{className:"hidden md:inline",children:"Get help nearby. Or help someone and earn locally."})]}),s.jsxs("div",{className:"flex items-center gap-2 text-[12px] md:text-[13px] text-black mb-4 md:mb-5 min-h-[16px] md:min-h-[18px]",children:[s.jsx("span",{className:"font-medium",children:"Examples:"}),s.jsx("div",{className:"flex-1",children:s.jsx(Oa,{texts:["Pick up grocery","Shift luggage tomorrow","Bring gas cylinder","Clean my car","Help with coding","Install washing machine"],typingSpeed:50,deletingSpeed:30,pauseDuration:2500})})]}),s.jsxs("div",{className:"flex gap-2 md:gap-3",children:[s.jsx("button",{onClick:()=>t("tasks"),className:"bg-black text-white px-4 md:px-5 py-2 md:py-2.5 rounded font-bold text-[12px] md:text-[13px] hover:bg-gray-800 transition-colors",children:"Find tasks"}),s.jsx("button",{onClick:()=>{t(e?"create-task":"login")},className:"bg-white text-black px-4 md:px-5 py-2 md:py-2.5 rounded font-bold text-[12px] md:text-[13px] hover:bg-gray-100 transition-colors",children:"Create task"})]})]}),s.jsx("img",{src:"/home-banner.png",alt:"",className:"absolute bottom-0 right-0 md:right-8 h-[90px] w-auto md:h-[120px] object-contain pointer-events-none"})]}),E?s.jsxs("div",{className:"space-y-3 mb-6",children:[s.jsx("h2",{className:"text-[17px] sm:text-xl font-bold text-heading px-1",children:"Tasks near you, complete and earn"}),s.jsx(ln,{count:3})]}):k.length>0?s.jsxs("div",{className:"space-y-4 mb-6",children:[s.jsx(r3,{title:"Tasks near you, complete and earn",onViewAll:()=>t("tasks"),showViewAll:!0,children:k.slice(0,5).map(P=>s.jsx("div",{className:"flex-shrink-0 w-72 sm:w-80",style:{scrollSnapAlign:"start"},children:s.jsx(Zu,{task:P,onClick:()=>t("task-detail",{taskId:P.id}),currentUserId:R?.id,onChatClick:e&&R?.id!==P.userId?async()=>{const{getOrCreateConversation:D}=await ys(async()=>{const{getOrCreateConversation:ae}=await Promise.resolve().then(()=>yg);return{getOrCreateConversation:ae}},void 0),{conversation:H,error:B}=await D(P.id,P.title,void 0,P.price,P.userId,P.userName,P.userAvatar,"task");if(B){J.error(B);return}H&&t("chat",{conversationId:H.id})}:void 0})},P.id))}),k.length>5&&s.jsx("div",{className:"overflow-x-auto scrollbar-hide -mx-3 sm:-mx-4 md:-mx-5 lg:-mx-6 xl:-mx-8 px-3 sm:px-4 md:px-5 lg:px-6 xl:px-8",children:s.jsx("div",{className:"flex gap-3 sm:gap-4",children:k.slice(5,10).map(P=>s.jsx("div",{className:"flex-shrink-0 w-72 sm:w-80",style:{scrollSnapAlign:"start"},children:s.jsx(Zu,{task:P,onClick:()=>t("task-detail",{taskId:P.id}),currentUserId:R?.id,onChatClick:e&&R?.id!==P.userId?async()=>{const{getOrCreateConversation:D}=await ys(async()=>{const{getOrCreateConversation:ae}=await Promise.resolve().then(()=>yg);return{getOrCreateConversation:ae}},void 0),{conversation:H,error:B}=await D(P.id,P.title,void 0,P.price,P.userId,P.userName,P.userAvatar,"task");if(B){J.error(B);return}H&&t("chat",{conversationId:H.id})}:void 0})},P.id))})})]}):s.jsxs("div",{className:"text-center py-8 bg-white rounded-lg border border-border mb-6",children:[s.jsx(Ot,{className:"w-12 h-12 text-muted mx-auto mb-3"}),s.jsx("p",{className:"text-body text-sm mb-4",children:"No tasks available in your area yet"}),s.jsx("button",{onClick:()=>{t(e?"create-task":"login")},className:"bg-[#CDFF00] text-black px-6 py-2.5 rounded-md font-bold text-sm hover:bg-[#CDFF00]/90 transition-all",children:"Post a task"})]}),s.jsx("div",{className:"bg-white rounded-lg border border-border p-4 sm:p-5 mb-6",children:s.jsxs("div",{className:"flex items-start gap-3 sm:gap-4",children:[s.jsx("div",{className:"text-[32px] sm:text-[40px] shrink-0",children:""}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"text-[16px] sm:text-[18px] font-bold text-heading mb-2",children:"Looking for something specific?"}),s.jsxs("div",{className:"flex items-start gap-1.5 text-[14px] sm:text-[15px] text-body mb-4 h-[48px] sm:h-[50px]",children:[s.jsx("span",{className:"font-medium whitespace-nowrap",children:"Examples:"}),s.jsx("div",{className:"flex-1 overflow-hidden",children:s.jsx(Oa,{texts:["Looking for maths teacher","Looking for bike under 50,000","Looking for iPhone 14 under 30,000","Looking for wedding photographer","Looking for guitar trainer","Looking for office space for rent","Looking for laptop under 25,000","Looking for gym trainer nearby","Looking for interior designer","Looking for second-hand car under 2 lakh"],typingSpeed:50,deletingSpeed:30,pauseDuration:2500})})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[s.jsx("button",{onClick:()=>{e||J.error("Please log in to create a wish"),t("create-wish")},className:"bg-black text-white px-5 py-2.5 rounded-md font-bold text-[13px] sm:text-[14px] hover:bg-gray-800 transition-all border border-black",children:"Post a wish"}),s.jsx("button",{onClick:()=>t("wishes"),className:"bg-transparent text-gray-600 px-5 py-2.5 rounded-md font-medium text-[13px] sm:text-[14px] hover:text-black transition-all",children:"Explore wishes"})]})]})]})}),!E&&k.length===0&&v.length===0&&C.length===0&&s.jsxs("div",{className:"text-center py-12 mb-6",children:[s.jsx(u1,{className:"w-16 h-16 text-muted mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No nearby content yet"}),s.jsx("p",{className:"text-body mb-6",children:"Be the first to post a task in your area!"}),s.jsx("button",{onClick:()=>{t(e?"create-task":"login")},className:"bg-[#CDFF00] text-black px-6 py-3 rounded-md font-bold hover:bg-[#CDFF00]/90 transition-all",children:"Post a task"})]})]}),s.jsx(lc,{onNavigate:t,onContactClick:p||(()=>{}),socialLinks:y})]})}function i3({notification:t,onClose:e,onAction:r}){const[i,o]=j.useState(!1),[c,l]=j.useState(!1);j.useEffect(()=>{setTimeout(()=>o(!0),10);const y=setTimeout(()=>{u()},8e3);return()=>clearTimeout(y)},[]);const u=()=>{l(!0),setTimeout(e,300)},h=y=>{r?.(y,t),u()},f=()=>{switch(t.type){case"task_accepted":return s.jsx(rn,{className:"w-5 h-5 text-white"});case"task_cancelled":return s.jsx(ar,{className:"w-5 h-5 text-red-300"});case"task_completion_request":return s.jsx(cs,{className:"w-5 h-5 text-white"});case"task_completed":return s.jsx(rn,{className:"w-5 h-5 text-white"});case"chat_message":return s.jsx(ct,{className:"w-5 h-5 text-white"});default:return s.jsx(cs,{className:"w-5 h-5 text-white"})}},g=()=>t.type==="task_cancelled"||t.type.includes("rejected")?"bg-red-600":"bg-black",p=()=>{switch(t.type){case"task_accepted":return s.jsx("button",{onClick:()=>h("chat"),className:"px-4 py-2 bg-[#CDFF00] text-black rounded-lg hover:bg-[#b8e600] transition-colors text-sm font-medium",children:" Chat Now"});case"task_completion_request":return s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>h("mark_complete"),className:"px-4 py-2 bg-[#CDFF00] text-black rounded-lg hover:bg-[#b8e600] transition-colors text-sm font-medium",children:" Mark Complete"}),s.jsx("button",{onClick:()=>h("chat"),className:"px-4 py-2 bg-white text-black rounded-lg hover:bg-gray-100 transition-colors text-sm font-medium",children:" Chat"})]});case"task_cancelled":return s.jsx("button",{onClick:()=>h("view_task"),className:"px-4 py-2 bg-white text-black rounded-lg hover:bg-gray-100 transition-colors text-sm font-medium",children:"View Details"});case"chat_message":return s.jsx("button",{onClick:()=>h("chat"),className:"px-4 py-2 bg-[#CDFF00] text-black rounded-lg hover:bg-[#b8e600] transition-colors text-sm font-medium",children:"Reply"});default:return s.jsx("button",{onClick:()=>h("view"),className:"px-4 py-2 bg-[#CDFF00] text-black rounded-lg hover:bg-[#b8e600] transition-colors text-sm font-medium",children:"View"})}};return s.jsx("div",{className:`fixed top-4 right-4 z-[9999] max-w-md w-full transition-all duration-300 ${i&&!c?"translate-x-0 opacity-100":"translate-x-full opacity-0"}`,style:{pointerEvents:"auto"},children:s.jsxs("div",{className:`${g()} rounded-lg shadow-2xl overflow-hidden`,children:[s.jsxs("div",{className:"flex items-start gap-3 p-4",children:[s.jsx("div",{className:"shrink-0 mt-0.5",children:f()}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h4",{className:"font-semibold text-white text-sm mb-1",children:t.title}),s.jsx("p",{className:"text-sm text-white leading-relaxed",children:t.message}),t.metadata?.taskTitle&&s.jsxs("div",{className:"mt-2 p-2 bg-white/10 rounded border border-white/20",children:[s.jsx("p",{className:"text-xs text-gray-300",children:"Task:"}),s.jsx("p",{className:"text-sm font-medium text-white truncate",children:t.metadata.taskTitle}),t.metadata.taskPrice&&s.jsxs("p",{className:"text-xs text-white font-semibold mt-1",children:["",t.metadata.taskPrice.toLocaleString("en-IN")]})]})]}),s.jsx("button",{onClick:u,className:"shrink-0 p-1 hover:bg-white/10 rounded transition-colors","aria-label":"Close notification",children:s.jsx(ut,{className:"w-4 h-4 text-white"})})]}),s.jsx("div",{className:"p-4 pt-2 flex justify-end gap-2",children:p()})]})})}function a3({onComplete:t,onSkip:e}){return s.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/70 p-3 sm:p-4",children:s.jsxs("div",{className:"w-full max-w-md bg-white overflow-hidden flex flex-col max-h-[95vh]",style:{borderRadius:"20px"},children:[s.jsx("div",{className:"text-center pt-5 pb-4 px-5 bg-white flex-shrink-0",children:s.jsxs("svg",{width:"130",height:"21",viewBox:"0 0 1299 207",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"mx-auto",children:[s.jsx("path",{d:"M118.027 109.199L191.251 179.81L165.568 206.443L92.6514 136.129L26.9277 205.877L0 180.503L83.1953 92.2139H13.4639V55.2139H168.899L118.027 109.199ZM210.86 94.4766L185.385 121.311L148.632 86.417L174.106 59.583L210.86 94.4766ZM185.964 0C199.495 0 210.464 10.969 210.464 24.5C210.464 38.031 199.495 49 185.964 49C172.433 49 161.464 38.031 161.464 24.5C161.464 10.969 172.433 0 185.964 0Z",fill:"black"}),s.jsx("path",{d:"M278.838 171.202H327.456L321.462 204.28H229.11L256.86 47.77H300.372L278.838 171.202Z",fill:"black"}),s.jsx("path",{d:"M396.101 205.834C385.297 205.834 375.677 203.688 367.241 199.396C358.953 195.104 352.515 189.036 347.927 181.192C343.339 173.348 341.045 164.172 341.045 153.664C341.045 139.456 344.375 126.58 351.035 115.036C357.843 103.492 367.167 94.464 379.007 87.952C390.847 81.44 404.093 78.184 418.745 78.184C429.549 78.184 439.095 80.33 447.383 84.622C455.819 88.914 462.331 95.056 466.919 103.048C471.655 110.892 474.023 120.068 474.023 130.576C474.023 144.932 470.619 157.882 463.811 169.426C457.003 180.822 447.679 189.776 435.839 196.288C423.999 202.652 410.753 205.834 396.101 205.834ZM402.761 168.316C407.941 168.316 412.529 166.688 416.525 163.432C420.669 160.176 423.777 155.958 425.849 150.778C428.069 145.598 429.179 140.27 429.179 134.794C429.179 128.578 427.551 123.842 424.295 120.586C421.187 117.33 417.117 115.702 412.085 115.702C406.757 115.702 402.095 117.33 398.099 120.586C394.251 123.842 391.217 128.06 388.997 133.24C386.925 138.42 385.889 143.822 385.889 149.446C385.889 155.662 387.443 160.398 390.551 163.654C393.659 166.762 397.729 168.316 402.761 168.316Z",fill:"black"}),s.jsx("path",{d:"M483.29 141.898C485.658 128.874 490.32 117.626 497.276 108.154C504.38 98.534 513.112 91.134 523.472 85.954C533.98 80.774 545.376 78.184 557.66 78.184C573.496 78.184 586.076 82.55 595.4 91.282C604.724 99.866 609.608 111.928 610.052 127.468H563.654C562.47 119.328 557.956 115.258 550.112 115.258C544.636 115.258 539.9 117.552 535.904 122.14C531.908 126.58 529.17 133.166 527.69 141.898C527.098 144.858 526.802 147.818 526.802 150.778C526.802 156.698 528.06 161.212 530.576 164.32C533.092 167.28 536.496 168.76 540.788 168.76C548.78 168.76 554.626 164.69 558.326 156.55H604.724C598.952 171.942 589.85 184.004 577.418 192.736C565.134 201.468 551 205.834 535.016 205.834C518.736 205.834 505.786 201.394 496.166 192.514C486.694 183.634 481.958 171.424 481.958 155.884C481.958 151.444 482.402 146.782 483.29 141.898Z",fill:"black"}),s.jsx("path",{d:"M618.137 141.898C620.505 129.022 624.871 117.774 631.235 108.154C637.599 98.534 645.221 91.134 654.101 85.954C663.129 80.774 672.601 78.184 682.517 78.184C691.101 78.184 698.205 79.886 703.829 83.29C709.453 86.694 713.375 91.282 715.595 97.054L718.703 79.738H762.215L740.237 204.28H696.725L699.833 186.964C695.541 192.736 689.917 197.324 682.961 200.728C676.005 204.132 668.309 205.834 659.873 205.834C646.849 205.834 636.415 201.542 628.571 192.958C620.727 184.226 616.805 172.386 616.805 157.438C616.805 152.554 617.249 147.374 618.137 141.898ZM707.825 141.898C708.269 139.678 708.491 137.606 708.491 135.682C708.491 129.466 706.715 124.656 703.163 121.252C699.759 117.848 695.319 116.146 689.843 116.146C683.331 116.146 677.485 118.44 672.305 123.028C667.125 127.468 663.869 133.758 662.537 141.898C662.093 144.118 661.871 146.264 661.871 148.336C661.871 154.552 663.573 159.362 666.977 162.766C670.529 166.17 675.043 167.872 680.519 167.872C687.031 167.872 692.877 165.578 698.057 160.99C703.237 156.402 706.493 150.038 707.825 141.898Z",fill:"black"}),s.jsx("path",{d:"M837.848 40L808.766 204.28H765.032L794.114 40H837.848Z",fill:"black"}),s.jsx("path",{d:"M967.189 47.77L961.195 82.402H898.591L893.707 109.93H939.661L933.889 143.008H887.935L877.057 204.28H833.323L861.073 47.77H967.189Z",fill:"black"}),s.jsx("path",{d:"M1036.35 78.184C1052.63 78.184 1065.51 82.55 1074.98 91.282C1084.6 100.014 1089.41 111.928 1089.41 127.024C1089.41 132.056 1089.04 136.496 1088.3 140.344C1087.41 145.08 1086.52 148.484 1085.64 150.556H1003.27C1003.13 151.444 1003.05 152.776 1003.05 154.552C1003.05 160.176 1004.38 164.32 1007.05 166.984C1009.86 169.648 1013.56 170.98 1018.15 170.98C1025.4 170.98 1031.17 167.724 1035.46 161.212H1081.64C1078.24 169.796 1073.13 177.492 1066.32 184.3C1059.66 190.96 1051.74 196.214 1042.57 200.062C1033.54 203.91 1023.92 205.834 1013.71 205.834C997.428 205.834 984.478 201.394 974.858 192.514C965.238 183.634 960.428 171.424 960.428 155.884C960.428 151.444 960.872 146.782 961.76 141.898C964.128 128.874 968.79 117.626 975.746 108.154C982.85 98.534 991.582 91.134 1001.94 85.954C1012.45 80.774 1023.92 78.184 1036.35 78.184ZM1045.45 131.02C1045.75 128.948 1045.9 127.616 1045.9 127.024C1045.9 122.288 1044.42 118.736 1041.46 116.368C1038.5 113.852 1034.65 112.594 1029.91 112.594C1024.44 112.594 1019.7 114.148 1015.71 117.256C1011.71 120.364 1008.75 124.952 1006.83 131.02H1045.45Z",fill:"black"}),s.jsx("path",{d:"M1167.38 40L1138.3 204.28H1094.56L1123.65 40H1167.38Z",fill:"black"}),s.jsx("path",{d:"M1220.8 205.834C1209.99 205.834 1200.37 203.688 1191.94 199.396C1183.65 195.104 1177.21 189.036 1172.62 181.192C1168.03 173.348 1165.74 164.172 1165.74 153.664C1165.74 139.456 1169.07 126.58 1175.73 115.036C1182.54 103.492 1191.86 94.464 1203.7 87.952C1215.54 81.44 1228.79 78.184 1243.44 78.184C1254.24 78.184 1263.79 80.33 1272.08 84.622C1280.51 88.914 1287.03 95.056 1291.61 103.048C1296.35 110.892 1298.72 120.068 1298.72 130.576C1298.72 144.932 1295.31 157.882 1288.51 169.426C1281.7 180.822 1272.37 189.776 1260.53 196.288C1248.69 202.652 1235.45 205.834 1220.8 205.834ZM1227.46 168.316C1232.64 168.316 1237.22 166.688 1241.22 163.432C1245.36 160.176 1248.47 155.958 1250.54 150.778C1252.76 145.598 1253.87 140.27 1253.87 134.794C1253.87 128.578 1252.25 123.842 1248.99 120.586C1245.88 117.33 1241.81 115.702 1236.78 115.702C1231.45 115.702 1226.79 117.33 1222.79 120.586C1218.95 123.842 1215.91 128.06 1213.69 133.24C1211.62 138.42 1210.58 143.822 1210.58 149.446C1210.58 155.662 1212.14 160.398 1215.25 163.654C1218.35 166.762 1222.42 168.316 1227.46 168.316Z",fill:"black"})]})}),s.jsxs("div",{className:"px-5 pb-4 space-y-3 overflow-y-auto flex-1",children:[s.jsxs("div",{className:"bg-[#CDFF00] p-4 border-2 border-[#CDFF00] shadow-[0_0_0_2px_black]",style:{borderRadius:"14px"},children:[s.jsxs("div",{className:"flex items-center gap-2.5 mb-2",children:[s.jsx("div",{className:"flex-shrink-0 w-9 h-9 bg-black flex items-center justify-center",style:{borderRadius:"8px"},children:s.jsx(f1,{className:"w-[18px] h-[18px] text-[#CDFF00]"})}),s.jsx("h3",{className:"text-black text-[16px]",style:{fontWeight:"800"},children:"Tasks"})]}),s.jsx("p",{className:"text-black text-[13px] leading-relaxed mb-2",style:{fontWeight:"600"},children:"Need help? Post tasks. Want to earn? Complete tasks."}),s.jsx("div",{className:"bg-black/10 px-3 py-2 min-h-[36px] flex items-center",style:{borderRadius:"8px"},children:s.jsx("div",{className:"text-black text-[12px] leading-tight w-full",children:s.jsx(Oa,{texts:["Need help with luggage shifting","Bring gas cylinder from market","Clean my car today","Help with Java coding issue","Pick up grocery from store","Fix leaking tap now"],typingSpeed:50,deletingSpeed:30,pauseDuration:2e3})})})]}),s.jsxs("div",{className:"bg-white border-2 border-gray-200 p-4",style:{borderRadius:"14px"},children:[s.jsxs("div",{className:"flex items-center gap-2.5 mb-2",children:[s.jsx("div",{className:"flex-shrink-0 w-9 h-9 bg-[#CDFF00] flex items-center justify-center",style:{borderRadius:"8px"},children:s.jsx(mt,{className:"w-[18px] h-[18px] text-black"})}),s.jsx("h3",{className:"text-black text-[16px]",style:{fontWeight:"800"},children:"Wishes"})]}),s.jsx("p",{className:"text-gray-700 text-[13px] leading-relaxed mb-2",style:{fontWeight:"500"},children:"Looking for something? Post a wish and people will respond."}),s.jsx("div",{className:"bg-gray-50 px-3 py-2 min-h-[36px] flex items-center",style:{borderRadius:"8px"},children:s.jsx("div",{className:"text-gray-700 text-[12px] leading-tight w-full",children:s.jsx(Oa,{texts:["Looking for maths teacher","Looking for bike under 50,000","Looking for iPhone 14 under 30,000","Looking for wedding photographer","Looking for laptop under 25,000","Looking for gym trainer nearby"],typingSpeed:50,deletingSpeed:30,pauseDuration:2e3})})})]}),s.jsxs("div",{className:"bg-white border-2 border-gray-200 p-4",style:{borderRadius:"14px"},children:[s.jsxs("div",{className:"flex items-center gap-2.5 mb-2",children:[s.jsx("div",{className:"flex-shrink-0 w-9 h-9 bg-[#CDFF00] flex items-center justify-center",style:{borderRadius:"8px"},children:s.jsx(Ua,{className:"w-[18px] h-[18px] text-black"})}),s.jsx("h3",{className:"text-black text-[16px]",style:{fontWeight:"800"},children:"Marketplace"})]}),s.jsx("p",{className:"text-gray-700 text-[13px] leading-relaxed mb-2",style:{fontWeight:"500"},children:"Buy and sell anything locally. Chat directly with sellers."}),s.jsx("div",{className:"bg-gray-50 px-3 py-2 min-h-[36px] flex items-center",style:{borderRadius:"8px"},children:s.jsx("div",{className:"text-gray-700 text-[12px] leading-tight w-full",children:s.jsx(Oa,{texts:["Sofa set in great condition","iPhone 13 under 35,000","Gaming laptop for sale","Kids bicycle barely used","Study table with chair","Books at 50% off"],typingSpeed:50,deletingSpeed:30,pauseDuration:2e3})})})]})]}),s.jsxs("div",{className:"px-5 py-5 space-y-2.5 bg-white border-t border-gray-100 flex-shrink-0",children:[s.jsx("button",{onClick:t,className:"w-full bg-[#CDFF00] text-black py-3.5 px-6 hover:bg-[#b8e600] transition-colors",style:{fontWeight:"900",borderRadius:"11px",fontSize:"15px"},children:"Get started"}),s.jsx("button",{onClick:e,className:"w-full text-gray-500 text-[13px] py-2 hover:text-gray-700 transition-colors",style:{fontWeight:"600"},children:"Skip for now"})]})]})})}function o3({isOpen:t,onClose:e,onNavigate:r,userCoordinates:i}){const[o,c]=j.useState(""),[l,u]=j.useState({listings:[],wishes:[],tasks:[]}),[h,f]=j.useState(!1),[g,p]=j.useState([]);j.useEffect(()=>{(async()=>{try{const w=await Ti();p(w)}catch(w){console.error("Failed to load categories:",w)}})()},[]),j.useEffect(()=>{if(!o.trim()){u({listings:[],wishes:[],tasks:[]});return}const w=setTimeout(async()=>{f(!0);try{const k=o.toLowerCase(),N=g.filter(P=>P.name.toLowerCase().includes(k)||P.slug.toLowerCase().includes(k)).map(P=>P.id),C=await ah({limit:1e3,userLat:i?.latitude,userLon:i?.longitude}),A=(C.data||C).filter(P=>{const D=P.title.toLowerCase().includes(k)||P.description.toLowerCase().includes(k),H=P.categoryName?.toLowerCase().includes(k),B=N.includes(String(P.categoryId));return D||H||B});i&&A.sort((P,D)=>P.distance!==void 0&&D.distance===void 0?-1:P.distance===void 0&&D.distance!==void 0?1:P.distance===void 0&&D.distance===void 0?0:P.distance-D.distance);const _=(await dc()).filter(P=>P.title.toLowerCase().includes(k)||P.description?.toLowerCase().includes(k)).slice(0,5),L=(await uc(void 0,void 0,void 0)).filter(P=>P.title.toLowerCase().includes(k)||P.description.toLowerCase().includes(k)).slice(0,5);u({listings:A.slice(0,10),wishes:_,tasks:L})}catch(k){console.error("Search failed:",k)}finally{f(!1)}},300);return()=>clearTimeout(w)},[o,g,i]);const y=l.listings.length+l.wishes.length+l.tasks.length;return s.jsx(Ar,{isOpen:t,onClose:e,title:"",children:s.jsxs("div",{className:"max-w-3xl mx-auto",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(mt,{className:"w-6 h-6 text-[#CDFF00]"}),s.jsx("h2",{className:"text-2xl font-bold",children:"Smart Search"})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Search across marketplace, wishes, and tasks"}),s.jsxs("div",{className:"relative",children:[s.jsx(Rs,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),s.jsx("input",{type:"text",value:o,onChange:v=>c(v.target.value),placeholder:"Try 'phone', 'furniture', 'cleaning'...",className:"w-full pl-11 pr-10 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#CDFF00] focus:border-transparent text-base",autoFocus:!0}),o&&s.jsx("button",{onClick:()=>c(""),className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 hover:bg-gray-100 rounded",children:s.jsx(ut,{className:"w-4 h-4 text-gray-400"})})]})]}),s.jsx("div",{className:"max-h-[60vh] overflow-y-auto",children:h?s.jsxs("div",{className:"text-center py-8 text-gray-500",children:[s.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-[#CDFF00] border-t-transparent rounded-full mx-auto mb-2"}),"Searching..."]}):o.trim()===""?s.jsxs("div",{className:"text-center py-12 text-gray-500",children:[s.jsx(Rs,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),s.jsx("p",{children:"Start typing to search..."})]}):y===0?s.jsxs("div",{className:"text-center py-12 text-gray-500",children:[s.jsx(Rs,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),s.jsxs("p",{children:['No results found for "',o,'"']}),s.jsx("p",{className:"text-sm mt-1",children:"Try different keywords"})]}):s.jsxs("div",{className:"space-y-6",children:[l.listings.length>0&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(Fn,{className:"w-4 h-4 text-gray-600"}),s.jsxs("h3",{className:"font-bold text-sm text-gray-700",children:["MARKETPLACE (",l.listings.length,")"]})]}),s.jsx("div",{className:"space-y-2",children:l.listings.map(v=>s.jsx("button",{onClick:()=>{r("listing",v),e()},className:"w-full text-left p-3 border border-gray-200 rounded-lg hover:border-[#CDFF00] hover:bg-gray-50 transition-all",children:s.jsxs("div",{className:"flex gap-3",children:[v.imageUrl&&s.jsx("img",{src:v.imageUrl,alt:v.title,className:"w-16 h-16 object-cover rounded"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-semibold truncate",children:v.title}),s.jsx("p",{className:"text-sm text-gray-600 truncate",children:v.categoryName}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsxs("span",{className:"font-bold text-white bg-black px-2 py-0.5 rounded text-sm",children:["",v.price]}),v.distance!==void 0&&s.jsxs("span",{className:"text-xs text-gray-500",children:[v.distance.toFixed(1)," km away"]})]})]})]})},v.id))})]}),l.wishes.length>0&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(bs,{className:"w-4 h-4 text-gray-600"}),s.jsxs("h3",{className:"font-bold text-sm text-gray-700",children:["WISHES (",l.wishes.length,")"]})]}),s.jsx("div",{className:"space-y-2",children:l.wishes.map(v=>s.jsxs("button",{onClick:()=>{r("wish-detail",{wishId:v.id}),e()},className:"w-full text-left p-3 border border-gray-200 rounded-lg hover:border-[#CDFF00] hover:bg-gray-50 transition-all",children:[s.jsx("p",{className:"font-semibold",children:v.title}),v.description&&s.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:v.description}),v.budget&&s.jsxs("p",{className:"text-sm font-medium text-[#CDFF00] mt-1",children:["Budget: ",v.budget]})]},v.id))})]}),l.tasks.length>0&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(Ot,{className:"w-4 h-4 text-gray-600"}),s.jsxs("h3",{className:"font-bold text-sm text-gray-700",children:["TASKS (",l.tasks.length,")"]})]}),s.jsx("div",{className:"space-y-2",children:l.tasks.map(v=>s.jsxs("button",{onClick:()=>{r("task-detail",{taskId:v.id}),e()},className:"w-full text-left p-3 border border-gray-200 rounded-lg hover:border-[#CDFF00] hover:bg-gray-50 transition-all",children:[s.jsx("p",{className:"font-semibold",children:v.title}),s.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:v.description}),v.budget&&s.jsxs("p",{className:"text-sm font-medium text-[#CDFF00] mt-1",children:["Budget: ",v.budget]})]},v.id))})]})]})})]})})}function l3({onNavigate:t,activeTasksCount:e}){const[r,i]=j.useState(!1),[o,c]=j.useState(!1),[l,u]=j.useState("Active Tasks"),[h,f]=j.useState("Tap to view details"),[g,p]=j.useState("");j.useEffect(()=>{y()},[]),j.useEffect(()=>{if(sessionStorage.getItem("activeTaskBannerDismissed")==="true"){c(!0);return}e>0?i(!0):i(!1)},[e]);const y=async()=>{try{const{data:k,error:N}=await V.from("site_settings").select("title, message, image_url").eq("id","active_task_banner").single();k&&(u(k.title||"Active Tasks"),f(k.message||"Tap to view details"),p(k.image_url||""))}catch(k){console.error("Error loading banner settings:",k)}},v=k=>{k.stopPropagation(),i(!1),c(!0),sessionStorage.setItem("activeTaskBannerDismissed","true")},w=()=>{t("tasks")};return!r||o||e===0?null:s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"sm:hidden fixed bottom-[60px] left-0 right-0 z-40 px-3 pb-2",children:s.jsx("div",{onClick:w,className:"bg-black text-white rounded-lg shadow-lg cursor-pointer hover:bg-gray-800 transition-all animate-slide-up",children:s.jsxs("div",{className:"flex items-center gap-2 px-3 py-2",children:[g?s.jsx("div",{className:"w-7 h-7 rounded-full overflow-hidden flex-shrink-0",children:s.jsx("img",{src:g,alt:"",className:"w-full h-full object-cover"})}):s.jsx("div",{className:"bg-[#CDFF00] rounded-full p-1.5",children:s.jsx(Ot,{className:"w-3.5 h-3.5 text-black"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("p",{className:"text-xs font-semibold truncate",children:[e," ",l]}),s.jsx("p",{className:"text-[10px] text-white/70",children:h})]}),s.jsx("button",{onClick:v,className:"p-1 hover:bg-white/10 rounded transition-colors","aria-label":"Dismiss",children:s.jsx(ut,{className:"w-3.5 h-3.5"})})]})})}),s.jsx("div",{className:"hidden sm:block fixed bottom-6 right-6 z-40",children:s.jsx("div",{onClick:w,className:"bg-black text-white rounded-lg shadow-lg cursor-pointer hover:bg-gray-800 transition-all animate-slide-up",children:s.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[g?s.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden flex-shrink-0",children:s.jsx("img",{src:g,alt:"",className:"w-full h-full object-cover"})}):s.jsx("div",{className:"bg-[#CDFF00] rounded-full p-2",children:s.jsx(Ot,{className:"w-4 h-4 text-black"})}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("p",{className:"text-sm font-semibold whitespace-nowrap",children:[e," ",l]}),s.jsx("p",{className:"text-xs text-white/70",children:h})]}),s.jsx("button",{onClick:v,className:"p-1 hover:bg-white/10 rounded transition-colors","aria-label":"Dismiss",children:s.jsx(ut,{className:"w-4 h-4"})})]})})})]})}function zx(t){return t==="/"?"home":t.startsWith("/listing/")?"listing":t.startsWith("/edit-listing/")?"edit":{"/marketplace":"marketplace","/create":"create","/profile":"profile","/chat":"chat","/admin":"admin","/about":"about","/terms":"terms","/privacy":"privacy","/safety":"safety","/contact":"contact","/diagnostic":"diagnostic","/notifications":"notifications","/wishes":"wishes","/create-wish":"create-wish","/wish-detail":"wish-detail","/tasks":"tasks","/create-task":"create-task","/task-detail":"task-detail","/prohibited":"prohibited"}[t]||"home"}function c3(){const[t,e]=j.useState("home"),[r,i]=j.useState(null),[o,c]=j.useState(!1),[l,u]=j.useState(null),[h,f]=j.useState(!1),[g,p]=j.useState(!1),[y,v]=j.useState(!1),[w,k]=j.useState(!1),[N,C]=j.useState([]),[A,E]=j.useState(!0),[_,R]=j.useState(0),[L,P]=j.useState(null),[D,H]=j.useState(null),[B,ae]=j.useState(null),[ue,le]=j.useState(null),[fe,we]=j.useState(null),[oe,Y]=j.useState(0),[I,$]=j.useState(!1),[W,T]=j.useState(""),[z,G]=j.useState(!1),[M,X]=j.useState(!1),[ie,be]=j.useState(!1),[ve,ee]=j.useState(!1),[ce,Ue]=j.useState(null),[he,Le]=j.useState([]),[Ke,at]=j.useState(!1),[re,ne]=j.useState(!1),[Oe,He]=j.useState([]),[wt,Lt]=j.useState({}),[st,Qt]=j.useState(""),[Ae,Je]=j.useState([]),[jt,St]=j.useState(!1),{location:xe,loading:ur,updateLocation:ts,hasAttemptedLoad:Ds}=Fi(r?.id||null),[Zs,hr]=j.useState(()=>localStorage.getItem("localfelo_location_modal_shown")==="true"),{notifications:js,unreadCount:zt,markAsRead:Ir,markAllAsRead:dn,deleteNotification:mr}=J2(r?.id||null),Zt=ek(r?.id),qe=$5();j.useEffect(()=>{const O={home:"LocalFelo - Get Help Nearby | Post Tasks, Wishes & Local Marketplace",marketplace:"Local Marketplace Near You - Buy & Sell Locally | LocalFelo",tasks:"Available Tasks Near You - Find Local Gigs & Services | LocalFelo",wishes:"Wishes Near You - Post What You Need | LocalFelo",create:"Sell Item - Create Listing | LocalFelo","create-task":"Post Task | LocalFelo","create-wish":"Post Wish | LocalFelo",profile:"My Profile | LocalFelo",chat:"Messages | LocalFelo",notifications:"Notifications | LocalFelo",admin:"Admin Panel | LocalFelo",about:"About Us | LocalFelo",terms:"Terms of Service | LocalFelo",privacy:"Privacy Policy | LocalFelo",safety:"Safety Guidelines | LocalFelo",contact:"Contact Us | LocalFelo",prohibited:"Prohibited Items | LocalFelo",listing:"View Item | LocalFelo","task-detail":"Task Details | LocalFelo","wish-detail":"Wish Details | LocalFelo",edit:"Edit Listing | LocalFelo",diagnostic:"Diagnostics | LocalFelo"};document.title=O[t]||"LocalFelo - Get Help Nearby"},[t]),j.useEffect(()=>{r?.id?(window.testNotification=async()=>{const O=await Zy(r.id);return console.log("Test notification result:",O),O},window.pushStatus=Zt):(window.testNotification=void 0,window.pushStatus=void 0)},[r?.id,Zt]),j.useEffect(()=>{window.scrollTo(0,0)},[t]),j.useEffect(()=>{window.testToast=()=>{console.log(" Testing all toast types..."),qe.success(" Success toast test!"),setTimeout(()=>qe.error(" Error toast test!"),500),setTimeout(()=>qe.info(" Info toast test!"),1e3),setTimeout(()=>qe.warning(" Warning toast test!"),1500)}},[qe]),j.useEffect(()=>{if(!r||js.length===0)return;const O=["task_accepted","task_cancelled","task_completion_request","task_completed"],U=js.find(De=>!De.is_read&&O.includes(De.type)&&!Oe.includes(De.id));U&&(console.log(" Showing popup for critical notification:",U),Ue(U),He(De=>[...De,U.id]));const Re=["broadcast","info","promotion","alert"],pe=js.find(De=>!De.is_read&&Re.includes(De.type)&&!he.includes(De.id));pe&&(console.log(" Showing toast for broadcast notification:",pe),qe.info(`${pe.title}: ${pe.message}`),Le(De=>[...De,pe.id]))},[js,r,qe,Oe,he]),j.useEffect(()=>{!js.some(U=>!U.is_read)&&(Oe.length>0||he.length>0)&&(console.log(" [App] No unread notifications - clearing shown notification tracking"),He([]),Le([]))},[js,Oe.length,he.length]),j.useEffect(()=>{xe&&xe.latitude&&xe.longitude&&(console.log(" [App] User location SET:",{city:xe.city,area:xe.area,lat:xe.latitude.toFixed(4),lon:xe.longitude.toFixed(4)}),console.log(" [App] Distances will now be calculated for all items!"))},[xe]),j.useEffect(()=>{if(localStorage.getItem("localfelo_location_modal_shown")==="true"){console.log(" [App] Location modal already shown before - not showing again"),ne(!0),hr(!0);return}const U=xe&&xe.city==="Bangalore"&&xe.latitude===12.9716&&xe.longitude===77.5946&&xe.detectionMethod==="manual";if(xe&&xe.latitude&&xe.longitude&&!U){console.log(" [App] Valid user-selected location detected - not showing modal"),localStorage.setItem("localfelo_location_modal_shown","true"),ne(!0),hr(!0);return}const Re=localStorage.getItem("localfelo_guest_location")||localStorage.getItem("oldcycle_guest_location");if(Re)try{const pe=JSON.parse(Re),De=pe.city==="Bangalore"&&pe.latitude===12.9716&&pe.longitude===77.5946;if(pe.latitude&&pe.longitude&&!De){console.log(" [App] User-selected location found in localStorage - not showing modal"),localStorage.setItem("localfelo_location_modal_shown","true"),ne(!0),hr(!0);return}}catch(pe){console.error(" [App] Failed to parse saved location:",pe)}if(!(!Ds||ur)){if(!M||Ke){console.log(" [App] Location modal waiting: hasCheckedIntro=",M,"justCreatedContent=",Ke);return}re||(console.log(" [App]  Intro complete! Now showing location setup modal"),St(!0),ne(!0),localStorage.setItem("localfelo_location_modal_shown","true"),hr(!0))}},[Ds,ur,xe,M,Ke,re,Zs]);const Fs=async O=>{console.log(" [App] Syncing Supabase session with OldCycle auth...");try{const{data:U,error:Re}=await V.from("profiles").select("*").eq("id",O.user.id).single();if(Re&&Re.code!=="PGRST116"){console.error(" [App] Profile fetch error:",Re);return}let pe=U?.client_token,De=U?.display_name||O.user.user_metadata?.name||O.user.email?.split("@")[0]||"User";const Ie=localStorage.getItem("localfelo_guest_location")||localStorage.getItem("oldcycle_guest_location");let $e=null;if(Ie)try{$e=JSON.parse(Ie),console.log(" [App] Found guest location to migrate:",$e)}catch(Rt){console.error(" [App] Failed to parse guest location:",Rt)}if(U)if($e&&(!U.city||!U.latitude||!U.longitude)){console.log(" [App] Migrating guest location to existing profile");const{error:Rt}=await V.from("profiles").update({city_id:$e.cityId,city:$e.city,area_id:$e.areaId,area:$e.area,latitude:$e.latitude,longitude:$e.longitude,location_updated_at:new Date().toISOString()}).eq("id",O.user.id);Rt?console.error(" [App] Failed to migrate guest location:",Rt):(localStorage.removeItem("localfelo_guest_location"),localStorage.removeItem("oldcycle_guest_location"),console.log(" [App] Guest location migrated to existing profile and cleared"))}else $e&&(localStorage.removeItem("localfelo_guest_location"),localStorage.removeItem("oldcycle_guest_location"),console.log(" [App] Guest location cleared (profile already has location)"),localStorage.removeItem("localfelo_guest_location"),localStorage.removeItem("oldcycle_guest_location"),ne(!0),setHadValidLocationOnce(!0),console.log(" [App] Guest location cleared (profile already has location)"));else{console.log(" [App] Creating new OldCycle profile...");const Rt=window.crypto||window.msCrypto,oo=new Uint8Array(32);Rt.getRandomValues(oo),pe=Array.from(oo,fr=>fr.toString(16).padStart(2,"0")).join("");const Xs={id:O.user.id,email:O.user.email,display_name:De,client_token:pe,created_at:new Date().toISOString()};$e&&(Xs.city_id=$e.cityId,Xs.city=$e.city,Xs.area_id=$e.areaId,Xs.area=$e.area,Xs.latitude=$e.latitude,Xs.longitude=$e.longitude,Xs.location_updated_at=new Date().toISOString(),console.log(" [App] Migrating guest location to new profile"));const{error:lo}=await V.from("profiles").insert(Xs);if(lo){console.error(" [App] Profile creation error:",lo);return}console.log(" [App] Profile created successfully"),$e&&(localStorage.removeItem("localfelo_guest_location"),localStorage.removeItem("oldcycle_guest_location"),console.log(" [App] Guest location migrated and cleared from localStorage"))}const Te={id:O.user.id,email:O.user.email,name:De,phone:U?.phone||"",whatsappSame:U?.whatsapp_same??!0,whatsappNumber:U?.whatsapp_number||void 0,authUserId:O.user.id,clientToken:pe,profilePic:O.user.user_metadata?.avatar_url||U?.avatar_url||void 0};localStorage.setItem("oldcycle_user",JSON.stringify(Te)),localStorage.setItem("oldcycle_token",pe),i(Te);const{checkIsAdmin:Ye}=await ys(async()=>{const{checkIsAdmin:Rt}=await Promise.resolve().then(()=>Dy);return{checkIsAdmin:Rt}},void 0),Ze=await Ye();c(Ze),console.log(" [App] OldCycle auth synced successfully"),O.user.user_metadata?.needs_password_setup===!0||qe.success(`Welcome back, ${De}! `)}catch(U){console.error(" [App] Session sync error:",U)}};j.useEffect(()=>{console.log(" App initializing...");const O=async()=>{const{data:{session:Te}}=await V.auth.getSession();return Te?(console.log(" Active Supabase session found"),await Fs(Te),!0):!1},U=()=>{const Te=tt(),Ye=nn();return Te&&Ye?(console.log(" User found in localStorage:",Te.name),i(Te),Iu().then(Ze=>{c(Ze),Ze&&console.log(" Admin user detected")}),!0):(console.log(" No user in localStorage"),!1)};O().then(Te=>{Te||U()}),new URLSearchParams(window.location.search).get("screen")==="diagnostic"&&e("diagnostic"),console.log(" Initializing history for mobile back button support");const pe=window.location.pathname,De=zx(pe);if(De!=="home"||pe!=="/"){if(console.log(" Setting initial screen from URL:",pe,"",De),e(De),pe.startsWith("/listing/")){const Te=pe.split("/listing/")[1];Te&&(console.log(" Loading listing from URL:",Te),hi(Te).then(Ye=>{Ye&&u(Ye)}).catch(Ye=>console.error("Failed to load listing:",Ye)))}if(pe.startsWith("/edit-listing/")){const Te=pe.split("/edit-listing/")[1];Te&&(console.log(" Loading edit listing from URL:",Te),hi(Te).then(Ye=>{Ye&&u(Ye)}).catch(Ye=>console.error("Failed to load listing:",Ye)))}}window.history.replaceState({screen:De,isBase:!0,sentinel:!0},"",pe);const Ie=Te=>{const Ye=window.location.pathname,Ze=zx(Ye);if(console.log(" Back button pressed - Path:",Ye,"Screen:",Ze,"State:",Te.state),Ye.startsWith("/listing/")){const Ct=Ye.split("/listing/")[1];if(Ct&&Te.state?.listingId){console.log(" Loading listing from history:",Ct),hi(Ct).then(Rt=>{Rt?(u(Rt),e("listing")):e("home")}).catch(()=>{e("home")}),window.scrollTo(0,0);return}}if(Ye.startsWith("/edit-listing/")){const Ct=Ye.split("/edit-listing/")[1];if(Ct&&Te.state?.listingId){console.log(" Loading edit listing from history:",Ct),hi(Ct).then(Rt=>{Rt?(u(Rt),e("edit")):e("home")}).catch(()=>{e("home")}),window.scrollTo(0,0);return}}if(Ze==="wish-detail"&&Te.state?.wishId){console.log(" Loading wish from history:",Te.state.wishId),H(Te.state.wishId),e("wish-detail"),window.scrollTo(0,0);return}if(Ze==="task-detail"&&Te.state?.taskId){console.log(" Loading task from history:",Te.state.taskId),ae(Te.state.taskId),e("task-detail"),window.scrollTo(0,0);return}if(Ze==="chat"&&Te.state?.conversationId){console.log(" Loading chat from history:",Te.state.conversationId),P(Te.state.conversationId),e("chat"),window.scrollTo(0,0);return}console.log(" Navigating to screen:",Ze),window.scrollTo(0,0),e(Ze)};window.addEventListener("popstate",Ie);const{data:$e}=V.auth.onAuthStateChange(async(Te,Ye)=>{console.log(" Auth event:",Te),Te==="SIGNED_IN"&&Ye?await Fs(Ye):Te==="SIGNED_OUT"?(console.log(" User signed out"),i(null),c(!1)):Te==="PASSWORD_RECOVERY"&&(console.log(" Password recovery event"),qe.info("Please set your new password"))});return()=>{window.removeEventListener("popstate",Ie),$e?.subscription.unsubscribe()}},[]),j.useEffect(()=>{async function O(){console.log(" Loading cities from Supabase..."),E(!0);try{const U=await nh();C(U),console.log(` Loaded ${U.length} cities`)}catch(U){console.error(" Failed to load cities:",U),qe.error("Failed to load locations. Please refresh the page.")}finally{E(!1)}}O()},[]),j.useEffect(()=>{async function O(){try{console.log(" [App] Loading app download settings...");const{data:U,error:Re}=await V.from("site_settings").select("enabled, app_download_url").eq("id","app_download").single();console.log(" [App] App download settings:",{data:U,error:Re}),U?($(U.enabled||!1),T(U.app_download_url||""),console.log(" [App] App download settings loaded:",{enabled:U.enabled,url:U.app_download_url})):console.log(" [App] No app download settings found")}catch(U){console.error(" [App] Error loading app download settings:",U)}}O()},[]),j.useEffect(()=>{async function O(){try{const{data:U,error:Re}=await V.from("site_settings").select("instagram_url, facebook_url, linkedin_url").eq("id","social_links").single();U&&Lt({instagram:U.instagram_url||void 0,facebook:U.facebook_url||void 0,linkedin:U.linkedin_url||void 0})}catch(U){console.error("Error loading social links:",U)}}O()},[]),j.useEffect(()=>{const O=localStorage.getItem("localfelo_intro_skipped");console.log(" [App] Checking intro status:",{introSkipped:O}),O?(console.log(" [App] Returning user - skipping intro"),X(!0)):(console.log(" [App] First time user - showing intro modal"),G(!0))},[]),j.useEffect(()=>{if(t==="home"){const O=window.history.state;(!O||O.screen!=="home")&&(console.log(" Ensuring home screen has proper history state"),window.history.replaceState({screen:"home",isBase:!0,sentinel:!0},"","/"))}},[t]),j.useEffect(()=>{if(!r){R(0);return}const O=async()=>{console.log(" [App] Fetching unread count...");const pe=await By();console.log(" [App] Unread count fetched:",pe),R(pe)};O(),console.log(" [App] Setting up real-time subscription for unread count...");const U=ih(()=>{console.log(" [App]  REAL-TIME CALLBACK FIRED! Refreshing unread count..."),O()}),Re=setInterval(()=>{t!=="chat"&&(console.log(" [App] Polling unread count (fallback)..."),O())},3e3);return()=>{console.log(" [App] Cleaning up unread count subscription..."),U?.unsubscribe(),clearInterval(Re)}},[r,t]),j.useEffect(()=>{if(!r){Y(0);return}const O=async()=>{try{const{getUserActiveTasks:pe}=await ys(async()=>{const{getUserActiveTasks:Ie}=await Promise.resolve().then(()=>Jb);return{getUserActiveTasks:Ie}},void 0),De=await pe(r.id);Y(De.length),console.log(" [App] Active tasks count:",De.length)}catch(pe){console.error(" [App] Failed to fetch active tasks count:",pe)}};O();const U=V.channel("active-tasks-changes").on("postgres_changes",{event:"*",schema:"public",table:"tasks",filter:`user_id=eq.${r.id},acceptedBy=eq.${r.id}`},pe=>{console.log(" [App] Task changed, refreshing active tasks count...",pe),O()}).subscribe(),Re=setInterval(()=>{O()},1e4);return()=>{U.unsubscribe(),clearInterval(Re)}},[r]),j.useEffect(()=>{(async()=>{if(t==="listing"&&!l&&N.length>0){const Re=window.location.pathname.match(/^\/listing\/(.+)$/);if(Re&&Re[1]){const pe=Re[1];if(!pe||pe==="undefined"||pe==="null"){console.error(" [App] Invalid listing ID in URL:",pe),e("home");return}console.log(" [App] Fetching listing from URL:",pe);try{const De=await Ti(),Ie=await hi(pe,xe?.latitude,xe?.longitude);if(Ie){console.log(" [App] Listing fetched successfully:",Ie);const $e=De.find(Ct=>Ct.slug===Ie.category_slug),Te=N.find(Ct=>Ct.name===Ie.city),Ye=Te&&Te.areas?Te.areas.find(Ct=>Ct.slug===Ie.area_slug):void 0,Ze={id:Ie.id,title:Ie.title,description:Ie.description,price:Ie.price,categoryId:$e?.id||0,categoryName:$e?.name||"Other",categoryEmoji:$e?.emoji||"",cityId:Te?.id||"",cityName:Te?.name||"",areaId:Ye?.id||"",areaName:Ye?.name||"",images:Ie.images||[],phone:Ie.owner_phone,hasWhatsapp:Ie.whatsapp_enabled||!1,whatsapp:Ie.whatsapp_number,userId:Ie.owner_token,userName:Ie.owner_name,createdAt:Ie.created_at,isHidden:!Ie.is_active,latitude:Ie.latitude,longitude:Ie.longitude,distance:Ie.distance};u(Ze)}else console.error(" [App] Listing not found"),qe.error("Listing not found"),se("home")}catch(De){console.error(" [App] Failed to fetch listing:",De),qe.error("Failed to load listing"),se("home")}}}})()},[t,l,N]);const Ms=async O=>{console.log(" Logging in with client token...");try{const U=await Iy(O);if(U&&U.user){console.log(" Login successful:",U.user.name),i(U.user);const Re=await Iu();c(Re),Re&&console.log(" Admin user logged in"),qe.success(`Welcome back, ${U.user.name}! `)}else console.error(" Login failed: No user returned"),qe.error("Login failed. Please try again.")}catch(U){console.error(" Login error:",U),qe.error(U?.message||"Login failed. Please try again.")}},Lr=async()=>{await Ay(),i(null),c(!1),e("home"),qe.success("Logged out successfully")},se=(O,U)=>{if((O==="profile"||O==="create"||O==="chat"||O==="create-wish"||O==="create-task")&&!r){f(!0);return}if(O==="listing"&&U){if(!U.id||U.id==="undefined"||U.id==="null"||U.id===""||typeof U.id!="string"){console.error(" [App] Cannot navigate to listing with invalid ID:",U.id,"Title:",U.title,"Type:",typeof U.id),e("home");return}u(U),window.history.pushState({screen:O,listingId:U.id},"",`/listing/${U.id}`)}else if(O==="edit"&&U){if(!U.id||U.id==="undefined"||U.id==="null"||U.id===""||typeof U.id!="string"){console.error(" [App] Cannot navigate to edit with invalid ID:",U.id,"Title:",U.title,"Type:",typeof U.id),e("home");return}u(U),window.history.pushState({screen:O,listingId:U.id},"",`/edit-listing/${U.id}`)}else if(O==="wish-detail")window.history.pushState({screen:O,wishId:D},"","/wish-detail");else if(O==="task-detail")window.history.pushState({screen:O,taskId:B},"","/task-detail");else if(O==="chat")window.history.pushState({screen:O,conversationId:L},"","/chat");else{const Re={home:"/",marketplace:"/marketplace",create:"/create",profile:"/profile",chat:"/chat",admin:"/admin",about:"/about",terms:"/terms",privacy:"/privacy",safety:"/safety",contact:"/contact",diagnostic:"/diagnostic",listing:"/",edit:"/",notifications:"/notifications",wishes:"/wishes","create-wish":"/create-wish","wish-detail":"/wish-detail",tasks:"/tasks","create-task":"/create-task","task-detail":"/task-detail"};window.history.pushState({screen:O},"",Re[O]||"/")}window.scrollTo(0,0),e(O)},ft=()=>{switch(t){case"home":return s.jsx(n3,{onNavigate:(O,U)=>{if(console.log("[NewHomeScreen] Navigation:",O,U),O==="login"){f(!0);return}if(U)if(U.wishId)console.log(" App.tsx: Setting selectedWishId to:",U.wishId),H(U.wishId),se("wish-detail");else if(U.taskId)console.log(" App.tsx: Setting selectedTaskId to:",U.taskId),ae(U.taskId),se("task-detail");else if(O==="chat"&&U.conversationId){P(U.conversationId),setTimeout(()=>{se("chat")},100);return}else typeof U=="object"&&"id"in U&&"title"in U?U.id&&U.id!=="undefined"&&U.id!=="null"?se("listing",U):(console.error(" [App] Listing object has invalid ID:",U?.id,"Title:",U?.title,"Type:",typeof U?.id),se("home")):O==="listing"?(console.error(" [App] Cannot navigate to listing - invalid data:",U),se("home")):se(O);else se(O)},isLoggedIn:!!r,isAdmin:o,userDisplayName:r?.name,unreadCount:_,notificationCount:zt,userLocation:xe&&xe.latitude!==void 0&&xe.longitude!==void 0?{latitude:xe.latitude,longitude:xe.longitude,area:xe.area,city:xe.city}:null,onNotificationClick:()=>ee(!0),onLocationClick:()=>St(!0),onMenuClick:()=>v(!0),onGlobalSearchClick:()=>be(!0),onContactClick:()=>k(!0),socialLinks:wt});case"marketplace":return s.jsx(Y5,{onListingClick:O=>{O?.id&&O?.title&&typeof O.id=="string"&&O.id!=="undefined"&&O.id!=="null"&&O.id!==""?se("listing",O):(console.error(" [App] MarketplaceScreen - Invalid listing data:","ID:",O?.id,"Title:",O?.title,"Type:",typeof O?.id),qe.error("Invalid listing data"))},selectedCity:st,selectedArea:Ae,onCityChange:O=>Qt(O),onAreaChange:O=>Je(O),onNavigate:(O,U)=>{U?.conversationId?(P(U.conversationId),se("chat")):se(O)},isLoggedIn:!!r,isAdmin:o,userDisplayName:r?.name,unreadCount:_,cities:N,globalLocationArea:xe?.area,globalLocationCity:xe?.city,onGlobalLocationClick:()=>St(!0),notificationCount:zt,onNotificationClick:()=>ee(!0),onMenuClick:()=>v(!0),userCoordinates:xe&&xe.latitude!==void 0&&xe.longitude!==void 0?{latitude:xe.latitude,longitude:xe.longitude}:null,onContactClick:()=>k(!0),socialLinks:wt});case"create":return r?s.jsx(s4,{onBack:()=>se("home"),onSuccess:()=>{at(!0),setTimeout(()=>at(!1),5e3),se("home"),qe.success("Listing created successfully! ")},onNavigate:O=>se(O),isLoggedIn:!!r,isAdmin:o,userDisplayName:r.name,unreadCount:_,cities:N}):null;case"profile":return s.jsx(f4,{user:r,onLogin:()=>f(!0),onLogout:Lr,onListingClick:O=>{O?.id&&O?.title&&typeof O.id=="string"&&O.id!=="undefined"&&O.id!=="null"&&O.id!==""?se("listing",O):(console.error(" [App] ProfileScreen - Invalid listing data:","ID:",O?.id,"Title:",O?.title,"Type:",typeof O?.id),qe.error("Invalid listing data"))},onEditListing:O=>{O?.id&&O?.title&&typeof O.id=="string"&&O.id!=="undefined"&&O.id!=="null"&&O.id!==""?se("edit",O):(console.error(" [App] ProfileScreen - Invalid edit listing data:","ID:",O?.id,"Title:",O?.title,"Type:",typeof O?.id),qe.error("Invalid listing data"))},onNavigate:(O,U)=>{console.log("[App.tsx] ProfileScreen onNavigate called:",{screen:O,data:U}),O==="create-wish"&&U?.editMode&&U?.wish?(console.log("[App.tsx] Setting editWishData:",U.wish),we(U.wish),se("create-wish")):O==="create-task"&&U?.editMode&&U?.task?(console.log("[App.tsx] Setting editTaskData:",U.task),le(U.task),se("create-task")):se(O)},isLoggedIn:!!r,isAdmin:o,userDisplayName:r?.name,unreadCount:_});case"listing":return l?s.jsx(y4,{listing:l,onBack:()=>{u(null),window.history.back()},isLoggedIn:!!r,onLoginRequired:()=>f(!0),onChatClick:async O=>{if(console.log(" Chat button clicked for listing:",O.id),console.log(" Seller userId/owner_token:",O.userId),!O.userId){console.error(" Listing has no userId"),qe.error("Unable to chat. Seller information is missing.");return}try{const{conversation:U,error:Re}=await Di(O.id,O.title,O.images[0],O.price,O.userId,O.userName,void 0,"listing");if(Re||!U){console.error(" Failed to create/get conversation:",Re),Re&&Re.includes("cannot chat with yourself")?qe.error("You cannot chat about your own listing."):Re&&Re.includes("profile could not be found")?qe.error("This listing is no longer available for chat. The seller may have deleted their account."):Re&&Re.includes("Seller information is missing")?qe.error("Unable to chat. Seller information is missing."):qe.error(Re||"Failed to open chat. Please try again.");return}console.log(" Conversation ready:",U.id),console.log(" Setting chatConversationId to:",U.id),P(U.id),console.log(" Waiting 100ms for state update before navigating..."),await new Promise(pe=>setTimeout(pe,100)),console.log(" chatConversationId SET - now navigating to chat screen"),console.log(" ChatScreen will auto-select the conversation with retry logic"),se("chat")}catch(U){console.error(" Exception in onChatClick:",U),qe.error("Failed to open chat. Please try again.")}},currentUserId:r?.id}):null;case"edit":return l&&r?s.jsx(b4,{listing:l,onBack:()=>{u(null),window.history.back()},onSuccess:()=>{u(null),se("home"),qe.success("Listing updated successfully!")},onNavigate:O=>se(O),isLoggedIn:!!r,isAdmin:o,userDisplayName:r.name,cities:N}):null;case"chat":return s.jsx(j4,{onBack:()=>{P(null),window.history.length>1?window.history.back():se("home")},initialConversationId:L,onNavigate:(O,U)=>{console.log(" [App.tsx] ChatScreen onNavigate:",{screen:O,data:U}),O==="wishDetail"&&U?.wishId?(H(U.wishId),se("wish-detail")):O==="taskDetail"&&U?.taskId?(ae(U.taskId),se("task-detail")):O==="listingDetail"&&U?.listingId?(async()=>{try{const pe=await hi(U.listingId,xe?.latitude,xe?.longitude);if(pe){const Ie=(await Ti()).find(Ze=>Ze.slug===pe.category_slug),$e=N.find(Ze=>Ze.name===pe.city),Te=$e?.areas?.find(Ze=>Ze.slug===pe.area_slug),Ye={id:pe.id,title:pe.title,description:pe.description,price:pe.price,categoryId:Ie?.id||0,categoryName:Ie?.name||"Other",categoryEmoji:Ie?.emoji||"",cityId:$e?.id||"",cityName:$e?.name||"",areaId:Te?.id||"",areaName:Te?.name||"",images:pe.images||[],phone:pe.owner_phone,hasWhatsapp:pe.whatsapp_enabled||!1,whatsapp:pe.whatsapp_number,userId:pe.owner_token,userName:pe.owner_name,createdAt:pe.created_at,isHidden:!pe.is_active,latitude:pe.latitude,longitude:pe.longitude,distance:pe.distance};se("listing",Ye)}else qe.error("Listing not found"),se("home")}catch(pe){console.error(" [App] Failed to fetch listing:",pe),qe.error("Failed to load listing"),se("home")}})():O==="listing"&&U&&typeof U=="object"&&"id"in U?U.id&&U.id!=="undefined"&&U.id!=="null"?se("listing",U):(console.error(" [App] Listing object has invalid ID:",U?.id,"Title:",U?.title,"Type:",typeof U?.id),se("home")):se(O)},isLoggedIn:!!r,isAdmin:o,userDisplayName:r?.name,unreadCount:_,onMenuClick:()=>v(!0),globalLocationArea:xe?.area,globalLocationCity:xe?.city,onGlobalLocationClick:()=>St(!0),notificationCount:zt,onNotificationClick:()=>ee(!0),onGlobalSearchClick:()=>be(!0)},L||"chat-default");case"admin":return r&&o?s.jsx(L4,{onNavigate:O=>se(O),isLoggedIn:!!r,isAdmin:o,userDisplayName:r.name}):null;case"about":return s.jsx(D4,{onBack:()=>se("home")});case"terms":return s.jsx(F4,{onBack:()=>se("home")});case"privacy":return s.jsx(M4,{onBack:()=>se("home")});case"safety":return s.jsx(O4,{onBack:()=>se("home")});case"prohibited":return s.jsx(V4,{onBack:()=>se("home")});case"contact":return s.jsx(U4,{onBack:()=>se("home")});case"diagnostic":return s.jsx(B4,{onNavigate:O=>se(O),isLoggedIn:!!r,isAdmin:o,userDisplayName:r?.name});case"notifications":return s.jsx(W4,{onNavigate:(O,U)=>{U?U.taskId?(ae(U.taskId),se("task-detail")):U.wishId?(H(U.wishId),se("wish-detail")):U.conversationId?(P(U.conversationId),se("chat")):se(O):se(O)},isLoggedIn:!!r,isAdmin:o,userDisplayName:r?.name,unreadCount:_,notificationCount:zt});case"wishes":return s.jsx(q4,{onNavigate:(O,U)=>{if(U){if(U.wishId)H(U.wishId),se("wish-detail");else if(U.taskId)ae(U.taskId),se("wish-detail");else if(O==="chat"&&U.conversationId){P(U.conversationId),setTimeout(()=>{se("chat")},100);return}}else se(O)},isLoggedIn:!!r,isAdmin:o,userDisplayName:r?.name,unreadCount:_,cities:N,onMenuClick:()=>v(!0),showGlobalLocation:!0,globalLocationArea:xe?.area,globalLocationCity:xe?.city,onLocationClick:()=>St(!0),notificationCount:zt,onNotificationClick:()=>ee(!0),userCoordinates:xe?.latitude&&xe?.longitude?{latitude:xe.latitude,longitude:xe.longitude}:null,onLoginRequired:()=>f(!0),onContactClick:()=>k(!0),socialLinks:wt});case"create-wish":return r?s.jsx(K4,{onBack:()=>se("home"),onSuccess:()=>{at(!0),setTimeout(()=>at(!1),5e3),se("home"),qe.success("Wish created successfully! ")},onNavigate:(O,U)=>{if(console.log("[App.tsx] CreateWishScreen onNavigate:",{screen:O,data:U}),U){if(U.wishId)H(U.wishId),we(null),se("wish-detail");else if(U.taskId)ae(U.taskId),se("task-detail");else if(O==="chat"&&U.conversationId){P(U.conversationId),setTimeout(()=>{se("chat")},100);return}}else se(O)},isLoggedIn:!!r,isAdmin:o,userDisplayName:r.name,unreadCount:_,cities:N,editMode:!!fe,wishId:fe?.id,wish:fe}):null;case"wish-detail":return D?s.jsx(Y4,{wishId:D,onBack:()=>{H(null),se("home")},onNavigate:(O,U)=>{O==="chat"&&U?.conversationId?(P(U.conversationId),setTimeout(()=>{se("chat")},100)):se(O)},isLoggedIn:!!r,onLoginRequired:()=>f(!0),currentUserId:r?.id,showGlobalLocation:!0,globalLocationArea:xe?.area,globalLocationCity:xe?.city,onLocationClick:()=>St(!0),onMenuClick:()=>v(!0),notificationCount:zt,onNotificationClick:()=>ee(!0),userCoordinates:xe?.latitude&&xe?.longitude?{latitude:xe.latitude,longitude:xe.longitude}:null}):null;case"tasks":return s.jsx(Q4,{user:r,onNavigate:(O,U)=>{if(U){if(U.editMode&&U.task)le(U.task),se("create-task");else if(U.taskId)ae(U.taskId),se("task-detail");else if(U.wishId)H(U.wishId),se("wish-detail");else if(O==="chat"&&U.conversationId){P(U.conversationId),setTimeout(()=>{se("chat")},100);return}}else se(O)},isLoggedIn:!!r,isAdmin:o,userDisplayName:r?.name,unreadCount:_,cities:N,showGlobalLocation:!0,globalLocationArea:xe?.area,globalLocationCity:xe?.city,onLocationClick:()=>St(!0),onMenuClick:()=>v(!0),notificationCount:zt,onNotificationClick:()=>ee(!0),userCoordinates:xe?.latitude&&xe?.longitude?{latitude:xe.latitude,longitude:xe.longitude}:null,onLoginRequired:()=>f(!0),onContactClick:()=>k(!0),socialLinks:wt});case"create-task":return r?s.jsx(Z4,{onBack:()=>{le(null),se("home")},onSuccess:()=>{at(!0),setTimeout(()=>at(!1),5e3),le(null),se("home"),qe.success(ue?"Task updated successfully! ":"Task created successfully!")},onNavigate:O=>{le(null),se(O)},isLoggedIn:!!r,isAdmin:o,userDisplayName:r.name,unreadCount:_,cities:N,editMode:!!ue,taskId:ue?.id,task:ue}):null;case"task-detail":return B?s.jsx(s3,{taskId:B,onBack:()=>{ae(null),se("home")},onNavigate:(O,U)=>{if(O==="create-task"&&U?.editMode&&U?.task&&le(U.task),O==="chat"&&U?.conversationId){P(U.conversationId),setTimeout(()=>{se("chat")},100);return}se(O)},isLoggedIn:!!r,onLoginRequired:()=>f(!0),isAdmin:o,userDisplayName:r?.name,showGlobalLocation:!0,globalLocationArea:xe?.area,globalLocationCity:xe?.city,onLocationClick:()=>St(!0),onMenuClick:()=>v(!0),unreadCount:_,notificationCount:zt,onNotificationClick:()=>ee(!0),userCoordinates:xe?.latitude&&xe?.longitude?{latitude:xe.latitude,longitude:xe.longitude}:null}):null;default:return null}};return s.jsxs("div",{className:"min-h-screen bg-[#F5F5F5]",children:[ft(),["home","marketplace","wishes","tasks","chat","profile","create-wish","create-task"].includes(t)&&s.jsx(D5,{currentScreen:t,onNavigate:O=>{if(O==="chat"&&!r){f(!0);return}se(O)},unreadCount:zt,chatUnreadCount:_,activeTasksCount:oe,onMenuClick:()=>v(!0)}),s.jsx(M5,{isOpen:y,onClose:()=>v(!1),isLoggedIn:!!r,isAdmin:o,userDisplayName:r?.name,onNavigate:O=>se(O),onLogout:Lr,onNotificationClick:()=>ee(!0),notificationCount:zt,onLocationClick:()=>St(!0),locationText:xe?.area&&xe?.city?`${xe.area}, ${xe.city}`:void 0,onLoginClick:()=>f(!0),onContactClick:()=>k(!0),appDownloadUrl:W,appDownloadEnabled:I}),s.jsx(O5,{isOpen:w,onClose:()=>k(!1)}),h&&s.jsx(R5,{onSuccess:O=>{Ms(O.clientToken),f(!1)},onClose:()=>f(!1)}),jt&&s.jsx(ao,{onLocationSelect:async O=>{const U=N.find(Ie=>Ie.name.toLowerCase()===O.city.toLowerCase());let Re=O.locality;if(!Re&&O.address){const Ie=O.address.split(",").map($e=>$e.trim()).filter(Boolean);Ie.length>=2?Re=`${Ie[0]}, ${Ie[1]}`:Ie.length>=1&&(Re=Ie[0])}Re||(Re=O.city);let pe=O.city;if(!pe||pe.trim()===""){const Ie=O.address.split(",").map($e=>$e.trim()).filter(Boolean);Ie.length>=3?pe=Ie[2]:Ie.length>=2&&(pe=Ie[1]),console.log(" Extracted city from address:",pe)}const De={cityId:U?.id||null,city:pe||O.locality||Re,areaId:O.locality||pe,area:Re,subAreaId:void 0,subArea:void 0,latitude:O.latitude,longitude:O.longitude,address:O.address,locality:O.locality,state:O.state,pincode:O.pincode,detectionMethod:"auto"};console.log(" Saving location with:",{area:De.area,city:De.city}),await ts(De),St(!1),xe&&xe.latitude?qe.success("Location updated! "):qe.success("Location set!  Now you can browse nearby items!")},onClose:()=>{xe&&xe.latitude&&St(!1)},currentLocation:xe&&xe.latitude?{latitude:xe.latitude,longitude:xe.longitude,city:xe.city}:null,title:xe&&xe.latitude?"Change Your Location":"Set Your Location",description:xe&&xe.latitude?"Update your location to see nearby items":"LocalFelo works better with your precise location"}),ve&&s.jsx(F5,{notifications:js,unreadCount:zt,onMarkAsRead:Ir,onMarkAllAsRead:dn,onDelete:mr,onClose:()=>ee(!1),onNotificationClick:O=>{ee(!1),O.action_url&&(O.related_type==="task"&&O.related_id?(ae(O.related_id),se("task-detail")):O.related_type==="wish"&&O.related_id?(H(O.related_id),se("wish-detail")):O.related_type==="chat"&&se("chat"))}}),ce&&s.jsx(i3,{notification:ce,onClose:()=>Ue(null),onAction:O=>{console.log(" Popup action:",O,ce),O==="chat"&&ce.related_id?(Ue(null),P(ce.related_id),se("chat")):(O==="view"&&ce.related_id||O==="complete"&&ce.related_id)&&(Ue(null),ae(ce.related_id),se("task-detail"))}}),s.jsx(V1,{position:"top-right",expand:!0,richColors:!0,closeButton:!0,toastOptions:{style:{background:"#000000",color:"#ffffff",border:"1px solid #333333"},className:"sonner-toast"}}),s.jsx(B5,{notifications:qe.notifications,onRemove:qe.removeNotification}),z&&s.jsx(a3,{onComplete:()=>{console.log(" [App] Intro completed - saving to localStorage"),localStorage.setItem("localfelo_intro_skipped","true"),G(!1),X(!0)},onSkip:()=>{console.log(" [App] Intro skipped - saving to localStorage"),localStorage.setItem("localfelo_intro_skipped","true"),G(!1),X(!0)}}),s.jsx(o3,{isOpen:ie,onClose:()=>be(!1),onNavigate:(O,U)=>{U?O==="listing"&&U.id?U.id&&U.id!=="undefined"&&U.id!=="null"&&U.id!==""?se("listing",U):(console.error(" [App] GlobalSearch listing has invalid ID:",U?.id,"Title:",U?.title,"Type:",typeof U?.id),se("home")):O==="wish-detail"&&U.wishId?(H(U.wishId),se("wish-detail")):O==="task-detail"&&U.taskId&&(ae(U.taskId),se("task-detail")):se(O)},userCoordinates:xe?.latitude&&xe?.longitude?{latitude:xe.latitude,longitude:xe.longitude}:null}),s.jsx(l3,{onNavigate:O=>se(O),activeTasksCount:oe}),s.jsx(Ar,{isOpen:g,onClose:()=>p(!1),title:"Menu",children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("button",{onClick:()=>{p(!1),se("about")},className:"w-full p-3 text-left flex items-center gap-3 hover:bg-input rounded transition-all",children:[s.jsx(n1,{className:"w-5 h-5 text-primary"}),s.jsx("span",{className:"text-body",children:"About"})]}),s.jsxs("button",{onClick:()=>{p(!1),se("safety")},className:"w-full p-3 text-left flex items-center gap-3 hover:bg-input rounded transition-all",children:[s.jsx(Rn,{className:"w-5 h-5 text-primary"}),s.jsx("span",{className:"text-body",children:"Safety Guidelines"})]}),s.jsxs("button",{onClick:()=>{p(!1),se("terms")},className:"w-full p-3 text-left flex items-center gap-3 hover:bg-input rounded transition-all",children:[s.jsx(An,{className:"w-5 h-5 text-primary"}),s.jsx("span",{className:"text-body",children:"Terms & Conditions"})]}),s.jsxs("button",{onClick:()=>{p(!1),se("privacy")},className:"w-full p-3 text-left flex items-center gap-3 hover:bg-input rounded transition-all",children:[s.jsx(An,{className:"w-5 h-5 text-primary"}),s.jsx("span",{className:"text-body",children:"Privacy Policy"})]}),s.jsxs("button",{onClick:()=>{p(!1),se("contact")},className:"w-full p-3 text-left flex items-center gap-3 hover:bg-input rounded transition-all",children:[s.jsx(Ci,{className:"w-5 h-5 text-primary"}),s.jsx("span",{className:"text-body",children:"Contact Us"})]})]})})]})}typeof window<"u"&&(window.clearUnreadMessages=async()=>{console.log(" Clearing all unread messages...");const t=await Wy();return t.success?(console.log(` Successfully cleared ${t.count||0} unread messages!`),console.log(" Please refresh the page.")):console.error(" Error:",t.error),t});Yw.createRoot(document.getElementById("root")).render(s.jsx(c3,{}));
